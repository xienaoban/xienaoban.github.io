<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Java 实现扫雷与高胜率低耗时自动扫雷 AI (下)</title>
    <url>/posts/62679.html</url>
    <content><![CDATA[<figure>
<img src="/posts/62679/figure-trans.png" alt="渐变头图"><figcaption>渐变头图</figcaption>
</figure>
<p>上一篇博客介绍了本项目总体情况, 这一篇来介绍一下我实现的自动扫雷 AI 算法. 本 AI 胜率比网上最高胜率的 AI 差 0.5% 左右. 不过本 AI 也不是没有优势, 它运算速度很快 (强行有优势 <code>(ˉ▽￣～)</code>), 平均 42 毫秒可以扫完一局 Win XP 规则下的专家难度.</p>
<p>这篇博客会介绍一下我的思路和踩过的坑, 也会列出一些关于胜率的数据. 希望能够帮助其他萌新入个门. 项目已经开源, 代码也写了注释, 链接放在文章最后.</p>
<p>先再次把最终成品的 AI 胜率等指标罗列一下:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">指标</th>
<th style="text-align: center;">Win XP 规则测试结果</th>
<th style="text-align: center;">Win 7 规则测试结果</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">测试版本</td>
<td style="text-align: center;">Win XP 规则, 专家难度</td>
<td style="text-align: center;">Win 7 规则, 专家难度</td>
</tr>
<tr class="even">
<td style="text-align: left;">测试局数</td>
<td style="text-align: center;">50,0000 局</td>
<td style="text-align: center;">50,0000 局</td>
</tr>
<tr class="odd">
<td style="text-align: left;">胜率</td>
<td style="text-align: center;">39.68%</td>
<td style="text-align: center;">52.45%</td>
</tr>
<tr class="even">
<td style="text-align: left;">运行总耗时</td>
<td style="text-align: center;">21275 秒</td>
<td style="text-align: center;">33136 秒</td>
</tr>
<tr class="odd">
<td style="text-align: left;">每局平均耗时</td>
<td style="text-align: center;">42 毫秒</td>
<td style="text-align: center;">66 毫秒</td>
</tr>
<tr class="even">
<td style="text-align: left;">胜局的每局平均耗时</td>
<td style="text-align: center;">57 毫秒</td>
<td style="text-align: center;">68 毫秒</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>注1:</strong> 测试 Win XP 规则是在半夜运行的, 电脑除了扫雷没有在运行其他进程; 而测试 Win 7 规则时我同时还在拿电脑办公, 导致 Win 7 规则下耗时比 XP 多. 而实际上 Win XP 与 Win 7 应该运行时间差不多. <strong>注2:</strong> 测试使用的扫雷程序是自己复现的 Win XP 与 Win 7 规则, 而非模拟鼠标点击原版扫雷窗口. 因为那样太慢了. 网上有大佬已经测试过, Win XP, Win 7 原版扫雷并无影响地雷分布的隐藏规则. 所以若真要在原版上测试, 结果应该不会有较大偏差.</p>
</blockquote>
<p>我在网上找到的胜率最高的扫雷 AI 是 <strong><a href="https://github.com/ztxz16/Mine" target="_blank" rel="noopener">ztxz16</a></strong> 大佬写的, <strong>Win XP 版本胜率 40.07%, Win 7 版本胜率 52.98%</strong>. 我的做法也是参考了 ztxz16 大佬的算法 (<a href="https://zhuanlan.zhihu.com/p/136791369" target="_blank" rel="noopener">最强扫雷 AI 算法详解 + 源码分享 - ztxz16</a>). B 站的 <a href="https://space.bilibili.com/434011092" target="_blank" rel="noopener">_黄歪歪</a> 应该也是他, 也发了些关于扫雷 AI 的视频. 膜一波.</p>
<p>不过 ztxz16 大佬的这个项目偏试验性, 我顶着没有注释的压力把大佬开源的源码看了一遍, 看得出来有些地方他应该是懒得优化, 最终 AI 速度不是很快. 我本来想自己测试一遍他的 AI, 但跑了一晚上也只跑出来了几千局还是几万局 (捂脸).</p>
<p>该交代的差不多都交代完了, 下面开始讲我的做法.</p>
<h2 id="高胜率低耗时自动扫雷-ai-算法">高胜率低耗时自动扫雷 AI 算法</h2>
<h3 id="术语与定义">术语与定义</h3>
<p>统一一下一些操作的术语方便后续描述. 我不是扫雷圈的, 很多术语可能不知道, 所以如果以下操作本来就有自己的中文名称, 提醒我我会改过来的!</p>
<table>
<thead>
<tr class="header">
<th>操作</th>
<th>术语</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>鼠标左键, 那个点开格子的操作</td>
<td>挖掘</td>
</tr>
<tr class="even">
<td>鼠标右键, 那个放置小红旗的操作</td>
<td>插旗</td>
</tr>
<tr class="odd">
<td>鼠标双键或中键, 那个自动检测周围八格是否可挖掘的操作</td>
<td>检查周围</td>
</tr>
<tr class="even">
<td>空白的, 没点过的格子</td>
<td>未知格</td>
</tr>
<tr class="odd">
<td>已知的有数字 (包括 0) 的格子 (已挖开且不是雷的格子)</td>
<td>数字格</td>
</tr>
</tbody>
</table>
<p>另外, 1. 格子坐标 <span class="math inline">\((x, y)\)</span> 表示 <span class="math inline">\(x\)</span> 行 <span class="math inline">\(y\)</span> 列, 下标从 <span class="math inline">\(0\)</span> 开始. 2. <span class="math inline">\(N\)</span> 和 <span class="math inline">\(M\)</span> 为棋盘行数与列数, <span class="math inline">\(S = N \times M\)</span> 表示格子总数. 3. 以下所涉及的 &quot;胜率&quot;, 除非另外注明, 均为 Win XP 规则专家难度下的胜率.</p>
<h3 id="第一步-开局挖哪">第一步: 开局挖哪</h3>
<p>开局第一步点击不同的地方也是会影响胜率的. 根据 ztxz16 大佬的测试 (<a href="https://www.bilibili.com/video/BV1Si4y1t7n1" target="_blank" rel="noopener">地表最强扫雷AI • 编程探索扫雷极限胜率 - _黄歪歪</a>), <strong>开局 Win XP 挖掘 <span class="math inline">\((0, 0)\)</span>, Win 7 挖掘 <span class="math inline">\((2, 2)\)</span> (或对称的另外三个角落) 胜率最高</strong>.</p>
<p>我自己也对 Win XP 与 Win7 大致测了一下 <span class="math inline">\((0, 1)\)</span>, <span class="math inline">\((1, 0)\)</span>, <span class="math inline">\((1, 1)\)</span> 等几个位置, 确实如此, 胜率会下降 1% ~ 2% 左右.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><img src="/posts/62679/round-start-xp.png" alt="Win XP 开局"></th>
<th style="text-align: center;"><img src="/posts/62679/round-start-7.png" alt="Win 7 开局"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Win XP 开局 <span class="math inline">\((0, 0)\)</span></td>
<td style="text-align: center;">Win 7 开局 <span class="math inline">\((2, 2)\)</span></td>
</tr>
</tbody>
</table>
<p>不过至于为什么是角落胜率比中心高, 我猜可能是角落有更多可套用减法公式的场景 (减法公式在下一节有讲). 减法公式本质就是根据相邻两个数字格的一侧去推断另一侧. 而边缘的格子天然已知靠边的一侧无雷, 因而可以更容易地推断出另一侧雷的个数.</p>
<h3 id="第二步-基于定义与定式">第二步: 基于定义与定式</h3>
<p>用到了两个基本公式或定式:</p>
<p>第一, 仅基于一格判断: 即根据目标数字格的数字与其周围八格 (角落的话不满八格) 的状态, 判断该数字格周围八格的未知格是不是全为雷或全不为雷. 这是扫雷最基本的公式. 其逻辑其实就是鼠标左右双键检查周围的逻辑.</p>
<p>第二, 基于相邻两格: 即使用减法公式.</p>
<figure>
<img src="/posts/62679/subtraction-formula.png" alt="减法公式"><figcaption>减法公式</figcaption>
</figure>
<p>如图, <span class="math inline">\(M\)</span>, <span class="math inline">\(N\)</span> 为两个相邻数字格, 两者上下各有一块互相影响的公共区域 <span class="math inline">\(P\)</span>, <span class="math inline">\(Q\)</span>, 左右则分别有互不影响的两翼 <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>. 记地雷数量为 <span class="math inline">\(C\)</span>, 显然地雷数量 <span class="math inline">\(C\)</span> 符合如下等式:</p>
<p><span class="math display">\[
\begin{cases}
C_{AroundM} = C_A + C_P + C_Q \\
C_{AroundN} = C_B + C_P + C_Q
\end{cases}
\]</span></p>
<p>两式相减即得减法公式:</p>
<p><span class="math display">\[
C_{AroundM} - C_{AroundN} = C_A - C_B
\]</span></p>
<p>即 <span class="math inline">\(M\)</span> 与 <span class="math inline">\(N\)</span> 的数字之差就是 <span class="math inline">\(A\)</span> 与 <span class="math inline">\(B\)</span> 雷数量之差.</p>
<p>举个简单的例子: 如下方案例图 1 两个数字格 <span class="math inline">\(2 - 1 = 1\)</span>, 即蓝色区域比绿色区域多一个雷, 而蓝色区域三个格子有两个已知不是雷, 故而可推得蓝色区域有且只有一个雷, 这个雷只能在 <code>*</code> 处. 既然蓝区有一个雷, 绿区就有 <span class="math inline">\(1 - 1 = 0\)</span> 个雷, 故而 <code>N</code> 处必为一个数字格.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><img src="/posts/62679/subtraction-formula-example.png" alt="减法公式最简单 &quot;2-1&quot; 案例"></th>
<th style="text-align: center;"><img src="/posts/62679/subtraction-formula-example-edge.png" alt="减法公式边缘案例"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">案例图 1</td>
<td style="text-align: center;">案例图 2</td>
</tr>
</tbody>
</table>
<p>而如果相邻两格的一侧在棋盘边缘, 如案例图 2 所示, 蓝区在棋盘外, 即蓝区无雷, 而 <span class="math inline">\(M - N = 0\)</span>, 故绿区均不为雷.</p>
<p>可见减法公式在边缘有更多的使用场景, 这可能也是开局要挖角落的原因之一.</p>
<blockquote>
<p>关于减法公式更详细的内容可以参考这篇专栏: <a href="https://zhuanlan.zhihu.com/p/27439584" target="_blank" rel="noopener">扫雷新手判雷上路（一）——初步认识减法公式及其衍生的最简单定式 - MsPVZ.ZSW</a>.</p>
</blockquote>
<h4 id="截至这一步的胜率与耗时">截至这一步的胜率与耗时</h4>
<p>如果仅仅使用基本定式, 遇到定式无法解决的就投降判负, 胜率在 5% 左右 (毕竟如果开局就点了个 '1', 那就直接无了).</p>
<p>而如果仅使用基本定式, 遇到定式无法解决的就瞎猜, 胜率就已经有 23% 了.</p>
<p>平均每局耗时在 4ms 以下, 没精确测过. 基于定式的算法虽然使用场景较为受限, 但效率非常高, 扫完一整局的时间复杂度也就 <span class="math inline">\(O(S)\)</span>.</p>
<h3 id="第三步-基于每个格子可能有雷的概率">第三步: 基于每个格子可能有雷的概率</h3>
<p>针对某一棋局局面, 每个未知格有雷的概率当然是可以计算出来的, 即</p>
<p><span class="math display">\[
目标未知格含雷概率 = \frac{目标未知格含雷的方案数量}{局面所有可行方案数量}
\]</span></p>
<p>扫的时候谁有雷的概率最低就扫谁.</p>
<p>局面所有可行方案的计算方法用回溯法即可. 当然直接就对所有未知格进行回溯的话复杂度有 <span class="math inline">\(O(2^S)\)</span> 自然受不了, 所以这一步的算法主要难点是剪枝.</p>
<p>如何剪枝, 可以用下面这张图很直观地展现出来:</p>
<p><img src="/posts/62679/prob-example.png"></p>
<p>在上图中, 每个未知格上都被打上了该格子的非雷概率 (注意, 这张图上展示的是 &quot;非雷概率&quot;, 也就是 <span class="math inline">\(1 - P_{有雷}\)</span>), 且与数字格相邻的未知格均被用彩色高亮了出来; 而不与数字格相邻的未知格则均用灰色标识.</p>
<p>不知道怎么取名, 这里我姑且将所有相近的 (不一定紧挨)、相同颜色的未知格集合称作一个 &quot;<strong>连通分量</strong>&quot;, 而剩下所有灰色格子姑且称之为 &quot;<strong>孤立格</strong>&quot;. 而本小节最重要的两个步骤就是①计算出所有连通分量, ②基于连通分量计算出每个未知格的有雷概率.</p>
<h4 id="计算连通分量">计算连通分量</h4>
<p>回溯法剪枝其实就是要分隔出尽可能短的连通分量, 然后在每个连通分量上回溯出所有可能方案, 最后合并所有连通分量的方案.</p>
<p>首先不太严谨地定义一下 &quot;连通分量&quot;. 在<strong>不考虑剩余雷数制约</strong>的前提下, 如果一个未知格 A 最终挖开的不同状态 (数字或雷) 会影响另一个未知格 B 不同状态的概率分布 (反过来 B 的状态也会影响 A), 则认为 A、B 同属一个连通分量. 且若 A、B 同属一个连通分量, B、C 同属一个连通分量, 则 A、B、C 同属一个连通分量.</p>
<p>放到实际计算中, 其实就很简单:</p>
<ol type="1">
<li>从任意数字格开始, 找出其周围八格中所有未知格, 并加入队列;</li>
<li>取队列中一未知格, 找出其周围八格中所有数字格, 再分别找出这些数字格周围八格的未知格入队列 (不重复入队).</li>
<li>重复 2 直到队列为空. 在队列里存在过的所有未知格均属同一连通分量.</li>
</ol>
<p>用上述方法计算得的连通分量内部其实依然可能存在互不影响的部分, 可以进一步优化, 将一个连通分量拆成多个更短的连通分量.</p>
<p>优化方法也很简单, 如果已经能确定某个未知格是雷, 请把他插上小红旗 (网上看了很多 AI 不喜欢插旗). 如下两张图所示.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><img src="/posts/62679/prob-without-flag.png" alt="连通分量 - 不插旗"></th>
<th style="text-align: center;"><img src="/posts/62679/prob-with-flag.png" alt="连通分量 - 插了旗"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">不插旗时找出的连通分量 (深红)</td>
<td style="text-align: center;">插了旗后找出的连通分量 (青色、深红)</td>
</tr>
</tbody>
</table>
<h4 id="计算有雷概率">计算有雷概率</h4>
<p>(公式敲的我头昏脑胀, 如有错误请指正)</p>
<p>回溯枚举所有 <span class="math inline">\(K\)</span> 个连通分量, 可以得到如下结果:</p>
<p>对于 <span class="math inline">\(\forall c \ge 0\)</span>, <span class="math inline">\(\forall i \in [1, K]\)</span>, <span class="math inline">\(\forall j \in [1, Len(CC_i)]\)</span>,</p>
<ul>
<li><span class="math inline">\(TotalCnt_{(i, c)}\)</span> - 当连通分量 <span class="math inline">\(CC_i\)</span> 中一共有 <span class="math inline">\(c\)</span> 个雷时的所有可行方案个数.</li>
<li><span class="math inline">\(MineCnt_{(i, j, c)}\)</span> - 当连通分量 <span class="math inline">\(CC_i\)</span> 中一共有 <span class="math inline">\(c\)</span> 个雷时, 属于 <span class="math inline">\(CC_i\)</span> 的格子 <span class="math inline">\(Cell_{(i, j)}\)</span> 在所有 <span class="math inline">\(TotalCnt_{(i, c)}\)</span> 个可行方案中有雷的次数.</li>
</ul>
<p>由上述信息可以计算, 前 <span class="math inline">\(k\)</span> 个连通分量 <span class="math inline">\(CC_1 \sim CC_k\)</span> 作为一个整体一共有 <span class="math inline">\(c\)</span> 个雷时的方案数:</p>
<p><span class="math display">\[
\begin{aligned}
MultiCnt_{(1 \sim k, c)}
&amp; = \sum_{s = 0}^c MultiCnt_{(1 \sim k - 1, s)} \times TotalCnt_{(k, c - s)} &amp; (1) \\
&amp; = \sum_{s = 0}^c MultiCnt_{(1 \sim i - 1, s)} \times MultiCnt_{(i \sim k, c - s)}, i \in [2, k] &amp; (2)
\end{aligned}
\]</span></p>
<blockquote>
<p>在实际编程中, 会涉及大量计算 <span class="math inline">\(MultiCnt_{(\text{except }i, c)}\)</span>. 使用上面 <span class="math inline">\((1)\)</span> 动态规划, 使用 <span class="math inline">\((2)\)</span> 从左右双向记忆化, 能节约点计算.</p>
</blockquote>
<p>然后对于所有不属于任何连通分量的孤立格, 我们也要计算它们的可行方案数. 若 <span class="math inline">\(b\)</span> 个孤立格中有 <span class="math inline">\(c\)</span> 个雷, 则这些孤立格的可行方案数为:</p>
<p><span class="math display">\[
IsolCnt_{(b, c)} = IsolCnt_{(b - 1, c)} + IsolCnt_{(b - 1, c - 1)}
\]</span></p>
<blockquote>
<p>实际实现中我直接打了个 <span class="math inline">\(16 \times 30 \times 99\)</span> 的表.</p>
</blockquote>
<p>于是可以计算, 所有 <span class="math inline">\(b\)</span> 个孤立格与指定连通分量集合 <span class="math inline">\(T\)</span> 在有 <span class="math inline">\(c\)</span> 个雷的情况下的可行方案数为:</p>
<p><span class="math display">\[
Cnt_{(T, c)} = \sum_{s = 0}^c MultiCnt_{(T, s)} \times IsolCnt_{(b, c - s)}
\]</span></p>
<p>于是, 对于任意连通分量的任意格子 <span class="math inline">\(Cell_{(i, j)}\)</span>, 一共 <span class="math inline">\(c\)</span> 个雷, <span class="math inline">\(K\)</span> 个连通分量, 其有雷概率为:</p>
<p><span class="math display">\[
MineProb_{(i, j)} = \frac{\sum_{s = 0}^c Cnt_{(\text{except }i, s)} \times MineCnt_{(i, j, c - s)}}{Cnt_{(1 \sim K, c)}}
\]</span></p>
<p>有了每个连通分量的格子的概率, 孤立格子的概率就很好算了:</p>
<p><span class="math display">\[
MineProb_{\text{isol}} = \frac{c - \sum_{i}\sum_{j}MineProb_{(i, j)}}{b}
\]</span></p>
<p>由此我们就计算出了所有未知格的有雷概率.</p>
<h4 id="附加小策略小技巧">附加小策略小技巧</h4>
<p>当有雷概率最低的未知格有不止一个时, 也有些小策略可以增加胜率. 经过实际测试, 目前我采用了以下策略, 能提升 2% 左右:</p>
<ol type="1">
<li>优先选择在四个角落的格子;</li>
<li>当两者都在 (或都不在) 角落时, 选择周围 24 格中数字格最多的.</li>
</ol>
<h4 id="截至这一步的胜率与耗时-1">截至这一步的胜率与耗时</h4>
<p>这一步的算法的使用场景是覆盖了基本定式那一步的, 即定式能做的概率也能做. 但定式速度快, 所以仍有存在意义. 测了十来万盘, &quot;定式 + 概率&quot; 策略的胜率在 36% ~ 37% 左右, 平均每局耗时 6ms.</p>
<p><del>(一开始我没有将连通分量的不同雷数分开考虑, 而是根据连通分量的平均雷数来计算, 导致胜率只有 32%, 可见近似算法差距还是很大的.)</del></p>
<p>而加上了那些小策略后, 胜率提升到了 38.5%.</p>
<p><strong>极端情况</strong>:</p>
<p>到这里你可能有疑问, 剪枝确实很高效, 但如果遇到极端情况不是依然得爆炸?</p>
<p>答案是肯定的. 但是经过我这么多次的测试, 基本上 1,0000 局里也很难遇上极端情况.</p>
<p>但如果您真的很迫切地想看我的 AI 出丑也没关系, 我亲自在项目根目录放了一个难以剪枝的残局案例, 保证让您风扇起飞.</p>
<figure>
<img src="/posts/62679/fuck-ai-file.png" alt="残局_给我卡死那个AI.txt"><figcaption>残局_给我卡死那个AI.txt</figcaption>
</figure>
<h3 id="第四步-基于对下一局面的有限预测">第四步: 基于对下一局面的有限预测</h3>
<p>这一步是我瞎想的, 没想到真的有用. 想到这一步的主要原因是, 无雷概率高不完全等于获胜概率高; 而计算胜率又绝大部分情况下不可行. 于是就想着整个折中方案.</p>
<p>这一步是针对上一步有雷概率计算出现多个格子有最低有雷概率的情况. 本策略会覆盖上面说的小策略小技巧, 但又由于本策略复杂度不低, 所以当判断发现计算量过大时还是采用之前的小策略小技巧.</p>
<p>原理是, 对于每个有雷概率最低的格子, 计算: 选择该格子后, 可被百分百确定的其他未知格的期望数量. 方法是, 枚举格子的所有可能性 (0 ~ 8, 雷), 使用上一步的概率计算这一假设的新局面中所有格子的非雷概率. 最后统计每个新局面必然非雷的格子个数, 计算一下它们的平均值.</p>
<p>最后我们选择期望值最高的格子.</p>
<h4 id="截至这一步的胜率与耗时-2">截至这一步的胜率与耗时</h4>
<p>测了万把盘, 胜率达到 39.3%, 平均每局耗 8ms 多.</p>
<p>这一步我做的比较保守, 因为我不知道有没有可能出现 &quot;非雷概率 A &gt; B&quot; 但 &quot;胜率 A &lt; B&quot; 的情况.</p>
<h3 id="第五步-基于胜率-最终杀招">第五步: 基于胜率 (最终杀招)</h3>
<p>最后一招, 直接把每个未知格的胜率算出来.</p>
<p>这里区分一下 &quot;获胜概率&quot; 与第三步的 &quot;有雷概率&quot;. 胜率是指挖掘某个未知格的最终获胜概率; 有雷概率是指当前局面下未知格是雷的概率. 显然, 当前局面所有未知格中最高的胜率代表了这个残局的整体胜率.</p>
<p>这世上没有什么策略比直接算胜率更准了, 但可惜它的复杂度过于恐怖, 所以我只在当残余未知格少于等于 12 时才会启用这个策略.</p>
<p>算法原理还是动态规划. 设 <span class="math inline">\(b\)</span> 为当前局面, <span class="math inline">\(b_{(x, y)}\)</span> 为将未知格 <span class="math inline">\(x\)</span> 设为数字 <span class="math inline">\(y\)</span> 的下一局面. 另设 <span class="math inline">\(CellWinRate()\)</span> 为某格子的胜率, <span class="math inline">\(BoardWinRate()\)</span> 为某局面的胜率, <span class="math inline">\(Cnt()\)</span> 为某局面的所有可行方案个数.</p>
<p><span class="math display">\[
\begin{aligned}
BoardWinRate(b) &amp; = \underset{x}{\text{Max}}(CellWinRate(b, x)) \\
CellWinRate(b, x) &amp; = \sum_{y=0}^{8}BoardWinRate(b_{(x, y)}) \times \frac{Cnt(b_{(x, y)})}{Cnt(b)} 
\end{aligned}
\]</span></p>
<p>每个局面 <span class="math inline">\(b\)</span> 可以状态压缩, 用一个 <code>String</code> 表示, 方便记忆化搜索.</p>
<p>胜率算法计算完后就很简单了, 胜率最高的格子随便挑一个挖. 而且所有后续局面的胜率也在之前的计算中缓存过了, 从缓存里掏出来一路扫到结束即可.</p>
<p>我自己整理了几个 &quot;无雷概率&quot; 与 &quot;获胜概率&quot; 区别的例子 (这里是无雷概率, 为了方便与胜率对比), 可以帮助理解一下:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">无雷概率</th>
<th style="text-align: center;">获胜概率</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="/posts/62679/3-2-mine.png" alt="无雷概率 3-2"></td>
<td style="text-align: center;"><img src="/posts/62679/3-2-win.png" alt="获胜概率 3-2"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="/posts/62679/6-3-mine.png" alt="无雷概率 6-3"></td>
<td style="text-align: center;"><img src="/posts/62679/6-3-win.png" alt="获胜概率 6-3"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="/posts/62679/6-4-mine.png" alt="无雷概率 6-4"></td>
<td style="text-align: center;"><img src="/posts/62679/6-4-win.png" alt="获胜概率 6-4"></td>
</tr>
</tbody>
</table>
<p>更多对比案例可以在我的 Github 项目根目录找到.</p>
<p><strong>衍生</strong></p>
<p>最后我稍微衍生了一下使用场景. 如果某个区域只可能有 <span class="math inline">\(c\)</span> 个雷 (雷数可确定, 比如幸福三选一), 那这片区域也能套用胜率算法直接扫掉, 姑且叫之局部胜率. 这个操作不会影响总体胜率, 但能稍微提一丢丢速 (指爆雷重开的速度... 早发现早治疗, 早暴毙早投胎).</p>
<h4 id="最终胜率与概率">最终胜率与概率</h4>
<p>已经写在博文最上面了. 50 万局测试, 胜率 39.68%, 平均每局 42ms.</p>
<h3 id="附-探索百分比">附: 探索百分比</h3>
<p>测试 50 万盘的时候顺便记录了一下每一局不论输赢都探索到了什么程度 (游戏结束前被扫开的格子占所有格子的百分比). 虽然不知道有什么用但也列一下 (柱状图是我在命令行里画的, 有点写意):</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Win XP 规则专家难度 <span class="number">50</span>,<span class="number">0000</span> 局:</span><br><span class="line">A 占比</span><br><span class="line">|</span><br><span class="line">|</span><br><span class="line">|</span><br><span class="line">|</span><br><span class="line">|</span><br><span class="line">|  M                                       M</span><br><span class="line">|  M                                   M   M</span><br><span class="line">|  M                                   M   M</span><br><span class="line">|  M   M   M   M   M   M   M   M   M   M   M</span><br><span class="line">+---------------------------------------------&gt; 探索程度</span><br><span class="line">   <span class="number">0</span>% <span class="number">10</span>% <span class="number">20</span>% <span class="number">30</span>% <span class="number">40</span>% <span class="number">50</span>% <span class="number">60</span>% <span class="number">70</span>% <span class="number">80</span>% <span class="number">90</span>% <span class="number">100</span>%</span><br></pre></td></tr></table></figure>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Win <span class="number">7</span> 规则专家难度 <span class="number">50</span>,<span class="number">0000</span> 局:</span><br><span class="line">A 占比</span><br><span class="line">|</span><br><span class="line">|</span><br><span class="line">|</span><br><span class="line">|                                          M</span><br><span class="line">|                                          M</span><br><span class="line">|                                          M</span><br><span class="line">|                                      M   M</span><br><span class="line">|                                      M   M</span><br><span class="line">|  M   M   M   M   M   M   M   M   M   M   M</span><br><span class="line">+---------------------------------------------&gt; 探索程度</span><br><span class="line">   <span class="number">0</span>% <span class="number">10</span>% <span class="number">20</span>% <span class="number">30</span>% <span class="number">40</span>% <span class="number">50</span>% <span class="number">60</span>% <span class="number">70</span>% <span class="number">80</span>% <span class="number">90</span>% <span class="number">100</span>%</span><br></pre></td></tr></table></figure>
<p>这么看确实 Win XP 下开局劝退得有点离谱.</p>
<h2 id="源码">源码</h2>
<blockquote>
<p>本博客仅发布于 Github IO: <a href="https://xienaoban.github.io/posts/62679.html" class="uri">https://xienaoban.github.io/posts/62679.html</a></p>
<p>和 CSDN: <a href="https://blog.csdn.net/xienaoban/article/details/112424633" target="_blank" rel="noopener" class="uri">https://blog.csdn.net/xienaoban/article/details/112424633</a></p>
<p>其他都是盗的.</p>
</blockquote>
<p>项目源码 Github: <a href="https://github.com/xienaoban/Minesweeper" target="_blank" rel="noopener" class="uri">https://github.com/xienaoban/Minesweeper</a> (喜欢的话 Star 一下呀 <code>（づ￣3￣）づ╭❤～</code>)</p>
<p>不会用 Github 的萌新也可以在这里下载: <a href="https://download.csdn.net/download/XieNaoban/14090898" target="_blank" rel="noopener" class="uri">https://download.csdn.net/download/XieNaoban/14090898</a></p>
<p>主要有以下几个文件:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">AutoSweeper.java    <span class="comment">// 自动扫雷 AI</span></span><br><span class="line">Gui.java            <span class="comment">// 扫雷 GUI 界面</span></span><br><span class="line">Main.java           <span class="comment">// 执行入口</span></span><br><span class="line">MineSweeper.java    <span class="comment">// 扫雷游戏规则的实现</span></span><br><span class="line">WinXpSweeper.java   <span class="comment">// 通过监视 Win XP 原版扫雷完成的规则实现</span></span><br></pre></td></tr></table></figure>
<p>其中 <code>AutoSweeper.java</code> 和 <code>MineSweeper.java</code> 写的比较上心, 有较为详细的注释, 代码结构也相对清晰. 别的几个文件就写的比较写意, 酌情观看.</p>
]]></content>
      <tags>
        <tag>笔记</tag>
        <tag>扫雷</tag>
        <tag>造轮子</tag>
        <tag>自动扫雷 AI</tag>
      </tags>
  </entry>
  <entry>
    <title>Java 实现扫雷与高胜率低耗时自动扫雷 AI (上)</title>
    <url>/posts/25814.html</url>
    <content><![CDATA[<figure>
<img src="/posts/25814/figure-trans.png" alt="渐变头图"><figcaption>渐变头图</figcaption>
</figure>
<p>东西是疫情期间做的, 但由于拖延症博客一直拖到现在都没写, 半年了再不写出来自己都要忘光了 <code>_(:з」∠)_</code>.</p>
<p>起因是疫情期间蹲家里, 就迷上了扫雷. Win XP 的扫雷程序在高分辨率屏下体验不好, 于是一开始是玩的 Win 10 商店里的那个 <a href="https://www.microsoft.com/zh-cn/p/microsoft-minesweeper/9wzdncrfhwcn?activetab=pivot:overviewtab" target="_blank" rel="noopener">Microsoft Minesweeper</a>, 但它区区一个扫雷却还好意思整了那么多广告, 搞得花里胡哨体验还差. 于是一时气愤, 决定自己写一个.</p>
<p>写完之后想着既然游戏本体都写了, 这不乘着气没消顺路再研究研究自动扫雷 AI? 于是又折腾了好一阵子, <del>终于发现 AI 确实难写... (啊不是)</del>, 终于写出一个胜率还能看, 速度也不差的 AI. 说实话写到后面挺丧气的, 毕竟是 19 世纪 60 年代的老游戏了, 我能想到的大佬们基本都想得到, 我做的也就是造个轮子以提高提高自己的代码姿势水平.</p>
<h2 id="成品介绍">成品介绍</h2>
<p>先列一下最终做出来的样子, 以防博客没人看. 开源地址放文末了.</p>
<h3 id="ai-胜率">AI 胜率</h3>
<p>先看 AI 的胜率 (专家难度) 与运行效率. 在 Win XP 的规则下 (开局第一步戳的格子必不为雷):</p>
<ul>
<li>测试了 <strong>50,0000 局</strong>,</li>
<li>AI <strong>胜率: 39.68%</strong>,</li>
<li>运行总耗时: 21275秒 (串行跑的),</li>
<li>每局<strong>平均耗时: 42毫秒</strong>,</li>
<li>所有胜局的每局平均耗时: 57毫秒.</li>
</ul>
<p>而在 Win 7 的规则下 (开局第一步戳的格子与其周围 8 格均不为雷), 也跑了 50,0000 局, AI <strong>胜率 52.45%</strong>.</p>
<blockquote>
<p><strong>注1:</strong> 测试 AI 使用的游戏规则是根据 Win XP, Win 7 版扫雷公开的规则自己复现的 (而不是在原版游戏窗口上模拟鼠标点击, 那样测试起来太慢了), 使用的地雷随机生成算法肯定与原版游戏不同, 但运行结果应该是差不多的 (网上有大佬测过, 原版扫雷并没有什么特殊的隐藏规则). <strong>注2:</strong> 测试用的是笔记本上的 CPU i7-7700HQ, 测试速度因人而异.</p>
</blockquote>
<p>我在网上看到的胜率最高的的应该是 <strong><a href="https://github.com/ztxz16/Mine" target="_blank" rel="noopener">ztxz16</a>大佬</strong> 的, <strong>Win XP 版本胜率 40.07%, Win 7 版本胜率 52.98%</strong>. 我的做法也有参考 ztxz16 大佬的算法 (<a href="https://zhuanlan.zhihu.com/p/136791369" target="_blank" rel="noopener">最强扫雷 AI 算法详解 + 源码分享 - ztxz16</a>).</p>
<h3 id="游戏本体">游戏本体</h3>
<p>游戏本体完成度其实也挺高的, 还带一些趣味小功能, 欢迎来玩~</p>
<p>首先是游戏界面. 仿的经典 XP 原版扫雷的风格. GUI 用的 Swing 编写. 操作比原版更人性化一点点, 比如支持改变格子大小, 支持单击已揭开的格子以快速检查周围 8 格 (原版要求左右键一起按) 等. 然后由于是 Java 写的所以跨平台 (Ubuntu 自带的扫雷竟然不能自动扫已知格子的周围八格, 十分影响体验. 但是在 Ubuntu 下实测 Emoji 和字体渲染有偏差, 但至少能用, 所以暂时不想管了).</p>
<figure>
<img src="/posts/25814/mine-lose.png" alt="稀疏平常的一局"><figcaption>稀疏平常的一局</figcaption>
</figure>
<p>菜单里的功能有:</p>
<figure>
<img src="/posts/25814/menus.png" alt="所有菜单"><figcaption>所有菜单</figcaption>
</figure>
<p>其中部分功能的说明:</p>
<ol type="1">
<li><p>套娃扫雷: 在我的扫雷程序里扫原版程序的雷 (没看懂? 没看懂就对了). 原理是在屏幕里找到 XP 原版扫雷的窗口, 然后同步棋盘到我的扫雷程序的棋盘, 同时玩家对我的扫雷程序的操作都会同步到原版扫雷. <img src="/posts/25814/control-xp-player-trans.gif" alt="套娃扫雷 - 玩家"></p>
<p>乍一看是不是感觉很无厘头 <code>&lt;(*￣▽￣*)/</code>, 但此时再配合我的 AI 的概率预测与自动清扫功能, 事情就变得有意思了起来~ <img src="/posts/25814/control-xp-prob.png" alt="套娃扫雷 - 概率"></p>
<p>没错, 可以拿来分析棋局! 帮助初学者快速入门 (好吧, 确实有种透视外挂的感觉了...</p>
<p>当然硬要用 AI 去扫原版 XP 扫雷游戏也不是不可以~ <img src="/posts/25814/control-xp-ai-trans.gif" alt="套娃扫雷 - 自动"></p></li>
<li>规则切换: 众所周知, 扫雷有两套经典的规则, 分别使用在 Win XP 版与 Win 7 版上. Win XP 版的规则是, 挖的第一个格子必不为雷; Win 7 版的规则是, 挖的第一个格子与其周围 8 格均必不为雷.</li>
<li><p>作弊: 不开启作弊则下面的选项都是灰的. 开启作弊后不会计时 (永远 9999). &gt; <strong>注:</strong> 这里区分一下本游戏中的 &quot;作弊&quot; 与 &quot;AI&quot;. 作弊是指直接告诉你所有雷在哪, AI 则是在游戏规则内帮你推断雷在哪.</p></li>
<li>撤销操作: 字面意思, 但是只能撤销一步, 毕竟不会真的有人在除了炸雷以外的时候去用这个功能吧?</li>
<li>透视: 直接把雷显示在棋盘上.</li>
<li>导入, 保存棋盘: 从文件导入残局, 以及把当前残局导出到文件. 为什么使用这个功能也需要先开启作弊呢? 因为文件里需要储存雷的位置...</li>
<li>提示一格: 使用最简单的扫雷规则找出一个必为雷或必不为雷的格子并予以高亮, 旨在辅助星际玩家找出遗漏的地方 (类似于连连看里的提示).</li>
<li><p>显示概率: 对整个棋盘精准地计算每个格子不是雷的概率 (通过展示出来的不同颜色, 相信你也猜出来大概用的什么算法去计算的了). <img src="/posts/25814/ai-prob.png" alt="AI - 概率"></p></li>
<li><p>显示胜率: 对整个棋盘精准地计算每个格子作为下一步挖掘目标时的全局胜率. 计算胜率的算法复杂度爆炸, 所以只在残局未知格子少于等于 12 时才计算. 胜率和上面的概率是两个概念. 具体在算法原理部分会解释. <img src="/posts/25814/ai-prob-vs-win-rate.png" alt="AI - 概率 VS 胜率"></p></li>
<li>安全清扫 (很快): 用简单的规则帮你清扫棋局. 所以运行速度极快. 所谓 &quot;安全&quot; 就是指只清扫必为雷或必不为雷的格子.</li>
<li>安全清扫 (较慢): 在上面规则的基础上, 计算概率再清扫一遍必为雷或必不为雷的格子. 尽管已经充分剪枝, 计算概率的复杂度依然较高. 绝大部分情况下还是能很快出结果, 但是在极端环境下可能会耗时很久.</li>
<li><p>扫到结束: 所有算法一起上, 遇到不一定是不是雷的格子则根据概率与胜率猜雷, 直到胜利或失败.</p></li>
</ol>
<p>以上基本就是游戏的全部功能了. 下面介绍 AI 算法.</p>
<p>但是又看了一下, 本文长度够<del>水</del>一篇了 <code>(～￣▽￣)～</code>, 所以决定拆开来, 下一篇再讲 AI, 这篇就算是项目介绍~</p>
<h2 id="项目开源地址">项目开源地址</h2>
<blockquote>
<p>本博客仅发布于 Github IO: <a href="https://xienaoban.github.io/posts/25814.html" class="uri">https://xienaoban.github.io/posts/25814.html</a></p>
<p>和 CSDN: <a href="https://blog.csdn.net/xienaoban/article/details/112424609" target="_blank" rel="noopener" class="uri">https://blog.csdn.net/xienaoban/article/details/112424609</a></p>
<p>其他都是盗的.</p>
</blockquote>
<p>Github 发布页: <a href="https://github.com/xienaoban/Minesweeper/releases" target="_blank" rel="noopener" class="uri">https://github.com/xienaoban/Minesweeper/releases</a> (喜欢的话 Star 一下呀 <code>（づ￣3￣）づ╭❤～</code>)</p>
<p>不会用 Github 的萌新也可以在这里下载: <a href="https://download.csdn.net/download/XieNaoban/14090898" target="_blank" rel="noopener" class="uri">https://download.csdn.net/download/XieNaoban/14090898</a></p>
]]></content>
      <tags>
        <tag>笔记</tag>
        <tag>扫雷</tag>
        <tag>造轮子</tag>
        <tag>自动扫雷 AI</tag>
      </tags>
  </entry>
  <entry>
    <title>带精英策略的非支配排序的遗传算法 NSGAII</title>
    <url>/posts/60126.html</url>
    <content><![CDATA[<p>啊要出分数线了好紧张. 赶紧复习复习以前学的东西_(:з」∠)_</p>
<p>竟然写了大半天, 全都忘光了, 怕不是要凉 (/ﾟДﾟ)/</p>
<h1 id="遗传算法genetic-algorithm">遗传算法(Genetic Algorithm)</h1>
<p>此处使用二进制编码法形成染色体.</p>
<p>种群初始化: 随机将染色体的某些 DNA 置 1, 进行 M 次, 形成 M 个不重复的个体组成第一代种群.</p>
<p>适应度评价: 对每个个体运行适应度评价函数, 区分群体中个体好坏. 并按照一定策略选择出部分适应度高的个体, 作为下一代的父代.</p>
<p>交叉与变异: 对挑选出的父代, 每次随机选择两个染色体, 在一定概率下将两者的某些 DNA 进行交换, 形成两个新的个体, 即为染色体的交叉; 同时上述新产生的个体有一定概率发生染色体变异, 即对染色体的某些位取反. 最后形成新的子代. 遗传算法就是上述步骤的反复.</p>
<h1 id="非支配排序遗传算法non-dominated-sorting-genetic-algorithm-nsga">非支配排序遗传算法(Non-Dominated Sorting Genetic Algorithm, NSGA)</h1>
<p>有时候我们的优化目标不止一个, 比如买菜时同时要求菜越新鲜越好, 且单价越便宜越好. 这便是多目标优化问题. 面对此类问题时, 无法用 1 个指标衡量染色体的好坏, 在判断两个染色体孰优孰劣时将会产生困难. NSGA 解决多目标问题和普通 GA 的主要区别就是在选择算子执行之前对个体关系的分层, 而选择算子, 交叉算子, 变异算子没有区别.</p>
<h2 id="pareto-支配关系">Pareto 支配关系</h2>
<p>Pareto 最优解给出了多目标问题的判别的方法.</p>
<p>对于最小化多目标问题, n 个目标分量 <span class="math inline">\(f_i\)</span> <span class="math inline">\((i=1,...,n)\)</span> 组成的向量 <span class="math inline">\(\overline{f}(\overline{X})=(f_1(\overline{X}), f_2(\overline{X}), ..., f_n(\overline{X}))\)</span>, 给定两个决策变量 <span class="math inline">\(\overline{X}_u, \overline{X}_v \ U\)</span>:</p>
<ul>
<li>当且仅当 <span class="math inline">\(\forall i \in \{1, ..., n\}\)</span> 时, 都有 <span class="math inline">\(f_i(\overline{X}_u) &lt; f_i(\overline{X}_v)\)</span>, 则 <span class="math inline">\(\overline{X}_u\)</span> 支配 <span class="math inline">\(\overline{X}_v\)</span>.</li>
<li>当且仅当 <span class="math inline">\(\forall i \in \{1, ..., n\}\)</span> 时, 都有 <span class="math inline">\(f_i(\overline{X}_u) \leqslant f_i(\overline{X}_v)\)</span>, 且至少存在一个 <span class="math inline">\(j \in \{1, ..., n\}\)</span> 使得 <span class="math inline">\(f_j(\overline{X}_u) = f_j(\overline{X}_v)\)</span>, 则 <span class="math inline">\(\overline{X}_u\)</span> 弱支配 <span class="math inline">\(\overline{X}_v\)</span>.</li>
<li>当且仅当 <span class="math inline">\(\exists i \in \{1, ..., n\}\)</span>, 使 <span class="math inline">\(f_i(\overline{X}_u) &lt; f_i(\overline{X}_v)\)</span>, 且 <span class="math inline">\(\exists j \in \{1, ..., n\}\)</span>, 使 <span class="math inline">\(f_j(\overline{X}_u) &gt; f_j(\overline{X}_v)\)</span>, 则 <span class="math inline">\(\overline{X}_u\)</span> 和 <span class="math inline">\(\overline{X}_v\)</span> 互不支配.</li>
</ul>
<p>若 <span class="math inline">\(\overline{X}_u\)</span> 为 Pareto 最优解, 则不存在 <span class="math inline">\(\overline{X}_v \in U\)</span> 支配 <span class="math inline">\(\overline{X}_u\)</span>.</p>
<h2 id="非支配排序">非支配排序</h2>
<p>对于互不支配的染色体, 我们称这些染色体处于同一层. 则所有的染色体可以被划分到若干层. 非支配排序就是将染色体分层的排序算法, 分得的层称为第一级非支配层, 第二级非支配层...... 其中第一级非支配层处于 Pareto 前沿(Pareto Front).</p>
<p>非支配排序步骤如下:</p>
<ul>
<li>(1)设 <span class="math inline">\(i = 1\)</span>;</li>
<li>(2)对所有的 <span class="math inline">\(j = 1, 2, ..., N (j \ne i)\)</span>, 基于适应度函数比较个体 <span class="math inline">\(x_i\)</span>, <span class="math inline">\(x_j\)</span> 之间的支配关系;</li>
<li>(3)若不存在任何一个个体 <span class="math inline">\(x_j\)</span> 优于 <span class="math inline">\(x_i\)</span>, 则标记 <span class="math inline">\(x_i\)</span> 为非支配个体;</li>
<li>(4)令 <span class="math inline">\(i = i + 1\)</span>, 转到 (1), 重复直至找到所有非支配个体.</li>
</ul>
<p>上述步骤将得到第一级非支配层, 过滤第一层所有个体后再次运行非支配排序, 即可得到第二级非支配层.</p>
<p>可以看到每找一层的时间复杂度是 <span class="math inline">\(O(MN^2)\)</span> (<span class="math inline">\(M\)</span> 为目标数, <span class="math inline">\(N\)</span> 为种群大小), 最多要找 <span class="math inline">\(N\)</span> 次, 所以一共的时间复杂度到了 <span class="math inline">\(O(MN^3)\)</span>.</p>
<h2 id="虚拟适应度略">虚拟适应度(略)</h2>
<p>为了算法更快地收敛, 虚拟适应度越大(层数越低)的个体应该有更多机会进入下一代. 但同时, 我们期望的 Pareto 最优解集应该是均匀分布的(而不是都挤在一个或几个点附近), 因此还要保证当前非支配层上的个体具有多样性。NSGA 中引入了基于拥挤策略的小生境(NIChe)技术, 对每个个体计算共享适应度.</p>
<h1 id="带精英策略的非支配排序遗传算法nsga-ii">带精英策略的非支配排序遗传算法(NSGA-II)</h1>
<p>NSGA-II 是 NSGA 的改进. NSGA-II 相对于 NSGA, 1. 提出了快速非支配排序算子, 将非支配排序从 <span class="math inline">\(O(MN^3)\)</span> 优化到了 <span class="math inline">\(O(MN^2)\)</span> (<span class="math inline">\(M\)</span> 为目标数, <span class="math inline">\(N\)</span> 为种群大小); 2. 提出了拥挤距离算子; 3. 提出了精英策略选择算子.</p>
NSGA-II 流程图
<div id="flowchart-0" class="flow-chart">

</div>
<h2 id="快速支配排序算子">快速支配排序算子</h2>
<ul>
<li>(1)对种群 <span class="math inline">\(P\)</span> 中的每个个体 <span class="math inline">\(p\)</span>, 计算 <span class="math inline">\(p\)</span> 在种群 <span class="math inline">\(P\)</span> 中支配的个体数 <span class="math inline">\(n_p\)</span>, 并将这些被 <span class="math inline">\(p\)</span> 支配的个体存入 <span class="math inline">\(S_p\)</span> 中(即每个个体都要两两比较一次, 共比较 <span class="math inline">\(\frac{N(N-1))}{2}\)</span> 次, 每次比较要遍历 <span class="math inline">\(M\)</span> 个目标, 时间复杂度 <span class="math inline">\(O(MN^2)\)</span>);</li>
<li>(2)<span class="math inline">\(layer = 1\)</span>;</li>
<li>(3)找出所有 <span class="math inline">\(n_p = 0\)</span> 的个体, 保存在数组 <span class="math inline">\(F_{layer}\)</span> 中;</li>
<li>(4)对于 <span class="math inline">\(F_{layer}\)</span> 中的每个个体 <span class="math inline">\(p\)</span> 的支配集 <span class="math inline">\(S_p\)</span>: 遍历 <span class="math inline">\(S_p\)</span>, 对 <span class="math inline">\(S_p\)</span> 中每个个体 <span class="math inline">\(l\)</span>, 执行 <span class="math inline">\(n_l = n_l - 1\)</span>;</li>
<li>(5)<span class="math inline">\(layer = layer + 1\)</span>, 重复(3).</li>
</ul>
<h2 id="拥挤距离算子">拥挤距离算子</h2>
<ul>
<li>(1)对每个个体 <span class="math inline">\(p\)</span> 令拥挤距离 <span class="math inline">\(d_p = 0, p = 1, 2, ..., N\)</span></li>
<li>(2)对 <span class="math inline">\(M\)</span> 个目标的每个目标函数 <span class="math inline">\(f_m\)</span>:
<ul>
<li>1)根据目标 <span class="math inline">\(f_m\)</span> 的数值大小, 对每个个体排序;</li>
<li>2)对每个个体 <span class="math inline">\(p\)</span>, 计算 <span class="math inline">\(d_p = d_p + (f_m(p+1) - f_m(p-1))\)</span> (其中第一个和最后一个个体拥挤距离设为无穷 <span class="math inline">\(d_1 = d_N = \infty\)</span>)</li>
</ul></li>
</ul>
<p>选择时优先选择拥挤距离 <span class="math inline">\(d\)</span> 大的.</p>
<h2 id="精英策略选择算子">精英策略选择算子</h2>
即保留父代优良个体直接进入子代, 以防止 Pareto 前沿的解丢失. 具体操作就可以直接把父代子代合并到一起进行非支配排序.
<script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script>
<textarea id="flowchart-0-code" style="display: none">st=>start: 开始
init=>operation: 随机生成第一代种群
eval=>operation: 计算每个个体的所有目标
gene=>operation: 选择, 交叉, 变异
merg=>operation: 父代与子代合并
fnds=>operation: 快速非支配排序
cong=>operation: 拥挤距离计算
selc=>operation: 选择优秀个体组成新的父代
iter=>condition: 运行代数大于最大代数?
opt=>inputoutput: 输出 Pareto 前沿
e=>end: 结束
st->init->eval->fnds->cong->iter
iter(no)->selc(right)->gene(right)->merg(right)->eval
iter(yes)->opt->e</textarea><textarea id="flowchart-0-options" style="display: none">{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-0-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-0", options);</script>
]]></content>
      <tags>
        <tag>笔记</tag>
        <tag>NSGA-II</tag>
        <tag>遗传算法</tag>
        <tag>多目标</tag>
      </tags>
  </entry>
  <entry>
    <title>ACM笔记 - 组合数</title>
    <url>/posts/36480.html</url>
    <content><![CDATA[<h1 id="一高中数学公式复习">一、高中数学公式复习</h1>
<p><span class="math inline">\(C_n^m = \frac{n!}{m!(n-m)!}\)</span></p>
<p><span class="math inline">\(C_n^m = C_n^{n-m} = C^{m}_{n-1} + C^{m-1}_{n-1}\)</span></p>
<p><span class="math inline">\(C_n^0+C_n^1+C_n^2+...+C_n^n = \sum_{i=0}^{n}{C_n^i} = 2^n\)</span></p>
<p><span class="math inline">\(C_n^0+C_n^2+C_n^4+... = C_n^1+C_n^3+C_n^5+... = 2^{n-1}\)</span></p>
<p><span class="math inline">\(C_n^m+C_{n+1}^m+C_{n+2}^m+...+C_{n+m}^m = \sum_{i=0}^{m}C_{n+i}^{m} = C_{n+m+1}^{m+1}\)</span></p>
<p><span class="math inline">\(k C_n^k = nC_{n-1}^{k-1}\)</span>， <span class="math inline">\(\frac{C_n^k}{k+1} = \frac{C_{n+1}^{k+1}}{n+1}\)</span> （好吧这个没学过但是既然看到了就一并抄过来了）</p>
<h1 id="二快速求组合数取模cn-mp">二、快速求组合数取模C(n, m)%p</h1>
<p>当n和p大小不同时方法有不同。</p>
<h2 id="n很小p随意p不需要为素数">1. n很小，p随意，p不需要为素数</h2>
<h3 id="原理">1) 原理</h3>
<p>使用<font color="#FF0000">杨辉三角</font>：<span class="math inline">\(C^{m}_{n}\%p = (C^{m-1}_{n-1}+C^{m}_{n-1})\%p\)</span>。</p>
<p>组合数C(n, m)其实就是杨辉三角第n行第m列的值（下标从0开始算的话）。每一行的各个值都是迭代上一行的结果。那么用二维数组打个表即可，for里套个for。</p>
<h3 id="我的模板">2) 我的模板</h3>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> lld;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1000</span>+<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">lld C_arr[maxn+<span class="number">10</span>][maxn+<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">C_init</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> pr)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) &#123;</span><br><span class="line">		C_arr[i][<span class="number">0</span>] = C_arr[i][i] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j++)</span><br><span class="line">			C_arr[i][j] = (C_arr[i - <span class="number">1</span>][j - <span class="number">1</span>] + C_arr[i - <span class="number">1</span>][j]) % pr;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">lld <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> C_arr[n][m];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="n相对小方便打表p可以很大p要求为素数">2. n相对小（方便打表），p可以很大，p要求为素数</h2>
<h3 id="原理-1">1) 原理</h3>
<p>仅使用<font color="#FF0000">费马小定理</font>： 若p是质数，且a,p互质，那么 a的(p-1)次方除以p的余数恒等于1， 即a^(p-1) ≡ 1 （mod p），所以a^(p-2) ≡ 1/a (mod p)。所以a的逆元为a^(p-2)。于是将<span class="math inline">\(\frac{n!}{m!(n-m)!}\)</span> 中的除法全变成了乘法：</p>
<p>得到公式：<span class="math inline">\(C^{m}_{n}\%p = ((n!)\%p*[(n-m)!]^{p-2}\%p*(m!)^{p-2}\%p)\%p\)</span></p>
<h3 id="我的模板-1">2) 我的模板</h3>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">lld <span class="title">pow_mod</span><span class="params">(lld a, lld b, <span class="keyword">const</span> <span class="keyword">int</span> &amp;pr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	lld ans = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (b) &#123;</span><br><span class="line">		<span class="keyword">if</span> (b &amp; <span class="number">1</span>) ans = ans * a % pr;</span><br><span class="line">		b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">		a = a * a % pr;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">lld <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> fac(n) % p * pow_mod(fac(n - m), p - <span class="number">2</span>, p) * pow_mod(fac(m), p - <span class="number">2</span>, p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到这里最麻烦的是求阶乘<code>fac(n)</code>，如果n不大的话打表是极好的。n较大的话使用以下公式递归求得：</p>
<p><span class="math inline">\(n! = \frac{n!}{(\frac{n}{2})!\frac{n}{2})!}*[(\frac{n}{2})!]^2 = C^{n/2}_n*[(\frac{n}{2})!]^2\)</span></p>
<p>具体以后再写一篇求阶乘。</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">lld <span class="title">C_small</span><span class="params">(lld n, lld m, <span class="keyword">const</span> <span class="keyword">int</span> &amp;pr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	lld ans = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		lld a = (n - m + i) % pr;</span><br><span class="line">		lld b = i % pr;</span><br><span class="line">		ans = ans * (a * pow_mod(b, pr - <span class="number">2</span>, pr) % pr) % pr; <span class="comment">//Fermat Theory</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是不打表的版本（其实就是没打表而已，没什么区别）。</p>
<h2 id="n很大时要求p较小p105p要求为素数">3. n很大时要求p较小（p&lt;10^5），p要求为素数</h2>
<h3 id="原理-2">1) 原理</h3>
<p>使用<font color="#FF0000">Lucas定理</font>：<span class="math inline">\(C^{m}_{n}\%p =(C^{m\%p}_{n\%p}C^{m/p}_{n/p})\%p\)</span>。</p>
<p>为什么要求p挺小，由公式就可以看出，p太大了的话<span class="math inline">\(C^{m\%p}_{n\%p}\)</span>也依然很大。Lucas定理用到了费马小定理，要求p为素数。对于每个<span class="math inline">\(C^{m/p}_{n/p}\)</span>，递归调用Lucas定理。可以看见n被p取模后很容易就变小了，所以要求p较小。</p>
<p>定理证明：<a href="http://blog.csdn.net/zengaming/article/details/63681754" target="_blank" rel="noopener">网上看到的大神的博客</a></p>
<h3 id="我的模板-2">2) 我的模板</h3>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> lld;</span><br><span class="line"></span><br><span class="line"><span class="function">lld <span class="title">pow_mod</span><span class="params">(lld a, lld b, <span class="keyword">const</span> <span class="keyword">int</span> &amp;pr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	lld ans = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (b) &#123;</span><br><span class="line">		<span class="keyword">if</span> (b &amp; <span class="number">1</span>) ans = ans * a % pr;</span><br><span class="line">		b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">		a = a * a % pr;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">lld <span class="title">C_small</span><span class="params">(lld n, lld m, <span class="keyword">const</span> <span class="keyword">int</span> &amp;pr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	lld ans = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		lld a = (n - m + i) % pr;</span><br><span class="line">		lld b = i % pr;</span><br><span class="line">		ans = ans * (a * pow_mod(b, pr - <span class="number">2</span>, pr) % pr) % pr; <span class="comment">//Fermat Theory</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">lld <span class="title">C</span><span class="params">(lld n, lld m, <span class="keyword">const</span> <span class="keyword">int</span> &amp;pr)</span> <span class="comment">// Lucas's theorem</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (m == <span class="number">0</span> || m == n) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> C_small(n % pr, m % pr, pr) * C(n / pr, m / pr, pr) % pr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>C_small就是用求逆元求解，像法二一样做打表也是极好的。 如果n不大，p很大，用一下Lucas定理后也就相当于执行了法二，所以以后直接用Lucas即可。</p>
<h1 id="三vandermonde恒等式">三、Vandermonde恒等式</h1>
<p><font color="#FF0000">范德蒙（Vandermonde）恒等式</font>：</p>
<p><span class="math display">\[C^{k}_{n+m} = \sum^{k}_{i=0}C^{i}_{n}C^{k-i}_{m}\]</span></p>
<p>其中k肯定得小于等于min(n,m)。</p>
<p>理解：从n个黑球、m个白球里找k个球有多少方式。</p>
<p>当<span class="math inline">\(k=min(n,m)\)</span>时，这里假设<span class="math inline">\(m&lt;n\)</span>，那就是<span class="math inline">\(k=m\)</span>时，可以变个形：</p>
<p><span class="math display">\[C^{k}_{n+m} = \sum^{k}_{i=0}C^{i}_{n}C^{m-k+i}_{m} = \sum^{m}_{i=0}C^{i}_{n}C^{i}_{m}\]</span></p>
<p>那意义就是n个黑球和m白个球中各找0个、1个、2个……m个对应颜色的球，一共有多少方法。</p>
<p>例题链接：<a href="http://blog.csdn.net/xienaoban/article/details/64547450" target="_blank" rel="noopener">Codeforces 785D - Anton and School - 2</a></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
      </categories>
      <tags>
        <tag>笔记</tag>
        <tag>组合数</tag>
      </tags>
  </entry>
  <entry>
    <title>LATEX 安装使用</title>
    <url>/posts/60405.html</url>
    <content><![CDATA[<p>啊... 又要写毕业论文了... 担心 Overleaf 须要联网有一定风险, 还是打算 本地 TeX Live + Github 版本管理与备份.</p>
<h1 id="安装">安装</h1>
<h2 id="tex-live-2021">TeX Live 2021</h2>
<p>用国内镜像下载, 速度快: <a href="https://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/Images/" target="_blank" rel="noopener">清华源</a> | <a href="https://mirrors.huaweicloud.com/CTAN/systems/texlive/Images/" target="_blank" rel="noopener">华为云源</a> | <a href="https://link.zhihu.com/?target=https%3A//mirrors.aliyun.com/CTAN/systems/texlive/Images/">阿里云源</a>.</p>
<p>双击下载的 ISO, 打开 (不用管理员) <code>install-tl-windows.bat</code>, 会有 GUI 安装界面. 我直接便携安装在 D 盘了, 安装出来有 7 个多 G, 语言少选几个可以少安装一个 G, 不过也就一个 G, 干脆全装了.</p>
<blockquote>
<p>好家伙装了半个多小时了, 怎么还没装完, 我这硬盘还是 SSD.</p>
</blockquote>
<blockquote>
<p>妈耶一看全是几 k 到几百 k 的小文件... 又让我想起了被 NPM 的依赖包支配的恐惧...</p>
</blockquote>
<blockquote>
<p>尼玛快 50 分钟了吧? 早知道直接上 Overleaf 了... 感觉现在 Overleaf 访问也挺稳定的.</p>
</blockquote>
<blockquote>
<p>终于装完了...</p>
</blockquote>
<p>由于我选了便携安装, 所以为了识别出那几个指令, 要自己把安装路径的 bin <code>D:\texlive\2021\bin\win32</code> 加入系统环境变量的 Path 里.</p>
<h2 id="vscode-插件配置">VSCode 插件配置</h2>
<ol type="1">
<li><p>安装 SumatraPDF 可以实时预览: <a href="https://www.sumatrapdfreader.org" target="_blank" rel="noopener">官网</a> | <a href="https://github.com/sumatrapdfreader/sumatrapdf" target="_blank" rel="noopener">Github</a>. 这是可选项, 但是确实方便. 由于只是给 LaTeX 用, 就下了个便携版, 下下来只有一个 exe, 直接扔 TeX Live 目录里得了.</p></li>
<li><p>在 VSCode 插件商店安装 LaTeX Workshop, 用来语法高亮, 自动补全, 编译什么的.</p></li>
<li>在 VSCode 按 <code>F1</code>, 输入 <code>setjson</code>, 选择 <code>首选项: 打开设置 (json)</code>, 在最外层花括号内追加如下内容: <figure class="highlight"><table><tr><td class="code"><pre><span class="line">// ======================== LaTeX 设置 BEGIN  ========================</span><br><span class="line">// bibtex 格式</span><br><span class="line">"latex-workshop.bibtex-format.tab": "tab",</span><br><span class="line"></span><br><span class="line">// 自动编译，全部关闭，当且仅当你认为有需要的时候才会去做编译</span><br><span class="line">"latex-workshop.latex.autoBuild.run": "never",</span><br><span class="line">"latex-workshop.latex.autoBuild.cleanAndRetry.enabled": false,</span><br><span class="line"></span><br><span class="line">// 设置 latex-workshop 的 PDF 预览程序，external 指的是外部程序</span><br><span class="line">"latex-workshop.view.pdf.viewer": "tab",</span><br><span class="line">"latex-workshop.view.pdf.ref.viewer": "external",</span><br><span class="line">"latex-workshop.view.pdf.external.viewer.command": "D:\\texlive\\SumatraPDF-3.3.3-64.exe", // 注意修改路径</span><br><span class="line">"latex-workshop.view.pdf.external.viewer.args": [</span><br><span class="line">    <span class="string">"%PDF%"</span></span><br><span class="line">],</span><br><span class="line"></span><br><span class="line">// 配置正向、反向搜索：.tex -&gt; .pdf</span><br><span class="line">"latex-workshop.view.pdf.external.synctex.command": "D:\\texlive\\SumatraPDF-3.3.3-64.exe", // 注意修改路径</span><br><span class="line">"latex-workshop.view.pdf.external.synctex.args": [</span><br><span class="line">    // 正向搜索</span><br><span class="line">    "-forward-search",</span><br><span class="line">    "%TEX%",</span><br><span class="line">    "%LINE%",</span><br><span class="line">    "-reuse-instance",</span><br><span class="line">    // 反向搜索</span><br><span class="line">    "-inverse-search",</span><br><span class="line">    "\"C:\\Users\\xie\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe\" \"C:\\Users\\xie\\AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\out\\cli.js\" -gr %f:%l",</span><br><span class="line">    <span class="string">"%PDF%"</span></span><br><span class="line">],</span><br><span class="line"></span><br><span class="line">// 这是一些独立的编译选项，可以作为工具被编译方案调用</span><br><span class="line">"latex-workshop.latex.tools": [&#123;</span><br><span class="line">        // Windows 原生安装 TeX Live 2020 的编译选项</span><br><span class="line">        "name": "Windows XeLaTeX",</span><br><span class="line">        "command": "xelatex",</span><br><span class="line">        "args": [</span><br><span class="line">            "-synctex=1",</span><br><span class="line">            "-interaction=nonstopmode",</span><br><span class="line">            "-file-line-error",</span><br><span class="line">            "-pdf",</span><br><span class="line">            <span class="string">"%DOCFILE%"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        // Windows BibTeX 编译</span><br><span class="line">        "name": "Windows BibTeX",</span><br><span class="line">        "command": "bibtex",</span><br><span class="line">        "args": [</span><br><span class="line">            <span class="string">"%DOCFILE%"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        // Windows Biber 编译</span><br><span class="line">        "name": "Windows Biber",</span><br><span class="line">        "command": "biber",</span><br><span class="line">        "args": [</span><br><span class="line">            <span class="string">"%DOCFILE%"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        // WSL XeLaTeX 编译一般的含有中文字符的文档</span><br><span class="line">        "name": "WSL XeLaTeX",</span><br><span class="line">        "command": "wsl",</span><br><span class="line">        "args": [</span><br><span class="line">            "/usr/local/texlive/2020/bin/x86_64-linux/xelatex",</span><br><span class="line">            "-synctex=1",</span><br><span class="line">            "-interaction=nonstopmode",</span><br><span class="line">            "-file-line-error",</span><br><span class="line">            "-pdf",</span><br><span class="line">            //"-output-directory=%OUTDIR%",</span><br><span class="line">            //"-aux-directory=%OUTDIR%",</span><br><span class="line">            <span class="string">"%DOCFILE%"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        // WSL biber / bibtex 编译带有 citation 标记项目的文档</span><br><span class="line">        "name": "WSL Biber",</span><br><span class="line">        "command": "wsl",</span><br><span class="line">        "args": [</span><br><span class="line">            "/usr/local/texlive/2020/bin/x86_64-linux/biber",</span><br><span class="line">            <span class="string">"%DOCFILE%"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        // macOS 或者 Linux 的简单编译</span><br><span class="line">        // 两种操作系统的操作方式相同</span><br><span class="line">        "name": "macOS / Linux XeLaTeX",</span><br><span class="line">        "command": "xelatex",</span><br><span class="line">        "args": [</span><br><span class="line">            "-synctex=1",</span><br><span class="line">            "-interaction=nonstopmode",</span><br><span class="line">            "-file-line-error",</span><br><span class="line">            "-pdf",</span><br><span class="line">            <span class="string">"%DOCFILE%"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        // macOS 或者 Linux 的索引编译</span><br><span class="line">        // 两种操作系统的操作方式相同</span><br><span class="line">        "name": "macOS / Linux Biber",</span><br><span class="line">        "command": "biber",</span><br><span class="line">        "args": [</span><br><span class="line">            <span class="string">"%DOCFILE%"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">],</span><br><span class="line"></span><br><span class="line">// 这是一些编译方案，会出现在 GUI 菜单里</span><br><span class="line">"latex-workshop.latex.recipes": [&#123;</span><br><span class="line">        // 1.1 Windows 编译简单的小文档，这个选项不太常用，因为绝大多数文章都需要有参考文献索引</span><br><span class="line">        "name": "Windows XeLaTeX 简单编译",</span><br><span class="line">        "tools": [</span><br><span class="line">            <span class="string">"Windows XeLaTeX"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        // 1.2 Windows 编译带有索引的论文，需要进行四次编译；-&gt; 符号只是一种标记而已，没有程序上的意义</span><br><span class="line">        "name": "Windows xe-&gt;bib-&gt;xe-&gt;xe 复杂编译",</span><br><span class="line">        "tools": [</span><br><span class="line">            "Windows XeLaTeX",</span><br><span class="line">            "Windows BibTeX",</span><br><span class="line">            "Windows XeLaTeX",</span><br><span class="line">            <span class="string">"Windows XeLaTeX"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        // 2.1  WSL 编译简单的小文档，这个选项不太常用，因为我绝大多数文章都需要有引用。</span><br><span class="line">        "name": "XeLaTeX 简单编译",</span><br><span class="line">        "tools": [</span><br><span class="line">            <span class="string">"WSL XeLaTeX"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        // 2.2 带有 citation 索引的文档，需要进行四次编译；-&gt; 符号只是一种标记而已，没有程序上的意义</span><br><span class="line">        "name": "xe-&gt;bib-&gt;xe-&gt;xe 复杂编译",</span><br><span class="line">        "tools": [</span><br><span class="line">            "WSL XeLaTeX",</span><br><span class="line">            "WSL Biber",</span><br><span class="line">            "WSL XeLaTeX",</span><br><span class="line">            <span class="string">"WSL XeLaTeX"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        // 3.1 macOS 简单 小文档</span><br><span class="line">        "name": "macOS XeLaTeX 简单编译",</span><br><span class="line">        "tools": [</span><br><span class="line">            <span class="string">"macOS XeLaTeX"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        // 3.2 macOS 四次编译</span><br><span class="line">        "name": "macOS xe-&gt;bib-&gt;xe-&gt;xe 复杂编译",</span><br><span class="line">        "tools": [</span><br><span class="line">            "macOS / Linux XeLaTeX",</span><br><span class="line">            "macOS / Linux Biber",</span><br><span class="line">            "macOS / Linux XeLaTeX",</span><br><span class="line">            <span class="string">"macOS / Linux XeLaTeX"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">],</span><br><span class="line"></span><br><span class="line">// 清空中间文件</span><br><span class="line">"latex-workshop.latex.clean.fileTypes": [</span><br><span class="line">    "*.aux",</span><br><span class="line">    "*.bbl",</span><br><span class="line">    "*.blg",</span><br><span class="line">    "*.idx",</span><br><span class="line">    "*.ind",</span><br><span class="line">    "*.lof",</span><br><span class="line">    "*.lot",</span><br><span class="line">    "*.out",</span><br><span class="line">    "*.toc",</span><br><span class="line">    "*.acn",</span><br><span class="line">    "*.acr",</span><br><span class="line">    "*.alg",</span><br><span class="line">    "*.glg",</span><br><span class="line">    "*.glo",</span><br><span class="line">    "*.gls",</span><br><span class="line">    "*.ist",</span><br><span class="line">    "*.fls",</span><br><span class="line">    "*.log",</span><br><span class="line">    "*.fdb_latexmk",</span><br><span class="line">    "*.bcf",</span><br><span class="line">    "*.run.xml",</span><br><span class="line">    //"*.synctex.gz"</span><br><span class="line">]</span><br><span class="line">// ======================== LaTeX 设置 END ========================</span><br></pre></td></tr></table></figure> 上面这串设置是网上找的 (文章都是抄来抄去, 也不知道到底是谁整理的...), 不过看着很靠谱. 但也是自己改动了一些.
<ol type="1">
<li>首先是网上找的原版有错别字, 有个 <code>command</code> 打成了 <code>commmand</code>...</li>
<li>其次由于我用的是 BibTeX 而不是 Biber, 所以依葫芦画瓢加了个 Windows BibTeX 的配置, 复杂编译改成了 BibTeX (其他 Linux, Mac 的没改, 还是 Biber).</li>
<li><code>latex-workshop.view.pdf.viewer</code> 改成了 <code>tab</code>, 在 VSCode 内部打开预览窗口. 原本是 <code>external</code>.</li>
<li>Json 里面要注意必须修改的有两个, 一个是 VSCode 的路径要替换, 一个是 SumatraPDF 的路径.</li>
</ol></li>
<li><p>搞腚! <img src="/posts/60405/vscode-latex-preview.png" alt="vscode-latex-preview.png"> 点上面那个绿色的播放键 <span style="color:green;font-weight: bold">▷</span> 就会编译并更新预览. 当然你也可以把 VSCode 设置里的 <code>latex-workshop.latex.autoBuild.run</code> 改成 <code>onSave</code> 甚至 <code>onFileChange</code>, 可以做到实时刷新. 但是 LaTeX 毕竟不是 Markdown, 编译还是挺慢的, 想想还是手动更新好了.</p></li>
</ol>
<h2 id="安装问题踩坑">安装问题踩坑</h2>
<h3 id="vscode-报错-recipe-terminated-with-fatal-error-spawn-xelatex-enoent.">VSCode 报错: <code>Recipe terminated with fatal error: spawn xelatex ENOENT.</code></h3>
<p>这是忘记把安装路径的 bin 加入 Path 了.</p>
<h3 id="编译报错-cannot-find-xxx.bcf">编译报错: <code>Cannot find 'xxx.bcf'!</code></h3>
<p>将默认文献工具改为 BibTeX, 于是找的不是 <code>.bcf</code> 而是 <code>.bib</code> 了.</p>
<h1 id="搞论文">搞论文</h1>
<p>复旦毕业论文模板: <a href="https://github.com/stone-zeng/fduthesis" target="_blank" rel="noopener">曾祥东大佬的模板 Github</a></p>
]]></content>
  </entry>
  <entry>
    <title>LeetCode 第 223 场周赛</title>
    <url>/posts/45902.html</url>
    <content><![CDATA[<h1 id="解码异或后的数组"><a href="https://leetcode-cn.com/problems/decode-xored-array/" target="_blank" rel="noopener">5649. 解码异或后的数组</a></h1>
<p>异或运算可逆, 所以直接异或回去.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] decode(<span class="keyword">int</span>[] encoded, <span class="keyword">int</span> first) &#123;</span><br><span class="line">        <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[encoded.length + <span class="number">1</span>];</span><br><span class="line">        res[<span class="number">0</span>] = first;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; encoded.length; ++i) &#123;</span><br><span class="line">            res[i + <span class="number">1</span>] = res[i] ^ encoded[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="交换链表中的节点"><a href="https://leetcode-cn.com/problems/swapping-nodes-in-a-linked-list/" target="_blank" rel="noopener">5652. 交换链表中的节点</a></h1>
<p>双指针, 前者距离后者 k 格.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * public class ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode next;</span></span><br><span class="line"><span class="comment"> *     ListNode() &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val) &#123; this.val = val; &#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val, ListNode next) &#123; this.val = val; this.next = next; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ListNode <span class="title">swapNodes</span><span class="params">(ListNode head, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        ListNode n2 = head;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; k; ++i) n2 = n2.next;</span><br><span class="line">        ListNode swap1 = n2;</span><br><span class="line">        ListNode n1 = head;</span><br><span class="line">        <span class="keyword">while</span> (n2.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">            n2 = n2.next;</span><br><span class="line">            n1 = n1.next;</span><br><span class="line">        &#125;</span><br><span class="line">        ListNode swap2 = n1;</span><br><span class="line">        <span class="keyword">int</span> t = swap1.val;</span><br><span class="line">        swap1.val = swap2.val;</span><br><span class="line">        swap2.val = t;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="执行交换操作后的最小汉明距离"><a href="https://leetcode-cn.com/problems/minimize-hamming-distance-after-swap-operations/" target="_blank" rel="noopener">5650. 执行交换操作后的最小汉明距离</a></h1>
<p>可以任意交换, 也就是只要两个节点直接或间接有边, 就能交换.</p>
<p>并查集找出所有连通图, 连通图里的节点可以任意交换. 把连通图里所有节点打入一个集合, target 要啥我就从集合里拿啥, 不在集合里就 res - 1.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minimumHammingDistance</span><span class="params">(<span class="keyword">int</span>[] source, <span class="keyword">int</span>[] target, <span class="keyword">int</span>[][] allowedSwaps)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = source.length;</span><br><span class="line">        HashMap[] a = <span class="keyword">new</span> HashMap[n];</span><br><span class="line">        <span class="keyword">int</span>[] f = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) f[i] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] e : allowedSwaps) merge(f, e[<span class="number">0</span>], e[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) find(f, i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[f[i]] == <span class="keyword">null</span>) a[f[i]] = <span class="keyword">new</span> HashMap();</span><br><span class="line">            <span class="keyword">if</span> (f[i] != i) a[i] = a[f[i]];</span><br><span class="line">            <span class="keyword">int</span> cnt = (<span class="keyword">int</span>) a[i].getOrDefault(source[i], <span class="number">0</span>);</span><br><span class="line">            a[i].put(source[i], cnt + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">int</span> cnt = (<span class="keyword">int</span>) a[i].getOrDefault(target[i], <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (cnt == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">            --res;</span><br><span class="line">            a[i].put(target[i],cnt - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span>[] f, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(f[x] == x) <span class="keyword">return</span> x;</span><br><span class="line">        <span class="keyword">return</span> f[x] = find(f, f[x]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span>[] f, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = find(f, i), y = find(f, j);</span><br><span class="line">        <span class="keyword">if</span> (x &lt; y) &#123;</span><br><span class="line">            <span class="keyword">int</span> t = x;</span><br><span class="line">            x = y;</span><br><span class="line">            y = t;</span><br><span class="line">        &#125;</span><br><span class="line">        f[x] = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="完成所有工作的最短时间"><a href="https://leetcode-cn.com/problems/find-minimum-time-to-finish-all-jobs/" target="_blank" rel="noopener">5639. 完成所有工作的最短时间</a></h1>
<p>比赛时没做出来, 赛后倒是想出来了一个方法, 虽然还是很暴力... 但至少过了.</p>
<p>用回溯法枚举所有任务分配给任意用户的情况.</p>
<p>然后发现很多回溯是重复的. 比如说如下两种分配, 其实是一种 (这里 <code>arr[i]</code> 表示任务 <code>i</code> 分配给打工人 <code>arr[i]</code>):</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">[<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<p>最简单的, 我们发现开局分配第一个工作时, 分配给谁都是一样的, 每种情况回溯下来都是重复的, 那我们不如让第一个工作只分配给第一个人. 同样, 第二个工作要么继续分配给第一个人, 要么分配给一个没工作的人, 而所有没工作的人情况都是重复的, 于是不如就指定分给第二个人.</p>
<p>也就是给定 <code>n</code> 个 job 和 <code>k</code> 个人. 在已经分配了 <code>x</code> 个 job 给前 <code>y</code> 个人的情况下, 第 <code>x + 1</code> 个 job 要么继续分配给前 <code>y</code> 个人的其中之一, 要么分配给一个任意的没工作的人. 于是本来这个 job 要回溯所有 <code>k</code> 个人, 现在剪成只要回溯 <code>min(k, x + 1)</code>.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] job;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] man;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> res;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minimumTimeRequired</span><span class="params">(<span class="keyword">int</span>[] jobs, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (jobs.length &lt;= k) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> v : jobs) x = Math.max(x, v);</span><br><span class="line">            <span class="keyword">return</span> x;</span><br><span class="line">        &#125;</span><br><span class="line">        job = jobs;</span><br><span class="line">        man = <span class="keyword">new</span> <span class="keyword">int</span>[k];</span><br><span class="line">        res = <span class="number">0x7fffffff</span>;</span><br><span class="line">        f(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> max, <span class="keyword">int</span> used)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i == job.length) &#123;</span><br><span class="line">            res = Math.min(res, max);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> type = Math.min(man.length, used + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; type; ++ j) &#123;</span><br><span class="line">            man[j] += job[i];</span><br><span class="line">            f(i + <span class="number">1</span>, Math.max(max, man[j]), Math.max(used, j + <span class="number">1</span>));</span><br><span class="line">            man[j] -= job[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行用时：345 ms, 内存消耗：35.9 MB</p>
<p>这方法不好, 看大佬的方法是二分 + 状态压缩DP 可以只用几毫秒.</p>
]]></content>
  </entry>
  <entry>
    <title>LeetCode 第 38 场双周赛</title>
    <url>/posts/5962.html</url>
    <content><![CDATA[<p>一阵子没打了, 竟然四题都做出来了.</p>
<h1 id="按照频率将数组升序排序"><a href="https://leetcode-cn.com/contest/biweekly-contest-38/problems/sort-array-by-increasing-frequency/" target="_blank" rel="noopener">5539. 按照频率将数组升序排序</a></h1>
<h2 id="题解">题解</h2>
<p>很暴力地构建 <code>{数值: 频率}</code> 字典, 再很暴力地根据频率构建 <code>{频率: 降序数值列表}</code>. 最后根据频率升序输出.</p>
<h2 id="垃圾代码">垃圾代码</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">frequencySort</span><span class="params">(self, nums: List[int])</span> -&gt; List[int]:</span></span><br><span class="line">        mp = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> nums: mp[n] = mp.get(n, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">        mp2 = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> k, v <span class="keyword">in</span> mp.items():</span><br><span class="line">            mp2.setdefault(v, []).append(k)</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> sorted(mp2.keys()):</span><br><span class="line">            v = sorted(mp2[k], reverse=<span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">for</span> n <span class="keyword">in</span> v:</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> range(int(k)):</span><br><span class="line">                    res.append(n)</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h1 id="两点之间不包含任何点的最宽垂直面积"><a href="https://leetcode-cn.com/contest/biweekly-contest-38/problems/widest-vertical-area-between-two-points-containing-no-points/" target="_blank" rel="noopener">5540. 两点之间不包含任何点的最宽垂直面积</a></h1>
<h2 id="题解-1">题解</h2>
<p><code>Point.Y</code> 是干扰项, 没用. 直接对每个 <code>Point.X</code> 排序, 找出相邻 <code>Point.X</code> 最大的间隔. 比第一题还水.</p>
<h2 id="垃圾代码-1">垃圾代码</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxWidthOfVerticalArea</span><span class="params">(self, points: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        lst = []</span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> points: lst.append(p[<span class="number">0</span>])</span><br><span class="line">        lst.sort()</span><br><span class="line">        x = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(lst)):</span><br><span class="line">            x = max(x, lst[i] - lst[i - <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure>
<h1 id="统计只差一个字符的子串数目"><a href="https://leetcode-cn.com/contest/biweekly-contest-38/problems/count-substrings-that-differ-by-one-character/" target="_blank" rel="noopener">5541. 统计只差一个字符的子串数目</a></h1>
<h2 id="题解-2">题解</h2>
<p>对 <code>t</code> 构造前缀树 <code>trie</code>, 同时 <code>trie</code> 每一层保存从根节点到目前位置的字串个数. 然后以 <code>s</code> 的每个字符作为起点去递归匹配 <code>trie</code>, 递归匹配时考虑 <code>目前仍无字符不同</code> 与 <code>目前已有一个字符不同</code> 两种情况, 返回所有子情况的个数的求和.</p>
<h2 id="垃圾代码-讲道理-python-写-trie-属实方便">垃圾代码 (讲道理 Python 写 Trie 属实方便)</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">countSubstrings</span><span class="params">(self, s: str, t: str)</span> -&gt; int:</span></span><br><span class="line">        trie = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(t)):</span><br><span class="line">            nxt = trie</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> t[i:]:</span><br><span class="line">                nxt = nxt.setdefault(c, &#123;&#125;)</span><br><span class="line">                nxt[<span class="string">''</span>] = nxt.get(<span class="string">''</span>, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">        <span class="comment"># print(trie)</span></span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">            res += self.cal(s, i, trie)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cal</span><span class="params">(self, s, idx, trie, diff=False)</span>:</span></span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> idx &gt;= len(s): <span class="keyword">return</span> res</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> trie:</span><br><span class="line">            <span class="keyword">if</span> c == <span class="string">''</span>: <span class="keyword">continue</span></span><br><span class="line">            next_trie = trie[c]</span><br><span class="line">            <span class="keyword">if</span> c == s[idx]:</span><br><span class="line">                <span class="keyword">if</span> diff: res += next_trie[<span class="string">''</span>]</span><br><span class="line">                res += self.cal(s, idx + <span class="number">1</span>, next_trie, diff)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> diff: <span class="keyword">pass</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    res += next_trie[<span class="string">''</span>]</span><br><span class="line">                    res += self.cal(s, idx + <span class="number">1</span>, next_trie, <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h1 id="通过给定词典构造目标字符串的方案数"><a href="https://leetcode-cn.com/contest/biweekly-contest-38/problems/number-of-ways-to-form-a-target-string-given-a-dictionary/" target="_blank" rel="noopener">5542. 通过给定词典构造目标字符串的方案数</a></h1>
<h2 id="题解-3">题解</h2>
<p>动态规划. 设 <span class="math inline">\(Words\)</span> 每个 <span class="math inline">\(Word\)</span> 长度为 <span class="math inline">\(L_w\)</span>, <span class="math inline">\(Target\)</span> 长度为 <span class="math inline">\(L_t\)</span>, <span class="math inline">\(N(i, j)\)</span> 为 <span class="math inline">\(Target\)</span> 第 <span class="math inline">\(i\)</span> 个字符在 <span class="math inline">\(Words\)</span> 第 <span class="math inline">\(j\)</span> 列出现次数. <span class="math inline">\(Words\)</span> 用前 <span class="math inline">\(j\)</span> 个字符成功匹配 <span class="math inline">\(Target\)</span> 前 <span class="math inline">\(i\)</span> 个字符的可能情况数 <span class="math inline">\(DP(i, j)\)</span> 为</p>
<p><span class="math display">\[
DP(i, j) = DP(i - 1, j - 1) \times N(i, j) + DP(i, j - 1)
\]</span></p>
<p>遍历时 <span class="math inline">\(j\)</span> 从 <span class="math inline">\(i\)</span> 而不是 <span class="math inline">\(0\)</span> 开始, 因为大于等于 <span class="math inline">\(i\)</span> 个字符才可能匹配上 <span class="math inline">\(i\)</span> 个字. 同理 <span class="math inline">\(j\)</span> 大于 <span class="math inline">\(L_w - L_t + i\)</span> 时剩下的字符也不可能匹配得完, 即 <span class="math inline">\(j \in [i, L_w - L_t + i]\)</span>.</p>
<p>可以看到状态转移方程只跟 <span class="math inline">\(i\)</span> 和 <span class="math inline">\(i - 1\)</span> 有关, 所以可以将 DP 空间从 <span class="math inline">\(L_w \times L_t\)</span> 降为 <span class="math inline">\(L_w\)</span>, 遍历 <span class="math inline">\(j\)</span> 时从后往前遍历以免覆盖 <span class="math inline">\(i - 1\)</span> 的状态.</p>
<p>其实还能进一步降 DP 空间降到 <span class="math inline">\(L_w - L_t + 1\)</span>, 因为 <span class="math inline">\(j\)</span> 每次遍历的范围就是 <span class="math inline">\([i, L_w - L_t + i]\)</span>. 但是我懒.</p>
<h2 id="不是很垃圾的代码">不是很垃圾的代码</h2>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">numWays</span><span class="params">(String[] words, String target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> MOD = (<span class="keyword">int</span>)<span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">        <span class="keyword">int</span> lw = words[<span class="number">0</span>].length(), lt = target.length();</span><br><span class="line">        <span class="keyword">long</span>[] dpa = <span class="keyword">new</span> <span class="keyword">long</span>[lw];</span><br><span class="line">        <span class="keyword">long</span>[][] n26 = <span class="keyword">new</span> <span class="keyword">long</span>[lw][<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">for</span> (String w : words) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; lw; ++i) &#123;</span><br><span class="line">                ++n26[i][w.charAt(i) - <span class="string">'a'</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// System.out.println(Arrays.deepToString(n26));</span></span><br><span class="line">        <span class="keyword">int</span> c = target.charAt(<span class="number">0</span>) - <span class="string">'a'</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= lw - lt; ++j) &#123;</span><br><span class="line">            dpa[j] = n26[j][c];</span><br><span class="line">            <span class="keyword">if</span> (j &gt; <span class="number">0</span>) dpa[j] += dpa[j - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// System.out.println(Arrays.toString(dpa));</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; lt; ++i) &#123;</span><br><span class="line">            c = target.charAt(i) - <span class="string">'a'</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = lw - (lt - i); j &gt;= i; --j) &#123;</span><br><span class="line">                dpa[j] = dpa[j - <span class="number">1</span>] * n26[j][c];</span><br><span class="line">                dpa[j] %= MOD;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= lw - (lt - i); ++j) &#123;</span><br><span class="line">                dpa[j] += dpa[j - <span class="number">1</span>];</span><br><span class="line">                dpa[j] %= MOD;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">// System.out.println(Arrays.toString(dpa));</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)dpa[lw - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>LeetCode</category>
      </categories>
      <tags>
        <tag>LeetCode</tag>
      </tags>
  </entry>
  <entry>
    <title>Win10 U 盘启动安装与初步设置</title>
    <url>/posts/47315.html</url>
    <content><![CDATA[<h1 id="安装">安装</h1>
<p>用 UEFI+GPT 安装, 可以快速启动.</p>
<p>使用 <a href="https://rufus.ie" target="_blank" rel="noopener">Rufus</a> 制作. 选项如图.</p>
<figure>
<img src="/posts/47315/rufus.png" alt="Rufus"><figcaption>Rufus</figcaption>
</figure>
<p>BIOS 设置启动方式为 UEFI.</p>
<p>如果硬盘是 MBR 的, 则安装程序会提示装不了. 此时 <code>Shift + F10</code> 调出控制台, 输入:</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">diskpart</span><br><span class="line">list disk</span><br><span class="line">select disk <span class="number">0</span>   # 在 list 出来的 disk 里选一个</span><br><span class="line"><span class="built_in">convert</span> gpt</span><br></pre></td></tr></table></figure>
<p>曾经我觉得 C 盘分 100 GB 就够了, 现在感觉还是 200 GB 舒服 (针对我的需求. 比如 WSL、Maven、Anaconda 等等环境都在 C 盘, 还是大一点舒服).</p>
<h1 id="配置">配置</h1>
<p>都是些个人习惯, 记一下.</p>
<ol type="1">
<li>文件资源管理器 - 选项 - 常规 - 打开文件资源管理器时打开: 此电脑</li>
<li>文件资源管理器 - 选项 - 查看 - 高级设置: V 显示隐藏的文件、文件夹和驱动器、X 隐藏已知文件类型的扩展名</li>
<li>回收站 - 回收站工具 - 回收站属性 - V 常规: 显示删除确认对话框</li>
<li>设置 - 个性化 - 主题 - 桌面图标设置: X 回收站</li>
<li>OneDrive - 设置: X 当我登陆 Windows 时自动启动 OneDrive</li>
<li>设置 - 个性化 - 开始 - 选择哪些文件夹显示在“开始”菜单上: 文件资源管理器、设置、下载、图片、个人文件夹</li>
<li>允许 Powershell 脚本: (管理员) <code>set-executionpolicy remotesigned</code></li>
<li>设置 - 个性化 - 任务栏 - V 当你将鼠标移动到任务栏末端的“显示桌面”按钮时，使用“速览”预览桌面</li>
</ol>
]]></content>
  </entry>
  <entry>
    <title>LeetCode 第 204 场周赛</title>
    <url>/posts/173.html</url>
    <content><![CDATA[<h1 id="重复至少-k-次且长度为-m-的模式"><a href="https://leetcode-cn.com/problems/detect-pattern-of-length-m-repeated-k-or-more-times/" target="_blank" rel="noopener">5499. 重复至少 K 次且长度为 M 的模式</a></h1>
<h2 id="垃圾题解-略">垃圾题解 略</h2>
<h2 id="垃圾代码">垃圾代码</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">containsPattern</span><span class="params">(self, arr: List[int], m: int, k: int)</span> -&gt; bool:</span></span><br><span class="line">        print(<span class="string">'ohhh'</span>)</span><br><span class="line">        n = len(arr)</span><br><span class="line">        <span class="keyword">if</span> m * k &gt; n: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n - m + <span class="number">1</span>):</span><br><span class="line">            a = arr[i : i + m]</span><br><span class="line">            c = <span class="number">1</span></span><br><span class="line">            j = i + m</span><br><span class="line">            <span class="keyword">while</span> j &lt;= n - m:</span><br><span class="line">                kk = <span class="number">0</span></span><br><span class="line">                <span class="keyword">while</span> kk &lt; m <span class="keyword">and</span> a[kk] == arr[j + kk]: kk += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> kk == m: c += <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>: <span class="keyword">break</span></span><br><span class="line">                j += kk</span><br><span class="line">            <span class="comment"># print(str(i) + " " + str(c) + "-----")</span></span><br><span class="line">            <span class="keyword">if</span> c &gt;= k: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>
<h1 id="乘积为正数的最长子数组长度"><a href="https://leetcode-cn.com/problems/maximum-length-of-subarray-with-positive-product/" target="_blank" rel="noopener">5500. 乘积为正数的最长子数组长度</a></h1>
<h2 id="垃圾题解-略-1">垃圾题解 略</h2>
<h2 id="垃圾代码-1">垃圾代码</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getMaxLen</span><span class="params">(self, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">        l0, l1, l_1 = <span class="number">-1</span>, <span class="number">0</span>, <span class="number">-1</span></span><br><span class="line">        flag = <span class="literal">False</span></span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">            n = nums[i]</span><br><span class="line">            <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">                l0 = i</span><br><span class="line">                l1 = i + <span class="number">1</span></span><br><span class="line">                l_1 = <span class="number">-1</span></span><br><span class="line">                flag = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> n &lt; <span class="number">0</span>:</span><br><span class="line">                    flag = <span class="keyword">not</span> flag</span><br><span class="line">                    <span class="keyword">if</span> l_1 == <span class="number">-1</span>: l_1 = i</span><br><span class="line">                <span class="keyword">if</span> flag <span class="keyword">and</span> l_1 != <span class="number">-1</span>: res = max(res, i - l_1)</span><br><span class="line">                <span class="keyword">elif</span> <span class="keyword">not</span> flag: res = max(res, i - l1 + <span class="number">1</span>)</span><br><span class="line">        <span class="comment">#     print(res, end='  ')</span></span><br><span class="line">        <span class="comment"># print('----')</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>
<h1 id="使陆地分离的最少天数"><a href="https://leetcode-cn.com/problems/minimum-number-of-days-to-disconnect-island/" target="_blank" rel="noopener">5501. 使陆地分离的最少天数</a></h1>
<h2 id="垃圾题解">垃圾题解</h2>
<p>求把一个连通分量拆成俩的最小切割次数. 这题撑死最多切两次 (即当图有三个及以上的点时, 图的边缘必存在只有两条边的点).</p>
<p>先遍历一遍全图, 如果本来就有不止一个分量, 直接返回 0.</p>
<p>然后判断一个特例: 连通分量就一个, 但该分量就两个点. 这样的话删除一个后依然是一个连通分量. 所以要删两次, 返回 2.</p>
<p>然后遍历所有点, 如果找到一个点只有一条边, 返回 1; 如果找到有点有两条边, 则临时删除该点, DFS 遍历全图判断是不是变成了两个分量, 是则返回 1 (不要问我什么割点、什么 Tarjan, 爷忘光啦. 反正我赌 LeetCode 会让我过).</p>
<p>剩下的情况直接返回 2.</p>
<h2 id="垃圾代码-2">垃圾代码</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minDays</span><span class="params">(self, grid: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        n, m = len(grid), len(grid[<span class="number">0</span>])</span><br><span class="line">        cnt1 = <span class="number">0</span></span><br><span class="line">        vis = [[<span class="literal">False</span>] * m <span class="keyword">for</span> _ <span class="keyword">in</span> range(n)]</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(g, v, x, y)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> v[x][y]: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            v[x][y] = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> x &gt; <span class="number">0</span> <span class="keyword">and</span> g[x - <span class="number">1</span>][y] == <span class="number">1</span> <span class="keyword">and</span> <span class="keyword">not</span> v[x - <span class="number">1</span>][y]: dfs(g, v, x - <span class="number">1</span>, y)</span><br><span class="line">            <span class="keyword">if</span> y &gt; <span class="number">0</span> <span class="keyword">and</span> g[x][y - <span class="number">1</span>] == <span class="number">1</span> <span class="keyword">and</span> <span class="keyword">not</span> v[x][y - <span class="number">1</span>]: dfs(g, v, x, y - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> x &lt; len(g) - <span class="number">1</span> <span class="keyword">and</span> g[x + <span class="number">1</span>][y] == <span class="number">1</span> <span class="keyword">and</span> <span class="keyword">not</span> v[x + <span class="number">1</span>][y]: dfs(g, v, x + <span class="number">1</span>, y)</span><br><span class="line">            <span class="keyword">if</span> y &lt; len(g[<span class="number">0</span>]) - <span class="number">1</span> <span class="keyword">and</span> g[x][y + <span class="number">1</span>] == <span class="number">1</span> <span class="keyword">and</span> <span class="keyword">not</span> v[x][y + <span class="number">1</span>]: dfs(g, v, x, y + <span class="number">1</span>)</span><br><span class="line">        flag = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(m):</span><br><span class="line">                <span class="keyword">if</span> grid[i][j] == <span class="number">1</span>: cnt1 += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> grid[i][j] == <span class="number">1</span> <span class="keyword">and</span> <span class="keyword">not</span> vis[i][j]:</span><br><span class="line">                    <span class="keyword">if</span> flag: <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">                    flag = <span class="literal">True</span></span><br><span class="line">                    dfs(grid, vis, i, j)</span><br><span class="line">        <span class="keyword">if</span> cnt1 == <span class="number">2</span>: <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(m):</span><br><span class="line">                <span class="keyword">if</span> grid[i][j] == <span class="number">0</span>: <span class="keyword">continue</span></span><br><span class="line">                c = []</span><br><span class="line">                <span class="keyword">if</span> i &gt; <span class="number">0</span> <span class="keyword">and</span> grid[i - <span class="number">1</span>][j] == <span class="number">1</span>: c.append((i - <span class="number">1</span>, j))</span><br><span class="line">                <span class="keyword">if</span> j &gt; <span class="number">0</span> <span class="keyword">and</span> grid[i][j - <span class="number">1</span>] == <span class="number">1</span>: c.append((i, j - <span class="number">1</span>))</span><br><span class="line">                <span class="keyword">if</span> i &lt; n - <span class="number">1</span> <span class="keyword">and</span> grid[i + <span class="number">1</span>][j] == <span class="number">1</span>: c.append((i + <span class="number">1</span>, j))</span><br><span class="line">                <span class="keyword">if</span> j &lt; m - <span class="number">1</span> <span class="keyword">and</span> grid[i][j + <span class="number">1</span>] == <span class="number">1</span>: c.append((i, j + <span class="number">1</span>))</span><br><span class="line">                <span class="keyword">if</span> len(c) == <span class="number">1</span>: <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> len(c) != <span class="number">2</span>: <span class="keyword">continue</span></span><br><span class="line">                grid[i][j] = <span class="number">0</span></span><br><span class="line">                <span class="keyword">for</span> ii <span class="keyword">in</span> range(n):</span><br><span class="line">                    <span class="keyword">for</span> jj <span class="keyword">in</span> range(m):</span><br><span class="line">                        vis[ii][jj] = <span class="literal">False</span></span><br><span class="line">                dfs(grid, vis, c[<span class="number">0</span>][<span class="number">0</span>], c[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> vis[c[<span class="number">1</span>][<span class="number">0</span>]][c[<span class="number">1</span>][<span class="number">1</span>]]: <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">                grid[i][j] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>
<h1 id="将子数组重新排序得到同一个二叉查找树的方案数"><a href="https://leetcode-cn.com/problems/number-of-ways-to-reorder-array-to-get-same-bst/" target="_blank" rel="noopener">5502. 将子数组重新排序得到同一个二叉查找树的方案数</a></h1>
<h2 id="垃圾题解-1">垃圾题解</h2>
<p>给一棵二叉查找树, 问有多少种方法产生此树 (即求可行的输入顺序的个数 - 1).</p>
<p>根节点必为输入的第一个. 剩下的, 左右子树互不影响, 可以随意穿插 (只要左子树的顺序之间、右子树的顺序之间的顺序不变即可).</p>
<p>所以 <code>输入顺序个数 = 左子树输入顺序个数 * 右子树输入顺序个数 * 左右子树所有穿插的可能数</code>, 其中 <code>左右子树所有穿插的可能数 = C(总结点数 - 1, 左或右子树节点个数)</code>.</p>
<h2 id="垃圾代码-3">垃圾代码</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">numOfWays</span><span class="params">(self, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">comb</span><span class="params">(n, m)</span>:</span></span><br><span class="line">            <span class="keyword">return</span> math.factorial(n)//(math.factorial(n-m)*math.factorial(m))</span><br><span class="line">        MOD = int(<span class="number">10</span> ** <span class="number">9</span> + <span class="number">7</span>)</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(arr)</span>:</span></span><br><span class="line">            n = len(arr)</span><br><span class="line">            <span class="keyword">if</span> n &lt;= <span class="number">2</span>: <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">            left, right = [], []</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">                <span class="keyword">if</span> arr[i] &lt; arr[<span class="number">0</span>]: left.append(arr[i])</span><br><span class="line">                <span class="keyword">else</span>: right.append(arr[i])</span><br><span class="line">            l, r = len(left), len(right)   </span><br><span class="line">            <span class="keyword">return</span> dfs(left) * dfs(right) * comb(n - <span class="number">1</span>, l) % MOD</span><br><span class="line">        <span class="keyword">return</span> dfs(nums) - <span class="number">1</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>LeetCode</category>
      </categories>
      <tags>
        <tag>LeetCode</tag>
      </tags>
  </entry>
  <entry>
    <title>Java 的两种异常 Checked Exception 与 Runtime Exception</title>
    <url>/posts/49879.html</url>
    <content><![CDATA[<p>Java 有两种异常: Checked Exception 与 Runtime Exception. 整理了一下两者的区别:</p>
<table>
<thead>
<tr class="header">
<th>区别</th>
<th>Checked Exception</th>
<th>Runtime Exception</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>基类</td>
<td>java.lang.Exception</td>
<td>java.lang.RuntimeException</td>
</tr>
<tr class="even">
<td>捕获</td>
<td>强制</td>
<td>不强制</td>
</tr>
</tbody>
</table>
<ol type="1">
<li>Checked Exception 的基类是 <code>Exception</code>; Runtime Exception 的基类是 <code>RuntimeException</code> (不过 <code>RuntimeException</code> 的父类也是 <code>Exception</code>).</li>
<li>Checked Exception 要求必须捕获. 一个方法内如果抛出了 Checked Exception, 必须要么 <code>catch</code>, 要么给方法声明 <code>throws</code> 以交给上一层去处理, 如果漏写了 <code>catch</code> 会直接通不过编译. Runtime Exception 就没这个要求, 不强制 <code>catch</code> 或 <code>throws</code>, 这样对于明显不会异常的代码段就不必处理了.</li>
</ol>
<p>各举个例子:</p>
<ol type="1">
<li><p>Runtime Exception 例子 (<code>IndexOutOfBoundsException</code>) <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ArrayList 的 get 方法, 调用了 rangeCheck 方法.</span></span><br><span class="line"><span class="comment">// 可以看到两个方法均没有 catch 或 声明 throws.</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    rangeCheck(index);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> elementData(index);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// rangeCheck 可能抛出 IndexOutOfBoundsException 这一 Runtime Exception.</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">rangeCheck</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index &gt;= size)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(outOfBoundsMsg(index));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
<li><p>Checked Exception 例子 (<code>FileNotFoundException</code>) <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// FileInputStream 的构造函数, 声明了可能抛出 FileNotFoundException.</span></span><br><span class="line"><span class="comment">// 同时也可能抛出 NullPointerException, 但 NullPointerException 为</span></span><br><span class="line"><span class="comment">// Runtime Exception, 所以没有 throws.</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">FileInputStream</span><span class="params">(File file)</span> <span class="keyword">throws</span> FileNotFoundException </span>&#123;</span><br><span class="line">    String name = (file != <span class="keyword">null</span> ? file.getPath() : <span class="keyword">null</span>);</span><br><span class="line">    SecurityManager security = System.getSecurityManager();</span><br><span class="line">    <span class="keyword">if</span> (security != <span class="keyword">null</span>) &#123;</span><br><span class="line">        security.checkRead(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (name == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (file.isInvalid()) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> FileNotFoundException(<span class="string">"Invalid file path"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    fd = <span class="keyword">new</span> FileDescriptor();</span><br><span class="line">    fd.attach(<span class="keyword">this</span>);</span><br><span class="line">    path = name;</span><br><span class="line">    open(name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></li>
</ol>
]]></content>
      <tags>
        <tag>Java</tag>
        <tag>语法</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows Terminal 捣鼓</title>
    <url>/posts/3549.html</url>
    <content><![CDATA[<p>安装: Win10 商店.</p>
<h2 id="添加-git-bash-支持">添加 Git Bash 支持</h2>
<p>打开设置, 在 <code>profiles -&gt; list</code> 添加以下必须项:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"guid"</span>: <span class="string">"&#123;c169f907-832c-4aa4-9ab3-84a4658b4b93&#125;"</span>,</span><br><span class="line">    <span class="attr">"name"</span> : <span class="string">"Git Bash"</span>,</span><br><span class="line">    <span class="attr">"commandline"</span> : <span class="string">"C:\\Program Files\\Git\\bin\\bash.exe -i -l"</span>,</span><br><span class="line">    <span class="attr">"icon"</span> : <span class="string">"C:\\Program Files\\Git\\mingw64\\share\\git\\git-for-windows.ico"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其他的配置看自己喜好就行, 我都定义在 <code>defaults</code> 里了, 所以这里只有四项.</p>
<p>其中,</p>
<p><code>guid</code> 其实随便填一个与其他 shell 不同的序列号即可, 这里我是用 Visual Studio 生成了一个.</p>
<p><code>commandline</code> 定位到 Git Bash 安装路径下的 bin 文件夹. 注意要带上 <code>-i -l</code> 的参数. 参数的作用: 如果不加, 则不会加载 Git Bash 的配置, 会打开一个没有自定义过的 Bash. 事实上, Git 自带的 Bash Terminal 启动时带的参数就是这个: <img src="/posts/3549/1.png" alt="官方 Terminal 启动时, 参数显示在了左上角"></p>
<h2 id="个人配置喜好">个人配置喜好</h2>
<p>在打开设置时按住 <code>Alt</code>, 会打开 <code>defaults.json</code>, 里面有所有设置的默认值, 可以拿来作参考.</p>
<p>以下是我的 <code>settings.json</code> 的 <code>profiles</code> 部分:</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">"profiles":</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"defaults"</span>:</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"startingDirectory"</span>: <span class="string">"."</span>,</span><br><span class="line">        <span class="attr">"closeOnExit"</span>: <span class="string">"graceful"</span>,</span><br><span class="line">        <span class="attr">"historySize"</span>: <span class="number">9001</span>,</span><br><span class="line">        <span class="attr">"snapOnInput"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">"colorScheme"</span>: <span class="string">"One Half Dark"</span>,</span><br><span class="line">        <span class="attr">"fontFace"</span>: <span class="string">"Cascadia Mono"</span>,</span><br><span class="line">        <span class="attr">"fontSize"</span>: <span class="number">12</span>,</span><br><span class="line">        <span class="attr">"antialiasingMode"</span>: <span class="string">"grayscale"</span>,</span><br><span class="line">        <span class="attr">"useAcrylic"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">"acrylicOpacity"</span> : <span class="number">0.9</span>,</span><br><span class="line">        <span class="attr">"padding"</span>: <span class="string">"8, 8, 8, 8"</span>,</span><br><span class="line">        <span class="attr">"cursorShape"</span>: <span class="string">"bar"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"list"</span>:</span><br><span class="line">    [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"guid"</span>: <span class="string">"&#123;61c54bbd-c2c6-5271-96e7-009a87ff44bf&#125;"</span>,</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"Windows PowerShell"</span>,</span><br><span class="line">            <span class="attr">"commandline"</span>: <span class="string">"powershell.exe"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"guid"</span>: <span class="string">"&#123;0caa0dad-35be-5f56-a8ff-afceeeaa6101&#125;"</span>,</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"命令提示符"</span>,</span><br><span class="line">            <span class="attr">"commandline"</span>: <span class="string">"cmd.exe"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"guid"</span>: <span class="string">"&#123;c169f907-832c-4aa4-9ab3-84a4658b4b93&#125;"</span>,</span><br><span class="line">            <span class="attr">"name"</span> : <span class="string">"Git Bash"</span>,</span><br><span class="line">            <span class="attr">"commandline"</span> : <span class="string">"C:\\Program Files\\Git\\bin\\bash.exe -i -l"</span>,</span><br><span class="line">            <span class="attr">"icon"</span> : <span class="string">"C:\\Program Files\\Git\\mingw64\\share\\git\\git-for-windows.ico"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"guid"</span>: <span class="string">"&#123;b453ae62-4e3d-5e58-b989-0a998ec441b8&#125;"</span>,</span><br><span class="line">            <span class="attr">"hidden"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"Azure Cloud Shell"</span>,</span><br><span class="line">            <span class="attr">"source"</span>: <span class="string">"Windows.Terminal.Azure"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="windows-terminal-添加到右键菜单">Windows Terminal 添加到右键菜单</h2>
<p>要求效果类似 <code>Git Bash Here</code>, <code>在此处打开 Powershell 窗口(s)</code>, <code>通过 Code 打开</code> 这种, 在文件夹空白处右键出现菜单:</p>
<p><img src="/posts/3549/2.png"></p>
<p>原理就仿照上面那几位, 创建类似效果的注册表. 上面几个软件的菜单都能在注册表编辑器的如下位置找到:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">计算机\HKEY_CLASSES_ROOT\Directory\Background\shell</span><br></pre></td></tr></table></figure>
<p>新建一个 <code>.reg</code> 文件, 写入如下内容:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\wt]</span><br><span class="line">@&#x3D;&quot;Windows Terminal here&quot;</span><br><span class="line">&quot;Icon&quot;&#x3D;&quot;&lt;path-to-your-ico&gt;&quot;</span><br><span class="line">&quot;Extended&quot;&#x3D;&quot;&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\wt\command]</span><br><span class="line">@&#x3D;&quot;C:\\Users\\&lt;user&gt;\\AppData\\Local\\Microsoft\\WindowsApps\\wt.exe&quot;</span><br></pre></td></tr></table></figure>
<p>其中,</p>
<ul>
<li><p>第 5 行 &quot;Icon&quot; 是图标的路径, 图标随意, 放的路径也随意. 如果不需要图标就删掉这行.</p>
<p>如果要 Windows Terminal 官方图标, 在他们的 Github 上有: <a href="https://github.com/microsoft/terminal/blob/master/res/terminal.ico" target="_blank" rel="noopener" class="uri">https://github.com/microsoft/terminal/blob/master/res/terminal.ico</a>.</p>
<p>当然, 上面这个链接只是 Github 上该文件的页面, 转换成源文件链接就是 <a href="https://raw.githubusercontent.com/microsoft/terminal/master/res/terminal.ico" target="_blank" rel="noopener" class="uri">https://raw.githubusercontent.com/microsoft/terminal/master/res/terminal.ico</a>, 点击即下.</p></li>
<li><p>第 6 行 &quot;Extended&quot; 代表需要按住 Shift 才能显示, 就像 Powershell 一样, 删掉该行则不需要按 Shift 也能显示.</p></li>
<li><p>第 9 行是 Windows Terminal 的绝对路径 (记得改 <code>&lt;user&gt;</code>), 必须是完全的绝对路径, 不可以是</p>
<figure class="highlight taggerscript"><table><tr><td class="code"><pre><span class="line"><span class="variable">%USERPROFILE%</span><span class="symbol">\\</span>AppData<span class="symbol">\\</span>Local<span class="symbol">\\</span>Microsoft<span class="symbol">\\</span>WindowsApps<span class="symbol">\\</span>wt.exe</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight taggerscript"><table><tr><td class="code"><pre><span class="line"><span class="variable">%LOCALAPPDATA%</span><span class="symbol">\\</span>Microsoft<span class="symbol">\\</span>WindowsApps<span class="symbol">\\</span>wt.exe</span><br></pre></td></tr></table></figure>
<p>原因不明, 总之如果不填写完整的绝对路径, 它就报错.</p>
<p>另外有人的 Windows Terminal 名字是 wtd.exe 而不是 wt.exe, 先去目录确认一下.</p></li>
</ul>
<p>我自己用的 <code>right-click menu.reg</code>:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\wt]</span><br><span class="line">@&#x3D;&quot;Windows Terminal here&quot;</span><br><span class="line">&quot;Icon&quot;&#x3D;&quot;%LOCALAPPDATA%\\WindowsTerminal\\terminal.ico&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\wt\command]</span><br><span class="line">@&#x3D;&quot;C:\\Users\\xie\\AppData\\Local\\Microsoft\\WindowsApps\\wt.exe&quot;</span><br></pre></td></tr></table></figure>
<p>注册后右键的效果上面已经展示了.</p>
<p>然后还有问题, 右键打开后 Windows Terminal 路径总是为 <code>C:\Users\&lt;user&gt;</code>. 解决方法有两种:</p>
<ol type="1">
<li><p>Windows Terminal 默认启动路径一直是 user profile. 所以打开其 <code>settings.json</code> 把 <code>&quot;startingDirectory&quot;: &quot;%USERPROFILE%&quot;</code> 改为 <code>&quot;startingDirectory&quot;: &quot;.&quot;</code>.</p>
<p>这个方法比较推荐, 但也有缺点: 改了 <code>startingDirectory</code> 之后, 从开始菜单直接打开 Windows Terminal 会显示路径为 <code>C:\WINDOWS\system32</code>.</p></li>
<li><p>不改 <code>startingDirectory</code> 其实也可以. wt.exe 有个参数 <code>-d</code> 用于设定目录. 所以可以把 <code>.reg</code> 最后一行的 command 改为:</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">@=<span class="string">"C:<span class="subst">\\</span>Users<span class="subst">\\</span>xie<span class="subst">\\</span>AppData<span class="subst">\\</span>Local<span class="subst">\\</span>Microsoft<span class="subst">\\</span>WindowsApps<span class="subst">\\</span>wt.exe -d ."</span></span><br></pre></td></tr></table></figure>
<p>于是不用设置 <code>startingDirectory</code>, 打开也是当前目录. 但缺点也很明显, 它只限定打开的第一个 terminal 的目录, 如果你按加号新建一个 terminal, 目录就又变成 <code>C:\Users\&lt;user&gt;</code> 了.</p></li>
</ol>
]]></content>
      <tags>
        <tag>日常配环境</tag>
        <tag>Windows Terminal</tag>
      </tags>
  </entry>
  <entry>
    <title>Doxygen 安装使用</title>
    <url>/posts/34140.html</url>
    <content><![CDATA[<h1 id="安装">安装</h1>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># graphviz 用于生成图, doxygen-guigraphviz 是 doxygen 的 GUI</span></span><br><span class="line">sudo apt-get install graphviz doxygen doxygen-gui doxygen-doc</span><br></pre></td></tr></table></figure>
<p>也可以从源码编译安装, 源项目是 CMake 项目. 不过源码安装会导致使用 apt 安装的 GUI 找不到 CLI 安装位置, 还是 apt 方便. 清华的 apt 源貌似没有 doxygen, 后来改用阿里云的源就好了.</p>
<h1 id="使用">使用</h1>
<h2 id="gui-程序使用的典型流程">GUI 程序使用的典型流程</h2>
<p>以分析 Doxygen 项目本身为例, 目标是获取其函数调用关系. 先打开 GUI 程序:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">doxywizard</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或指定一个 Doxyfile</span></span><br><span class="line">doxywizard Doxyfile</span><br></pre></td></tr></table></figure>
<ol type="1">
<li><p>确定工作目录, 填写项目名称 (貌似不填也无所谓), 选择源码目录 (CMake 项目的根目录即可), 记得勾选 <code>Scan recursively</code>, 即子目录的源文件也会被检索. 然后确定一下文档的输出目录. <img src="/posts/34140/doxywizard_Wizard_Project.png"></p></li>
<li><p>提取模式勾选 <code>All Entities</code>, 具体比第一个多哪些内容我还没看, 对运行时间的影响和提取的内容待考证. <img src="/posts/34140/doxywizard_Wizard_Mode.png"></p></li>
<li><p>选择输出格式, 我的目标不是输出文档而是提取函数调用关系, 仅导出 XML 就够了, 导出 HTML 和 LaTex 等速度很慢, XML会快上不少 (但也还是很慢). <img src="/posts/34140/doxywizard_Wizard_Output.png"></p></li>
<li><p>图表选 <code>dot tool</code>, 关键是把最后俩选项勾选以获得函数调用信息 (如果下面的框框都是灰色的, 就重新选择一下 <code>dot tool</code>). <img src="/posts/34140/doxywizard_Wizard_Diagrams.png"></p></li>
<li><p><code>EXTRACT</code> 全部勾选, 这些内容和函数调用应该都有关系 (根据左下角的描述, 其中一个特别耗时, 我忘了是哪个). <img src="/posts/34140/doxywizard_Expert_Build.png"></p></li>
<li><p><code>dot</code> 的设置如图, dot 是用来生成调用图的. <code>CALL_GRAPH</code> 和 <code>CALLER_GRAPH</code> 分别是函数的调用视图和被调用视图. <code>DOT_PATH</code> 是 dot 安装地址 (dot 就是 apt 安装的 <code>graphviz</code>). dot 貌似仅对 HTML 等起作用? 以后我再看看仅导出 XML 是不是可以不用 dot. <img src="/posts/34140/doxywizard_Expert_Dot.png"></p></li>
</ol>
<p>最后转到 <code>Run</code> 选项卡运行即可.</p>
<h2 id="doxyfile-与-cli-使用">Doxyfile 与 CLI 使用</h2>
<p>我想把 Doxygen 作为 CMake 项目源码的静态分析工具. 由于需要用脚本自动化执行, 用 GUI 肯定不现实, 于是又研究了下这个 CLI 怎么用.</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">doxygen</span> -g Doxyfile       <span class="comment"># 生成 Doxyfile (带注释)</span></span><br><span class="line">doxygen -g -s Doxyfile    <span class="comment"># 生成 Doxyfile (不带注释的简化版)</span></span><br></pre></td></tr></table></figure>
<p>除了源/头文件之间的依赖关系, 我还需要每个源/头文件之间的函数、全局变量、类等等所有的调用关系, 例如 <code>文件 A</code> 中的 <code>函数 foo</code> 调用了 <code>文件 B</code> 中的 <code>函数 bar</code>. 同时我不想让分析过程耗时太久, 所以尽量把不相关的选项全部关了. 针对上述需求，整理了份 Doxyfile 模板:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">DOXYFILE_ENCODING      &#x3D; UTF-8</span><br><span class="line">PROJECT_NAME           &#x3D; </span><br><span class="line">PROJECT_NUMBER         &#x3D; </span><br><span class="line">PROJECT_BRIEF          &#x3D; </span><br><span class="line">PROJECT_LOGO           &#x3D; </span><br><span class="line">OUTPUT_DIRECTORY       &#x3D; .</span><br><span class="line">CREATE_SUBDIRS         &#x3D; NO</span><br><span class="line">ALLOW_UNICODE_NAMES    &#x3D; NO</span><br><span class="line">OUTPUT_LANGUAGE        &#x3D; English</span><br><span class="line">BRIEF_MEMBER_DESC      &#x3D; YES</span><br><span class="line">REPEAT_BRIEF           &#x3D; YES</span><br><span class="line">ABBREVIATE_BRIEF       &#x3D; </span><br><span class="line">ALWAYS_DETAILED_SEC    &#x3D; NO</span><br><span class="line">INLINE_INHERITED_MEMB  &#x3D; NO</span><br><span class="line">FULL_PATH_NAMES        &#x3D; YES</span><br><span class="line">STRIP_FROM_PATH        &#x3D; </span><br><span class="line">STRIP_FROM_INC_PATH    &#x3D; </span><br><span class="line">SHORT_NAMES            &#x3D; NO</span><br><span class="line">JAVADOC_AUTOBRIEF      &#x3D; NO</span><br><span class="line">QT_AUTOBRIEF           &#x3D; NO</span><br><span class="line">MULTILINE_CPP_IS_BRIEF &#x3D; NO</span><br><span class="line">INHERIT_DOCS           &#x3D; YES</span><br><span class="line">SEPARATE_MEMBER_PAGES  &#x3D; NO</span><br><span class="line">TAB_SIZE               &#x3D; 4</span><br><span class="line">ALIASES                &#x3D; </span><br><span class="line">TCL_SUBST              &#x3D; </span><br><span class="line">OPTIMIZE_OUTPUT_FOR_C  &#x3D; NO</span><br><span class="line">OPTIMIZE_OUTPUT_JAVA   &#x3D; NO</span><br><span class="line">OPTIMIZE_FOR_FORTRAN   &#x3D; NO</span><br><span class="line">OPTIMIZE_OUTPUT_VHDL   &#x3D; NO</span><br><span class="line">EXTENSION_MAPPING      &#x3D; </span><br><span class="line">MARKDOWN_SUPPORT       &#x3D; YES</span><br><span class="line">AUTOLINK_SUPPORT       &#x3D; YES</span><br><span class="line">BUILTIN_STL_SUPPORT    &#x3D; NO</span><br><span class="line">CPP_CLI_SUPPORT        &#x3D; NO</span><br><span class="line">SIP_SUPPORT            &#x3D; NO</span><br><span class="line">IDL_PROPERTY_SUPPORT   &#x3D; YES</span><br><span class="line">DISTRIBUTE_GROUP_DOC   &#x3D; NO</span><br><span class="line">GROUP_NESTED_COMPOUNDS &#x3D; NO</span><br><span class="line">SUBGROUPING            &#x3D; YES</span><br><span class="line">INLINE_GROUPED_CLASSES &#x3D; NO</span><br><span class="line">INLINE_SIMPLE_STRUCTS  &#x3D; NO</span><br><span class="line">TYPEDEF_HIDES_STRUCT   &#x3D; NO</span><br><span class="line">LOOKUP_CACHE_SIZE      &#x3D; 0</span><br><span class="line">EXTRACT_ALL            &#x3D; YES</span><br><span class="line">EXTRACT_PRIVATE        &#x3D; YES</span><br><span class="line">EXTRACT_PACKAGE        &#x3D; YES</span><br><span class="line">EXTRACT_STATIC         &#x3D; YES</span><br><span class="line">EXTRACT_LOCAL_CLASSES  &#x3D; YES</span><br><span class="line">EXTRACT_LOCAL_METHODS  &#x3D; YES</span><br><span class="line">EXTRACT_ANON_NSPACES   &#x3D; NO</span><br><span class="line">HIDE_UNDOC_MEMBERS     &#x3D; NO</span><br><span class="line">HIDE_UNDOC_CLASSES     &#x3D; NO</span><br><span class="line">HIDE_FRIEND_COMPOUNDS  &#x3D; NO</span><br><span class="line">HIDE_IN_BODY_DOCS      &#x3D; NO</span><br><span class="line">INTERNAL_DOCS          &#x3D; NO</span><br><span class="line">CASE_SENSE_NAMES       &#x3D; NO</span><br><span class="line">HIDE_SCOPE_NAMES       &#x3D; NO</span><br><span class="line">HIDE_COMPOUND_REFERENCE&#x3D; NO</span><br><span class="line">SHOW_INCLUDE_FILES     &#x3D; YES</span><br><span class="line">SHOW_GROUPED_MEMB_INC  &#x3D; NO</span><br><span class="line">FORCE_LOCAL_INCLUDES   &#x3D; NO</span><br><span class="line">INLINE_INFO            &#x3D; YES</span><br><span class="line">SORT_MEMBER_DOCS       &#x3D; YES</span><br><span class="line">SORT_BRIEF_DOCS        &#x3D; NO</span><br><span class="line">SORT_MEMBERS_CTORS_1ST &#x3D; NO</span><br><span class="line">SORT_GROUP_NAMES       &#x3D; NO</span><br><span class="line">SORT_BY_SCOPE_NAME     &#x3D; NO</span><br><span class="line">STRICT_PROTO_MATCHING  &#x3D; NO</span><br><span class="line">GENERATE_TODOLIST      &#x3D; YES</span><br><span class="line">GENERATE_TESTLIST      &#x3D; YES</span><br><span class="line">GENERATE_BUGLIST       &#x3D; YES</span><br><span class="line">GENERATE_DEPRECATEDLIST&#x3D; YES</span><br><span class="line">ENABLED_SECTIONS       &#x3D; </span><br><span class="line">MAX_INITIALIZER_LINES  &#x3D; 30</span><br><span class="line">SHOW_USED_FILES        &#x3D; YES</span><br><span class="line">SHOW_FILES             &#x3D; YES</span><br><span class="line">SHOW_NAMESPACES        &#x3D; YES</span><br><span class="line">FILE_VERSION_FILTER    &#x3D; </span><br><span class="line">LAYOUT_FILE            &#x3D; </span><br><span class="line">CITE_BIB_FILES         &#x3D; </span><br><span class="line">QUIET                  &#x3D; NO</span><br><span class="line">WARNINGS               &#x3D; YES</span><br><span class="line">WARN_IF_UNDOCUMENTED   &#x3D; YES</span><br><span class="line">WARN_IF_DOC_ERROR      &#x3D; YES</span><br><span class="line">WARN_NO_PARAMDOC       &#x3D; NO</span><br><span class="line">WARN_AS_ERROR          &#x3D; NO</span><br><span class="line">WARN_FORMAT            &#x3D; &quot;$file:$line: $text&quot;</span><br><span class="line">WARN_LOGFILE           &#x3D; </span><br><span class="line">INPUT                  &#x3D; &lt;input&gt;</span><br><span class="line">INPUT_ENCODING         &#x3D; UTF-8</span><br><span class="line">FILE_PATTERNS          &#x3D; *.c *.cc *.cxx *.cpp *.c++ *.ii *.ixx *.ipp *.i++ *.h *.hh *.hxx *.hpp *.h++</span><br><span class="line">RECURSIVE              &#x3D; YES</span><br><span class="line">EXCLUDE                &#x3D; </span><br><span class="line">EXCLUDE_SYMLINKS       &#x3D; NO</span><br><span class="line">EXCLUDE_PATTERNS       &#x3D; </span><br><span class="line">EXCLUDE_SYMBOLS        &#x3D; </span><br><span class="line">EXAMPLE_PATH           &#x3D; </span><br><span class="line">EXAMPLE_PATTERNS       &#x3D; *</span><br><span class="line">EXAMPLE_RECURSIVE      &#x3D; NO</span><br><span class="line">IMAGE_PATH             &#x3D; </span><br><span class="line">INPUT_FILTER           &#x3D; </span><br><span class="line">FILTER_PATTERNS        &#x3D; </span><br><span class="line">FILTER_SOURCE_FILES    &#x3D; NO</span><br><span class="line">FILTER_SOURCE_PATTERNS &#x3D; </span><br><span class="line">USE_MDFILE_AS_MAINPAGE &#x3D; </span><br><span class="line">SOURCE_BROWSER         &#x3D; NO</span><br><span class="line">INLINE_SOURCES         &#x3D; NO</span><br><span class="line">STRIP_CODE_COMMENTS    &#x3D; YES</span><br><span class="line">REFERENCED_BY_RELATION &#x3D; NO</span><br><span class="line">REFERENCES_RELATION    &#x3D; NO</span><br><span class="line">REFERENCES_LINK_SOURCE &#x3D; YES</span><br><span class="line">SOURCE_TOOLTIPS        &#x3D; YES</span><br><span class="line">USE_HTAGS              &#x3D; NO</span><br><span class="line">VERBATIM_HEADERS       &#x3D; YES</span><br><span class="line">CLANG_ASSISTED_PARSING &#x3D; NO</span><br><span class="line">CLANG_OPTIONS          &#x3D; </span><br><span class="line">ALPHABETICAL_INDEX     &#x3D; YES</span><br><span class="line">COLS_IN_ALPHA_INDEX    &#x3D; 5</span><br><span class="line">IGNORE_PREFIX          &#x3D; </span><br><span class="line">GENERATE_HTML          &#x3D; NO</span><br><span class="line">HTML_OUTPUT            &#x3D; html</span><br><span class="line">HTML_FILE_EXTENSION    &#x3D; .html</span><br><span class="line">HTML_HEADER            &#x3D; </span><br><span class="line">HTML_FOOTER            &#x3D; </span><br><span class="line">HTML_STYLESHEET        &#x3D; </span><br><span class="line">HTML_EXTRA_STYLESHEET  &#x3D; </span><br><span class="line">HTML_EXTRA_FILES       &#x3D; </span><br><span class="line">HTML_COLORSTYLE_HUE    &#x3D; 220</span><br><span class="line">HTML_COLORSTYLE_SAT    &#x3D; 100</span><br><span class="line">HTML_COLORSTYLE_GAMMA  &#x3D; 80</span><br><span class="line">HTML_TIMESTAMP         &#x3D; NO</span><br><span class="line">HTML_DYNAMIC_SECTIONS  &#x3D; NO</span><br><span class="line">HTML_INDEX_NUM_ENTRIES &#x3D; 100</span><br><span class="line">GENERATE_DOCSET        &#x3D; NO</span><br><span class="line">DOCSET_FEEDNAME        &#x3D; &quot;Doxygen generated docs&quot;</span><br><span class="line">DOCSET_BUNDLE_ID       &#x3D; org.doxygen.Project</span><br><span class="line">DOCSET_PUBLISHER_ID    &#x3D; org.doxygen.Publisher</span><br><span class="line">DOCSET_PUBLISHER_NAME  &#x3D; Publisher</span><br><span class="line">GENERATE_HTMLHELP      &#x3D; YES</span><br><span class="line">CHM_FILE               &#x3D; </span><br><span class="line">HHC_LOCATION           &#x3D; </span><br><span class="line">GENERATE_CHI           &#x3D; NO</span><br><span class="line">CHM_INDEX_ENCODING     &#x3D; </span><br><span class="line">BINARY_TOC             &#x3D; NO</span><br><span class="line">TOC_EXPAND             &#x3D; NO</span><br><span class="line">GENERATE_QHP           &#x3D; NO</span><br><span class="line">QCH_FILE               &#x3D; </span><br><span class="line">QHP_NAMESPACE          &#x3D; org.doxygen.Project</span><br><span class="line">QHP_VIRTUAL_FOLDER     &#x3D; doc</span><br><span class="line">QHP_CUST_FILTER_NAME   &#x3D; </span><br><span class="line">QHP_CUST_FILTER_ATTRS  &#x3D; </span><br><span class="line">QHP_SECT_FILTER_ATTRS  &#x3D; </span><br><span class="line">QHG_LOCATION           &#x3D; </span><br><span class="line">GENERATE_ECLIPSEHELP   &#x3D; NO</span><br><span class="line">ECLIPSE_DOC_ID         &#x3D; org.doxygen.Project</span><br><span class="line">DISABLE_INDEX          &#x3D; NO</span><br><span class="line">GENERATE_TREEVIEW      &#x3D; NO</span><br><span class="line">ENUM_VALUES_PER_LINE   &#x3D; 4</span><br><span class="line">TREEVIEW_WIDTH         &#x3D; 250</span><br><span class="line">EXT_LINKS_IN_WINDOW    &#x3D; NO</span><br><span class="line">FORMULA_FONTSIZE       &#x3D; 10</span><br><span class="line">FORMULA_TRANSPARENT    &#x3D; YES</span><br><span class="line">USE_MATHJAX            &#x3D; NO</span><br><span class="line">MATHJAX_FORMAT         &#x3D; HTML-CSS</span><br><span class="line">MATHJAX_RELPATH        &#x3D; http:&#x2F;&#x2F;cdn.mathjax.org&#x2F;mathjax&#x2F;latest</span><br><span class="line">MATHJAX_EXTENSIONS     &#x3D; </span><br><span class="line">MATHJAX_CODEFILE       &#x3D; </span><br><span class="line">SEARCHENGINE           &#x3D; YES</span><br><span class="line">SERVER_BASED_SEARCH    &#x3D; NO</span><br><span class="line">EXTERNAL_SEARCH        &#x3D; NO</span><br><span class="line">SEARCHENGINE_URL       &#x3D; </span><br><span class="line">SEARCHDATA_FILE        &#x3D; searchdata.xml</span><br><span class="line">EXTERNAL_SEARCH_ID     &#x3D; </span><br><span class="line">EXTRA_SEARCH_MAPPINGS  &#x3D; </span><br><span class="line">GENERATE_LATEX         &#x3D; NO</span><br><span class="line">LATEX_OUTPUT           &#x3D; latex</span><br><span class="line">LATEX_CMD_NAME         &#x3D; latex</span><br><span class="line">MAKEINDEX_CMD_NAME     &#x3D; makeindex</span><br><span class="line">COMPACT_LATEX          &#x3D; NO</span><br><span class="line">PAPER_TYPE             &#x3D; a4</span><br><span class="line">EXTRA_PACKAGES         &#x3D; </span><br><span class="line">LATEX_HEADER           &#x3D; </span><br><span class="line">LATEX_FOOTER           &#x3D; </span><br><span class="line">LATEX_EXTRA_STYLESHEET &#x3D; </span><br><span class="line">LATEX_EXTRA_FILES      &#x3D; </span><br><span class="line">PDF_HYPERLINKS         &#x3D; YES</span><br><span class="line">USE_PDFLATEX           &#x3D; YES</span><br><span class="line">LATEX_BATCHMODE        &#x3D; NO</span><br><span class="line">LATEX_HIDE_INDICES     &#x3D; NO</span><br><span class="line">LATEX_SOURCE_CODE      &#x3D; NO</span><br><span class="line">LATEX_BIB_STYLE        &#x3D; plain</span><br><span class="line">LATEX_TIMESTAMP        &#x3D; NO</span><br><span class="line">GENERATE_RTF           &#x3D; NO</span><br><span class="line">RTF_OUTPUT             &#x3D; rtf</span><br><span class="line">COMPACT_RTF            &#x3D; NO</span><br><span class="line">RTF_HYPERLINKS         &#x3D; NO</span><br><span class="line">RTF_STYLESHEET_FILE    &#x3D; </span><br><span class="line">RTF_EXTENSIONS_FILE    &#x3D; </span><br><span class="line">RTF_SOURCE_CODE        &#x3D; NO</span><br><span class="line">GENERATE_MAN           &#x3D; NO</span><br><span class="line">MAN_OUTPUT             &#x3D; man</span><br><span class="line">MAN_EXTENSION          &#x3D; .3</span><br><span class="line">MAN_SUBDIR             &#x3D; </span><br><span class="line">MAN_LINKS              &#x3D; NO</span><br><span class="line">GENERATE_XML           &#x3D; YES</span><br><span class="line">XML_OUTPUT             &#x3D; xml</span><br><span class="line">XML_PROGRAMLISTING     &#x3D; YES</span><br><span class="line">GENERATE_DOCBOOK       &#x3D; NO</span><br><span class="line">DOCBOOK_OUTPUT         &#x3D; docbook</span><br><span class="line">DOCBOOK_PROGRAMLISTING &#x3D; NO</span><br><span class="line">GENERATE_AUTOGEN_DEF   &#x3D; NO</span><br><span class="line">GENERATE_PERLMOD       &#x3D; NO</span><br><span class="line">PERLMOD_LATEX          &#x3D; NO</span><br><span class="line">PERLMOD_PRETTY         &#x3D; YES</span><br><span class="line">PERLMOD_MAKEVAR_PREFIX &#x3D; </span><br><span class="line">ENABLE_PREPROCESSING   &#x3D; YES</span><br><span class="line">MACRO_EXPANSION        &#x3D; NO</span><br><span class="line">EXPAND_ONLY_PREDEF     &#x3D; NO</span><br><span class="line">SEARCH_INCLUDES        &#x3D; YES</span><br><span class="line">INCLUDE_PATH           &#x3D; </span><br><span class="line">INCLUDE_FILE_PATTERNS  &#x3D; </span><br><span class="line">PREDEFINED             &#x3D; </span><br><span class="line">EXPAND_AS_DEFINED      &#x3D; </span><br><span class="line">SKIP_FUNCTION_MACROS   &#x3D; YES</span><br><span class="line">TAGFILES               &#x3D; </span><br><span class="line">GENERATE_TAGFILE       &#x3D; </span><br><span class="line">ALLEXTERNALS           &#x3D; NO</span><br><span class="line">EXTERNAL_GROUPS        &#x3D; YES</span><br><span class="line">EXTERNAL_PAGES         &#x3D; YES</span><br><span class="line">PERL_PATH              &#x3D; &#x2F;usr&#x2F;bin&#x2F;perl</span><br><span class="line">CLASS_DIAGRAMS         &#x3D; NO</span><br><span class="line">MSCGEN_PATH            &#x3D; </span><br><span class="line">DIA_PATH               &#x3D; </span><br><span class="line">HIDE_UNDOC_RELATIONS   &#x3D; YES</span><br><span class="line">HAVE_DOT               &#x3D; NO</span><br><span class="line">DOT_NUM_THREADS        &#x3D; 0</span><br><span class="line">DOT_FONTNAME           &#x3D; Helvetica</span><br><span class="line">DOT_FONTSIZE           &#x3D; 10</span><br><span class="line">DOT_FONTPATH           &#x3D; </span><br><span class="line">CLASS_GRAPH            &#x3D; YES</span><br><span class="line">COLLABORATION_GRAPH    &#x3D; YES</span><br><span class="line">GROUP_GRAPHS           &#x3D; YES</span><br><span class="line">UML_LOOK               &#x3D; NO</span><br><span class="line">UML_LIMIT_NUM_FIELDS   &#x3D; 10</span><br><span class="line">TEMPLATE_RELATIONS     &#x3D; NO</span><br><span class="line">INCLUDE_GRAPH          &#x3D; YES</span><br><span class="line">INCLUDED_BY_GRAPH      &#x3D; YES</span><br><span class="line">CALL_GRAPH             &#x3D; YES</span><br><span class="line">CALLER_GRAPH           &#x3D; YES</span><br><span class="line">GRAPHICAL_HIERARCHY    &#x3D; YES</span><br><span class="line">DIRECTORY_GRAPH        &#x3D; YES</span><br><span class="line">DOT_IMAGE_FORMAT       &#x3D; png</span><br><span class="line">INTERACTIVE_SVG        &#x3D; NO</span><br><span class="line">DOT_PATH               &#x3D; &#x2F;usr&#x2F;bin</span><br><span class="line">DOTFILE_DIRS           &#x3D; </span><br><span class="line">MSCFILE_DIRS           &#x3D; </span><br><span class="line">DIAFILE_DIRS           &#x3D; </span><br><span class="line">PLANTUML_JAR_PATH      &#x3D; </span><br><span class="line">PLANTUML_INCLUDE_PATH  &#x3D; </span><br><span class="line">DOT_GRAPH_MAX_NODES    &#x3D; 50</span><br><span class="line">MAX_DOT_GRAPH_DEPTH    &#x3D; 0</span><br><span class="line">DOT_TRANSPARENT        &#x3D; NO</span><br><span class="line">DOT_MULTI_TARGETS      &#x3D; NO</span><br><span class="line">GENERATE_LEGEND        &#x3D; YES</span><br><span class="line">DOT_CLEANUP            &#x3D; YES</span><br></pre></td></tr></table></figure>
<p>使用时仅需要把上述代码段中第 90 行的 <code>&lt;input&gt;</code> 替换为你指定的所有源文件或源文件目录即可。例如改为:</p>
<figure class="highlight smalltalk"><table><tr><td class="code"><pre><span class="line"><span class="type">INPUT</span>                  = <span class="comment">"/path/to/your/source1.cpp"</span> \</span><br><span class="line">                         <span class="comment">"/path/to/your/source2.cpp"</span> \</span><br><span class="line">                         <span class="comment">"/path/to/your/source3.cpp"</span> \</span><br><span class="line">                         <span class="comment">"/path/to/your/header1.hpp"</span> \</span><br><span class="line">                         <span class="comment">"/path/to/your/header2.hpp"</span></span><br></pre></td></tr></table></figure>
<ul>
<li>注: Doxygen 似乎不关心你的项目是 CMake 组织的、Makefile 组织的还是什么框架都没有用, 我们只需要把所有源文件或所有源文件所在目录告诉它, 它会根据源/头文件名自动去匹配依赖 (所以如果项目在不同目录有同名文件, Doxygen 可能识别出错).</li>
</ul>
<p>然后在该目录执行指令 <code>doxygen Doxyfile</code> 即可 (Doxyfile 文件名并不强制, 如果你的 Doxyfile 文件名不叫 <code>Doxyfile</code>, 那把指令改成 <code>doxygen 你的文件名</code> 即可).</p>
<p>其输出是一堆 <code>XML</code> 文件. 其中 <code>index.xml</code> 给每个文件的每个函数、每个类、变量等等提供了一个唯一 id. 其余每个文件代表一个源文件、头文件或一个目录的信息. 里面有每个文件之间的类、函数、全局变量等等的调用关系 (其中涉及函数、类、变量调用关系的标签是<code>&lt;references&gt;</code> 和 <code>&lt;referencedby&gt;</code>, 分别是 &quot;调用&quot; 与 &quot;被调用&quot;). 整个文件格式还是蛮清晰易懂的.</p>
]]></content>
      <tags>
        <tag>日常配环境</tag>
        <tag>Doxygen</tag>
      </tags>
  </entry>
  <entry>
    <title>Angular 安装使用</title>
    <url>/posts/48194.html</url>
    <content><![CDATA[<p>网上的三方教程大部分是 AngularJS, 但我要用的是 Angular, 是 AngularJS 的新版本, 有些东西不太一样. 关键这两者名字太像了, 这框架命名竟然不用版本号命名, 而只是比老版本少了两个字符, 搜索起来太坑了......</p>
<p>学习使用时使用的环境: - Node.js: 12.10.0 - npm: 6.10.3 - Angular CLI: 8.3.4</p>
<p>以及 Angular 一些包的环境:</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Package                      Version</span><br><span class="line">------------------------------------------------------</span><br><span class="line">@angular-devkit/architect    <span class="number">0.803</span><span class="number">.4</span></span><br><span class="line">@angular-devkit/core         <span class="number">8.3</span><span class="number">.4</span></span><br><span class="line">@angular-devkit/schematics   <span class="number">8.3</span><span class="number">.4</span></span><br><span class="line">@schematics/angular          <span class="number">8.3</span><span class="number">.4</span></span><br><span class="line">@schematics/update           <span class="number">0.803</span><span class="number">.4</span></span><br><span class="line">rxjs                         <span class="number">6.4</span><span class="number">.0</span></span><br></pre></td></tr></table></figure>
<p>官方文档: <a href="https://angular.cn/docs" target="_blank" rel="noopener">中文文档</a>.</p>
<h1 id="安装与指令">安装与指令</h1>
<h2 id="安装">安装</h2>
<p>先安装 Node.js.</p>
<p>然后使用 <code>npm</code> 安装 Angular 的命令行界面工具 Angular CLI.</p>
<blockquote>
<p>Angular CLI 是一个命令行界面工具, 可用于初始化、开发、构建和维护 Angular 应用. Angular CLI 的主版本会跟随它所支持的 Angular 主版本, 不过其小版本可能会独立发布.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g @angular/cli</span><br></pre></td></tr></table></figure>
<h2 id="指令">指令</h2>
<ol type="1">
<li><p>新建一个项目并运行:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 创建项目文件夹, 生成一些配置文件</span></span><br><span class="line"><span class="comment"># 会有一些个性化配置选择, 比如选择 CSS 还是 LESS,</span></span><br><span class="line"><span class="comment"># JavaScript 还是 TypesCript 等. 选默认的即可.</span></span><br><span class="line">ng new &lt;project_name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入项目文件夹</span></span><br><span class="line"><span class="built_in">cd</span> &lt;project_name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行项目</span></span><br><span class="line"><span class="comment"># 新项目自带一个 hello world 程序</span></span><br><span class="line"><span class="comment"># 在 http://localhost:4200/ 访问</span></span><br><span class="line">ng serve</span><br></pre></td></tr></table></figure></li>
<li><p>在项目中新建模块:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 新建一个 Component</span></span><br><span class="line"><span class="comment"># 会在 `src/app` 下创建一个同名文件夹, 默认产生四个文件:</span></span><br><span class="line"><span class="comment"># &lt;name&gt;.component.css, &lt;name&gt;.component.html,</span></span><br><span class="line"><span class="comment"># &lt;name&gt;.component.ts, &lt;name&gt;.component.spec.ts</span></span><br><span class="line">ng generate component &lt;name&gt;</span><br><span class="line">ng g c &lt;name&gt;                   <span class="comment"># 上面指令的缩写</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 新建一个 Service</span></span><br><span class="line"><span class="comment"># 会在 `src/app` 下创建两个文件 (不产生文件夹):</span></span><br><span class="line"><span class="comment"># &lt;name&gt;.service.ts 和 &lt;name&gt;.service.spec.ts</span></span><br><span class="line">ng generate service &lt;name&gt;</span><br></pre></td></tr></table></figure>
<p>能够 <code>ng generate</code> 的东西还有很多, 但我还没用过.</p>
<p>其中 <code>.spec.ts</code> 是单元测试编写用例用的.</p></li>
<li><p>单元测试</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 在 http://localhost:9876/ 访问</span></span><br><span class="line">ng <span class="built_in">test</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="语法用法">语法用法</h1>
<p>内容太多了, 稍微整理点...</p>
<h2 id="html-中的语法"><code>.html</code> 中的语法</h2>
<p>这玩意太坑了, 好好的 html 格式各种被魔改, 报错也没处说理去, 很多语法写在了引号内, vscode 插件也没法报语法错误.</p>
<p>关键这些语法也花里胡哨的, 没个规律.</p>
<h3 id="插值语法-双花括号">插值语法 (双花括号)</h3>
<figure class="highlight clojure"><table><tr><td class="code"><pre><span class="line">&#123;&#123; &#125;&#125;</span><br></pre></td></tr></table></figure>
<p>会把双大括号内的值作为文本渲染出来. 例如</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"&#123;&#123;'aaa'&#125;&#125;"</span>&gt;</span>&#123;&#123;'233'+666&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>会被渲染为</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">'aaa'</span>&gt;</span>233666<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>. 同时渲染会执行转义, 例如</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;'<span class="tag">&lt;<span class="name">br</span> /&gt;</span>'&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>会被渲染为</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>&amp;lt;br /&amp;gt;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>, 而不是</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>, 所以想插入标签是不可能的. 它这么做目的是防止恶意注入等问题, 不过也可以使用 ng-bind-html-unsafe 指令来关掉默认的 html标签转义 (没用过, 用到了再写).</p>
<p>插值可以使用变量, 变量可以是 <code>.ts</code> 中定义的全局变量或函数, 也可以是 <code>.html</code> 中父标签定义的局部变量. 例如:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ng-container</span> *<span class="attr">ngFor</span>=<span class="string">"let item of this.items"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123;this.getValueOf(item)&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ng-container</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="ngif-ngfor"><code>*ngIf</code>, <code>*ngFor</code></h3>
<p>写在 HTML 标签中.</p>
<p>例如在 Component 的 <code>.ts</code> 中定义了全局变量:</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> ItemComponent <span class="keyword">implements</span> OnInit &#123;</span><br><span class="line">    items = [<span class="string">'aa'</span>, <span class="string">'bb'</span>, <span class="string">'cc'</span>, <span class="string">'dd'</span>];</span><br><span class="line">    <span class="comment">// ... ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>, 则在 Component 的 <code>.html</code> 中:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngFor</span>=<span class="string">"let item of this.items; let i = index;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> *<span class="attr">ngIf</span>=<span class="string">"i &lt; 2"</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>会被渲染为:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>aa<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>bb<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以看到, 对于 <code>ngIf</code>, 条件成立则渲染该标签 (及其子标签), 否则不渲染.</p>
<p>对于 <code>ngFor</code>, 可以看到渲染是包括 for 语句所在的标签的, 即重复渲染的是当前标签, 而不是仅仅重复子标签.</p>
<h4 id="两者注意事项">两者注意事项</h4>
<p><code>*ngIf</code>, <code>*ngFor</code> 不能同时存在于一个标签. 如</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"..."</span> *<span class="attr">ngFor</span>=<span class="string">"..."</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>是非法的, 可以用 ng-container 拆开, 改写为</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ng-container</span> *<span class="attr">ngIf</span>=<span class="string">"..."</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngFor</span>=<span class="string">"..."</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ng-container</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="ngif-注意事项"><code>*ngIf</code> 注意事项</h4>
<p>我还以为它支持 js/ts 的所有语法, 结果它好像是自己实现了部分语法 (或者支持的语法版本老旧).</p>
<p>我想使用 <code>*ngIf=&quot;key in obj&quot;</code> 来判断元素是否在 Object 内, 但它并不能识别, 报错了.</p>
<p>只能使用 <code>*ngIf=&quot;obj.hasOwnProperty(key)&quot;</code> 来判断.</p>
<p>同时它也不支持 <code>async</code> 异步语法. <code>*ngIf=&quot;func1(); func2();&quot;</code> 没问题, <code>*ngIf=&quot;func1(); async func3();&quot;</code> 会报错. 只能想别的办法.</p>
<h4 id="ngfor-注意事项"><code>*ngFor</code> 注意事项</h4>
<ol type="1">
<li><p>如果我们希望重复多个同级标签, 却又不想用一个多余的标签包裹它们 , 要用 ng-container.</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ng-container</span> *<span class="attr">ngFor</span>=<span class="string">"let item of this.items"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>ooooo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>xxxxx<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ng-container</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>被渲染为:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>ooooo<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span>aa<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span>xxxxx<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>ooooo<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span>bb<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span>xxxxx<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>ooooo<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span>cc<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span>xxxxx<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>ooooo<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span>dd<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span>xxxxx<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>引号内末尾的封号可加可不加.</p>
<p><code>*ngFor=&quot;let e of arr&quot;</code> 与 <code>*ngFor=&quot;let e of arr;&quot;</code>, 以及 <code>*ngFor=&quot;let e of arr; let i = index&quot;</code> 与 <code>*ngFor=&quot;let e of arr; let i = index;&quot;</code> 都可以, 只要中间的封号加了就行.</p></li>
<li><p>遍历的不同语法:</p>
<p>遍历 Array: <code>let e of arr</code>.</p>
<p>遍历 Array 同时需要知道元素的数组下标: <code>let e of arr; let i = index</code>.</p>
<p>遍历 Object (字典): <code>let e of obj | keyvalue</code>. 调用方法: <code></code>, <code></code>.</p></li>
</ol>
<h3 id="ng-containerng-container"><code>&lt;ng-container&gt;&lt;/ng-container&gt;</code></h3>
<p>不会在最终编译出来的网页中存在该标签, 作用是框住一些元素, 方便 ngFor 和 ngIf 针对内部的元素进行操作. 或者配合 <code>ng-template</code> 使用 ( 见 <code>ng-template</code> 部分).</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ng-container</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>text<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>text<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ng-container</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>会被渲染为</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>text<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>text<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>, 相当于直接去掉了这个壳.</p>
<h3 id="ng-templateng-template"><code>&lt;ng-template&gt;&lt;/ng-template&gt;</code></h3>
<p>不会在最终编译出来的网页中存在该元素及其子元素, 这只是定义了一个模板. 只有在被 <code>ng-container</code> 调用时显现在调用的位置.</p>
<p>例子:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 定义模板, 模板 id 为 displaySetting, 传入参数 nodeData, 定义模板内变量 item 并赋值为 nodeData. --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ng-template</span> #<span class="attr">displaySetting</span> <span class="attr">let-item</span>=<span class="string">'nodeData'</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">ng-template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用 ng-container 调用模板, 在 ng-container 处模板内元素会替换 ng-container 的位置. --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ng-container</span> *<span class="attr">ngTemplateOutlet</span>=<span class="string">'displaySetting; context: &#123;nodeData: 233&#125;'</span>&gt;</span><span class="tag">&lt;/<span class="name">ng-container</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 最终结果就是在 ng-container 处输出了个 233. --&gt;</span></span><br></pre></td></tr></table></figure>
<p>骚操作: 使用 ng-template 和 ng-container DFS 一颗树并输出:</p>
<p>(以下代码从真实代码提取的, 但是改完没跑一下测试, 应该能跑通...吧)</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> tree = &#123;</span><br><span class="line">    name: <span class="string">'root'</span>,</span><br><span class="line">    children: [</span><br><span class="line">        &#123; name: <span class="string">'aaa'</span>, chileren: [] &#125;,</span><br><span class="line">        &#123; name: <span class="string">'bbb'</span>, chileren: [</span><br><span class="line">            &#123; name: <span class="string">'bbbaaa'</span>, chileren: [] &#125;,</span><br><span class="line">            &#123; name: <span class="string">'bbbbbb'</span>, chileren: [] &#125;</span><br><span class="line">        ] &#125;,</span><br><span class="line">        &#123; name: <span class="string">'ccc'</span>, chileren: [] &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ng-template</span> #<span class="attr">dfs</span> <span class="attr">let-item</span>=<span class="string">'data'</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ng-container</span> *<span class="attr">ngFor</span>=<span class="string">"let child of item.children"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ng-container</span> *<span class="attr">ngTemplateOutlet</span>=<span class="string">'dfs; context: &#123;data: child&#125;'</span>&gt;</span><span class="tag">&lt;/<span class="name">ng-container</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ng-container</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ng-template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ng-container</span> *<span class="attr">ngTemplateOutlet</span>=<span class="string">'dfs; context: &#123;data: this.tree&#125;'</span>&gt;</span><span class="tag">&lt;/<span class="name">ng-container</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="输入输出语法">输入输出语法 <code>()</code>, <code>[]</code>, <code>[()]</code></h3>
<p>懒得写了, 官方教程这一块写的还算清晰.</p>
<h2 id="ts-语法"><code>.ts</code> 语法</h2>
<p><code>ng generate</code> 指令生成时已经写好了基础模板.</p>
<p>但是我发现 Service 无法 implements OnInit, 实现了这个接口也不会初始化.</p>
<h3 id="constructor-与-ngoninit-区别"><code>constructor()</code> 与 <code>ngOnInit()</code> 区别</h3>
<p>ngOnInit 是 Angular Component 的生命周期中的一环, 一般尽量使用 ngOnInit. constructor 是类的初始化, 比 ngOnInit 更早, 可能会出现获取遍历的值为 undefined.</p>
<h1 id="踩坑">踩坑</h1>
<h2 id="ng-serve-报错"><code>ng serve</code> 报错</h2>
<p>报错如下:</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">系统找不到指定的路径。</span><br><span class="line">An unhandled exception occurred: Cannot <span class="built_in">find</span> <span class="keyword">module</span> <span class="string">'@angular/compiler-cli'</span></span><br></pre></td></tr></table></figure>
<p>是依赖包没正确安装.</p>
<p>在项目目录下, 先删除 <code>node_modules</code> 文件夹, 然后运行 <code>npm install</code> (或 <code>yarn</code>, 如果 <code>npm install</code> 不成功的话) 以安装 <code>package.json</code> 内的库.</p>
<h2 id="国内源加速">国内源加速</h2>
<p>其实这算 Node.js 的问题. 淘宝的源:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class="line">cnpm install</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>日常配环境</tag>
        <tag>Angular</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu18.04 美化</title>
    <url>/posts/40409.html</url>
    <content><![CDATA[<h1 id="美化软件">美化软件</h1>
<h2 id="gnome-tweak-tool-美化必备">Gnome Tweak Tool: 美化必备</h2>
<p>首先肯定是安装 <code>gnome-tweak-tool</code>.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install gnome-tweak-tool</span><br></pre></td></tr></table></figure>
<h2 id="dash-to-dock">Dash To Dock</h2>
<p>是 <code>Tweak</code> 的一个扩展. 可以从 <code>Ubuntu Software</code> 搜索下载安装 <code>Dash to dock</code>, 然后就能从 <code>Tweak</code> 的 <code>Extensions</code> 标签页下找到它.</p>
<p>主要功能: Dock 图标居中显示; 将 Dock 的 <code>Show Applications</code> 从右侧 / 底部 挪到 左侧 / 上方.</p>
<p>也支持用指令. 比如要将 <code>Show Applications</code> 从 Dock 挪动位置可以输入:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gsettings <span class="built_in">set</span> org.gnome.shell.extensions.dash-to-dock show-apps-at-top <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h2 id="hide-top-bar">Hide Top Bar</h2>
<p>用于隐藏顶部栏.</p>
<p>可从 <code>Ubuntu Software</code> 搜索下载安装. 一样可以在 <code>Tweak</code> 的 <code>Extensions</code> 标签页下找到它.</p>
<h2 id="user-themes">User Themes</h2>
<p>用于将主题配置文件放在用户文件夹, 以防止重装导致美化丢失.</p>
<p>一样是 <code>Tweak</code> 的扩展, 且可从 <code>Ubuntu Software</code> 搜索下载安装.</p>
<h1 id="主题">主题</h1>
<h2 id="vimix-gtk-theme">Vimix Gtk Theme</h2>
<p><a href="https://www.gnome-look.org/p/1013698/" target="_blank" rel="noopener">点击前往官网</a>. 我用的是 <code>vimix-normal-dark</code> 下的 <code>vimix-dark-laptop-beryl</code>.</p>
<p><img src="/posts/40409/1.png"></p>
<h2 id="vimix-icon-theme">Vimix Icon Theme</h2>
<p><a href="https://www.pling.com/p/1273372" target="_blank" rel="noopener">点击前往官网</a>. 是 Vimix 的图标包.</p>
<p>下载后解压到 <code>/usr/share/icons/</code> .</p>
<h1 id="杂七杂八">杂七杂八</h1>
<h2 id="终端-ps1-样式">终端 <code>$PS1</code> 样式</h2>
<p>在 <code>~/.bashrc</code> 里. 我把 <code>@\h</code> 删了, 只留用户名不留计算机名, 不然太长了.</p>
<p>删完效果:</p>
<div style="background-color:#313338;width:100%;font-family:&#39;Ubuntu Mono&#39;;">
<span style="color:#8ae234;">fduse</span><span style="color:#dde1e4;">:</span><span style="color:#729fcf;">~/Workspaces</span><span style="color:#dde1e4;">$ </span>
</div>
]]></content>
      <categories>
        <category>Linux</category>
        <category>Ubuntu</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>美化</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu18.04 UEFI+GPT 安装</title>
    <url>/posts/55661.html</url>
    <content><![CDATA[<h1 id="制作-u-盘启动">制作 U 盘启动</h1>
<p>使用 <a href="https://rufus.ie" target="_blank" rel="noopener">Rufus</a> 制作. 选项如图.</p>
<figure>
<img src="/posts/55661/rufus.png" alt="Rufus"><figcaption>Rufus</figcaption>
</figure>
<p>如图, 因为是要 UEFI 方式启动, 所以分区类型需要选 GPT.</p>
<h1 id="检查硬盘是否-gpt-格式">检查硬盘是否 GPT 格式</h1>
<p>如果是在 Win 下, 工具很多. 在 Win 下使用 <code>fdisk -l</code> 可展示.</p>
<h1 id="u盘启动并安装">U盘启动并安装</h1>
<p><code>Other options</code> 可选可不选.</p>
<p><img src="/posts/55661/1.png"></p>
<p>选择 <code>Something else</code> 以定义安装、定制分区.</p>
<p><img src="/posts/55661/2.png"></p>
<p>以下为一个典型的分区, 分了 <code>efi</code>, <code>/</code>, <code>/home</code>, <code>swap</code> 四个分区, 因为是 UEFI, 不需要分 <code>boot</code> 区.</p>
<p><img src="/posts/55661/3.png"></p>
<p><img src="/posts/55661/4.png"></p>
<p><img src="/posts/55661/5.png"></p>
<p><img src="/posts/55661/6.png"></p>
<p><img src="/posts/55661/7.png"></p>
]]></content>
      <categories>
        <category>Linux</category>
        <category>Ubuntu</category>
      </categories>
      <tags>
        <tag>日常配环境</tag>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
        <tag>UEFI</tag>
        <tag>GPT</tag>
      </tags>
  </entry>
  <entry>
    <title>Win7 虚拟机安装配置</title>
    <url>/posts/5005.html</url>
    <content><![CDATA[<p>整个 Win7 的虚拟机模板, 方便以后使用.</p>
<h1 id="安装">安装</h1>
<h2 id="vmware-下安装">VMware 下安装</h2>
<p>简易安装. 版本 <code>cn_windows_7_ultimate_with_sp1_x64_dvd_u_677408.iso</code>. 分配了 32 GB 磁盘空间. 过程略.</p>
<figure>
<img src="/posts/5005/1.png" alt="处理器与虚拟化配置"><figcaption>处理器与虚拟化配置</figcaption>
</figure>
<h2 id="激活">激活</h2>
<h3 id="kmspico-对-win7-旗舰不起作用">KMSpico (对 Win7 旗舰不起作用)</h3>
<p>官网:</p>
<p>没有官网, 是发布在 <a href="https://forums.mydigitallife.net" target="_blank" rel="noopener" class="uri">https://forums.mydigitallife.net</a> 论坛上的. 作者 <code>heldigard</code>. <code>s1ave77</code> 也是他的一个马甲.</p>
<p>搜索名为 <a href="https://forums.mydigitallife.net/forums/kms-tools.51/" target="_blank" rel="noopener">KMS tools</a> 的子论坛, 有个名为 <a href="https://forums.mydigitallife.net/threads/kmspico-official-thread.65739/" target="_blank" rel="noopener">KMSpico -Official Thread-</a> 的帖子即为官方发布帖子. 上面有提供下载链接. 以下是帖子的一个 txt 附件, 内附下载信息.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">KMSpico v10.2.0</span><br><span class="line"></span><br><span class="line">Download Link:</span><br><span class="line">Password: 2016</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;ncrypt.in&#x2F;folder-ujSQolDR</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;ncrypt.in&#x2F;folder-NsA1y13V</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;ncrypt.in&#x2F;folder-4GGfJ8SX</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;ncrypt.in&#x2F;folder-JLV1rtWc</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;files.fm&#x2F;u&#x2F;nshumc4m</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;www.datafilehost.com&#x2F;d&#x2F;0065fb1e</span><br><span class="line">http:&#x2F;&#x2F;www.datafilehost.com&#x2F;d&#x2F;16bdae50</span><br><span class="line">https:&#x2F;&#x2F;www.datafilehost.com&#x2F;d&#x2F;f7cd9812</span><br><span class="line"></span><br><span class="line">magnet:?xt&#x3D;urn:btih:E954AB6B5A93071E8F1A41C509E77F35A50B1B11&amp;dn&#x3D;KMSpico_v10.2.0&amp;tr&#x3D;udp%3a%2f%2ftracker.openbittorrent.com%3a80%2fannounce&amp;tr&#x3D;udp%3a%2f%2ftracker.publicbt.com%3a80%2fannounce&amp;tr&#x3D;udp%3a%2f%2finferno.demonoid.ooo%3a3392%2fannounce&amp;tr&#x3D;http%3a%2f%2fmgtracker.org%3a2710%2fannounce&amp;tr&#x3D;udp%3a%2f%2f9.rarbg.com%3a2710%2fannounce&amp;tr&#x3D;udp%3a%2f%2fglotorrents.pw%3a6969%2fannounce&amp;tr&#x3D;udp%3a%2f%2ftracker.blackunicorn.xyz%3a6969%2fannounce&amp;tr&#x3D;udp%3a%2f%2ftracker.ccc.de%3a80%2fannounce</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">File     : FrostRose_Install_v10.2.0_fixed.zip</span><br><span class="line">Size     : 3,05 MB</span><br><span class="line">CRC32    : 4c6181b1</span><br><span class="line">MD5      : 3b1ba86f4d1e5b206f6fa6b0fda5a1bb</span><br><span class="line">SHA1     : ef7393a9b3cfe97d5cf7ddf40e1346ad5faf9846</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">File     : FrostRose_Portable_v10.2.0.zip</span><br><span class="line">Size     : 4,27 MB</span><br><span class="line">CRC32    : cb799879</span><br><span class="line">MD5      : caaad448db19e1849e39c5b2c4725a11</span><br><span class="line">SHA1     : 7a9a8402f54bf186aca36309ba112d4d99b0f063</span><br><span class="line"></span><br><span class="line">File     : ServerService_KMS.exe</span><br><span class="line">Size     : 728,19 KB</span><br><span class="line">CRC32    : 30b6d947</span><br><span class="line">MD5      : ebd4d15394ac8416cb6ef70cec9cfa30</span><br><span class="line">SHA1     : 210d1700a10031b1b7207249f22b6cfe36d50685</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Encrypted Folder Link:</span><br><span class="line">Password: 2015</span><br><span class="line"></span><br><span class="line">8E57F4A47DF8492D76442518CF015F1BAEDB3DE0074D797BA73B4AE4140DBE7866D5374D3C3824BAC0AF3225776008AA396AC6A110411DB47BF75E183101D29799CF94E53DD24FAE7BA188821462E4934619DCCBF858E0673DCAE7AF4AA74985988C839269842F66</span><br><span class="line"></span><br><span class="line">Encrypt&#x2F;Decrypt @ByELDI</span><br><span class="line">https:&#x2F;&#x2F;mega.nz&#x2F;#!btIxgRTI!UZUpl220rH974PI_qECS1ElaXF4X5j2HKn8oN6laPNs</span><br><span class="line">http:&#x2F;&#x2F;www.solidfiles.com&#x2F;d&#x2F;17ea9e30de&#x2F;</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">11&#x2F;01&#x2F;2016</span><br><span class="line">@ByELDI</span><br></pre></td></tr></table></figure>
<p>这是他早前的另一个帖子 <a href="https://forums.mydigitallife.net/threads/how-to-kms-host-and-tools-v-3-0.39048" target="_blank" rel="noopener" class="uri">https://forums.mydigitallife.net/threads/how-to-kms-host-and-tools-v-3-0.39048</a>.</p>
<p>KMSpico 运行需要 <code>Microsoft .NET Framework 4</code> 框架: <a href="https://www.microsoft.com/zh-cn/download/details.aspx?id=17718" target="_blank" rel="noopener" class="uri">https://www.microsoft.com/zh-cn/download/details.aspx?id=17718</a> .</p>
<p>它并没有说支持 Ultimate 版本, 但评论区有人成功了, 但我没成功.</p>
<h3 id="windows-7-loader-成功">Windows 7 Loader (成功)</h3>
<p>官网: <a href="https://dazloaderteam.com/" target="_blank" rel="noopener">Windows 7 Loader by DAZ – 2019</a>. 目前版本 2.2.2 . 下载要先填写一些问卷, 有点烦人. 本来是怕国内那些乱七八糟的软件网站下的软件有问题, 但官网提供了哈希, 不想填问卷就国内站点下载了对比哈希就行.</p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">File : <span class="type">Windows</span> Loader.exe</span><br><span class="line">MD5 : 323<span class="type">c0fd51071400b51eedb1be90a8188</span></span><br><span class="line">SHA-<span class="number">1</span> : 0<span class="type">efc35935957c25193bbe9a83ab6caa25a487ada</span></span><br></pre></td></tr></table></figure>
<p>解压缩, 打开软件点一下 <code>Install</code> 再重启就安装完了.</p>
<figure>
<img src="/posts/5005/activated.png" alt="激活成功"><figcaption>激活成功</figcaption>
</figure>
<p><strong>注意:</strong> 有个网站叫 <code>dazwindowsloader.com</code>, 标题叫 <code>Windows 7 Loader 2.6.2 By Daz Download [Windows 7 Activator]</code>, 长得有模有样的, 版本都出到 3.2 了, 谷歌搜索排名还很靠前. 这是假的, 会弹广告什么的. 最新版就是 2.2.2. 下面两张图中上面的是真的下面的是假的.</p>
<figure>
<img src="/posts/5005/real_windows_loader.png" alt="真官网"><figcaption>真官网</figcaption>
</figure>
<figure>
<img src="/posts/5005/fake_windows_loader.png" alt="假官网"><figcaption>假官网</figcaption>
</figure>
<p>(甚至还搞了个假的 FEEDBACK??)</p>
<h1 id="配置">配置</h1>
<h2 id="开机启动小键盘">开机启动小键盘</h2>
<p><code>Win+R</code> -&gt; <code>regedit</code> -&gt; <code>HKEY_USERS\.DEFAULT\Control Panel\Keyboard</code> -&gt; <code>InitialKeyboardIndicators</code>, 双击把值改为 <code>2</code> .</p>
<h2 id="关闭-windows-update">关闭 Windows Update</h2>
<p><code>控制面板\系统和安全\Windows Update\更改设置</code>. 免得给我升到 Win10 了...</p>
<h1 id="必备软件">必备软件</h1>
<p><a href="https://www.7-zip.org/" target="_blank" rel="noopener">7-Zip</a> | <a href="https://www.huorong.cn" target="_blank" rel="noopener">火绒安全软件</a> | <a href="http://www.firefox.com.cn/" target="_blank" rel="noopener">火狐浏览器</a></p>
]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
        <tag>虚拟机</tag>
      </tags>
  </entry>
  <entry>
    <title>各类项目依赖可视化工具</title>
    <url>/posts/49962.html</url>
    <content><![CDATA[<h1 id="maven">Maven</h1>
<h2 id="maven-工具-mvn-dependencytree">Maven 工具: <code>mvn dependency:tree</code></h2>
<p>在项目目录执行 <code>mvn dependency:tree</code> :</p>
<p><code>https://github.com/che-samples/che-ide-server-extension</code> 项目的子项目 <code>plugins/plugin-serverservice/plugin-serverservice-ide</code> 的依赖如下:</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">[INFO] Scanning <span class="keyword">for</span> projects...</span><br><span class="line">[INFO] </span><br><span class="line">[INFO] ----------&lt; org.eclipse.che.<span class="string">sample:</span>plugin-serverservice-ide &gt;-----------</span><br><span class="line">[INFO] Building Plugin <span class="string">ServerService :</span>: <span class="string">Plugin :</span>: IDE <span class="number">6.16</span><span class="number">.0</span></span><br><span class="line">[INFO] ------------------------------[ gwt-lib ]-------------------------------</span><br><span class="line">[INFO] </span><br><span class="line">[INFO] --- maven-dependency-<span class="string">plugin:</span><span class="number">3.0</span><span class="number">.1</span>:tree (<span class="keyword">default</span>-cli) @ plugin-serverservice-ide ---</span><br><span class="line">[INFO] org.eclipse.che.<span class="string">sample:</span>plugin-serverservice-<span class="string">ide:</span>gwt-<span class="string">lib:</span><span class="number">6.16</span><span class="number">.0</span></span><br><span class="line">[INFO] +- com.google.<span class="string">inject:</span><span class="string">guice:</span><span class="string">jar:</span><span class="number">4.2</span><span class="number">.2</span>:compile</span><br><span class="line">[INFO] |  \- <span class="string">aopalliance:</span><span class="string">aopalliance:</span><span class="string">jar:</span><span class="number">1.0</span>:compile</span><br><span class="line">[INFO] +- javax.<span class="string">inject:</span>javax.<span class="string">inject:</span><span class="string">jar:</span><span class="number">1</span>:compile</span><br><span class="line">[INFO] +- org.eclipse.che.<span class="string">core:</span>che-core-commons-<span class="string">gwt:</span><span class="string">jar:</span><span class="number">6.16</span><span class="number">.0</span>:compile</span><br><span class="line">[INFO] |  +- com.google.code.<span class="string">findbugs:</span><span class="string">jsr305:</span><span class="string">jar:</span><span class="number">3.0</span><span class="number">.1</span>:compile</span><br><span class="line"></span><br><span class="line">... ...</span><br><span class="line"></span><br><span class="line">[INFO] |  +- org.eclipse.che.<span class="string">core:</span>che-core-api-<span class="string">core:</span><span class="string">jar:</span><span class="number">6.16</span><span class="number">.0</span>:compile</span><br><span class="line">[INFO] |  |  +- com.google.code.<span class="string">gson:</span><span class="string">gson:</span><span class="string">jar:</span><span class="number">2.8</span><span class="number">.5</span>:compile</span><br><span class="line">[INFO] |  |  +- javax.<span class="string">annotation:</span>javax.annotation-<span class="string">api:</span><span class="string">jar:</span><span class="number">1.2</span>:compile</span><br><span class="line">[INFO] |  |  +- javax.ws.<span class="string">rs:</span>javax.ws.rs-<span class="string">api:</span><span class="string">jar:</span><span class="number">2.0</span>:compile</span><br><span class="line">[INFO] |  |  +- net.java.dev.<span class="string">jna:</span><span class="string">jna:</span><span class="string">jar:</span><span class="number">4.1</span><span class="number">.0</span>:compile</span><br><span class="line">[INFO] |  |  +- org.eclipse.che.<span class="string">core:</span>che-core-commons-<span class="string">json:</span><span class="string">jar:</span><span class="number">6.16</span><span class="number">.0</span>:compile</span><br><span class="line">[INFO] |  |  +- org.eclipse.che.<span class="string">core:</span>che-core-commons-<span class="string">lang:</span><span class="string">jar:</span><span class="number">6.16</span><span class="number">.0</span>:compile</span><br><span class="line">[INFO] |  |  |  \- org.apache.<span class="string">commons:</span>commons-<span class="string">compress:</span><span class="string">jar:</span><span class="number">1.18</span>:compile</span><br><span class="line">[INFO] |  |  +- org.eclipse.che.<span class="string">core:</span>che-core-commons-<span class="string">schedule:</span><span class="string">jar:</span><span class="number">6.16</span><span class="number">.0</span>:compile</span><br><span class="line">[INFO] |  |  |  \- org.eclipse.che.<span class="string">core:</span>che-core-commons-<span class="string">inject:</span><span class="string">jar:</span><span class="number">6.16</span><span class="number">.0</span>:compile</span><br><span class="line">[INFO] |  |  |     +- com.google.inject.<span class="string">extensions:</span>guice-<span class="string">servlet:</span><span class="string">jar:</span><span class="number">4.2</span><span class="number">.2</span>:compile</span><br><span class="line">[INFO] |  |  |     \- org.<span class="string">everrest:</span>everrest-integration-<span class="string">guice:</span><span class="string">jar:</span><span class="number">1.13</span><span class="number">.5</span>:compile</span><br><span class="line">[INFO] |  |  +- org.<span class="string">everrest:</span>everrest-<span class="string">core:</span><span class="string">jar:</span><span class="number">1.13</span><span class="number">.5</span>:compile</span><br><span class="line">[INFO] |  |  |  +- commons-<span class="string">fileupload:</span>commons-<span class="string">fileupload:</span><span class="string">jar:</span><span class="number">1.3</span><span class="number">.3</span>:compile</span><br><span class="line">[INFO] |  |  |  +- javax.<span class="string">mail:</span><span class="string">mail:</span><span class="string">jar:</span><span class="number">1.4</span><span class="number">.4</span>:compile</span><br><span class="line">[INFO] |  |  |  \- commons-<span class="string">io:</span>commons-<span class="string">io:</span><span class="string">jar:</span><span class="number">2.6</span>:compile</span><br><span class="line">[INFO] |  |  \- org.<span class="string">slf4j:</span>slf4j-<span class="string">api:</span><span class="string">jar:</span><span class="number">1.7</span><span class="number">.24</span>:compile</span><br><span class="line">[INFO] |  +- org.eclipse.che.<span class="string">core:</span>che-core-commons-<span class="string">annotations:</span><span class="string">jar:</span><span class="number">6.16</span><span class="number">.0</span>:compile</span><br><span class="line">[INFO] |  +- org.<span class="string">vectomatic:</span>lib-gwt-<span class="string">svg:</span><span class="string">jar:</span><span class="number">0.5</span><span class="number">.12</span>:compile</span><br><span class="line">[INFO] |  \- org.<span class="string">webjars:</span><span class="string">requirejs:</span><span class="string">jar:</span><span class="number">2.1</span><span class="number">.15</span>:runtime</span><br><span class="line">[INFO] +- org.eclipse.che.<span class="string">core:</span>che-core-ide-<span class="string">api:</span><span class="string">jar:</span><span class="number">6.16</span><span class="number">.0</span>:compile</span><br><span class="line">[INFO] |  +- com.google.inject.<span class="string">extensions:</span>guice-<span class="string">assistedinject:</span><span class="string">jar:</span><span class="number">4.2</span><span class="number">.2</span>:compile</span><br><span class="line">[INFO] |  +- javax.<span class="string">validation:</span>validation-<span class="string">api:</span><span class="string">jar:</span><span class="number">1.1</span><span class="number">.0</span>.<span class="string">Final:</span>compile</span><br><span class="line">[INFO] |  +- org.eclipse.<span class="string">che:</span>che-exec-agent-<span class="string">shared:</span><span class="string">jar:</span><span class="number">6.16</span><span class="number">.0</span>:compile</span><br><span class="line"></span><br><span class="line">... ...</span><br><span class="line"></span><br><span class="line">[INFO] |  +- org.eclipse.che.<span class="string">core:</span>che-core-api-user-<span class="string">shared:</span><span class="string">jar:</span><span class="string">sources:</span><span class="number">6.16</span><span class="number">.0</span>:compile</span><br><span class="line">[INFO] |  +- org.eclipse.che.<span class="string">core:</span>che-core-api-workspace-<span class="string">shared:</span><span class="string">jar:</span><span class="number">6.16</span><span class="number">.0</span>:compile</span><br><span class="line">[INFO] |  \- org.eclipse.che.<span class="string">core:</span>che-core-api-workspace-<span class="string">shared:</span><span class="string">jar:</span><span class="string">sources:</span><span class="number">6.16</span><span class="number">.0</span>:compile</span><br><span class="line">[INFO] \- com.google.<span class="string">gwt:</span>gwt-<span class="string">user:</span><span class="string">jar:</span><span class="number">2.8</span><span class="number">.2</span>:provided</span><br><span class="line">[INFO]    +- com.google.<span class="string">jsinterop:</span>jsinterop-<span class="string">annotations:</span><span class="string">jar:</span><span class="number">1.0</span><span class="number">.2</span>:provided</span><br><span class="line">[INFO]    +- com.google.<span class="string">jsinterop:</span>jsinterop-<span class="string">annotations:</span><span class="string">jar:</span><span class="string">sources:</span><span class="number">1.0</span><span class="number">.2</span>:provided</span><br><span class="line">[INFO]    +- javax.<span class="string">servlet:</span>javax.servlet-<span class="string">api:</span><span class="string">jar:</span><span class="number">3.1</span><span class="number">.0</span>:provided</span><br><span class="line">[INFO]    \- org.w3c.<span class="string">css:</span><span class="string">sac:</span><span class="string">jar:</span><span class="number">1.3</span>:provided</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] BUILD SUCCESS</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Total <span class="string">time:</span>  <span class="number">2.313</span> s</span><br><span class="line">[INFO] Finished <span class="string">at:</span> <span class="number">2019</span><span class="number">-08</span><span class="number">-01</span><span class="string">T10:</span><span class="number">40</span>:<span class="number">52</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br></pre></td></tr></table></figure>
<h2 id="eclipse-可视化界面">Eclipse 可视化界面</h2>
<p>打开 <code>pom.xml</code>, Eclipse 提供多个视图, 点击下面的 <code>Dependency Hierarchy</code> 视图:</p>
<figure>
<img src="/posts/49962/Maven-Eclipse1.png" alt="Maven-Eclipse1.png"><figcaption>Maven-Eclipse1.png</figcaption>
</figure>
<p>点击左栏中的包时会在右栏高亮对应包, 在右栏点击包会在左栏高亮所有依赖与该包的包.</p>
<figure>
<img src="/posts/49962/Maven-Eclipse2.gif" alt="Maven-Eclipse2.gif"><figcaption>Maven-Eclipse2.gif</figcaption>
</figure>
<h2 id="apache-maven-dependency-plugin"><a href="http://maven.apache.org/components/plugins/maven-dependency-plugin/" target="_blank" rel="noopener">Apache Maven Dependency Plugin</a></h2>
<p>在项目的 <code>pom.xml</code> 下添加如下 plugin:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-dependency-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mvn dependency:tree -DoutputType=graphml -DoutputFile=dependency.graphml</span><br></pre></td></tr></table></figure>
<p>目录下生成 <code>dependency.graphml</code> .</p>
<p>然后下载 <a href="https://www.yworks.com/downloads#yEd" target="_blank" rel="noopener">yEd</a> , 或者使用 <a href="https://www.yworks.com/yed-live/" target="_blank" rel="noopener">yEd 的在线版本</a> 以生成查看导出依赖图.</p>
<p>同样是 <code>plugin-serverservice-ide</code> 的依赖↓:</p>
<figure>
<img src="/posts/49962/yEd-Dependency.png" alt="yEd-Dependency.png"><figcaption>yEd-Dependency.png</figcaption>
</figure>
<h1 id="c-c">C / C++</h1>
<h2 id="gcc-工具-gcc--m-file.cpp">GCC 工具: <code>gcc -M &lt;file&gt;.cpp</code></h2>
<p>对于 C++ 文件:</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"lib1.h"</span></span></span><br><span class="line"></span><br><span class="line">... ...</span><br></pre></td></tr></table></figure>
<p><code>gcc -M &lt;file&gt;.cpp</code> : 显示该文件的所有依赖.</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">main.<span class="string">o:</span> main.cpp <span class="regexp">/usr/</span>include<span class="regexp">/stdc-predef.h /</span>usr<span class="regexp">/include/</span>c++<span class="regexp">/5/</span>iostream \</span><br><span class="line"> <span class="regexp">/usr/</span>include<span class="regexp">/x86_64-linux-gnu/</span>c++<span class="regexp">/5/</span>bits/c++config.h \</span><br><span class="line"> <span class="regexp">/usr/</span>include<span class="regexp">/x86_64-linux-gnu/</span>c++<span class="regexp">/5/</span>bits/os_defines.h \</span><br><span class="line"> <span class="regexp">/usr/</span>include<span class="regexp">/features.h /</span>usr<span class="regexp">/include/</span>x86_64-linux-gnu<span class="regexp">/sys/</span>cdefs.h \</span><br><span class="line"> <span class="regexp">/usr/</span>include<span class="regexp">/x86_64-linux-gnu/</span>bits/wordsize.h \</span><br><span class="line"></span><br><span class="line">... ...</span><br><span class="line"></span><br><span class="line"> <span class="regexp">/usr/</span>include<span class="regexp">/c++/</span><span class="number">5</span><span class="regexp">/bits/</span>locale_facets.tcc \</span><br><span class="line"> <span class="regexp">/usr/</span>include<span class="regexp">/c++/</span><span class="number">5</span><span class="regexp">/bits/</span>basic_ios.tcc \</span><br><span class="line"> <span class="regexp">/usr/</span>include<span class="regexp">/c++/</span><span class="number">5</span><span class="regexp">/bits/</span>ostream.tcc <span class="regexp">/usr/</span>include<span class="regexp">/c++/</span><span class="number">5</span>/istream \</span><br><span class="line"> <span class="regexp">/usr/</span>include<span class="regexp">/c++/</span><span class="number">5</span><span class="regexp">/bits/</span>istream.tcc lib1.h</span><br></pre></td></tr></table></figure>
<p><code>gcc -MM &lt;file&gt;.cpp</code> : 显示该文件的所有依赖 (不包括系统依赖的头文件).</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">main<span class="selector-class">.o</span>: main<span class="selector-class">.cpp</span> lib1.h</span><br></pre></td></tr></table></figure>
<h2 id="cmake-graphviz">CMake: Graphviz</h2>
<p>需要 Graphviz 工具: <code>sudo apt-get install graphviz</code> .</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 当前在项目 (CMakeLists.txt) 目录</span></span><br><span class="line"><span class="built_in">cd</span> build/</span><br><span class="line">cmake .. --graphviz=&lt;graph&gt;.dot</span><br><span class="line">dot &lt;graph&gt;.dot -T png -o &lt;figure&gt;.png</span><br></pre></td></tr></table></figure>
<p>项目 CMake 本身的依赖图:</p>
<figure>
<img src="/posts/49962/CMake-Dependency.png" alt="CMake-Dependency.png"><figcaption>CMake-Dependency.png</figcaption>
</figure>
<p>项目 OpenCV 的依赖图:</p>
<p>dot 布局:</p>
<figure>
<img src="/posts/49962/OpenCV-Dependency-dot.png" alt="OpenCV-Dependency-dot.png"><figcaption>OpenCV-Dependency-dot.png</figcaption>
</figure>
<p>circo 布局:</p>
<figure>
<img src="/posts/49962/OpenCV-Dependency-circo.png" alt="OpenCV-Dependency-circo.png"><figcaption>OpenCV-Dependency-circo.png</figcaption>
</figure>
]]></content>
      <tags>
        <tag>可视化</tag>
        <tag>依赖</tag>
      </tags>
  </entry>
  <entry>
    <title>Maven 安装使用</title>
    <url>/posts/36502.html</url>
    <content><![CDATA[<h1 id="安装-ubuntu">安装 (Ubuntu)</h1>
<h2 id="apt-get-方式"><code>apt-get</code> 方式</h2>
<p>用 <code>apt-get</code> 会比较方便, 但安装出来版本可能不是最新的.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install maven</span><br></pre></td></tr></table></figure>
<p>安装完的目录为, Maven home: <code>/usr/share/maven</code>; Config file: <code>/etc/maven</code>.</p>
<p><code>settings.xml</code> 位置: <code>/etc/maven/settings.xml</code> .</p>
<h2 id="官网安装">官网安装</h2>
<p>apt 版本太旧了. 没有高亮, 且错误信息都不显示. 最后还得从官网装最新的.</p>
<p><a href="https://maven.apache.org/download.cgi" target="_blank" rel="noopener">官网下载页面</a> | <a href="https://maven.apache.org/install.html" target="_blank" rel="noopener">官网安装教程</a></p>
<p>下载后解压.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo tar -zxvf apache-maven-3.6.1-bin.tar.gz -C /usr/<span class="built_in">local</span>/bin/</span><br></pre></td></tr></table></figure>
<p>打开 <code>/etc/profile</code> 并添加 PATH.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=/usr/<span class="built_in">local</span>/bin/apache-maven-3.6.1/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>
<p>重启一下系统. 然后 <code>mvn -v</code> 以看看是否安装成功.</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">Apache Maven <span class="number">3.6</span><span class="number">.1</span> (d66c9c0b3152b2e69ee9bac180bb8fcc8e6af555; <span class="number">2019</span><span class="number">-04</span><span class="number">-05</span><span class="string">T03:</span><span class="number">00</span>:<span class="number">29</span>+<span class="number">08</span>:<span class="number">00</span>)</span><br><span class="line">Maven <span class="string">home:</span> <span class="regexp">/usr/</span>local<span class="regexp">/bin/</span>apache-maven<span class="number">-3.6</span><span class="number">.1</span></span><br><span class="line">Java <span class="string">version:</span> <span class="number">1.8</span><span class="number">.0</span>_161, <span class="string">vendor:</span> Oracle Corporation, <span class="string">runtime:</span> <span class="regexp">/usr/</span>lib<span class="regexp">/jdk/</span>jdk1<span class="number">.8</span><span class="number">.0</span>_161/jre</span><br><span class="line">Default <span class="string">locale:</span> en_US, platform <span class="string">encoding:</span> UTF<span class="number">-8</span></span><br><span class="line">OS <span class="string">name:</span> <span class="string">"linux"</span>, <span class="string">version:</span> <span class="string">"4.4.0-21-generic"</span>, <span class="string">arch:</span> <span class="string">"amd64"</span>, <span class="string">family:</span> <span class="string">"unix"</span></span><br></pre></td></tr></table></figure>
<p>配置文件: <code>/usr/local/bin/apache-maven-3.6.1/conf/settings.xml</code>.</p>
<h1 id="指令">指令</h1>
<h2 id="mvn-clean-install"><code>mvn clean install</code></h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mvn clean install -DskipTests   <span class="comment"># 跳过单元测试</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -pl: 仅构建选中的项目 (而不是目录下所有项目)</span></span><br><span class="line"><span class="comment"># -am: 同时处理选定模块所依赖的模块</span></span><br><span class="line">mvn clean install -pl :&lt;assemblyname&gt; -am</span><br></pre></td></tr></table></figure>
<h2 id="查看当前生效的-settings.">查看当前生效的 <code>settings</code>.</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mvn <span class="built_in">help</span>:effective-settings</span><br></pre></td></tr></table></figure>
<p>第一次使用该指令时会先下一坨东西.</p>
<h1 id="踩坑">踩坑</h1>
<h2 id="下载慢">下载慢</h2>
<p>换阿里云的源.</p>
<p>打开 <code>settings.xml</code>.</p>
<p>在 <code>&lt;mirrors&gt;</code> 标签中添加</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun-public<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun public<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/public<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun-central<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun central<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/central<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun-spring<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun spring<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/spring<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun-spring-plugin<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun spring-plugin<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/spring-plugin<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun-apache-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun apache-snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/apache-snapshots<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun-google<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun google<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/google<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun-gradle-plugin<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun gradle-plugin<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/gradle-plugin<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun-jcenter<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun jcenter<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/jcenter<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun releases<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/releases<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun snapshots<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/snapshots<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span>  </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun-grails-core<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun grails-core<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/grails-core<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>aliyun-mapr-public<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun mapr-public<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/mapr-public<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><em>啊~~ 速度起飞了.</em></p>
<p>但阿里云镜像有时候会抽风, 就突然长时间无响应, 给人一种爬虫被 ban 的感觉.</p>
<p><strong>更新:</strong> <em>好消息特大好消息</em>, 就在刚刚 (2019年07月09日), 腾讯云开源软件镜像站突然就上线了!!!</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-tencentyun<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>Nexus tencentyun<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://mirrors.cloud.tencent.com/nexus/repository/maven-public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>不过还没试过. 应该还可以.</p>
<h2 id="eclipse-配置-maven">Eclipse 配置 Maven</h2>
<p>现在的 Eclipse 自带 Maven 插件.</p>
<p><code>Window -&gt; Preference -&gt; Maven -&gt; Installation</code>, 添加本地 Maven 主目录, 不要用 Eclipse 自带的.</p>
<p><img src="/posts/36502/1.png"></p>
<p><code>Window -&gt; Preference -&gt; Maven -&gt; User Settings</code>, 修改配置文件地址.</p>
<p><img src="/posts/36502/2.png"></p>
<h3 id="this-compilation-unit-is-not-on-the-build-path-of-a-java-project."><code>This compilation unit is not on the build path of a java project.</code></h3>
<p>在给 java 源文件导入包时如图报错:</p>
<p><img src="/posts/36502/3.png"></p>
<p>解决方法: 未解决.</p>
<h2 id="不支持-lambda-等语法">不支持 Lambda 等语法</h2>
<p>Maven 默认使用语言版本比较低, 要在 POM 的 <code>build - plugins</code> 添加以下内容以支持 Java 8 的语法:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="打包-jar-时也将依赖打包入同一文件">打包 Jar 时也将依赖打包入同一文件</h2>
<p>在 POM 的 <code>build - plugins</code> 添加:</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-assembly-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appendAssemblyId</span>&gt;</span>false<span class="tag">&lt;/<span class="name">appendAssemblyId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">descriptorRefs</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">descriptorRef</span>&gt;</span>jar-with-dependencies<span class="tag">&lt;/<span class="name">descriptorRef</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">descriptorRefs</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">archive</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">manifest</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>xjf.Main<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">archive</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>make-assembly<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>assembly<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="openjdk-8-不包含-javafx.util-包">OpenJDK 8 不包含 <code>javafx.util</code> 包</h2>
<p>打包后的 Jar 包在本机上运行的好好的, 跑服务器上报错:</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">Exception <span class="keyword">in</span> thread <span class="string">"main"</span> java<span class="selector-class">.lang</span><span class="selector-class">.NoClassDefFoundError</span>: javafx/util/Pair</span><br></pre></td></tr></table></figure>
<p>一看原来是本机用的 Oracle JDK 8, 服务器用的 OpenJDK 8. OpenJDK 8 内不包括 <code>javafx.util</code> 这个商用包. 不过听说 OpenJDK 10+ 之后就拥有了这些商用功能.</p>
<p>在不动源码, 不改服务器 JDK 的情况下, 解决方法是把 <code>javafx.util</code> 手动添加为 Maven 依赖, 打 Jar 包时一起打进去.</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openjfx<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javafx-base<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>15.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后放到服务器上又报错:</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">Exception <span class="keyword">in</span> thread <span class="string">"main"</span> java.lang.UnsupportedClassVersionError: javafx/util/Pair has been compiled <span class="keyword">by</span> <span class="keyword">a</span> more recent <span class="built_in">version</span> <span class="keyword">of</span> <span class="keyword">the</span> Java Runtime (class <span class="built_in">file</span> <span class="built_in">version</span> <span class="number">55.0</span>), this <span class="built_in">version</span> <span class="keyword">of</span> <span class="keyword">the</span> Java Runtime only recognizes class <span class="built_in">file</span> versions up <span class="built_in">to</span> <span class="number">52.0</span></span><br></pre></td></tr></table></figure>
<p>原因是 15 版本的 javafx 编译版本太高 (55.0), 服务器上的老旧 JVM 不支持. 要改用 52.0 编译的旧版本. 但问题在于, Maven 中央仓库上 javafx 旧版本已经被删除了, 还在仓库的最老的版本是 11, 11 是 54.0 编译的, 依然不行.</p>
<p>最终解决方案是自己重写了一个 Pair 类... 因为好在我的项目只使用了 <code>javafx.util.Pair</code> 这一个类...</p>
]]></content>
      <tags>
        <tag>日常配环境</tag>
        <tag>快乐背指令</tag>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
        <tag>Eclipse</tag>
        <tag>Maven</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu 美化 (主题图标等)</title>
    <url>/posts/38422.html</url>
    <content><![CDATA[<p>Ubuntu 16.04 美化.</p>
<h1 id="unity-tweak-tool">Unity Tweak Tool</h1>
<p>首先安装 Unity Tweak Tool, 换主题和图标必备.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install unity-tweak-tool</span><br></pre></td></tr></table></figure>
<p><img src="/posts/38422/1.png"></p>
<h1 id="numix-图标与主题">numix 图标与主题</h1>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository ppa:numix/ppa</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install numix-gtk-theme numix-icon-theme-circle</span><br></pre></td></tr></table></figure>
<p>在 <code>Unity Tweak Tool</code> -&gt; <code>Appearance</code> -&gt; <code>Cursors</code> 中找到 numix 图标并更换.</p>
<p><img src="/posts/38422/2.png"></p>
<p>在 <code>Unity Tweak Tool</code> -&gt; <code>Appearance</code> -&gt; <code>Theme</code> 中找到 numix 主图并更换.</p>
<p><img src="/posts/38422/3.png"></p>
<h1 id="flatabulous-主题">flatabulous 主题</h1>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository ppa:noobslab/themes</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install flatabulous-theme</span><br></pre></td></tr></table></figure>
<p><img src="/posts/38422/4.png"></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
        <tag>美化</tag>
      </tags>
  </entry>
  <entry>
    <title>Eclipse Che 安装使用</title>
    <url>/posts/34765.html</url>
    <content><![CDATA[<p>安装使用的版本是 6.16.0, 已经过时, 7 版本已经出了.</p>
<h1 id="安装使用-ubuntu">安装使用 (Ubuntu)</h1>
<p>环境: Ubuntu 16.04</p>
<p><a href="https://github.com/eclipse/che/releases/" target="_blank" rel="noopener">Eclipse Che GitHub</a> | <a href="https://www.eclipse.org/che/docs/che-6/index.html" target="_blank" rel="noopener">官方文档</a> | <a href="https://www.eclipse.org/che/docs/che-6/docker-single-user.html" target="_blank" rel="noopener">官方安装文档</a></p>
<p>文档指出运行一个默认的 Eclipse Che, 在 Docker 下仅需如下命令.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -it --rm -v /var/run/docker.sock:/var/run/docker.sock -v &lt;path&gt;:/data eclipse/che start</span><br></pre></td></tr></table></figure>
<p>由于 Docker 进程使用 Unix Socket 而不是 TCP 端口, 需要 <code>sudo</code>. cd 到一个目录, 输入:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 指定了版本 6.16.0, 最新版总是提示 not found.</span></span><br><span class="line">sudo docker run -it -v /var/run/docker.sock:/var/run/docker.sock -v ~/Eclipse-Che:/data eclipse/che:6.16.0 start</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目前用的版本</span></span><br><span class="line">sudo docker run -it -v /var/run/docker.sock:/var/run/docker.sock -v ~/Workspace/Eclipse-Che/Eclipse-Che-6.16.0:/data -v ~/.m2:/home/user/.m2 eclipse/che:6.16.0 start</span><br></pre></td></tr></table></figure>
<p>倒数第二行输出 <code>INFO: (che start): Use: http://192.168.221.133:8080</code> 即为浏览器访问地址.</p>
<h1 id="踩坑">踩坑</h1>
<h2 id="workspace-中不显示且无法新建项目">Workspace 中不显示且无法新建项目</h2>
<p>如图.</p>
<p><img src="/posts/34765/1.png"></p>
<p><img src="/posts/34765/2.png"></p>
<p>而正常情况应该为:</p>
<p><img src="/posts/34765/3.png"></p>
<p>出现该问题的原因: 访问的地址是 <code>localhost:8080</code> 或 <code>127.0.0.1:8080</code>, 正确应该访问本机ip+端口8080.</p>
<p>问题主要发生在 Windows 下, win 下终端直接提示的用 localhost 访问, 而 Linux 环境下则提示用本机ip访问所以没这个问题:</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="string">INFO:</span> (che sstart): <span class="string">Use:</span> <span class="string">http:</span><span class="comment">//192.168.221.133:8080</span></span><br><span class="line"><span class="string">INFO:</span> (che start): <span class="string">API:</span> <span class="string">http:</span><span class="comment">//192.168.221.133:8080/swagger</span></span><br></pre></td></tr></table></figure>
<p>解决方法查询自 <a href="https://github.com/eclipse/che/issues/12475" target="_blank" rel="noopener">GitHub Issue 12475</a>:</p>
<blockquote>
<p><strong>qurben</strong> commented on 25 Feb</p>
<p><strong><span class="citation" data-cites="skabashnyuk">@skabashnyuk</span></strong> It seems to be related with <a href="https://github.com/eclipse/che/pull/12476" target="_blank" rel="noopener">#12476</a>, before that CORS on wsagent was a bit more liberal.</p>
<p>When running the normal setup on Docker (the one described on the wiki and in this issue) and accessing Che via http://localhost:8080 the following happens:</p>
<p>In <a href="https://github.com/eclipse/che/blob/master/wsagent/che-wsagent-core/src/main/java/org/eclipse/che/wsagent/server/CheWsAgentCorsAllowedOriginsProvider.java#L47" target="_blank" rel="noopener"><code>CheWsAgentCorsAllowedOriginsProvider</code></a> the value of <code>apiExternal</code> is equal to <code>http://10.0.75.2:8080/api</code> (or whatever ip the container has on the Docker NAT). This sets <code>allowedOrigins</code> to <code>http://10.0.75.2:8080</code>. This causes the wsagent server to not respond with any CORS headers when a request is sent from <code>http://localhost:8080</code> or <code>http://127.0.0.1:8080</code> because the host does not match.</p>
<p>I am currently not well known enough with the code to propose a proper solution for this.</p>
</blockquote>
<h2 id="代码补全快捷键-ctrl-space-不起作用">代码补全快捷键 (<code>Ctrl + Space</code>) 不起作用</h2>
<p>症状是报错与警告正常显示, 但在编辑器按快捷键 <code>Ctrl + Space</code> 尝试弹出代码补全的小框框时没有反应.</p>
<p>解决方法: 把 Win10 输入法关了......</p>
<h2 id="maven-install-报错-found-1-non-complying-files">Maven <code>install</code> 报错: <code>Found 1 non-complying files</code></h2>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">[ERROR] Found <span class="number">1</span> non-complying files, failing build</span><br><span class="line">[ERROR] To fix formatting errors, run <span class="string">"mvn fmt:format"</span></span><br><span class="line">[ERROR] Non complying <span class="string">file:</span> <span class="regexp">/home/</span>xie<span class="regexp">/Workspace/</span>Eclipse-Che<span class="regexp">/Eclipse-Che-6.16.0/</span>instance<span class="regexp">/data/</span>workspaces<span class="regexp">/workspaceo7zayfpxbzrdvmqf/</span>che-test-extension<span class="regexp">/plugins/</span>plugin-xxx<span class="regexp">/plugin-xxx-ide/</span>src<span class="regexp">/main/</span>java<span class="regexp">/zzz/</span>yyy<span class="regexp">/ide/</span>XXXExtension.java</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Reactor <span class="string">Summary:</span></span><br><span class="line">[INFO] </span><br><span class="line">[INFO] Plugin <span class="string">XXX :</span>: Parent pom ........................... SUCCESS [  <span class="number">1.921</span> s]</span><br><span class="line">[INFO] Plugin <span class="string">XXX :</span>: <span class="string">Plugins :</span>:  Parent ................... SUCCESS [  <span class="number">0.053</span> s]</span><br><span class="line">[INFO] Plugin <span class="string">XXX :</span>: <span class="string">Plugin :</span>: Parent ..................... SUCCESS [  <span class="number">0.816</span> s]</span><br><span class="line">[INFO] Plugin <span class="string">XXX :</span>: <span class="string">Plugin :</span>: Server ..................... SUCCESS [  <span class="number">3.759</span> s]</span><br><span class="line">[INFO] Plugin <span class="string">XXX :</span>: <span class="string">Plugin :</span>: IDE ........................ FAILURE [  <span class="number">2.800</span> s]</span><br><span class="line">[INFO] Plugin <span class="string">xxx :</span>: Che <span class="string">Assembly :</span>: Assembly Parent ...... SKIPPED</span><br><span class="line">[INFO] Plugin <span class="string">XXX :</span>: Che <span class="string">Assembly :</span>: Workspace Agent Assembly SKIPPED</span><br><span class="line">[INFO] Plugin <span class="string">XXX :</span>: Che <span class="string">Assembly :</span>: Workspace Agent Tomcat Assembly SKIPPED</span><br><span class="line">[INFO] Plugin <span class="string">XXX :</span>: Che <span class="string">Assembly :</span>: IDE Assembly ......... SKIPPED</span><br><span class="line">[INFO] Plugin <span class="string">XXX :</span>: Che <span class="string">Assembly :</span>: Assemblies Tomcat .... SKIPPED</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] BUILD FAILURE</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Total <span class="string">time:</span> <span class="number">11.225</span> s</span><br><span class="line">[INFO] Finished <span class="string">at:</span> <span class="number">2019</span><span class="number">-07</span><span class="number">-08</span><span class="string">T10:</span><span class="number">26</span>:<span class="number">53</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line">[INFO] Final <span class="string">Memory:</span> <span class="number">59</span>M/<span class="number">1319</span>M</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[ERROR] Failed to execute goal com.<span class="string">coveo:</span>fmt-maven-<span class="string">plugin:</span><span class="number">2.5</span><span class="number">.1</span>:check (<span class="keyword">default</span>) on project plugin-xxx-<span class="string">ide:</span> Found <span class="number">1</span> non-complying files, failing build -&gt; [Help <span class="number">1</span>]</span><br><span class="line">org.apache.maven.lifecycle.<span class="string">LifecycleExecutionException:</span> Failed to execute goal com.<span class="string">coveo:</span>fmt-maven-<span class="string">plugin:</span><span class="number">2.5</span><span class="number">.1</span>:check (<span class="keyword">default</span>) on project plugin-xxx-<span class="string">ide:</span> Found <span class="number">1</span> non-complying files, failing build</span><br><span class="line">	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.<span class="string">java:</span><span class="number">212</span>)</span><br><span class="line">	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.<span class="string">java:</span><span class="number">153</span>)</span><br><span class="line">	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.<span class="string">java:</span><span class="number">145</span>)</span><br><span class="line"></span><br><span class="line">... ...</span><br><span class="line"></span><br><span class="line">	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.<span class="string">java:</span><span class="number">207</span>)</span><br><span class="line">	... <span class="number">20</span> more</span><br><span class="line">[ERROR] </span><br><span class="line">[ERROR] </span><br><span class="line">[ERROR] For more information about the errors and possible solutions, please read the following <span class="string">articles:</span></span><br><span class="line">[ERROR] [Help <span class="number">1</span>] <span class="string">http:</span><span class="comment">//cwiki.apache.org/confluence/display/MAVEN/MojoFailureException</span></span><br><span class="line">[ERROR] </span><br><span class="line">[ERROR] After correcting the problems, you can resume the build with the command</span><br><span class="line">[ERROR]   mvn &lt;goals&gt; -<span class="string">rf :</span>plugin-xxx-ide</span><br></pre></td></tr></table></figure>
<p>运行 <code>mvn fmt:format</code> 即可. <a href="https://github.com/eclipse/che/issues/8947" target="_blank" rel="noopener">Issue 8947</a>.</p>
<h1 id="插件开发">插件开发</h1>
<h2 id="官网的-demo-安装">官网的 Demo 安装</h2>
<p>官网的双开ide的教程复现不了 (第二个 ide 也是显示不了工作区项目的问题), 作罢. 以下是 GitHub 上找到的方法.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/che-samples/che-ide-server-extension</span><br><span class="line"><span class="built_in">cd</span> che-ide-server-extension</span><br><span class="line">git checkout 6.16.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用 Maven 前先换阿里云的源, 不然大概率失败</span></span><br><span class="line">mvn clean install -DskipTests</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动带插件的 Eclipse Che</span></span><br><span class="line">sudo docker run -ti --rm -v /var/run/docker.sock:/var/run/docker.sock -v ~/Check:/data -v $(<span class="built_in">pwd</span>)/assembly/assembly-main/target/eclipse-che-6.16.0/eclipse-che-6.16.0:/assembly eclipse/che:6.16.0 start --fast</span><br></pre></td></tr></table></figure>
<p><img src="/posts/34765/4.png"> <img src="/posts/34765/5.png"></p>
<h2 id="目前用的一些指令">(目前用的一些指令)</h2>
<p>Docker:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 无插件 IDE</span></span><br><span class="line">sudo docker run -it -v /var/run/docker.sock:/var/run/docker.sock -v ~/Workspace/Eclipse-Che/Eclipse-Che-6.16.0:/data -v ~/.m2:/home/user/.m2 eclipse/che:6.16.0 start</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试 Plugin</span></span><br><span class="line">sudo docker run -ti --rm -v /var/run/docker.sock:/var/run/docker.sock -v ~/Workspace/Eclipse-Che/Eclipse-Che-6.16.0:/data -v $(<span class="built_in">pwd</span>)/assembly/assembly-main/target/eclipse-che-6.16.0/eclipse-che-6.16.0:/assembly eclipse/che:6.16.0 start --fast</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试本地 IDE</span></span><br><span class="line">sudo docker run -ti --rm -v ~/Workspace/Eclipse/Maven/che-6.16.0:/repo -v ~/Workspace/Eclipse-Che/Eclipse-Che-6.16.0:/data -v /var/run/docker.sock:/var/run/docker.sock eclipse/che:6.16.0 start --fast</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除所有容器</span></span><br><span class="line">sudo docker rm -f $(sudo docker ps -a -q)</span><br></pre></td></tr></table></figure>
<p>Tomcat:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker run -d -v /home/xie/Workspace/Eclipse/Maven/CLDIFF-WEB/target/CLDIFF-WEB.war:/usr/<span class="built_in">local</span>/tomcat/webapps/CLDIFF-WEB.war -p 8080:8080 --name cldiff-server tomcat</span><br><span class="line"></span><br><span class="line">sudo docker cp /home/xie/Workspace/Eclipse/Maven/CLDIFF-WEB/target/CLDIFF-WEB.war cldiff-server:/usr/<span class="built_in">local</span>/tomcat/webapps</span><br><span class="line"></span><br><span class="line">sudo docker <span class="built_in">exec</span> -it cldiff-server /bin/bash</span><br><span class="line"></span><br><span class="line">sudo /usr/<span class="built_in">local</span>/bin/tomcat9/bin/startup.sh </span><br><span class="line">sudo /usr/<span class="built_in">local</span>/bin/tomcat9/bin/shutdown.sh</span><br></pre></td></tr></table></figure>
<p>Maven:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 构建 che 整体</span></span><br><span class="line">mvn -DskipTests=<span class="literal">true</span> -Dfindbugs.skip=<span class="literal">true</span> -Dmdep.analyze.skip=<span class="literal">true</span> -Dlicense.skip=<span class="literal">true</span> -Dgwt.compiler.localWorkers=2 -T 1C -Pnative -pl <span class="string">'!dashboard'</span> fmt:format clean install -e | tee ~/Desktop/che.log</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建 plugin-git</span></span><br><span class="line"><span class="built_in">cd</span> ~/Workspace/Eclipse/Maven/che-6.16.0/plugins/plugin-git</span><br><span class="line">mvn fmt:format clean install -e -Dlicense.skip=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>日常配环境</tag>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
        <tag>Eclipse Che</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker 安装使用</title>
    <url>/posts/63135.html</url>
    <content><![CDATA[<p>环境: Ubuntu</p>
<h1 id="安装-ubuntu">安装 (Ubuntu)</h1>
<p>使用的官网安装教程: <code>https://docs.docker.com/install/linux/docker-ee/ubuntu/</code> .</p>
<h2 id="检查系统环境">检查系统环境</h2>
<p>安装的 CE, EE 要钱.</p>
<p>首先检查系统合不合要求.</p>
<blockquote>
<p>To install Docker CE, you need the 64-bit version of one of these Ubuntu versions: - Cosmic 18.10 - Bionic 18.04 (LTS) - Xenial 16.04 (LTS)</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">uname -r   <span class="comment"># 要求内核版本大于 3.10</span></span><br><span class="line"><span class="comment"># 4.4.0-21-generic</span></span><br><span class="line"></span><br><span class="line">cat /etc/lsb-release        <span class="comment"># 可以查看是不是 Xenial, 是不是 16.04 等</span></span><br><span class="line"><span class="comment"># DISTRIB_ID=Ubuntu</span></span><br><span class="line"><span class="comment"># DISTRIB_RELEASE=16.04</span></span><br><span class="line"><span class="comment"># DISTRIB_CODENAME=xenial</span></span><br><span class="line"><span class="comment"># DISTRIB_DESCRIPTION="Ubuntu 16.04.3 LTS"</span></span><br><span class="line"></span><br><span class="line">getconf LONG_BIT            <span class="comment"># 查看是不是 64 位</span></span><br><span class="line"><span class="comment"># 64</span></span><br></pre></td></tr></table></figure>
<p>先卸载旧版, 若本身就没有安装会提示 <code>Package 'xxx' is not installed, so not removed</code> .</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get remove docker docker-engine docker.io containerd runc</span><br></pre></td></tr></table></figure>
<h2 id="安装">安装</h2>
<p><del>前往 <code>https://download.docker.com/linux/ubuntu/dists/</code> , 根据 Ubuntu 版本打开对应目录. 例如我的是 <code>https://download.docker.com/linux/ubuntu/dists/xenial/pool/stable/amd64/</code> , 挑个新版本的 <code>.deb</code> 文件下载./</del></p>
<p>上述方法在使用 dpkg 安装该 deb 时安装错误, 因为缺少一些依赖. 于是还是选择了官方最推荐又比较烦的方法.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装一些依赖,比如允许 apt 添加 https 的仓库</span></span><br><span class="line">sudo apt-get install \</span><br><span class="line">    apt-transport-https \</span><br><span class="line">    ca-certificates \</span><br><span class="line">    curl \</span><br><span class="line">    gnupg-agent \</span><br><span class="line">    software-properties-common</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加 Docker 的官方 GPG Key</span></span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line"></span><br><span class="line"><span class="comment"># 确保该指令输出 "9DC8 5822 9FC7 DD38 854A E2D8 8D81 803C 0EBF CD88" 字样</span></span><br><span class="line">sudo apt-key fingerprint 0EBFCD88</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加仓库</span></span><br><span class="line">sudo add-apt-repository \</span><br><span class="line">    <span class="string">"deb [arch=amd64] https://download.docker.com/linux/ubuntu \</span></span><br><span class="line"><span class="string">    <span class="variable">$(lsb_release -cs)</span> \</span></span><br><span class="line"><span class="string">    stable"</span></span><br><span class="line"></span><br><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装**最新版** Docker</span></span><br><span class="line">sudo apt-get install docker-ce docker-ce-cli containerd.io</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装**指定版本** Docker</span></span><br><span class="line"><span class="comment"># apt-cache madison docker-ce   # 检索版本</span></span><br><span class="line"><span class="comment"># sudo apt-get install docker-ce=&lt;VERSION_STRING&gt; docker-ce-cli=&lt;VERSION_STRING&gt; containerd.io</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证是否安装成功</span></span><br><span class="line">sudo docker run hello-world</span><br></pre></td></tr></table></figure>
<h2 id="卸载">卸载</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get purge docker-ce    <span class="comment"># 卸载软件</span></span><br><span class="line">sudo rm -rf /var/lib/docker     <span class="comment"># 删除图片, 容器等文件</span></span><br></pre></td></tr></table></figure>
<h1 id="指令">指令</h1>
<h2 id="一个实例">一个实例</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker run -it -v /var/run/docker.sock:/var/run/docker.sock -v ~/Eclipse-Che:/data eclipse/che:6.16.0 start</span><br></pre></td></tr></table></figure>
<p><code>-it</code>: <code>-t</code> 让docker分配一个伪终端并绑定到容器的标准输入上, <code>-i</code> 则让容器的标准输入保持打开. <code>-it</code> 使得伪终端接管 stdin/stdout, 保持 bash 不退出.</p>
<p><code>-v</code>: 挂载宿主机的一个目录 (宿主机目录:容器内目录), 容器目录不可以为相对路径.</p>
<h2 id="指令-1">指令</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 容器</span></span><br><span class="line">sudo docker ps                              <span class="comment"># 查看运行中的容器</span></span><br><span class="line">sudo docker ps -a                           <span class="comment"># 查看所有容器</span></span><br><span class="line">sudo docker start &lt;name&gt;                    <span class="comment"># 启动已存在容器</span></span><br><span class="line">sudo docker start -a &lt;name&gt;                 <span class="comment"># 启动容器并在控制台打印其输出</span></span><br><span class="line">sudo docker stop &lt;name&gt;                     <span class="comment"># 关闭容器</span></span><br><span class="line">sudo docker rename &lt;old_name&gt; &lt;new_name&gt;    <span class="comment"># 重命名</span></span><br><span class="line">sudo docker <span class="built_in">export</span> &lt;name&gt; &gt; &lt;name&gt;.tar      <span class="comment"># 导出容器</span></span><br><span class="line">sudo docker rm &lt;name&gt;                       <span class="comment"># 删除容器</span></span><br><span class="line">sudo docker rm -f &lt;name&gt;                    <span class="comment"># 强制删除运行中的容器</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 镜像</span></span><br><span class="line">docker images       <span class="comment"># 查看所有镜像</span></span><br><span class="line">docker images -q    <span class="comment"># 仅查看所有镜像的id</span></span><br><span class="line">docker rmi &lt;name&gt;   <span class="comment"># 删除镜像</span></span><br></pre></td></tr></table></figure>
<p>启动/关闭 daemon 和 docker</p>
<blockquote>
<p>Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo systemctl start docker     <span class="comment"># 开启 Docker daemon</span></span><br><span class="line">sudo systemctl restart docker   <span class="comment"># 重启 Docker daemon</span></span><br><span class="line">sudo systemctl daemon-reload    <span class="comment"># 刷新修改</span></span><br><span class="line">sudo systemctl stop docker      <span class="comment"># 关闭 Docker daemon</span></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>日常配环境</tag>
        <tag>快乐背指令</tag>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>CMake 安装使用</title>
    <url>/posts/11689.html</url>
    <content><![CDATA[<p><a href="https://cmake.org/documentation" target="_blank" rel="noopener">官方在线文档</a></p>
<h1 id="安装与新建工程-ubuntu">安装与新建工程 (Ubuntu)</h1>
<p>CMake 官网下载: <a href="https://cmake.org/download/" target="_blank" rel="noopener" class="uri">https://cmake.org/download/</a> .</p>
<p>找个地方解压并进入.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -zxvf cmake-3.14.5.tar.gz</span><br><span class="line"><span class="built_in">cd</span> cmake-3.14.5/</span><br></pre></td></tr></table></figure>
<p>根据目录下的 <code>README</code> 文件, 执行以下命令安装.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./bootstrap &amp;&amp; make &amp;&amp; sudo make install</span><br></pre></td></tr></table></figure>
<p>编译好慢啊...</p>
<p>CMake 会默认安装在 /usr/local/bin 下面.</p>
<h2 id="用-cmake-编译安装-cmake">用 CMake 编译安装 CMake</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> build/</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>
<h2 id="构建一个简单的-cmake-项目">构建一个简单的 CMake 项目</h2>
<p>新建一个文件夹作为项目文件夹, 新建文件 <code>CMakeLists.txt</code>. 以下为一个典型的配置:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 项目名称</span></span><br><span class="line">PROJECT(CMakeTest CXX)</span><br><span class="line"></span><br><span class="line"><span class="comment"># CMake最低版本需求，不加入此行会受到警告信息</span></span><br><span class="line">CMAKE_MINIMUM_REQUIRED(VERSION 3.14)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 把目录src下所有源代码文件和头文件加入变量SRC_LIST</span></span><br><span class="line">AUX_SOURCE_DIRECTORY(src SRC_LIST)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成应用程序 hello</span></span><br><span class="line">ADD_EXECUTABLE(hello <span class="variable">$&#123;SRC_LIST&#125;</span>)</span><br></pre></td></tr></table></figure>
<p>在 <code>src</code> 文件夹写好源码后 (比如写个 <code>hello_world.cpp</code>), 在项目目录新建文件夹 <code>build</code>.</p>
<p>然后执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> build/</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<p>在 <code>build</code> 文件夹下就会生成编译文件和最终的可执行文件 <code>hello</code>.</p>
<h2 id="github-优秀-cmake-项目参考">GitHub 优秀 CMake 项目参考</h2>
<p><a href="https://github.com/Kitware/CMake" target="_blank" rel="noopener">CMake</a> | <a href="https://github.com/opencv/opencv" target="_blank" rel="noopener">OpenCV</a></p>
<h2 id="visual-studio-对-cmake-的支持"><a href="https://devblogs.microsoft.com/cppblog/cmake-support-in-visual-studio/" target="_blank" rel="noopener">Visual Studio 对 CMake 的支持</a></h2>
<h1 id="cmake-语法">CMake 语法</h1>
<h2 id="语法特性">语法特性</h2>
<h3 id="赋值语句">赋值语句</h3>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 在当前及其子项目定义变量 VAR (不影响父域)</span></span><br><span class="line"><span class="comment"># 使用 $&#123;&lt;var&gt;&#125; 访问</span></span><br><span class="line"><span class="comment"># set(VAR a b c) 以定义 LIST (set(VAR "a b c") 则定义了个字符串)</span></span><br><span class="line"><span class="keyword">set</span>(&lt;var&gt; &lt;value&gt;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在父域定义 VAR (而不影响当前环境!!)</span></span><br><span class="line"><span class="keyword">set</span>(&lt;var&gt; &lt;value&gt; PARENT_SCOPE)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Cache 变量, 定义后全局访问, 且存在 CMakeCache.txt 中</span></span><br><span class="line"><span class="comment"># 使用 $CACHE&#123;&lt;var&gt;&#125; 访问, 或当同名常规变量未被定义时也可用 $&#123;&lt;var&gt;&#125; 访问</span></span><br><span class="line"><span class="keyword">set</span>(&lt;var&gt; &lt;value&gt; CACHE &lt;<span class="keyword">STRING</span> | BOOL | FILEPATH | PATH&gt; INTERNAL)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 环境变量</span></span><br><span class="line"><span class="comment"># 使用 $ENV&#123;&lt;var&gt;&#125; 访问</span></span><br><span class="line"><span class="keyword">set</span>(ENV&#123;&lt;var&gt;&#125; &lt;path&gt;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 不再定义</span></span><br><span class="line"><span class="keyword">unset</span>(&lt;var&gt; [CACHE | PARENT_SCOPE])</span><br><span class="line"><span class="keyword">unset</span>(ENV&#123;&lt;variable&gt;&#125;)</span><br></pre></td></tr></table></figure>
<p>LIST 操作</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 读</span></span><br><span class="line"><span class="keyword">list</span>(LENGTH &lt;<span class="keyword">list</span>&gt; &lt;out-var&gt;)</span><br><span class="line"><span class="keyword">list</span>(GET &lt;<span class="keyword">list</span>&gt; &lt;element index&gt; [&lt;index&gt; ...] &lt;out-var&gt;)</span><br><span class="line"><span class="keyword">list</span>(JOIN &lt;<span class="keyword">list</span>&gt; &lt;glue&gt; &lt;out-var&gt;)</span><br><span class="line"><span class="keyword">list</span>(SUBLIST &lt;<span class="keyword">list</span>&gt; &lt;begin&gt; &lt;length&gt; &lt;out-var&gt;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查</span></span><br><span class="line"><span class="keyword">list</span>(FIND &lt;<span class="keyword">list</span>&gt; &lt;value&gt; &lt;out-var&gt;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删改</span></span><br><span class="line"><span class="keyword">list</span>(APPEND &lt;<span class="keyword">list</span>&gt; [&lt;element&gt;...])</span><br><span class="line"><span class="keyword">list</span>(FILTER &lt;<span class="keyword">list</span>&gt; &#123;<span class="keyword">INCLUDE</span> | EXCLUDE&#125; REGEX &lt;regex&gt;)</span><br><span class="line"><span class="keyword">list</span>(INSERT &lt;<span class="keyword">list</span>&gt; &lt;index&gt; [&lt;element&gt;...])</span><br><span class="line"><span class="keyword">list</span>(POP_BACK &lt;<span class="keyword">list</span>&gt; [&lt;out-var&gt;...])</span><br><span class="line"><span class="keyword">list</span>(POP_FRONT &lt;<span class="keyword">list</span>&gt; [&lt;out-var&gt;...])</span><br><span class="line"><span class="keyword">list</span>(PREPEND &lt;<span class="keyword">list</span>&gt; [&lt;element&gt;...])</span><br><span class="line"><span class="keyword">list</span>(REMOVE_ITEM &lt;<span class="keyword">list</span>&gt; &lt;value&gt;...)</span><br><span class="line"><span class="keyword">list</span>(REMOVE_AT &lt;<span class="keyword">list</span>&gt; &lt;index&gt;...)</span><br><span class="line"><span class="keyword">list</span>(REMOVE_DUPLICATES &lt;<span class="keyword">list</span>&gt;)</span><br><span class="line"><span class="keyword">list</span>(TRANSFORM &lt;<span class="keyword">list</span>&gt; &lt;ACTION&gt; [...])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 排序</span></span><br><span class="line"><span class="keyword">list</span>(REVERSE &lt;<span class="keyword">list</span>&gt;)</span><br><span class="line"><span class="keyword">list</span>(SORT &lt;<span class="keyword">list</span>&gt; [...])</span><br></pre></td></tr></table></figure>
<h3 id="条件语句">条件语句</h3>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(&lt;condition&gt;)</span><br><span class="line">    &lt;commands&gt;</span><br><span class="line"><span class="keyword">elseif</span>(&lt;condition&gt;)</span><br><span class="line">    &lt;commands&gt;</span><br><span class="line"><span class="keyword">else</span>()          <span class="comment"># 或在括号内填上与 if 一模一样的 &lt;condition&gt;</span></span><br><span class="line">    &lt;commands&gt;</span><br><span class="line"><span class="keyword">endif</span>()         <span class="comment"># 或在括号内填上与 if 一模一样的 &lt;condition&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="函数">函数</h3>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>(&lt;func_name&gt; [arg1 [arg2 [arg3 ...]]])</span><br><span class="line">    &lt;commands&gt;</span><br><span class="line"><span class="keyword">endfunction</span>()       <span class="comment"># 或在括号内一字不差地填上 function 括号内内容</span></span><br></pre></td></tr></table></figure>
<h3 id="宏">宏</h3>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">macro</span>(&lt;name&gt; [arg1 [arg2 [arg3 ...]]])</span><br><span class="line">  &lt;commands&gt;</span><br><span class="line"><span class="keyword">endmacro</span>()          <span class="comment"># 或在括号内一字不差地填上 macro 括号内内容</span></span><br></pre></td></tr></table></figure>
<h2 id="内置函数">内置函数</h2>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 确定所需 CMake 版本 (最好放在文件的最开头)</span></span><br><span class="line"><span class="comment"># cmake_minimum_required(VERSION 3.14 FATAL_ERROR)</span></span><br><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION &lt;min&gt;[...&lt;max&gt;] [FATAL_ERROR])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 确定项目名</span></span><br><span class="line"><span class="keyword">project</span>(&lt;<span class="keyword">project</span>&gt;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加并构建一个子项目 (即包含 CMakeLists.txt 的文件夹)</span></span><br><span class="line"><span class="keyword">add_subdirectory</span>(&lt;project_dir&gt; [binary_dir] [EXCLUDE_FROM_ALL])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将一整个文件夹里的 c/cpp 文件添加到源文件列表,</span></span><br><span class="line"><span class="comment"># 得到如 "src/main.cpp;src/s.cpp;..." 的字符串</span></span><br><span class="line"><span class="comment"># aux_source_directory(src SRC_LIST)</span></span><br><span class="line"><span class="keyword">aux_source_directory</span>(&lt;src_dir&gt; &lt;source_list&gt;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据提供的源文件参数生成可执行文件</span></span><br><span class="line"><span class="comment"># add_executable(CMakeTest.exe $&#123;SRC_LIST&#125;)</span></span><br><span class="line"><span class="keyword">add_executable</span>(&lt;target_exe&gt; [WIN32] [MACOSX_BUNDLE]</span><br><span class="line">               [EXCLUDE_FROM_ALL]</span><br><span class="line">               [source1] [source2 ...])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 同上, 生成库</span></span><br><span class="line"><span class="comment"># add_library(Dependency.lib d1.cpp)</span></span><br><span class="line"><span class="keyword">add_library</span>(&lt;target_lib&gt; [STATIC | SHARED | MODULE]</span><br><span class="line">            [EXCLUDE_FROM_ALL]</span><br><span class="line">            [source1] [source2 ...])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加头文件目录 (添加后可识别 #include "xxx.h" 而不用使用相对路径)</span></span><br><span class="line"><span class="comment"># include_directories(Dependency)</span></span><br><span class="line"><span class="keyword">include_directories</span>([AFTER|BEFORE] [SYSTEM] dir1 [dir2 ...])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给指定目标添加头文件目录</span></span><br><span class="line"><span class="comment"># target_include_directories(CMakeTest.exe PRIVATE Dependency)</span></span><br><span class="line"><span class="keyword">target_include_directories</span>(&lt;<span class="keyword">target</span>&gt; [SYSTEM] [BEFORE]</span><br><span class="line">  &lt;INTERFACE|PUBLIC|PRIVATE&gt; [items1...]</span><br><span class="line">  [&lt;INTERFACE|PUBLIC|PRIVATE&gt; [items2...] ...])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 链接先前已经生成的可执行文件和库</span></span><br><span class="line"><span class="comment"># target_link_libraries(CMakeTest.exe Dependency.lib)</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>(&lt;<span class="keyword">target</span>&gt; ... &lt;item&gt;... ...)</span><br></pre></td></tr></table></figure>
<h2 id="内置变量">内置变量</h2>
<h3 id="cmake_source_dir-project_source_dir-cmake_current_source_dir-project_name_source_dir"><strong><code>CMAKE_SOURCE_DIR</code> | <code>PROJECT_SOURCE_DIR</code> | <code>CMAKE_CURRENT_SOURCE_DIR</code> | <code>&lt;PROJECT_NAME&gt;_SOURCE_DIR</code></strong></h3>
<p>都指向项目的源目录的绝对路径 (<code>CMakeLists.txt</code> 所在的绝对路径).</p>
<p><strong><code>CMAKE_SOURCE_DIR</code></strong> 指向当前最顶层项目 (父项目) <code>CMakeLists.txt</code> 的路径.</p>
<p><strong><code>PROJECT_SOURCE_DIR</code></strong> 指向当前项目 (子项目) <code>CMakeLists.txt</code> 的路径.</p>
<p><strong><code>CMAKE_CURRENT_SOURCE_DIR</code></strong> 指向当前正在处理的 <code>CMakeLists.txt</code> 的路径 (感觉和 <code>PROJECT_SOURCE_DIR</code> 没啥区别啊???).</p>
<p><strong><code>&lt;PROJECT_NAME&gt;_SOURCE_DIR</code></strong> 就是指定某项目的 <code>CMakeLists.txt</code> 的路径. 但是当该项目还未被调用过之前, 该变量未定义.</p>
<p>所以当没有子项目时这几个都相同.</p>
<hr>
<p>例如对于父项目 <code>Outer</code> 与子项目 <code>Inner</code>:</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Outer/CMakeLists.txt</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">project</span>(Outer)</span><br><span class="line"><span class="keyword">add_subdirectory</span>(Inner)</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># Outer/Inner/CMakeLists.txt</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">project</span>(Inner)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>在 <code>Outer/CMakeLists.txt</code> 中的变量值为:</p>
<table>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><strong><code>CMAKE_SOURCE_DIR</code></strong></th>
<th style="text-align: center;"><strong><code>PROJECT_SOURCE_DIR</code></strong></th>
<th style="text-align: center;"><strong><code>CMAKE_CURRENT_SOURCE_DIR</code></strong></th>
<th style="text-align: center;"><strong><code>Outer_SOURCE_DIR</code></strong></th>
<th style="text-align: center;"><strong><code>Inner_SOURCE_DIR</code></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>/.../Outer</code></td>
<td style="text-align: center;"><code>/.../Outer</code></td>
<td style="text-align: center;"><code>/.../Outer</code></td>
<td style="text-align: center;"><code>/.../Outer</code></td>
<td style="text-align: center;"><code>/.../Outer/Inner</code></td>
</tr>
</tbody>
</table>
<p>在 <code>Outer/Inner/CMakeLists.txt</code> 中的变量值为:</p>
<table>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><strong><code>CMAKE_SOURCE_DIR</code></strong></th>
<th style="text-align: center;"><strong><code>PROJECT_SOURCE_DIR</code></strong></th>
<th style="text-align: center;"><strong><code>CMAKE_CURRENT_SOURCE_DIR</code></strong></th>
<th style="text-align: center;"><strong><code>Outer_SOURCE_DIR</code></strong></th>
<th style="text-align: center;"><strong><code>Inner_SOURCE_DIR</code></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>/.../Outer</code></td>
<td style="text-align: center;"><code>/.../Outer/Inner</code></td>
<td style="text-align: center;"><code>/.../Outer/Inner</code></td>
<td style="text-align: center;"><code>/.../Outer</code></td>
<td style="text-align: center;"><code>/.../Outer/Inner</code></td>
</tr>
</tbody>
</table>
<p><strong>TODO:</strong> <code>PROJECT_SOURCE_DIR</code> 与 <code>CMAKE_CURRENT_SOURCE_DIR</code> 区别.</p>
<h3 id="cmake_binary_dir-project_binary_dir-cmake_current_binary_dir-project_name_binary_dir"><strong><code>CMAKE_BINARY_DIR</code> | <code>PROJECT_BINARY_DIR</code> | <code>CMAKE_CURRENT_BINARY_DIR</code> | <code>&lt;PROJECT_NAME&gt;_BINARY_DIR</code></strong></h3>
<p>指向工程编译发生的绝对路径. 区别同上.</p>
<p>如果是 in source 编译, 指的就是工程顶层目录, 即与 <code>&lt;?&gt;_SOURCE_DIR</code> 一样. 而如果是:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> build/</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<p>这种, 则其路径为 <code>/.../CMake_Project/build</code> .</p>
<h1 id="踩坑">踩坑</h1>
<h2 id="项目依赖作图-graphviz">项目依赖作图 (graphviz)</h2>
<p>生成依赖图的文件:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> build/</span><br><span class="line">cmake .. --graphviz=&lt;graph&gt;.dot</span><br></pre></td></tr></table></figure>
<p>在 <code>build/</code> 下生成 <code>&lt;graph&gt;.dot</code> 文件, <code>&lt;graph&gt;.dot.&lt;target&gt;</code> 文件和 <code>&lt;graph&gt;.dot.&lt;target&gt;.dependers</code> 文件.</p>
<p>安装 graphviz 以生成 png:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install graphviz</span><br></pre></td></tr></table></figure>
<p>导出依赖为图片:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dot &lt;graph&gt;.dot -T png -o &lt;figure&gt;.png</span><br></pre></td></tr></table></figure>
<p>例如对于 <code>cmake-3.14.5</code> 项目:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir Build</span><br><span class="line"><span class="built_in">cd</span> Build</span><br><span class="line">cmake .. --graphviz=graph.dot</span><br><span class="line">ls | grep graph</span><br><span class="line"><span class="comment"># graph.dot</span></span><br><span class="line"><span class="comment"># graph.dot.cmake</span></span><br><span class="line"><span class="comment"># graph.dot.cmake.dependers</span></span><br><span class="line"><span class="comment"># graph.dot.CMakeLib</span></span><br><span class="line"><span class="comment"># graph.dot.CMakeLib.dependers</span></span><br><span class="line">...</span><br><span class="line"><span class="comment"># graph.dot.testConsoleBufChild</span></span><br><span class="line"><span class="comment"># graph.dot.testConsoleBufChild.dependers</span></span><br><span class="line"><span class="comment"># graph.dot.testEncoding</span></span><br><span class="line"><span class="comment"># graph.dot.testEncoding.dependers</span></span><br><span class="line"></span><br><span class="line">dot graph.dot -T png -o graph.png</span><br></pre></td></tr></table></figure>
<p>打开 <code>graph.png</code>:</p>
<p><img src="/posts/11689/cmake-3.14.5-graph.png"></p>
<p>emmmm, 好丑的图.</p>
]]></content>
      <tags>
        <tag>日常配环境</tag>
        <tag>快乐背指令</tag>
        <tag>CMake</tag>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Git 安装使用</title>
    <url>/posts/10606.html</url>
    <content><![CDATA[<h1 id="指令">指令</h1>
<h2 id="git-bash-使用-ssh-登陆">Git Bash 使用 ssh 登陆</h2>
<p>配置 Git Bash:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.name &lt;name&gt;</span><br><span class="line">git config --global user.email &lt;email&gt;</span><br><span class="line"><span class="comment"># 如果开了 Github 的 `Keep my email addresses private` 功能,</span></span><br><span class="line"><span class="comment"># 设置 email 时 要填 Github 生成的 email, 而不是注册 email.</span></span><br><span class="line"><span class="comment"># 还有一些其他可选设置</span></span><br></pre></td></tr></table></figure>
<p>以下是我的一些配置:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git config --list</span><br><span class="line">core.symlinks=<span class="literal">false</span></span><br><span class="line">core.autocrlf=<span class="literal">true</span></span><br><span class="line">core.fscache=<span class="literal">true</span></span><br><span class="line">color.diff=auto</span><br><span class="line">color.status=auto</span><br><span class="line">color.branch=auto</span><br><span class="line">color.interactive=<span class="literal">true</span></span><br><span class="line">help.format=html</span><br><span class="line">rebase.autosquash=<span class="literal">true</span></span><br><span class="line">http.sslbackend=openssl</span><br><span class="line">http.sslcainfo=C:/Program Files/Git/mingw64/ssl/certs/ca-bundle.crt</span><br><span class="line">credential.helper=manager</span><br><span class="line">core.editor=<span class="string">"C:\\Program Files\\Microsoft VS Code\\Code.exe"</span> --<span class="built_in">wait</span></span><br><span class="line">diff.astextplain.textconv=astextplain</span><br><span class="line">filter.lfs.clean=git-lfs clean -- %f</span><br><span class="line">filter.lfs.smudge=git-lfs smudge -- %f</span><br><span class="line">filter.lfs.process=git-lfs filter-process</span><br><span class="line">filter.lfs.required=<span class="literal">true</span></span><br><span class="line">filter.lfs.clean=git-lfs clean -- %f</span><br><span class="line">filter.lfs.smudge=git-lfs smudge -- %f</span><br><span class="line">filter.lfs.process=git-lfs filter-process</span><br><span class="line">filter.lfs.required=<span class="literal">true</span></span><br><span class="line">user.name=username</span><br><span class="line">user.email=fakenameg@users.noreply.github.com</span><br><span class="line">core.quotepath=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>配置 ssh:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 查看版本 (我的版本比较新, 老版本的指令略有不同)</span></span><br><span class="line">$ ssh -V</span><br><span class="line">OpenSSH_8.0p1, OpenSSL 1.1.1c  28 May 2019</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新开一个 ssh 代理</span></span><br><span class="line">$ ssh-agent -s</span><br><span class="line">SSH_AUTH_SOCK=/tmp/ssh-zBSkGOjqZpYl/agent.1678; <span class="built_in">export</span> SSH_AUTH_SOCK;</span><br><span class="line">SSH_AGENT_PID=1679; <span class="built_in">export</span> SSH_AGENT_PID;</span><br><span class="line"><span class="built_in">echo</span> Agent pid 1679;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 确定一下这个 ssh 还没有密钥</span></span><br><span class="line">$ ssh-add -l -E md5</span><br><span class="line">The agent has no identities.</span><br><span class="line"></span><br><span class="line"><span class="comment"># 整一个新的密钥, 一路回车确定 (默认配置)</span></span><br><span class="line">$ ssh-keygen -t rsa -b 4096 -C <span class="string">"随便一串字符"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 新密钥的私钥和公钥储存位置 (id_rsa 和 id_rsa.pub)</span></span><br><span class="line">$ ls ~/.ssh/</span><br><span class="line">id_rsa  id_rsa.pub  known_hosts</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加到 ssh-agent</span></span><br><span class="line">$ ssh-add ~/.ssh/id_rsa</span><br><span class="line">Identity added: /c/Users/xie/.ssh/id_rsa (随便一串字符)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 再次查看 ssh-agent 的密钥, 已经成功添加</span></span><br><span class="line">$ ssh-add -l -E md5</span><br><span class="line">4096 MD5:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx 随便一串字符 (RSA)</span><br></pre></td></tr></table></figure>
<p>然后登陆 Github, 复制公钥:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">clip &lt; ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>
<p>登陆后 <code>https://github.com/settings/keys</code> -&gt; <code>New SSH Key</code>, 'Title' 随意, 在 'Key' 粘贴.</p>
<p>然后测试一下连接 (初次使用以下指令会多一段对话(如下), 输入 &quot;yes&quot;):</p>
<figure class="highlight vhdl"><table><tr><td class="code"><pre><span class="line">$ ssh -T git@github.com</span><br><span class="line">The authenticity <span class="keyword">of</span> host <span class="symbol">'github</span>.com (<span class="number">13.250</span>.<span class="number">177.223</span>)' can<span class="symbol">'t</span> be established.</span><br><span class="line">RSA key fingerprint <span class="keyword">is</span> SHA256:aF9zXis7VUy4CsdfSltbl6ZCksa34ChdVfA54S3xcA2.</span><br><span class="line">Are you sure you want <span class="keyword">to</span> continue connecting (yes/no/[fingerprint])? yes</span><br><span class="line"><span class="literal">Warning</span>: Permanently added <span class="symbol">'github</span>.com,<span class="number">13.250</span>.<span class="number">177.223</span>' (RSA) <span class="keyword">to</span> the list <span class="keyword">of</span> known hosts.</span><br><span class="line">Hi XieNaoban! You<span class="symbol">'ve</span> successfully authenticated, but GitHub does <span class="keyword">not</span> provide shell <span class="keyword">access</span>.</span><br></pre></td></tr></table></figure>
<h2 id="提交三部曲">提交三部曲</h2>
<p>直接偷懒把当前时间作为本次提交版本的 &quot;提交说明&quot;, 每次都要思考 &quot;提交说明&quot; 怎么写真是太累了 (真实项目别这么干).</p>
<p>Bash:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 获取当前时间作为 "提交说明"</span></span><br><span class="line"><span class="built_in">readonly</span> date=$(date +%Y-%m-%d\ %H:%M:%S)</span><br><span class="line"></span><br><span class="line">git add .               <span class="comment"># 添加当前目录所有文件到暂存区</span></span><br><span class="line">git commit -m <span class="string">"<span class="variable">$&#123;date&#125;</span>"</span> <span class="comment"># 提交到本地仓库, 以时间作为 "提交说明"</span></span><br><span class="line">git push origin master  <span class="comment"># origin 表示远程主机, master 为分支名称</span></span><br></pre></td></tr></table></figure>
<p>PowerShell:</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$date</span> = <span class="built_in">Get-Date</span> -Format <span class="string">'yyyyMMdd-HH:mm:ss'</span></span><br><span class="line"></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">"$&#123;date&#125;"</span></span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>
<h2 id="分支操作">分支操作</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch                  <span class="comment"># 查看分支</span></span><br><span class="line"></span><br><span class="line">git branch &lt;branch&gt;         <span class="comment"># 创建分支</span></span><br><span class="line">git checkout &lt;branch&gt;       <span class="comment"># 切换分支</span></span><br><span class="line"></span><br><span class="line">git checkout -b &lt;branch&gt;    <span class="comment"># 创建并切换分支</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 推送到远程分支: 远程还没有该分支</span></span><br><span class="line">git push origin &lt;local_branch&gt;:&lt;remote_branch&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除远程分支</span></span><br><span class="line">git push origin --delete &lt;remote_branch&gt;</span><br></pre></td></tr></table></figure>
<h2 id="找不同">找不同</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git status      <span class="comment"># 找出不同的文件、文件夹</span></span><br><span class="line">git status -s   <span class="comment"># 找不同, 显示很精简规整, 就很舒服</span></span><br><span class="line">git diff        <span class="comment"># 找出不同的每一行</span></span><br></pre></td></tr></table></figure>
<h2 id="分支合并">分支合并</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout &lt;branch_1&gt;     <span class="comment"># 转到分支1</span></span><br><span class="line">git merge &lt;branch_2&gt;        <span class="comment"># 合并分支2</span></span><br><span class="line">git push origin &lt;branch_1&gt;  <span class="comment"># 推送到远程分支</span></span><br></pre></td></tr></table></figure>
<h2 id="从远程更新到本地">从远程更新到本地</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git pull &lt;host&gt; &lt;remote_branch&gt;:&lt;local_branch&gt;</span><br><span class="line">git pull &lt;host&gt; &lt;remote_branch&gt;                 <span class="comment"># 与当前本地分支合并</span></span><br><span class="line">git pull                                        <span class="comment"># 简写, 合并本分支</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># git pull origin tmp 相当于:</span></span><br><span class="line">git fetch origin</span><br><span class="line">git merge origin/tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># git pull 更快, 但 fetch 再 merge 可以方便查看 diff</span></span><br><span class="line">git fetch origin master:tmp</span><br><span class="line">git diff tmp</span><br><span class="line">git merge tmp</span><br></pre></td></tr></table></figure>
<h2 id="撤销">撤销</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 撤销未 git add 的文件的修改</span></span><br><span class="line">git checkout .        <span class="comment"># 全部撤销修改</span></span><br><span class="line">git checkout &lt;file&gt;   <span class="comment"># 撤销文件修改</span></span><br><span class="line">git reset --hard      <span class="comment"># 效果与 checkout 一样</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 撤销 git add 操作 (不修改文件本身)</span></span><br><span class="line">git reset HEAD</span><br></pre></td></tr></table></figure>
<h1 id="踩坑">踩坑</h1>
<h2 id="git-bash-中文乱码">Git Bash 中文乱码</h2>
<p>例如对于 <code>git status</code> 指令, 中文文件 &quot;新建文本文档.txt&quot; 会被显示为 <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">\<span class="number">346</span>\<span class="number">226</span>\<span class="number">260</span>\<span class="number">345</span>\<span class="number">273</span>\<span class="number">272</span>\<span class="number">346</span>\<span class="number">226</span>\<span class="number">207</span>\<span class="number">346</span>\<span class="number">234</span>\<span class="number">254</span>\<span class="number">346</span>\<span class="number">226</span>\<span class="number">207</span>\<span class="number">346</span>\<span class="number">241</span>\<span class="number">243.</span>txt</span><br></pre></td></tr></table></figure></p>
<p>解决方法如下:</p>
<p><img src="/posts/10606/3.png"></p>
<p>然后</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 解决 Windows Git Bash、Linux 下的中文转码问题</span></span><br><span class="line">git config --global core.quotepath <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<h2 id="powershell-中文乱码">Powershell 中文乱码</h2>
<p>例如对于 <code>git log</code> 指令, 中文的 Commit Message 会被显示为: <figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="section">&lt;E8&gt;</span><span class="section">&lt;BF&gt;</span><span class="section">&lt;87&gt;</span><span class="section">&lt;E6&gt;</span><span class="section">&lt;BB&gt;</span><span class="section">&lt;A4&gt;</span><span class="section">&lt;E5&gt;</span><span class="section">&lt;8A&gt;</span><span class="section">&lt;9F&gt;</span><span class="section">&lt;E8&gt;</span><span class="section">&lt;83&gt;</span><span class="section">&lt;BD&gt;</span><span class="section">&lt;E5&gt;</span><span class="section">&lt;9F&gt;</span><span class="section">&lt;BA&gt;</span><span class="section">&lt;E6&gt;</span><span class="section">&lt;9C&gt;</span><span class="section">&lt;AC&gt;</span><span class="section">&lt;E5&gt;</span><span class="section">&lt;AE&gt;</span><span class="section">&lt;8C&gt;</span><span class="section">&lt;E6&gt;</span><span class="section">&lt;88&gt;</span><span class="section">&lt;90&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>解决方法如下, 在 Powershell 输入:</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">git config --global core.quotepath false</span><br><span class="line">git config --global gui.encoding utf-<span class="number">8</span></span><br><span class="line">git config --global i18n.commit.encoding utf-<span class="number">8</span></span><br><span class="line">git config --global i18n.logoutputencoding utf-<span class="number">8</span></span><br><span class="line"><span class="variable">$env:LESSCHARSET</span>=<span class="string">'utf-8'</span>      <span class="comment">#该行可以不输入, 但可能之后要重启 Powershell</span></span><br></pre></td></tr></table></figure>
<p>然后设置系统环境变量, 设置 <code>LESSCHARSET</code> 为 <code>utf-8</code>.</p>
<p><img src="/posts/10606/4.png"></p>
<h2 id="git-bash-命令提示符的-总是另起一行">Git Bash 命令提示符的 <code>$</code> 总是另起一行</h2>
<p>命令前的那一串叫 &quot;系统终端命令提示符 (Prompt Sign)&quot; (就是那一串包含用户名, 工作目录和 <code>$</code> 符号的东西). Windows 下的 Git Bash 的命令提示符的 <code>$</code> 总是另起一行.</p>
<p><img src="/posts/10606/1.png"></p>
<p>这玩意由 <code>$PS1</code> 控制. 输入 <code>echo &quot;$PS1&quot;</code>, 可得:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 我的PS1被 conda 修改过, 所以前面有个 "(base)"</span></span><br><span class="line">(base)</span><br><span class="line">xie@DESKTOP-BAD47V8 MINGW64 ~</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"<span class="variable">$PS1</span>"</span></span><br><span class="line">(base) \[\033]0;<span class="variable">$TITLEPREFIX</span>:<span class="variable">$PWD</span>\007\]\n\[\033[32m\]\u@\h \[\033[35m\]<span class="variable">$MSYSTEM</span> \[\033[33m\]\w\[\033[36m\]`__git_ps1`\[\033[0m\]\n$</span><br></pre></td></tr></table></figure>
<p>修改它就能修改提示符样式.</p>
<p>而 Ubuntu 下的 <code>$PS1</code> 为:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">xie@xie-vm:~$ <span class="built_in">echo</span> <span class="string">"<span class="variable">$PS1</span>"</span></span><br><span class="line">\[\e]0;\u@\h: \w\a\]<span class="variable">$&#123;debian_chroot:+($debian_chroot)&#125;</span>\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$</span><br></pre></td></tr></table></figure>
<p>那么依葫芦画瓢改一改. 用 vim 或 code (vscode) 命令打开 <code>~/.bash_profile</code>, 添加一行:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> PS1=<span class="string">"\[\e]0;\u@\h: \w\a\]<span class="variable">$&#123;debian_chroot:+($debian_chroot)&#125;</span>\[\033[32m\]\u@\h\[\033[00m\]:\[\033[33m\]\w\[\033[00m\]\$ "</span></span><br></pre></td></tr></table></figure>
<p>保存重启 Git Bash即可.</p>
<p><img src="/posts/10606/2.png"></p>
<h2 id="使用-ssh-执行-git-clone-报错">使用 ssh 执行 <code>git clone</code> 报错</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> git@github.com:xxx/xxx.git</span><br><span class="line">Cloning into <span class="string">'xxx'</span>...</span><br><span class="line">git@github.com: Permission denied (publickey).</span><br><span class="line">fatal: Could not <span class="built_in">read</span> from remote repository.</span><br><span class="line"></span><br><span class="line">Please make sure you have the correct access rights</span><br><span class="line">and the repository exists.</span><br></pre></td></tr></table></figure>
<p>此时如果测试连接, 却显示正常:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ssh -T git@github.com</span><br><span class="line">Hi XieNaoban! You<span class="string">'ve successfully authenticated, but GitHub does not provide shell access.</span></span><br></pre></td></tr></table></figure>
<p>网上的解决方案大多是说 ssh 配置出了问题. 但我这里不是这个原因. 原因是勾选了 <code>https://github.com/settings/emails</code> -&gt; <code>Keep my email addresses private</code>, 好像是我的隐私邮箱被系统更换了, 所以就挂了. 解决方案同下面的 <a href="#push-err"><code>Push 时报错 push declined due to email privacy restrictions</code></a></p>
<h2 id="push-时报错-push-declined-due-to-email-privacy-restrictions">Push 时报错 <code>push declined due to email privacy restrictions</code> <a id="push-err"></a></h2>
<p>从某天开始突然不能 push 了, 错误信息:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">! [remote rejected] master -&gt; master (push declined due to email privacy restrictions)</span><br></pre></td></tr></table></figure>
<p>原因是勾选了 <code>https://github.com/settings/emails</code> -&gt; <code>Keep my email addresses private</code>, 可能是因为它重置了隐私邮箱吧.</p>
<p>复制 <code>Keep my email addresses private</code> 下给的邮箱 (数字+名字@users.noreply.github.com),</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.email 12345678+XieNaoban@users.noreply.github.com</span><br><span class="line">git commit --amend --reset-author <span class="comment"># 会打开文本编辑器, 直接关闭即可</span></span><br></pre></td></tr></table></figure>
<p>就好了.</p>
<h2 id="windows-下-clone-的文件以-lf-为换行符而非-crlf">Windows 下 Clone 的文件以 LF 为换行符而非 CRLF</h2>
<p>设置:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global core.autocrlf input <span class="comment"># 提交时转换为 LF, 签出时不转换</span></span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">git config --global core.autocrlf <span class="literal">false</span> <span class="comment"># 提交签出均不转换</span></span><br></pre></td></tr></table></figure>
<p>以下载 LF 的版本. 折腾完了改回去 (毕竟 Win 下还是默认开着好):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global core.autocrlf <span class="literal">true</span> <span class="comment"># 提交时转换为 LF, 签出时转换为 CRLF</span></span><br></pre></td></tr></table></figure>
<p>解决方案: 直接干脆把文件统一成 LF, 不要转来转去了, 反正在 Win 下用 LF 大多数软件也支持.</p>
<h2 id="win-下-warning-lf-will-be-replaced-by-crlf">Win 下 <code>warning: LF will be replaced by CRLF</code></h2>
<p>Windows 以 CRLF 为换行符, Linux 以 LF 为换行符, Git 仓库以 LF 为换行符. 从 Win 上 <code>git clone</code> 时, Git 会自动把仓库里所有的文件从 LF 转为 CRLF. 当提交时, 又会把 CRLF 转回 LF. 如果提交文件是纯 LF 文件, 会显示一个警告: <code>warning: LF will be replaced by CRLF in xxx.</code>.</p>
<p>直接关了这个 warning:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global core.safecrlf <span class="literal">false</span> <span class="comment"># 默认是 'warn'</span></span><br></pre></td></tr></table></figure>
<h2 id="git-reset-与-git-revert-区别"><code>git reset</code> 与 <code>git revert</code> 区别</h2>
<p><code>git reset</code> 回滚到某 commit, 后面的 commmit 都抛弃了. 而 <code>git revert</code> 创建一个新 commit, 中和之前的提交.</p>
<p>用 <code>git reset</code> 后 <code>git push</code> 会报错, 提示你当前本地版本落后于远程版本. 需要强制推送 (<code>git push -f</code>).</p>
<h2 id="保留空文件夹">保留空文件夹</h2>
<p>在提交时, 空文件夹 (或者文件夹内所有文件均被gitignore忽略) 不会被提交, 所以 <code>git clone</code> 时将没有那个文件夹. 如果希望提交时保留空文件夹, 可以在该文件夹下新建一个空白文件, 并取名 <code>.gitkeep</code>... 原理也很简单, 有了这个文件, 该文件夹就不是空的了... 所以其实取什么名字都行, 只不过 <code>.gitkeep</code> 比较约定俗成, 比如 IntelliJ 的文件目录视图貌似会自动忽略这个文件.</p>
<h2 id="删除历史中的所有大文件">删除历史中的所有大文件</h2>
<p>年少无知的我没写 <code>.gitignore</code>, 把一堆巨大的 json 文件一并 add 到了历史里, 期间这些 json 还改动过好几次, 于是乎我的 <code>.git</code> 文件夹就理所当然地膨胀到了 100MB... 现在我很后悔, 发现这些 json 从一开始就不应该 add, 于是想把它们统统从历史中删除.</p>
<p>参考了不少博客, Github 官方也有文档: <a href="https://help.github.com/en/github/authenticating-to-github/removing-sensitive-data-from-a-repository" target="_blank" rel="noopener">Removing sensitive data from a repository - GitHub Help</a>.</p>
<p>先看一下Git历史数据占地面积:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git count-objects -v</span><br></pre></td></tr></table></figure>
<p>得到:</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">count: <span class="number">119</span></span><br><span class="line">size: <span class="number">43363</span></span><br><span class="line"><span class="keyword">in</span>-pack: <span class="number">999</span></span><br><span class="line">packs: <span class="number">1</span></span><br><span class="line">size-pack: <span class="number">30787</span></span><br><span class="line">prune-packable: <span class="number">0</span></span><br><span class="line">garbage: <span class="number">0</span></span><br><span class="line">size-garbage: <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>然后找出所有大文件, 用的大佬写好的 bash 脚本 (<a href="https://github.com/appke/geekBigData/blob/master/findBigFile.sh" target="_blank" rel="noopener">findBigFile.sh</a>):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#set -x </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Shows you the largest objects in your repo's pack file.</span></span><br><span class="line"><span class="comment"># Written for osx.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># @see http://stubbisms.wordpress.com/2009/07/10/git-script-to-show-largest-pack-objects-and-trim-your-waist-line/</span></span><br><span class="line"><span class="comment"># @author Antony Stubbs</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># set the internal field spereator to line break, so that we can iterate easily over the verify-pack output</span></span><br><span class="line">IFS=$<span class="string">'\n'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># list all objects including their size, sort by size, take top 10</span></span><br><span class="line">objects=`git verify-pack -v .git/objects/pack/pack-*.idx | grep -v chain | sort -k3nr | head`</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"All sizes are in kB. The pack column is the size of the object, compressed, inside the pack file."</span></span><br><span class="line"></span><br><span class="line">output=<span class="string">"size,pack,SHA,location"</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="variable">$objects</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="comment"># extract the size in bytes</span></span><br><span class="line">	size=$((`<span class="built_in">echo</span> <span class="variable">$y</span> | cut -f 5 -d <span class="string">' '</span>`/1024))</span><br><span class="line">	<span class="comment"># extract the compressed size in bytes</span></span><br><span class="line">	compressedSize=$((`<span class="built_in">echo</span> <span class="variable">$y</span> | cut -f 6 -d <span class="string">' '</span>`/1024))</span><br><span class="line">	<span class="comment"># extract the SHA</span></span><br><span class="line">	sha=`<span class="built_in">echo</span> <span class="variable">$y</span> | cut -f 1 -d <span class="string">' '</span>`</span><br><span class="line">	<span class="comment"># find the objects location in the repository tree</span></span><br><span class="line">	other=`git rev-list --all --objects | grep <span class="variable">$sha</span>`</span><br><span class="line">	<span class="comment">#lineBreak=`echo -e "\n"`</span></span><br><span class="line">	output=<span class="string">"<span class="variable">$&#123;output&#125;</span>\n<span class="variable">$&#123;size&#125;</span>,<span class="variable">$&#123;compressedSize&#125;</span>,<span class="variable">$&#123;other&#125;</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="variable">$output</span> | column -t -s <span class="string">', '</span></span><br></pre></td></tr></table></figure>
<p>脚本运行结果大致如下: <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">size   pack  SHA                                       location</span><br><span class="line"><span class="number">60832</span>  <span class="number">2900</span>  a8b382af350184d5ead001b1e91c66cea62c54b7  path/to/your/file1</span><br><span class="line"><span class="number">33288</span>  <span class="number">4034</span>  e7bba187e68f752e88664c49b95e5ba18e022dca  path/to/your/file2</span><br><span class="line"><span class="number">13804</span>  <span class="number">572</span>   c0c7383de6e9b28e97822a896199b11174ade578  path/to/your/file3</span><br><span class="line"><span class="number">13751</span>  <span class="number">571</span>   <span class="number">2609</span>b4429eb13a2a9885a27073b608e8bdecb3d0  path/to/your/file4</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>默认展示 10 条, 如果想要展示 233 条更多只要把脚本里的 <code>head</code> 改为 <code>head -233</code> 即可. 核心就是 <code>objects</code> 那句, 大佬注释写的挺完整, 在此不解释了.</p>
<p>然后就是最核心的删除语句:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git filter-branch --force --index-filter <span class="string">"git rm --cached --ignore-unmatch path/to/your/file"</span> --prune-empty --tag-name-filter cat -- --all</span><br></pre></td></tr></table></figure>
<p>这行指令原理应该是遍历你的所有 commit, 如果该 commit 有这个目录有这个文件, 就删除. 运行结果如下 (运行速度挺慢的):</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">WARNING: git-<span class="built_in">filter</span>-branch has <span class="keyword">a</span> glut <span class="keyword">of</span> gotchas generating mangled history</span><br><span class="line">         rewrites.  Hit Ctrl-C <span class="keyword">before</span> proceeding <span class="built_in">to</span> abort, <span class="keyword">then</span> use <span class="keyword">an</span></span><br><span class="line">         alternative filtering tool such <span class="keyword">as</span> <span class="string">'git filter-repo'</span></span><br><span class="line">         (<span class="keyword">https</span>://github.com/newren/git-<span class="built_in">filter</span>-repo/) instead.  See <span class="keyword">the</span></span><br><span class="line">         <span class="built_in">filter</span>-branch manual page <span class="keyword">for</span> more details; <span class="built_in">to</span> squelch this warning,</span><br><span class="line">         <span class="built_in">set</span> FILTER_BRANCH_SQUELCH_WARNING=<span class="number">1.</span></span><br><span class="line">Proceeding <span class="keyword">with</span> <span class="built_in">filter</span>-branch...</span><br><span class="line"></span><br><span class="line">Rewrite a361c1d183b59a5df22bc2b7d38eeadf45255675 (<span class="number">73</span>/<span class="number">78</span>) (<span class="number">44</span> <span class="built_in">seconds</span> passed, remaining <span class="number">3</span> predicted)    rm <span class="string">'path/to/your/file'</span></span><br><span class="line">Rewrite <span class="number">434e4</span>dd7e434e2516dabf8987ab26ce0c45d2dc5 (<span class="number">75</span>/<span class="number">78</span>) (<span class="number">45</span> <span class="built_in">seconds</span> passed, remaining <span class="number">1</span> predicted)    rm <span class="string">'path/to/your/file'</span></span><br><span class="line">Rewrite <span class="number">50</span>ce64408ebf9f9e96d2aa407c8f5b752460b66a (<span class="number">75</span>/<span class="number">78</span>) (<span class="number">45</span> <span class="built_in">seconds</span> passed, remaining <span class="number">1</span> predicted)    rm <span class="string">'path/to/your/file'</span></span><br><span class="line">Rewrite <span class="number">820</span>ae95f38eac7e60eeeae40fe6d624c1c61a05a (<span class="number">77</span>/<span class="number">78</span>) (<span class="number">47</span> <span class="built_in">seconds</span> passed, remaining <span class="number">0</span> predicted)    rm <span class="string">'path/to/your/file'</span></span><br><span class="line">Rewrite <span class="number">1e2781</span>e656495a06e325641e59eed36fd0df1f40 (<span class="number">77</span>/<span class="number">78</span>) (<span class="number">47</span> <span class="built_in">seconds</span> passed, remaining <span class="number">0</span> predicted)</span><br><span class="line"></span><br><span class="line">Ref <span class="string">'refs/heads/master'</span> was rewritten</span><br><span class="line">Ref <span class="string">'refs/remotes/origin/master'</span> was rewritten</span><br><span class="line">WARNING: Ref <span class="string">'refs/remotes/origin/WS'</span> is unchanged</span><br><span class="line">WARNING: Ref <span class="string">'refs/remotes/origin/master'</span> is unchanged</span><br><span class="line">Ref <span class="string">'refs/remotes/origin/xie'</span> was rewritten</span><br></pre></td></tr></table></figure>
<p>然后强制 push:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git push origin --force --all</span><br></pre></td></tr></table></figure>
<p>有些教程到这就结束了, 有些还有后续 (清理、压缩 <code>.git</code> 等), 后续各不相同, 我综合整理了个自己的版本:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm -rf .git/refs/original/</span><br><span class="line"><span class="comment"># 虽然物理上文件被删了, 但逻辑上可能还有没更新的引用, 删了以下的文件让 git 重新生成</span></span><br><span class="line"></span><br><span class="line">git reflog expire --expire=now --all</span><br><span class="line"><span class="comment"># 管理所有的 reflog 信息, expire 表示修剪旧的 reflog 条目.</span></span><br><span class="line"><span class="comment"># --expire=now 表示修剪早于当前时间的条目;</span></span><br><span class="line"><span class="comment"># --all 表示处理所有引用的 reflog.</span></span><br><span class="line"><span class="comment"># 刚刚删掉的内容貌似就是在此重新生成 (应该吧).</span></span><br><span class="line"></span><br><span class="line">git fsck --full --unreachable</span><br><span class="line"><span class="comment"># 验证数据库中对象的连接性和有效性.</span></span><br><span class="line"><span class="comment"># --full 啥都检查;</span></span><br><span class="line"><span class="comment"># --unreachable 如果有节点存在但不可达, 则输出.</span></span><br><span class="line"><span class="comment"># 这条指令貌似只是检测, 不修改什么东西.</span></span><br><span class="line"></span><br><span class="line">git repack -A -d</span><br><span class="line"><span class="comment"># 把没打包的对象打包并删除冗余对象.</span></span><br><span class="line"><span class="comment"># -A 把引用的所有内容打到一个包里, -a 和 -A 好像是一个意思;</span></span><br><span class="line"><span class="comment"># -d 删除冗余包.</span></span><br><span class="line"></span><br><span class="line">git gc --aggressive --prune=now</span><br><span class="line"><span class="comment"># 清理不必要的文件, 优化本地存储.</span></span><br><span class="line"><span class="comment"># --aggressive 更好地优化存储, 但会花费更多时间;</span></span><br><span class="line"><span class="comment"># --prune=now 修剪比当前时间更早的松散物体</span></span><br></pre></td></tr></table></figure>
<p>其中 <code>git repack -A -d</code> 和 <code>git gc --aggressive --prune=now</code> 输出的 log 几乎一样, 可能只执行其中一个就行？</p>
<p>整理了个自动删除大文件的脚本 (事先找好要删的文件放在 <code>rm_list</code> 里):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">rm_list=(<span class="string">'path/file1'</span>, <span class="string">'path/file2'</span>, <span class="string">'path/file3'</span>)</span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> <span class="variable">$&#123;rm_list[@]&#125;</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">'---'</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"removing '<span class="variable">$&#123;f&#125;</span>'..."</span></span><br><span class="line">	git filter-branch --force --index-filter <span class="string">"git rm --cached --ignore-unmatch <span class="variable">$&#123;f&#125;</span>"</span> --prune-empty --tag-name-filter cat -- --all</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># clean up and reclaim space</span></span><br><span class="line">rm -rf .git/refs/original/</span><br><span class="line">git reflog expire --expire=now --all</span><br><span class="line">git fsck --full --unreachable</span><br><span class="line">git repack -A -d</span><br><span class="line">git gc --aggressive --prune=now</span><br><span class="line"></span><br><span class="line"><span class="comment"># force-push changes to overwrite remote repository</span></span><br><span class="line">git push origin --force --all</span><br></pre></td></tr></table></figure>
<p>删了 30 多个 json, 最后把 100MB 的 <code>.git</code> 清理到了 10MB (捂脸). 删除过程贼慢, 最后 push 时 &quot;Writing objects&quot; 也贼慢.</p>
<h2 id="gitignore-对已-track-文件不起作用"><code>.gitignore</code> 对已 track 文件不起作用</h2>
<p>当一个文件已经被 commit 后才被发现这个文件是应该 ignore 的, 此时再把它添加入 <code>.gitignore</code> 的话, git 依然会追踪它. 修改该文件, 然后你会发现 git 仍然记录了这个文件的修改. 原因是 <code>.gitignore</code> 仅对新文件生效, 已被 track 的文件不受影响. 解决方法:</p>
<ol type="1">
<li>强制清除对所有文件的追踪 (只清除不想追踪的文件应该也行, 没试) <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git rm -r -f --cache .</span><br></pre></td></tr></table></figure></li>
<li>更新你的 .gitignore (或者在上述指令之前更新也没关系)</li>
<li>重新 <code>add</code>、<code>commit</code>.</li>
</ol>
<h2 id="给-git-ssh-上-socks5-代理">给 Git SSH 上 Socks5 代理</h2>
<p>如果是使用 http/https 给 git 上代理, 那方法很多, 比如给终端上代理或者直接给 git 设置代理:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global http.proxy socks5://127.0.0.1:10808</span><br><span class="line">git config --global https.proxy socks5://127.0.0.1:10808</span><br><span class="line">使用完后:</span><br><span class="line">git config --global --<span class="built_in">unset</span> http.proxy</span><br><span class="line">git config --global --<span class="built_in">unset</span> https.proxy</span><br></pre></td></tr></table></figure>
<p>但是我现在想用 ssh 进行 git clone (<code>git clone git@github.com:xxx/xxx.git</code>), 针对 http/https 的代理对 ssh 是无效的. 所以要通过配置 ssh 自身来实现代理.</p>
<p>方法是打开 <code>~/.ssh/config</code> (Win下就是 <code>个人文件夹\.ssh\config</code>), 如果没有就新建这个文件.</p>
<p>然后写入一行代理指令, Win 和 Linux 指令不同:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Linux (如果无 nc 请先安装. 但是 Win 下压根没有 nc)</span><br><span class="line"># -X: 指定协议, 5 就是 Socks5 (不写该参数默认也是 Socks5); -x 指定 address:port</span><br><span class="line">ProxyCommand nc -X 5 -x 127.0.0.1:10808 %h %p</span><br><span class="line"></span><br><span class="line"># Win (使用 Git 在 Win 下自己实现的工具)</span><br><span class="line">ProxyCommand &quot;C:\Program Files\Git\mingw64\bin\connect.exe&quot; -S 127.0.0.1:10808 %h %p</span><br></pre></td></tr></table></figure>
<p>以上指令效果是全局的, 局部的稍微麻烦一点, 要在指令里指定主机和用户, 懒得弄了.</p>
<p>当然, 直接在控制台像这样设置也行:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -o 即 option 的意思</span></span><br><span class="line"><span class="comment"># 格式有两种, 语法略有不同而已, 本质一样的</span></span><br><span class="line">ssh -o ProxyCommand=<span class="string">"nc -X 5 -x 127.0.0.1:10808 %h %p"</span></span><br><span class="line">ssh -o <span class="string">"ProxyCommand nc -X 5 -x 127.0.0.1:10808 %h %p"</span></span><br><span class="line"><span class="comment"># 以上是 Linux 的指令, Win 还是改成上面对应的指令</span></span><br></pre></td></tr></table></figure>
<p>不过我对ssh 不太熟, 也没去试, 暂不知道 <code>-o</code> 是永久的还是仅限当前会话.</p>
]]></content>
      <tags>
        <tag>Windows</tag>
        <tag>快乐背指令</tag>
        <tag>Linux</tag>
        <tag>Git</tag>
        <tag>Git Bash</tag>
      </tags>
  </entry>
  <entry>
    <title>Anaconda 安装使用</title>
    <url>/posts/39659.html</url>
    <content><![CDATA[<blockquote>
<p>操作系统: Windows 10</p>
</blockquote>
<h1 id="安装">安装</h1>
<p>我选的全局安装 (装在了D盘. 全局安装不要装C盘, 以后会各种需要权限) 而不是为用户安装 (会被装在C:\Users\name\Anaconda3), 要管理员权限. 安装会自动在 &quot;系统变量&quot; 添加Path:</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line"><span class="function">D:\<span class="title">Anaconda3</span></span></span><br><span class="line"><span class="function"><span class="title">D</span>:\<span class="title">Anaconda3</span>\<span class="title">Library</span>\<span class="title">mingw</span>-<span class="title">w64</span>\<span class="title">bin</span></span></span><br><span class="line"><span class="function"><span class="title">D</span>:\<span class="title">Anaconda3</span>\<span class="title">Library</span>\<span class="title">usr</span>\<span class="title">bin</span></span></span><br><span class="line"><span class="function"><span class="title">D</span>:\<span class="title">Anaconda3</span>\<span class="title">Library</span>\<span class="title">bin</span></span></span><br><span class="line"><span class="function"><span class="title">D</span>:\<span class="title">Anaconda3</span>\<span class="title">Scripts</span></span></span><br></pre></td></tr></table></figure>
<p>下次重装系统了把 Path 添加回去兴许还能用.</p>
<h1 id="选择镜像">选择镜像</h1>
<p>选择<a href="https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/" target="_blank" rel="noopener">清华的镜像</a>以加速下载.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls yes</span><br></pre></td></tr></table></figure>
<h1 id="环境搭建">环境搭建</h1>
<ol type="1">
<li>创建/删除环境</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 指定 Python 版本创建 "py37" 环境</span></span><br><span class="line">conda create -n py37 python=3.7.3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列举创建的环境</span></span><br><span class="line">conda env list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除指定环境</span></span><br><span class="line">conda remove -n py35 –all</span><br></pre></td></tr></table></figure>
<ol start="2" type="1">
<li>进出环境</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Linux</span></span><br><span class="line"><span class="built_in">source</span> activate py37</span><br><span class="line"><span class="built_in">source</span> deactivate</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows CMD</span></span><br><span class="line">activate py37</span><br><span class="line">deactivate</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows PowerShell</span></span><br><span class="line">运行 Anaconda3 目录下的 envs\py37\Lib\venv\scripts\nt\Activate.ps1</span><br><span class="line">或先安装这个: conda install -n root -c pscondaenvs pscondaenvs,</span><br><span class="line">    然后也能用 activate py37</span><br><span class="line">    有点复杂, 不管了</span><br><span class="line"></span><br><span class="line"><span class="comment"># Git Bash</span></span><br><span class="line"><span class="built_in">source</span> activate py37</span><br><span class="line"><span class="built_in">source</span> deactivate</span><br></pre></td></tr></table></figure>
<p><strong>更新:</strong> 上述指令官方已经不推荐了, 推荐下面的.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 将 conda 更新到 4.7.5 后, </span></span><br><span class="line"><span class="comment"># 下列指令在各个终端均通用</span></span><br><span class="line">conda activate py37</span><br><span class="line">conda deactivate</span><br></pre></td></tr></table></figure>
<ol start="3" type="1">
<li>包的安装与管理</li>
</ol>
<p>安装时会自动安装依赖包, 强无敌.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">conda search numpy*                         <span class="comment"># 搜索 "numpy" 打头的包</span></span><br><span class="line">conda install numpy                         <span class="comment"># 安装 numpy 在当前环境</span></span><br><span class="line">conda install -n py37 numpy                 <span class="comment"># "-n py37" 以指定环境</span></span><br><span class="line">conda install -n py37 numpy=1.10            <span class="comment"># 指定 numpy 安装版本</span></span><br><span class="line">conda install -n py37 numpy scipy pandas    <span class="comment"># 支持同时安装多个包</span></span><br><span class="line">conda update -n py37 numpy                  <span class="comment"># 更新包</span></span><br><span class="line">conda remove -n py37 numpy                  <span class="comment"># 删除包</span></span><br><span class="line">conda list -n py37                          <span class="comment"># 查看安装的包</span></span><br></pre></td></tr></table></figure>
<h1 id="踩坑">踩坑</h1>
<h2 id="git-bash-windows-输入-source-activate-py37-时报错-commandnotfounderror-no-command-conda-conda.">Git Bash (Windows) 输入 <code>source activate py37</code> 时报错: CommandNotFoundError: No command 'conda conda'.</h2>
<p>原因是版本太高. 我的是 <code>4.6.11</code>. 搞个低版本即可.</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">conda install conda=<span class="number">4.6</span><span class="number">.8</span></span><br></pre></td></tr></table></figure>
<p>或者使用如下替换指令 (高版本里移除了 <code>source activate</code>) 指令.</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">conda <span class="built_in">activate</span> py37</span><br><span class="line">conda <span class="built_in">deactivate</span>      # 该指令还是报错 <span class="string">"CommandNotFoundError: No command 'conda conda'."</span> 还是等新版本把吧</span><br></pre></td></tr></table></figure>
<p><strong>更新:</strong> 把 conda 更新到了 <code>4.7.5</code>, 没问题了. <code>conda activate</code> 和 <code>source activate</code> 均可, 只不过后者不再被推荐.</p>
<h2 id="在-powershell-cmd-git-bash-均使用-conda-activate-指令">在 PowerShell / CMD / Git Bash 均使用 <code>conda activate</code> 指令</h2>
<p>在将 conda 更新到 <code>4.7.5</code> 之后, 发现其支持 PowerShell 了, 且 CMD 也支持 <code>conda activate</code> 了.</p>
<p>不过需要事先初始化一下. 在 Git Bash, PowerShell 分别输入一次</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">conda init</span><br></pre></td></tr></table></figure>
<p>然后重启该终端, 就能使用 <code>conda activate</code> 或 <code>source activate</code> 了.</p>
<h2 id="每次打开-terminal-都会自动进入-base-环境">每次打开 Terminal 都会自动进入 base 环境</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">conda config --<span class="built_in">set</span> auto_activate_base <span class="literal">false</span></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>Anaconda</tag>
        <tag>Windows</tag>
        <tag>日常配环境</tag>
        <tag>快乐背指令</tag>
      </tags>
  </entry>
  <entry>
    <title>qBittorrent 添加 Tracker 以提速</title>
    <url>/posts/42107.html</url>
    <content><![CDATA[<p><a href="https://www.zhihu.com/question/322253369/answer/686112121" target="_blank" rel="noopener">知乎uTorrent、qBittorrent、Transmission、Deluge全教程</a></p>
<p><a href="https://www.icoa.cn/a/869.html" target="_blank" rel="noopener">qBittorrent 添加自定义 Tracker 的方法</a></p>
<ol type="1">
<li></li>
</ol>
<p>qBittorrent -&gt; 工具 -&gt; 选项 -&gt; BitTorrent, 拉到最下面:</p>
<p><img src="/posts/42107/1.png"></p>
<p>勾选 &quot;自动添加以下 trackers 到新的 torrents:&quot; 并填入如下内容 (来源: https://dns.icoa.cn/tracker/).</p>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line"><span class="symbol">udp:</span><span class="comment">//tracker.tiny-vps.com:6969/announce</span></span><br><span class="line"><span class="symbol">https:</span><span class="comment">//1337.abcvg.info/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//tracker.torrent.eu.org:451/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//tracker4.itzmx.com:2710/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//tracker.corpscorp.online:80/announce</span></span><br><span class="line"><span class="symbol">https:</span><span class="comment">//tracker.fastdownload.xyz:443/announce</span></span><br><span class="line"><span class="symbol">https:</span><span class="comment">//opentracker.xyz:443/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//open.trackerlist.xyz:80/announce</span></span><br><span class="line"><span class="symbol">https:</span><span class="comment">//t.quic.ws:443/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//open.demonii.si:1337/announce</span></span><br><span class="line"><span class="symbol">https:</span><span class="comment">//tracker.gbitt.info:443/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//retracker.lanta-net.ru:2710/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//vps02.net.orel.ru:80/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//tracker.filemail.com:6969/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//tracker2.dler.org:80/announce</span></span><br><span class="line"><span class="symbol">https:</span><span class="comment">//1337.abcvg.info:443/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//explodie.org:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//tracker.internetwarriors.net:1337/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//denis.stalker.upeer.me:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//exodus.desync.com:6969/announce</span></span><br><span class="line"><span class="symbol">https:</span><span class="comment">//tracker.vectahosting.eu:2053/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//tracker.leechers-paradise.org:6969/announce</span></span><br><span class="line"><span class="symbol">https:</span><span class="comment">//tracker.parrotsec.org:443/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//tracker.supertracker.net:1337/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//gwp2-v19.rinet.ru:80/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//carapax.net:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//retracker.maxnet.ua:80/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//tracker.files.fm:6969/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//retracker.joxnet.ru:80/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//tracker.moxing.party:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//bt.xxx-tracker.com:2710/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//zephir.monocul.us:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//tracker.iamhansen.xyz:2000/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//opentracker.h4ck.me:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//torrentclub.tech:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//retracker.netbynet.ru:2710/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//web4.obit.ru:80/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//retracker.baikal-telecom.net:2710/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//bt1.xxxxbt.cc:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//tracker.uw0.xyz:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//thetracker.org:80/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//tracker.filepit.to:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//retracker.akado-ural.ru:80/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//t.nyaatracker.com:80/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//tracker.dyn.im:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//tracker.openbittorrent.com:80/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//tracker.cyberia.is:6969/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//tracker3.itzmx.com:6961/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//ipv4.tracker.harry.lu:80/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//188.241.58.209:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//208.83.20.20:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//185.225.17.100:1337/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//93.158.213.92:1337/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//93.158.213.92:1337/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//176.113.71.19:6961/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//5.2.79.219:1337/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//91.216.110.52:451/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//95.211.168.204:2710/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//5.206.58.23:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//159.100.245.181:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//176.31.241.153:80/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//5.2.79.22:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//188.246.227.212:80/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//184.105.151.164:6969/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//184.105.151.164:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//207.246.121.172:2000/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//109.248.43.36:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//45.56.74.11:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//37.235.174.46:2710/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//194.143.148.21:2710/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//78.30.254.12:2710/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//190.146.242.80:7070/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//89.35.39.197:1337/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//52.58.128.163:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//212.1.226.176:2710/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//94.177.237.99:6969/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//86.62.124.78:80/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//185.83.215.123:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//199.247.2.19:6969/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//199.247.2.19:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//212.47.227.58:6969/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//95.107.48.115:80/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//91.207.136.85:80/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//37.187.123.8:2710/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//81.200.240.19:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//52.29.11.73:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//52.28.76.37:6969/announce</span></span><br><span class="line"><span class="symbol">udp:</span><span class="comment">//45.79.184.106:6969/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//193.148.69.107:80/announce</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//54.39.98.124:80/announce</span></span><br></pre></td></tr></table></figure>
<ol start="2" type="1">
<li></li>
</ol>
<p>qBittorrent -&gt; 工具 -&gt; 选项 -&gt; 高级:</p>
<p><img src="/posts/42107/2.png"></p>
<p>勾选 &quot;总是向同级的所有 Tracker 汇报&quot;.</p>
]]></content>
      <tags>
        <tag>Windows</tag>
        <tag>日常配环境</tag>
        <tag>qBittorrent</tag>
        <tag>Torrent</tag>
      </tags>
  </entry>
  <entry>
    <title>2019 复旦计算机专硕考研经验</title>
    <url>/posts/30183.html</url>
    <content><![CDATA[<h1 id="战果">战果</h1>
<p>本人双非科班, 初试排名大约为 70.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">政治</th>
<th style="text-align: center;">英语二</th>
<th style="text-align: center;">数学二</th>
<th style="text-align: center;">专业课 (960)</th>
<th style="text-align: center;">初试总分</th>
<th style="text-align: center;">复试总分</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">64</td>
<td style="text-align: center;">82</td>
<td style="text-align: center;">121</td>
<td style="text-align: center;">110</td>
<td style="text-align: center;">377</td>
<td style="text-align: center;">78.91</td>
</tr>
</tbody>
</table>
<h1 id="初试">初试</h1>
<h2 id="政治">政治</h2>
<p>我政治是从 10 月份开始复习 (预习)的. 政治完全没必要更早时间开始看, 一方面是因为每年政治考纲变化大, 所以往年教材参考意义不大, 另一方面 2 至 3 个月确实足以应付政治.</p>
<h3 id="一轮预习-10-月初-11-月初">一轮预习: 10 月初 ~ 11 月初</h3>
<p><strong>使用材料:</strong> <strong>徐涛强化视频 + 肖秀荣精讲精练 + 肖秀荣1000题</strong>.</p>
<p><strong>时间分配:</strong> 每天花的时间其实不多, 看视频画重点还是挺轻松的, 就是做题耗时比较长, 但也不是每天都做题.</p>
<p>徐涛视频我直接看的强化视频 (2 倍速), 没看基础视频. 涛哥讲课确实很好. 听说腿姐的授课也不错, 用的人也很多, 自行选择. 但是肖秀荣团队的视频口碑反而好像很差...</p>
<p>徐涛视频本来是有一本配套的&quot;核心考案&quot;的, 我也买了, 但当时感觉核心考案内容较少 (相对于精讲精练), 总担心漏知识点, 于是教材使用的精讲精练. 徐涛视频和精讲精练绝大部分还是对的上的, 就可能有时候顺序不太一样, 会浪费一些时间找知识点位置.</p>
<p>现在想想没必要 &quot;徐涛视频 + 肖秀荣精讲精练&quot; 的组合, 毕竟当视频与精讲精练不太匹配时, 自己要两方考证, 有点费时费力. 徐涛的核心考案虽然看着字少但也不至于出现漏知识点的低级错误, 所以我现在推荐 &quot;<strong>徐涛视频 + 徐涛核心考案</strong>&quot; 即可.</p>
<p>肖秀荣1000题我刷了两遍. 第一遍和授课同步, 看一章做一章. 这玩意做起来错一半轻轻松松... 第二遍等看完一遍教材再复习一遍, 还是错一堆, 经常也要错三分之一.</p>
<p>一轮复习不涉及主观题, 做题也都是做客观题.</p>
<h3 id="二轮复习-11-月中旬-考试">二轮复习: 11 月中旬 ~ 考试</h3>
<p><strong>使用材料:</strong> <strong>肖八 + 肖四</strong>.</p>
<p><strong>时间分配:</strong> 客观题每天一套, 耗时不长. 背肖四主观题还是很耗时的, 最后几天一下午 + 一晚上都在背政治.</p>
<p>一轮复习完肖八还没开售, 所以近半个月没看政治. 等肖八到了刷了两遍客观题, 主观题依然没去管. 肖八结束就等肖四发货, 期间没怎么看政治.</p>
<p>后来肖四到了, 这可是重中之重, 客观题必须全部理解, 主观题全部背诵. 我当时主观题背了一个星期. 事实证明今年政治主观题考了不少肖四原题.</p>
<p>期间我还尝试背过徐涛的小黄书. 小黄书名义上是 20 个背诵考点, 但每个考点里又有 3 到 5 个子问题, 每个子问题的答案又有好多好多行, 我背了 5 个考点 (也就是 20 来个子问题), 感觉要屎了, 遂怒弃之.</p>
<p>你肖爷爷还是你肖爷爷, 肖四在手, 六十不愁.</p>
<h2 id="英语">英语</h2>
<p>英语我自己对答案下来客观题可能只扣了 2 分左右, 说明主观题做的不好, 只拿了 24 分.</p>
<p>重点就在背单词和做真题上面, 以及作文最好准备一下. 英语我花的时间最少, 大头还是背单词.</p>
<p>没必要看名师视频, 没必要整辅导资料 (除了真题的解析和临时抱佛脚用的作文辅导书). 看过朱伟的恋恋有词 (视频 + 书), 效率不高. 何凯文我也关注过, 也买了他的长难句解析, 效率不高 (以及后来他人设好像还崩了???).</p>
<h3 id="前期-1-月底-5-月">前期: 1 月底 ~ 5 月</h3>
<p><strong>使用材料:</strong> <strong>扇贝单词</strong>.</p>
<p><strong>时间分配:</strong> 尽量每天 (也有好些天比较怠惰没背) 300 个单词, 40 ~ 70 分钟.</p>
<p>用的扇贝单词 APP, 有时间就背. 1 月底就开始背了, 从简单的单词书开始背, 最后上考研词汇. 到 5 月份基本上背完一遍. 然后就停了.</p>
<h3 id="中期-8-月">中期: 8 月</h3>
<p><strong>使用材料:</strong> <strong>英一真题</strong>.</p>
<p><strong>时间分配:</strong> 英一真题客观题每天一套, 做完为止. 除此之外这几个月没碰英语 (江苏考生的秘制自信).</p>
<p>然而英一真题做下来很不好, 每次都错一堆, 心态有点崩.</p>
<h3 id="后期-10-月-考试">后期: 10 月(?) ~ 考试</h3>
<p><strong>使用材料:</strong> <strong>扇贝单词 + 英二真题 + 一些作文辅导书 + 英语字帖</strong>.</p>
<p><strong>时间分配:</strong> 上午到图书馆 (8 点多) 放下书包就出去背单词, 300 个单词 40 ~ 120 分钟不等, 视单词书难度而定. 做真题的话一套一般一上午. 复习作文是在考前一个月还是半个月的事了, 多花点时间整理整理一些骚句子, 练练真题的作文.</p>
<p>背单词还是最重要!!! 我兴冲冲地做了三天英二真题, 发现我这破词汇量是真的不行. 之前背的单词都忘光咯, 赶紧捡起来继续背 (背单词真滴累). 然后真题搁置了半个月再做.</p>
<p>考前半个月还是一个月开始捣鼓捣鼓作文, 学习学习满分范文 (学不会的), 从几本作文辅导书上找找好的句子摘抄下来, 在哪遇到好的句式或词组就记下来背背. 正所谓功夫不负有心人, 经过这半个月的努力写作文, 事实终于证明了<strong>像我这么考前抱佛脚并没有什么用</strong> (如果我客观题只扣 2 分属实, 那我 40 分的主观题只拿了 24 分). 所以作文还是<strong>积累在平时</strong>啊, 不要学我.</p>
<p>另外当自己开始练习写作文了, 才发现几年不写, 自己的字愈发丑陋了, 真写这一坨交上去不如交白卷得了, 于是买了本英语字帖不定期中午睡午觉前练练.</p>
<h2 id="数学">数学</h2>
<p>我做题很慢... 别人做卷子一个半小时就做完了, 我至少要两个半小时, 有时候三小时还做不完. 但是我做过的题正确率还是能保证的. 这次考研我就又炸了, 两道大题空着没来得及写... 另外我线代第一题我竟然忘了怎么写了... 复习时线代被轻视了, 教训惨痛.</p>
<p>另外关于&quot;跟汤家凤还是张宇&quot;, 我当时主要跟的汤家凤, 现在我还是推荐汤家凤. 网上常说:&quot;汤家凤讲的东西偏基础&quot;. 但汤的材料做下来, 我的感觉是, 那不叫&quot;汤家凤讲的基础&quot;, 而叫&quot;汤家凤讲的课基础扎实&quot;, 他的课不如张宇生动, 但是讲课稳稳当当. 以及, 1800做到后面其实并不基础 (和真题比还是拔高了不少的), 大家说他基础可能是和张宇比较的来的结论.</p>
<p>张宇讲的确实很深 (很难). 两位老师的教材我都买了 (本来想的是&quot;我全都看&quot;, 后来发现不仅来不及, 也没必要. 都是名师, 跟随一个老师走到底不会出岔子的), 但宇哥这些题可能有些太注重技巧性了, 而数二真题做下来我发现, 数二考的其实主要是计算 (数二的题计算量很大), 但没有什么题需要这么高技巧性去解. 这就导致宇哥和真题其实契合度不高 (上述主要对于数二, 数一可能确实比较难, 我没有发言权).</p>
<h3 id="一轮复习-5-月-9-月中旬">一轮复习: 5 月 ~ 9 月中旬</h3>
<p><strong>使用材料:</strong> <strong>高等数学教材 + 汤家凤基础视频 + 汤家凤辅导讲义 + 汤家凤1800 + 张宇强化视频 + 李永乐线代基础&amp;强化视频 + 李永乐线代讲义 + 李永乐复习全书</strong>.</p>
<p><strong>时间分配:</strong> 暑假之前比较水, 复习强度很低很低 (基本可以视作暑假开始复习). 暑假期间家旁边有图书馆, 9 点开门 5 点关门, 我每天也就这段时间学习, 中午图书馆旁边吃个饭再回图书馆睡个午觉, 晚上不怎么学. 暑假主要就数学和专业课, 我喜欢一天只学一门 (到后期才每门课每天复习复习), 所以专业课和数学差不多一天隔一天学.</p>
<p>貌似是在暑假前, 我把高数教材上下册过了一遍, 上面有一些定理的证明比如柯西中值定理的证明等等感觉还是要看看的. 过完一遍才发现大家不是很推荐刷教材, 网上说教材和考研差异还是比较大的.</p>
<p>汤家凤基础视频 (2 倍速) + 汤家凤辅导讲义 + 汤家凤1800 (的基础部分) 一起看. 7 月 20 多号结束. 看视频的时候记了笔记, 之后也经常会翻阅到, 挺有用的. 现在想来汤神的资料确实很好.</p>
<p>然后看线性代数. 线代看的永乐大帝线代基础视频 (2 倍速) + 李永乐线代讲义 (网友几乎一致推荐线代跟李永乐), 并做了汤家凤1800的线代基础部分. 大概花了一星期时间, 7 月 底看完. 我线代复习的不太好, 后期线代忘得特快.</p>
<p>然后我看的李永乐的全书, 两三天一章, 8 月 20 多号看完. 全书里对各种定义扣的很细, 很锻炼对所学知识的理解. 但我总感觉这本书里题目怪怪的... 尤其证明题那里的例题也太难了吧.</p>
<p>然后看的张宇的强化视频 (2 倍速) + 1800 (的提高部分), 看一章视频做一章 1800. 宇哥视频确实幽默, 讲的内容也很棒, 他讲的一些方法技巧很开阔眼界. 但是之前也说了, 宇哥技巧性很强, 挖的深但和真题并不很契合. 我舍友看的汤家凤强化觉得很棒 (他考上的南大).</p>
<p>最后是李永乐线代强化视频 + 1800 线代提高部分.</p>
<h3 id="二轮复习-9-月-10-月">二轮复习: 9 月 ~ 10 月</h3>
<p><strong>使用材料:</strong> 同上 <strong>+ 李永乐 660 + 汤家凤喊你起床.mp3</strong>.</p>
<p><strong>时间分配:</strong> 一个上午或一个下午或一个晚上看数学.</p>
<p>主要是二刷上述所有材料, 整理整理错题. 一轮复习时给那些比较难的题画了星星, 二轮重点做这些画了星星的题.</p>
<p>10 月 20 日开始做 660. 660 我只做了选择题, 难题不多, 一星期做完.</p>
<p>二轮期间此时精力越来越转移到专业课上.</p>
<p>另外推荐每天早上花个 5 分钟过个几遍 &quot;汤家凤喊你起床.mp3&quot;, 考研分数提升立竿见影.</p>
<blockquote>
你怎么睡得着的啊? 你这个年龄段, 你这个阶段你睡得着觉? 有点出息没有???
<div style="text-align: right">
——汤家凤
</div>
</blockquote>
<h3 id="三轮复习-11-月-12-月">三轮复习: 11 月 ~ 12 月</h3>
<p><strong>使用材料:</strong> <strong>汤家凤历年真题全解析 + 合工大超越模拟卷 + 汤家凤喊你起床.mp3</strong>.</p>
<p><strong>时间分配:</strong> 一个上午或一个下午或一个晚上.</p>
<p>真题只做了 2000 ~ 2018 的数二真题. 每天一套. 前面的真题很简单, 经常接近满分. 只有最近几年的题开始变难了, 计算量也猛增. 好像是 2016 和 2018 的题我做的非常差. 今年的难度和 2016, 2018 的比较像吧.</p>
<p>模拟卷我看大家都推荐合工大, 就做了几套它的超越卷. 质量很高 (或者说就是很难...), 做了几套放弃了, 还是看错题实在.</p>
<p>12 月后时间大多在政治背诵和专业课背诵上. 偶尔做做数学保持手感.</p>
<h2 id="专业课">专业课</h2>
<p>数据结构我还算擅长, 但考试时代码题最后写的, 差点来不及写, 代码写得很急, 涂涂改改的我自己都看不下去, 不知道老师有没有给分... 一题 15 分呢.</p>
<p>操作系统有考简述题, 我对这类题不太擅长, 写完了也没底.</p>
<p>网络我复习的不好, 也考的很差, 考完有种 30 分不要了的感觉.</p>
<h3 id="一轮复习-7-月-10-月">一轮复习: 7 月 ~ 10 月</h3>
<p><strong>使用材料:</strong> <strong>王道数据结构 + 王道操作系统 + 王道计算机网络 + 操作系统教程(费翔林) + 计算机网络(谢希仁) + 算法与数据结构考研试题精析</strong>.</p>
<p><strong>时间分配:</strong> 暑假期间专业课花的时间比数学少. 开学后每天花一个上午或一个下午或一个晚上. 越往后专业课每日占比越大.</p>
<p>我是按 <code>数据结构 -&gt; 操作系统 -&gt; 网络</code> 的顺序复习的. 数据结构占比 90 分, 优先复习. 操作系统和网络都是 30 分, 但是操作系统容易拿分, 所以第二个复习. 而网络, 根据往年学长的经验帖, 很难拿分, 所以最后复习.</p>
<p>数据结构用王道或者天勤的教材就够了. 另外算法与数据结构考研试题精析 (俗称 1800 题) 非常非常重要, 按照考纲重点刷. 但是要注意的是 1800 题答案出错的地方不少! 所以有疑问多去考研群里提问.</p>
<p>操作系统我一开始只用的王道, 但后来发现王道里知识点太简略了 (现在想想其实这书写的不太好). 所以翻出了学校里用的操作系统教材看. 你们如果用的别的教材也可以, 按照考纲来. 题目就做王道的好了. 但要注意! 王道自己出的题很多都不好, 有的表述模糊, 有的答案还是错的! 它有一道计算题在考验群里被提起了无数次, 最后讨论下来是它答案错了.</p>
<p>网络的话, 王道的网络和 960 差距蛮大的, 而且王道的网络知识点少. 但是它的题目可以做做 (稍微做点即可, 这些题目和 960 方向也不太一致). 所以我用的学校用的谢希仁的教材. 说实话网络我不太会复习, 书很厚, 囫囵吞枣看下来不知道自己看了什么.</p>
<h3 id="二轮复习-11-月-考试">二轮复习: 11 月 ~ 考试</h3>
<p><strong>使用材料:</strong> 同上.</p>
<p><strong>时间分配:</strong> 同上.</p>
<p>主要就二刷甚至三刷上述资料. 1800 第二第三遍只刷画星星的题.</p>
<p>另外考前背了背谢希仁网络的一张附录: 英文缩写/英文全称/中文翻译. 结果今年没考翻译.</p>
<h1 id="复试">复试</h1>
<p>当时考研最终选择复旦也是考虑到它的复试机试考算法, 比较适合我. 我本科期间也稍微学过一点算法竞赛.</p>
<p>第一天上午机试遇到了些小状况, 就是机房电脑总是出各种毛病, 调试了快一个小时才正式开考. 我的电脑就出了状况, 还是比较影响状态的 (甚至手忙脚乱到忘记给志愿信息表勾选&quot;调剂&quot;了).</p>
<p>机试三道题, 也确实不难. 主要还是要细心啊. 虽然还不知道结果, 但我前两题应该还行, 各种细节也有考虑到. 第三题也不难, 但问题在于即便是使用 <code>long long</code> 也过不了很多用例. 所以最好使用 Java 的大数来写本题. 但是很遗憾当我后知后觉地突然意识到 <code>long long</code> 不够用的时候已经没时间改 Java 了, 才写几行就交卷了.</p>
<p>下午口语面试. 我开头的自我介绍也准备的比较充分, 虽然临场还是有点忘词. 老师也比较和蔼. 其中老师还问到我的 &quot;hobby&quot;, 我不小心脱口而出 &quot;computer games!&quot; emmmmm 老师我两分钟内能撤回吗. 口语问题很宽泛很个性化. 比如有大佬被问了乔丹有多高.</p>
<p>第二天一整天面试 (99% 的时间在排队). 由于复试人太多, 原定的一, 二志愿各面试一次, 改为只面试一志愿. 进房间, 一圈的老师, 老师超凶_(´ཀ`」 ∠)_ (明明前面进去的有人出来说老师很和蔼. 为什么会变成这样呢?)... 被怼到放弃治疗, 我表现真的很差劲. 最后临出来前我还是厚着脸皮问老师我机试成绩, &quot;你去问专门的老师.&quot; 老师严肃地说到. (无可奉告?!)</p>
<p>复试这两天还是很紧张的, 紧张的吃不下饭.</p>
<h1 id="其他">其他</h1>
<h2 id="作息">作息</h2>
<p>暑假前我复习很划水, 进度缓慢.</p>
<p>暑假期间家旁边的图书馆 9:00 开门, 17:00 点关门. 我也基本这个时间段学习. 中午就在图书馆旁边快餐店吃. 回来趴桌子上睡个午觉. 晚上不怎么学习.</p>
<p>开学后学校图书馆 (的考研教室) 6:00 开门, 21:30 关门. 6 点需要抢座位必须醒. 一开始还能坚持几天 6 点起床, 后来实在起不来. 最后决定抢完座位继续睡! 然后 8 点 (甚至更晚) 再起床去图书馆. 不然老犯困, 没有意义.</p>
<p>中午吃完趴桌子上睡午觉. 一开始还能半小时醒, 越到后期睡越久.</p>
<p>晚上闭馆后去通宵教室呆到 11 点以后.</p>
<p>时间分配也不细致. 前期一天只复习一门科目. 后期一天的时间主要就分为三块, &quot;一上午&quot;, &quot;一下午&quot;, 和 &quot;一晚上&quot;. 每块时间只做一个科目. 时间分配还是看自己的节奏吧. 每天看上去学的时间很久, 其实一天真正专注的时间也不会很长, 学一阵子还要逛逛知乎玩玩 B 站看看新闻. 太疲劳太枯燥我真的坚持不了.</p>
<h2 id="健康">健康</h2>
<p>我备考期间有一阵子肠胃很不好, 然后咳嗽 (可能还是压力大了, 平常从没这样过), 什么小毛病一定要腾出半天一天去看医生. 考研战线还是很长的, 身体不好得不偿失.</p>
<p>另外要劳逸结合, 如果你是真心想考研, 那你压力应该还是不小的. 比如我越到考试前打游戏频率反而越频繁了, 因为考前容易烦躁, 游戏打打就平静了. 当然打游戏能克制还是克制.</p>
<h2 id="关于考研群">关于考研群</h2>
<p>经常会有人声称自己开学前就数学复习多少遍了, 以及各种想方设法劝退的, 如&quot;复旦今年不提供宿舍!&quot;, &quot;今年复旦必炸!&quot;, 搞得你很慌. 但事实上, 他们说的还真没错! 哈哈哈开玩笑的, 一方面考研群里信息要实时关注, 另一方流言还是满天飞的, 要学(习)会(惯)甄(就)别(好). 我和我舍友一开始就很容易被这类或真或假的消息搞得无心学习, 后来看得多了就好了. 最简单的方法是, 把所有同类学校的考研群都加一遍, 然后你会发现, 每个群都在复读着 &quot;今年必炸&quot;.</p>
<p>一个有趣的现象, 考试前群里很活跃的人和考试后群里活跃的人往往是不同的一拨人; 出成绩前很活跃的人和出成绩后很活跃的人又不是一批人.</p>
]]></content>
      <tags>
        <tag>考研</tag>
        <tag>笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>使用 Hexo 搭建 Github 博客</title>
    <url>/posts/52843.html</url>
    <content><![CDATA[<blockquote>
<p>平台: Windows 10 使用的 Hexo 主题: Next</p>
</blockquote>
<h1 id="平台安装">平台安装</h1>
<ol type="1">
<li><p>安装 Git (<a href="https://git-scm.com/downloads" target="_blank" rel="noopener">Git 官网</a>) 并如下配置: 打开Git Bash: <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 针对你的 Github 账户生成一个 SSH key:</span></span><br><span class="line">ssh-keygen -t rsa -b 4096 -C <span class="string">"username@host.com"</span></span><br><span class="line"><span class="comment"># 按三次回车, 密码设为空</span></span><br><span class="line"><span class="comment"># 最终在 C:\Users\Username 下生成 .ssh 文件夹并产生 id_rsa, id_rsa.pub 文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证 SSH 代理运行:</span></span><br><span class="line"><span class="built_in">eval</span> $(ssh-agent -s)</span><br><span class="line"><span class="comment"># 若正常运行则输出 Agent pid xxxxx</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加 SSH 私钥至代理:</span></span><br><span class="line">ssh-add ~/.ssh/id_rsa</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制 SSH 公钥到 Github 账号:</span></span><br><span class="line">clip &lt; ~/.ssh/id_rsa.pub</span><br><span class="line"><span class="comment"># 然后网页转到 https://github.com/settings/keys (在登陆的前提下)</span></span><br><span class="line"><span class="comment"># 点击 New SSH key, title 随意, 在 key 文本框 Ctrl+V</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证 SSH 连接</span></span><br><span class="line">ssh -T git@github.com </span><br><span class="line"><span class="comment"># 显示: Hi Username! You've successfully authenticated, but GitHub does not provide shell access.</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>安装 Node.js (<a href="https://nodejs.org" target="_blank" rel="noopener">Node.js 官网</a>, 安装完即可使用 <code>npm</code> )).</p></li>
<li><p>在 Github 上创建 <code>username.github.io</code> 仓库.</p></li>
<li><p>安装并配置 Hexo: 安装: <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure></p>
<p>(该指令表明 Hexo 为全局安装).</p>
<p>确定一个空文件夹(必须是空的)作为 Hexo 站点, 在文件夹内右键菜单,选择 &quot;Git Bash Here&quot; 打开 Git Bash, 输入:</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo init</span><br></pre></td></tr></table></figure></p>
<p>在该文件夹下产生一些 Hexo 文件. 然后打开刚生成的站点配置文件 <code>_config.yml</code>, 必要的修改如下:</p>
<p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">XXX's</span> <span class="string">Blog</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">XXX</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CH</span>           <span class="comment"># 或 language: en 等等</span></span><br><span class="line"></span><br><span class="line"><span class="attr">theme:</span> <span class="string">next</span></span><br><span class="line"></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">git</span></span><br><span class="line"><span class="attr">repo:</span> <span class="string">git@github.com:XXX/XXX.github.io.git</span></span><br><span class="line"><span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>Next 主题安装与配置 安装并配置 Next 主题 (<a href="https://github.com/theme-next/hexo-theme-next" target="_blank" rel="noopener">Next 官网</a>, 配置教程官网有). (Hexo 与 Next 主题各有一个 <code>_config.yml</code> 配置文件, 注意区分.)</p></li>
</ol>
<h1 id="网站发布至-github.io">网站发布至 github.io</h1>
<p>在 Hexo 目录安装: <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git</span><br></pre></td></tr></table></figure></p>
<p>首先我们可以在本地调试而不急于上传 Github: (同样在 Hexo 目录) <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure></p>
<p>执行完毕后打开 <code>http://localhost:4000</code> 即可查看主页. 针对 Markdown, 主题文件的任何修改, 保存后对网页按 F5 刷新立即可查看修改结果. 针对 Hexo 的修改似乎需要重启服务器.</p>
<p>要发布至 Github 则: <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure></p>
<p>指令执行完毕即可前往 github.io 查看结果.</p>
<h1 id="踩坑">踩坑</h1>
<h2 id="生成页面">生成页面</h2>
<h3 id="生成新文章页">生成新文章页</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo n &lt;post_name&gt;</span><br></pre></td></tr></table></figure>
<p>本质上就是在 <code>source/_posts/</code> 下生成一个 <code>&lt;post_name&gt;.md</code> 和一个 <code>&lt;post_name&gt;</code> 的文件夹. 其中 md 文件根据模板生成.</p>
<h3 id="生成标签-tags-和分类-categories-页面">生成标签 (Tags) 和分类 (Categories) 页面</h3>
<p>默认是没有这些页面的, 当在主页点击标签, 分类页面时会显示 <code>Cannot GET /tags/</code> 或 <code>Cannot GET /categories/</code>.</p>
<p>生成方法:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure>
<p>然后进入 <code>source/tags/</code>, 修改 <code>index.html</code>:</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: tags</span><br><span class="line">date: 2019-04-11 16:35:04</span><br><span class="line">type: "tags"</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p><code>categories</code>, <code>about</code> 等同理.</p>
<h2 id="文章的标题-发布时间-与标签等设置与模板">文章的标题, 发布时间, 与标签等设置与模板</h2>
<p>在 Markdown 文件最开头插入如下内容: <figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 标题标题标题标题</span><br><span class="line">categories:</span><br><span class="line">  - 分类</span><br><span class="line">  - 子分类</span><br><span class="line">  - 子子分类</span><br><span class="line">tags:</span><br><span class="line">  - 标签1</span><br><span class="line">  - 标签2</span><br><span class="line">  - 标签3</span><br><span class="line">abbrlink: 41653</span><br><span class="line">date: 2017-10-22 15:12:50</span><br><span class="line">---</span><br></pre></td></tr></table></figure></p>
<p>其中 <code>title</code> 必须填写, 不会根据文件名自动生成; <code>abbrlink</code> 是自动生成的, 请勿自己输入; 其余三项可有可无.</p>
<p>Hexo 提供 Markdown 生成模板(仅限使用 <code>hexo n &lt;file_name&gt;</code> 时), 打开 Hexo 站点目录下的 <code>scaffolds/post.md</code>, 若想要生成上述内容可如下填写: <figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: &#123;&#123; title &#125;&#125;</span><br><span class="line">date: &#123;&#123; date &#125;&#125;</span><br><span class="line">categories:</span><br><span class="line">  - </span><br><span class="line">tags:</span><br><span class="line">  - </span><br><span class="line">---</span><br></pre></td></tr></table></figure></p>
<h2 id="markdown-与图片的问题">Markdown 与图片的问题</h2>
<ol type="1">
<li><p>在 Hexo 站点文件夹下打开 Git Bash, 输入: <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure></p></li>
<li><p>打开站点配置文件 <code>_config.yml</code>, 修改: <figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></p>
<p>以后再使用 <code>hexo n &lt;post_name&gt;</code> 命令新建 Markdown 文件时, 会对应生成同名文件夹, 存放该文件的图片等资源.</p>
<p>但问题没有被完全解决, 此时在 Markdown 文件引用图片时, 必须以 <code>![图片](&lt;post_name&gt;/123.png)</code> 的方式引用, 而不能直接 <code>![图片](123.png)</code>.</p>
<blockquote>
<p>PS: Hexo 好像更新了方案! 现在可以直接 <code>![图片](123.png)</code> 了!</p>
</blockquote></li>
</ol>
<h2 id="修改文章与网址的映射关系">修改文章与网址的映射关系</h2>
<p>默认情况每篇文章的链接为: &quot;xxx.github.io/2019/01/01/标题&quot;, 这种以标题为组织方式的链接有时候不太好, 以下改为以 CRC 码为组织方式.</p>
<ol type="1">
<li><p>在 Hexo 站点文件夹下打开 Git Bash, 输入: <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-abbrlink --save</span><br></pre></td></tr></table></figure></p></li>
<li><p>打开站点配置文件 <code>_config.yml</code>, 修改: <figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'</span></span><br><span class="line"><span class="attr">url:</span> <span class="attr">http://yoursite.com</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">posts/:abbrlink.html</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"><span class="attr">abbrlink:</span></span><br><span class="line"><span class="attr">  alg:</span> <span class="string">crc16</span></span><br><span class="line"><span class="attr">  rep:</span> <span class="string">dec</span></span><br></pre></td></tr></table></figure></p></li>
</ol>
<h2 id="开启-latex-公式并修复默认公式渲染的-bug">开启 LaTeX 公式并修复默认公式渲染的 Bug</h2>
<ol type="1">
<li><p>默认 Next 主题不渲染公式. 开启渲染如下: 打开 Next 主题的配置文件 <code>_config.yml</code>, 修改: <figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">math:</span></span><br><span class="line"><span class="attr">  enable:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  per_page:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">  engine:</span> <span class="string">mathjax</span></span><br></pre></td></tr></table></figure></p></li>
<li><p>此时发现, 对于多行的公式, 如: <figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml">$$</span></span><br><span class="line"><span class="xml">\begin</span><span class="template-variable">&#123;aligned&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">a^</span><span class="template-variable">&#123;[i+1]&#125;</span><span class="xml"> &amp; = z^</span><span class="template-variable">&#123;[i+1]&#125;</span><span class="xml"> \\</span></span><br><span class="line"><span class="xml">&amp; = w^</span><span class="template-variable">&#123;[i+1]&#125;</span><span class="xml">a^</span><span class="template-variable">&#123;[i]&#125;</span><span class="xml"> + b^</span><span class="template-variable">&#123;[i+1]&#125;</span><span class="xml"> \\</span></span><br><span class="line"><span class="xml">&amp; = w^</span><span class="template-variable">&#123;[i+1]&#125;</span><span class="xml">(w^</span><span class="template-variable">&#123;[i]&#125;</span><span class="xml">a^</span><span class="template-variable">&#123;[i-1]&#125;</span><span class="xml"> + b^</span><span class="template-variable">&#123;[i]&#125;</span><span class="xml"> + b^</span><span class="template-variable">&#123;[i+1]&#125;</span><span class="xml"> \\</span></span><br><span class="line"><span class="xml">&amp; = (w^</span><span class="template-variable">&#123;[i+1]&#125;</span><span class="xml">w^</span><span class="template-variable">&#123;[i]&#125;</span><span class="xml">)a^</span><span class="template-variable">&#123;[i-1]&#125;</span><span class="xml"> + (w^</span><span class="template-variable">&#123;[i+1]&#125;</span><span class="xml">b^</span><span class="template-variable">&#123;[i]&#125;</span><span class="xml">+b^</span><span class="template-variable">&#123;[i+1]&#125;</span><span class="xml">) \\</span></span><br><span class="line"><span class="xml">&amp; = w'a^</span><span class="template-variable">&#123;[i-1]&#125;</span><span class="xml"> + b'</span></span><br><span class="line"><span class="xml">\end</span><span class="template-variable">&#123;aligned&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">$$</span></span><br></pre></td></tr></table></figure> <span class="math display">\[
 \begin{aligned}
 a^{[i+1]} &amp; = z^{[i+1]} \\
 &amp; = w^{[i+1]}a^{[i]} + b^{[i+1]} \\
 &amp; = w^{[i+1]}(w^{[i]}a^{[i-1]} + b^{[i]} + b^{[i+1]} \\
 &amp; = (w^{[i+1]}w^{[i]})a^{[i-1]} + (w^{[i+1]}b^{[i]}+b^{[i+1]}) \\
 &amp; = w&#39;a^{[i-1]} + b&#39;
 \end{aligned}
 \]</span> 渲染出来全挤在一行. 那肯定是不行的.</p>
<p>试过别的方法如 <code>hexo-renderer-markdown-it-plus</code>, <code>hexo-math</code>, 都不好用. 最好用的还是下面这个:</p>
<p>首先安装 Pandoc (<a href="https://pandoc.org/installing.html" target="_blank" rel="noopener">Pandoc 官网</a>), 然后执行下述指令以替换自带的 Renderer. <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm uninstall hexo-renderer-marked --save</span><br><span class="line">npm install hexo-renderer-pandoc --save</span><br></pre></td></tr></table></figure></p>
<p>目前来看还不错.</p></li>
</ol>
<h2 id="开启-markdown-的流程图支持">开启 Markdown 的流程图支持</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-filter-flowchart --save</span><br></pre></td></tr></table></figure>
<h2 id="自定义非-hexo-页面">自定义非 Hexo 页面</h2>
<p>例如我想在 <code>xienaoban.github.io/demo/</code> 下新建自定义一些网页, 希望 <code>demo</code> 文件夹下的所有网页不受 Hexo 框架影响.</p>
<p>在 Hexo 站点目录打开 Git Bash, 在 <code>source</code> 文件夹下新建 <code>demo</code> 文件夹:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new page demo</span><br></pre></td></tr></table></figure>
<p>在 <code>source/demo/</code> 下建立想要展示的 html 文件.</p>
<p>修改站点配置文件 <code>_config.yml</code>:</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">skip_render:</span> <span class="string">demo/**</span></span><br></pre></td></tr></table></figure>
<p>生成, 运行, Hexo 会将这些 html 直接复制到 <code>public</code> 文件夹下而不加以处理.</p>
<h2 id="令-next-主题默认展开所有子目录">令 Next 主题默认展开所有子目录</h2>
<p>打开 Next 主题下的 <code>source/css/_custom/custom.styl</code>, 添加一行</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.post-toc</span> <span class="selector-class">.nav</span> <span class="selector-class">.nav-child</span> &#123; <span class="attribute">display</span>: block; &#125;</span><br></pre></td></tr></table></figure>
<h2 id="hexo-本地搜索功能">Hexo 本地搜索功能</h2>
<p>于站点目录安装插件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>
<p>于站点配置文件添加如下几行:</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">search:</span></span><br><span class="line"><span class="attr">  path:</span> <span class="string">search.xml</span></span><br><span class="line"><span class="attr">  field:</span> <span class="string">post</span></span><br><span class="line"><span class="attr">  format:</span> <span class="string">html</span></span><br><span class="line"><span class="attr">  limit:</span> <span class="number">10000</span></span><br></pre></td></tr></table></figure>
<p>于 Next 主题配置文件 <code>_config.yml</code>, 修改:</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">local_search:</span></span><br><span class="line"><span class="attr">  enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h2 id="博客置顶">博客置顶</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ npm uninstall hexo-generator-index --save</span><br><span class="line">$ npm install hexo-generator-index-pin-top --save</span><br></pre></td></tr></table></figure>
<p>然后在 Markdown 中添加 <code>top</code> 字段:</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: 我的博客</span><br><span class="line">tags:</span><br><span class="line">  - 博客</span><br><span class="line">categories:</span><br><span class="line">  - 博客</span><br><span class="line">abbrlink: 12345</span><br><span class="line">date: 2021-01-28 14:58:38</span><br><span class="line">top: 1</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p>给 <code>top</code> 分配不同数值, 数值越高排名越前. 以下是 <code>hexo-generator-index-pin-top</code> 作者的源码:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">posts.data = posts.data.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a.top &amp;&amp; b.top) &#123; <span class="comment">// 两篇文章top都有定义</span></span><br><span class="line">        <span class="keyword">if</span>(a.top == b.top) <span class="keyword">return</span> b.date - a.date; <span class="comment">// 若top值一样则按照文章日期降序排</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> b.top - a.top; <span class="comment">// 否则按照top值降序排</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(a.top &amp;&amp; !b.top) &#123; <span class="comment">// 以下是只有一篇文章top有定义，那么将有top的排在前面（这里用异或操作居然不行233）</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(!a.top &amp;&amp; b.top) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> b.date - a.date; <span class="comment">// 都没定义按照文章日期降序排</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>Windows</tag>
        <tag>日常配环境</tag>
        <tag>快乐背指令</tag>
        <tag>Hexo</tag>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>深澜校园网无法打开 (弹出) 登陆网页解决方案</title>
    <url>/posts/46279.html</url>
    <content><![CDATA[<p>(适用于Windows) 打开CMD, 两行指令:</p>
<figure class="highlight bat"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ipconfig</span> /release</span><br><span class="line"><span class="built_in">ipconfig</span> /renew</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>深澜</tag>
      </tags>
  </entry>
  <entry>
    <title>Eclipse 开启代码提示与关闭变量命名补全</title>
    <url>/posts/32764.html</url>
    <content><![CDATA[<p>[TOC]</p>
<h1 id="增强代码提示功能">增强代码提示功能</h1>
<ol type="1">
<li><p>找到设置位置: <code>Window -&gt; Preferences -&gt; Java -&gt; Editor -&gt; Content Assist</code>.</p></li>
<li><p>将 <code>Auto Activation</code> 下的 <code>Auto activation triggers for Java</code> (默认为 <code>.</code>) 改为 <code>._abcdefghijklmnopqrstuvwsyzABCDEFGHIJKLMNOPQRSTUVWSYZ</code>. <img src="/posts/32764/1.png"> (若此时发现, 输入一个字符时依然没有弹出自动提示的框框, 则继续执行下一步)</p></li>
<li><p>转到: <code>Window -&gt; Preferences -&gt; Java -&gt; Editor -&gt; Content Assist -&gt; Advanced</code>.</p></li>
<li><p>在上边那个大框中, 将 <code>Java Proposals</code> 与 <code>Java Proposals (Task-Focused)</code> 勾选上. <img src="/posts/32764/2.png"></p></li>
</ol>
<p>PS: 介绍一下 <code>Java Proposals</code> 这些选项的含义:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">选项</th>
<th style="text-align: left;">含义</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>Java Type Proposals</code></td>
<td style="text-align: left;">类名, 关键字的提示</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Java Non-Type Proposals</code></td>
<td style="text-align: left;">其实就是变量名的提示</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Java Proposals</code></td>
<td style="text-align: left;"><code>Java Non-Type Proposals</code> 与 <code>Java Type Proposals</code> 的并集</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Java Proposals (Task-Focused)</code></td>
<td style="text-align: left;">不太清楚, 感觉和 <code>Java Proposals</code> 差不多</td>
</tr>
</tbody>
</table>
<p>(当同时勾选<code>Java Type Proposals</code> <code>Java Non-Type Proposals</code> <code>Java Proposals</code>时, 重启 Eclipse 会发现 <code>Java Non-Type Proposals</code> 与 <code>Java Type Proposals</code> 被取消勾选, 验证了三者关系)</p>
<p>此时代码补全提示应该如下图正常显示: <img src="/posts/32764/3.png"></p>
<h1 id="解决自动变量命名问题">解决自动变量命名问题</h1>
<p>增强代码提示后有个 bug, 即给变量命名时亦会自动补全, 就很蠢. 如下图: <img src="/posts/32764/4.png"></p>
<p>此时不论按 <code>=</code> 还是 <code>;</code>, 变量都会自动补全, 被命名为 <code>abcdBigInteger</code>.</p>
<p><strong>解决方案</strong>:</p>
<p>这个 bug 产生于 Eclipse 自带的 <code>org.eclipse.jface.text</code> 插件. 我们可以在 <code>Window -&gt; Show View -&gt; Other... -&gt; Plug-in Development -&gt; Plug-ins</code> 视图下找到这个插件. <img src="/posts/32764/5.png"></p>
<p>网上有的教程的做法是, 在 <code>Plug-ins</code> 视图下右键该插件然后 <code>Import As -&gt; Source Project</code>. 但该方法已经无法使用, 因为导入的工程现在没有源码只有 <code>.jar</code> 文件.</p>
<h2 id="获取工程">1. 获取工程</h2>
<p>所以我们要去官网下载插件源码. <a href="https://git.eclipse.org/c/platform/eclipse.platform.text.git/tree/org.eclipse.jface.text" target="_blank" rel="noopener">插件官网</a>, <a href="https://git.eclipse.org/c/platform/eclipse.platform.text.git/snapshot/eclipse.platform.text-I20190325-1800.zip" target="_blank" rel="noopener">插件下载(eclipse.platform.text-I20190325-1800.zip)</a>.</p>
<p>在下载的压缩包中找到 <code>org.eclipse.jface.text</code> 工程文件夹, 解压到工作区并打开.</p>
<h2 id="修改代码">2. 修改代码</h2>
<p>在 <code>src</code> 下找到 <code>CompletionProposalPopup.java</code> (如图)并打开. <img src="/posts/32764/6.png"></p>
<p><code>Ctrl+F</code> 搜索 <code>if (contains(triggers, key)) {</code>, 并将其修改: <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">将</span><br><span class="line"><span class="keyword">if</span> (contains(triggers, key)) &#123;</span><br><span class="line">修改为</span><br><span class="line"><span class="keyword">if</span> (key != <span class="string">'='</span> &amp;&amp; key != <span class="string">' '</span> &amp;&amp; key != <span class="string">';'</span> &amp;&amp; contains(triggers, key)) &#123;</span><br></pre></td></tr></table></figure></p>
<p><img src="/posts/32764/7.png"></p>
<p>目的很明显, 当我们输入 <code>=</code> <code></code> <code>;</code> 时不再自动补全. 以此曲线救国达到命名变量时不补全的目的...</p>
<h2 id="导出插件">3. 导出插件</h2>
<p><code>File -&gt; Export -&gt; Deployable plug-ins and fragments</code></p>
<p><img src="/posts/32764/8.png"></p>
<p><img src="/posts/32764/9.png"></p>
<p>桌面上产生了一个 <code>plugins</code> 文件夹. 打开该文件夹, 即是插件文件.</p>
<p><img src="/posts/32764/10.png"></p>
<p>打开 Eclipse 安装目录下的 <code>plugins</code> 文件夹. 搜索 <code>org.eclipse.jface.text</code>, 把搜索得的老插件删了, 把刚导出的修改版插件放进去.</p>
<p><img src="/posts/32764/11.png"></p>
<p>重启 Eclipse 即可.</p>
<h1 id="法二更方便">法二（更方便）</h1>
<p>打开<code>window -&gt; Preference -&gt;Java -&gt; Editor -&gt; Content Assist</code>.</p>
<p>勾选 <code>Disable insertion triggers except 'Enter'</code>.</p>
]]></content>
      <tags>
        <tag>日常配环境</tag>
        <tag>Eclipse</tag>
      </tags>
  </entry>
  <entry>
    <title>Coursera Deep Learning笔记 超参数调试 Batch归一化 Softmax</title>
    <url>/posts/2106.html</url>
    <content><![CDATA[<h1 id="调试tuning">调试(Tuning)</h1>
<p>深度学习要处理很多参数, 从学习速率 <span class="math inline">\(\alpha\)</span> 到 Momentum 的参数 <span class="math inline">\(\beta\)</span>, 若使用 Adam 优化算法,还得处理 <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span> 和 <span class="math inline">\(\varepsilon\)</span>. 同时还得选择层数, 每一层隐藏单元的数量, mini-batch 大小, 甚至如果还要使用学习率衰减.</p>
<p>其中学习速率 <span class="math inline">\(\alpha\)</span> 是最优先调试的超参数. mini-batch 大小与隐藏单元次之. 而 Momentum 的参数 <span class="math inline">\(\beta\)</span> 通常使用默认值 0.9, Adam 的参数 <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span> 和 <span class="math inline">\(\varepsilon\)</span> 通常不进行调试, 使用默认的 0.9, 0.999 和 <span class="math inline">\(10^{-8}\)</span>.</p>
<p>参数选择有以下一些方法: 1. 随机选择点. 例如现在有 <span class="math inline">\(\alpha\)</span> 与 Adam 的 <span class="math inline">\(\varepsilon\)</span> 两个超参数要调试. 在更早的机器学习算法中, 常见的是在网格中等距离取样. 现在更推荐随机选择. 在参数取值范围内随机选择若干点, 可以发现哪个超参数更重要, 影响更大.</p>
<ol start="2" type="1">
<li><p>由粗糙到精细的策略. 由1, 发现在某个点效果最好, 可以预测在该点附近效果也很好, 于是放大这块区域, 更密集地取值.</p></li>
<li><p>随机选择点时, 有些参数不适合均匀(在线性轴上)的随机选择. 例如 <span class="math inline">\(\alpha\)</span>, 我们希望其在对数轴上随机取点(0.0001, 0.001, 0.01, 0.1, 1), 我们可以 <code>a = 10**(-4*np.random.rand())</code>, 即可得到 <span class="math inline">\(a \isin [10^{-4}, 10^0]\)</span>.</p></li>
</ol>
<h1 id="batch-归一化batch-norm">Batch 归一化(Batch Norm)</h1>
<p>训练 Logistic 回归时, 归一化 X 可以加快学习过程. 现在我们希望对隐藏层的 A 行归一化. 吴恩达老师介绍的版本是归一化 Z, 也有学者认为应该归一化 A.</p>
<p>我们对每一层的z, a 做如下操作:</p>
<p><span class="math display">\[
\mu = \frac{1}{m} \sum_i z^{(i)} \\
\sigma^2 = \frac{1}{m} \sum_i (z^{(i)} - \mu)^2 \\
z_{\text{norm}}^{(i)} = \frac{z^{(i)} - \mu}{\sqrt{\sigma^2 + \varepsilon}} \\
\widetilde{z}^{(i)} = \gamma z_{\text{norm}}^{(i)} + \beta
\]</span></p>
<p>(<span class="math inline">\(\varepsilon\)</span>是为了防止分母为0.)</p>
<p><span class="math inline">\(z_{\text{norm}}\)</span> 就是标准化的 <span class="math inline">\(z\)</span>, 平均值为0, 方差为1. 当希望均值, 方差不是0和1时, 计算 <span class="math inline">\(\widetilde{z}\)</span>.</p>
<p><span class="math inline">\(\gamma\)</span> 与 <span class="math inline">\(\beta\)</span> 的作用是随意设置 <span class="math inline">\(\widetilde{z}^{(i)}\)</span> 的平均值. 当<span class="math inline">\(A = \sqrt{\sigma^2+\varepsilon}\)</span> 且 <span class="math inline">\(B = \mu\)</span> 时, <span class="math inline">\(\widetilde{z}^{(i)} = z^{(i)}\)</span>. <span class="math inline">\(\gamma\)</span> 与 <span class="math inline">\(\beta\)</span>是模型的学习参数, 梯度下降时会像更新神经网络的权重一样更新 <span class="math inline">\(\gamma\)</span> 和 <span class="math inline">\(\beta\)</span>.</p>
<p>使用该方法时, 参数 w 和 b 中的 b 可以不设立, 毕竟 b 总是会被归一化减去. 于是参数只剩下了 <span class="math inline">\(w\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\gamma\)</span>.</p>
<p>Batch 归一化减少了输入值改变的问题, 它的确使这些值变得更稳定, 它减弱了前层参数的作用与后层参数的作用之间的联系, 它使得网络每层都可以自己学习, 稍稍独立于其它层, 有助于加速整个网络的学习.</p>
<p>另外, 每个 mini-batch 子数据集的均值和方差均有一些噪音, 而 Batch 归一化将 <span class="math inline">\(z\)</span> 缩放到 <span class="math inline">\(\widetilde{z}\)</span> 的过程也有噪音, 因此有轻微的正则化效果.</p>
<p>在测试时, 我们很可能只想测一个样本, 此时均值 <span class="math inline">\(\mu\)</span> 和方差 <span class="math inline">\(\sigma\)</span> 没有意义. 因此我们要使用估算的 <span class="math inline">\(\mu\)</span> 和 <span class="math inline">\(\sigma\)</span> 进行测试. 估算方法很多, 通常运用指数加权平均来追踪在训练过程中的 <span class="math inline">\(\mu\)</span> 和 <span class="math inline">\(\sigma\)</span>. 还可以用指数加权平均.</p>
<h1 id="softmax-回归">Softmax 回归</h1>
<p>类似 Logistic 回归, 但 Softmax 回归能识别多个分类. 因此 <span class="math inline">\(\hat{y}\)</span> 是 C×1 维的向量, 给出 C 个分类的概率,所有概率加起来应该为1.</p>
<p>在神经网络的最后一层, 我们像往常一样计算各层的线性部分, 当计算了 <span class="math inline">\(z^{[L]} = W^{[L]}a^{[L-1]}+b^{[L]}\)</span> 之后, 使用 Softmax 激活函数.</p>
<p><span class="math display">\[
a^{[L]}_i = \frac{e^{z^{[L]}_i}}{\sum_{j=1}^{4} e^{z^{[L]}_i}}
\]</span></p>
<p>Softmax 分类中, 一般使用的损失函数及反向传播的导数是</p>
<p><span class="math display">\[
L(\hat{y}, y) = -\sum_{j=1}^{n}y_j \text{log } \hat{y}_j \\
J(w^{[1]}, b^{[1]}, ...) = \frac{1}{m} \sum_{i=1}^m L(\hat{y}^{(i)}, y^{(i)}) \\
\frac{\partial J}{\partial z^{[L]}} = \hat{y} - y
\]</span></p>
<p>Softmax 给出的是每个分类的概率. 而对应的 Hardmax 则是将最大的元素输出为 1, 其余元素置 0.</p>
]]></content>
      <categories>
        <category>Machine Learning</category>
        <category>Coursera Deep Learning</category>
      </categories>
      <tags>
        <tag>Deep Learning</tag>
        <tag>Machine Learning</tag>
        <tag>Coursera</tag>
        <tag>Batch Norm</tag>
        <tag>Softmax</tag>
      </tags>
  </entry>
  <entry>
    <title>Coursera Deep Learning笔记 优化算法</title>
    <url>/posts/58457.html</url>
    <content><![CDATA[<h1 id="mini-batch-梯度下降">Mini-batch 梯度下降</h1>
<p>将 <span class="math inline">\(X = [x^{(1)}, x^{(2)}, x^{(3)}, ..., x^{(m)}]\)</span> 矩阵所有 <span class="math inline">\(m\)</span> 个样本划分为 <span class="math inline">\(t\)</span> 个子训练集, 每个子训练集称为 <span class="math inline">\(x^{\{i\}}\)</span>, 每个子训练集内样本个数均相同(若每个子训练集有1000个样本, 则 <span class="math inline">\(x^{\{1\}} = [x^{(1)}, x^{(2)}, ..., x^{(1000)}]\)</span>, 维度 <span class="math inline">\((n_x,1000)\)</span>). 若m不能被子训练集样本数整除, 则最后一个子训练集样本可以小于其他子训练集样本数. <span class="math inline">\(Y\)</span> 亦然.</p>
<p>训练时, 每次迭代仅对一个子训练集进行梯度下降:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \text{Repeat} :\\
&amp; \qquad \text{For } i = 1, 2, ..., t: \\
&amp; \qquad \qquad \text{Forward Prop On } X^{\{i\}} \\
&amp; \qquad \qquad \text{Compute Cost } J^{\{i\}} \\
&amp; \qquad \qquad \text{Back Prop using } X^{\{i\}}, Y^{\{i\}}\\
&amp; \qquad \qquad \text{Update } w, b 
\end{aligned}
\]</span></p>
<p>使用 batch 梯度下降法时, 每次迭代都遍历整个训练集, 预期每次迭代成本都会下降, 但若使用 mini-batch 梯度下降法, 若对成本函数作图, 并不是每次迭代都下降, 噪声较大, 但整体上走势还是朝下的.</p>
<p>若样本集较小(小于2000), 无需使用 mini-batch; 否则一般的 mini-batch 大小为 64~512, 通常为 2 的整数次方.</p>
<h1 id="指数加权平均数exponentially-weighted-averages">指数加权平均数(Exponentially Weighted Averages)</h1>
<p>不是个具体的优化方法, 但是是下面的优化方法的数学基础. <img src="/posts/58457/1.png"></p>
<p><span class="math display">\[
v_t = \beta v_{t-1} + (1 - \beta)\theta_t, \qquad \beta \isin[0,1)
\]</span></p>
<p><span class="math inline">\(\beta\)</span> 越大, 画得曲线越平滑, 但画得图像会更为偏右.</p>
<p>为了让加权平均数运算更准确, 我们还需要偏差修正(Bias Correction). 由于我们默认 <span class="math inline">\(v_0 = 0\)</span>, 因此当t较小时, <span class="math inline">\(v_t\)</span> 会比 <span class="math inline">\(\theta_t\)</span> 小很多. 为解决这一问题, 得到更准确的估测, 我们不使用 <span class="math inline">\(v_t\)</span>, 而使用 <span class="math inline">\(\frac{v_t}{1-\beta^t}\)</span>.</p>
<h1 id="动量梯度下降法gradient-descent-with-momentum">动量梯度下降法(Gradient Descent With Momentum)</h1>
<p>当你的成本函数图像不够圆润, 例如是个很扁的椭圆, 使得梯度下降在y轴很快而在x轴很慢, 此时增加学习率也不是,减少学习率也不是. 动量梯度下降法使用指数加权平均数:</p>
<p><span class="math display">\[
\begin{aligned}
v_{dW} &amp; = \beta v_{dW} + (1 - \beta)dW \\
v_{db} &amp; = \beta v_{db} + (1 - \beta)db \\
W &amp; = W - \alpha v_{dW} \\
b &amp; = b - \alpha v_{db}
\end{aligned}
\]</span></p>
<p>以此减缓梯度下降摆动幅度.</p>
<h1 id="rmsprop">RMSprop</h1>
<p>同 Momentum, 能够很好的消除摆动.</p>
<p><span class="math display">\[
\begin{aligned}
S_{dW} &amp; = \beta S_{dW} + (1 - \beta)(dW)^2 \\
S_{db} &amp; = \beta S_{db} + (1 - \beta)(db)^2 \\
W &amp; = W - \alpha \frac{dW}{\sqrt{S_{dW}}} \\
b &amp; = b - \alpha \frac{db}{\sqrt{S_{db}}}
\end{aligned}
\]</span></p>
<h1 id="adam-优化算法">Adam 优化算法</h1>
<p>RMSprop 与 Adam 是少有的经受住人们考验的两种算法.</p>
<p>Adam 的本质就是将 Momentum 和 RMSprop 结合在一起. 使用该算法首先需要初始化:</p>
<p><span class="math display">\[
v_{dW} = 0, S_{dW} = 0, v_{db} = 0, S_{db} = 0.
\]</span></p>
<p>在第t次迭代中,梯度下降后:</p>
<p><span class="math display">\[
\begin{aligned}
v_{dW} &amp; = \beta_1 v_{dW} + (1 - \beta_1)dW \\
v_{db} &amp; = \beta_1 v_{db} + (1 - \beta_1)db \\
S_{dW} &amp; = \beta_2 S_{dW} + (1 - \beta_2)(dW)^2 \\
S_{db} &amp; = \beta_2 S_{db} + (1 - \beta_2)(db)^2 \\
v_{dW}^{\text{corrected}} &amp; = \frac{v_{dW}}{1-\beta_1^t}, \quad
v_{db}^{\text{corrected}} = \frac{v_{db}}{1-\beta_1^t} \\
S_{dW}^{\text{corrected}} &amp; = \frac{S_{dW}}{1-\beta_2^t}, \quad
S_{db}^{\text{corrected}} = \frac{S_{db}}{1-\beta_2^t} \\
W &amp; = W - \alpha\frac{v_{dW}^{\text{corrected}}}{\sqrt{S_{dW}^{\text{corrected}}}+\varepsilon} \\
b &amp; = b - \alpha\frac{v_{db}^{\text{corrected}}}{\sqrt{S_{db}^{\text{corrected}}}+\varepsilon}
\end{aligned}
\]</span></p>
<p>最后两个式子的 <span class="math inline">\(+ \varepsilon\)</span> 是为了防止分母为0, 上面 RMSprop 的分母实践中一般也加上, <span class="math inline">\(\varepsilon\)</span> 通常取 <span class="math inline">\(10^{-8}\)</span>.</p>
<p>Adam 算法结合了 Momentum 和 RMSprop 梯度下降法, 并且是一种极其常用的学习算法, 被证明能有效适用于不同神经网络. 适用于广泛的结构.</p>
<h1 id="学习率衰减learning-rate-decay">学习率衰减(Learning Rate Decay)</h1>
<p>如果使用固定的学习率 <span class="math inline">\(\alpha\)</span>, 在使用 mini-batch 时在最后的迭代过程中会有噪音, 不会精确收敛, 最终一直在附近摆动. 因此我们希望在训练后期 <span class="math inline">\(\alpha\)</span> 不断减小.</p>
<p>以下为几个常见的方法:</p>
<p>法一:</p>
<p><span class="math display">\[
\alpha = \frac{1}{1+decay\_rate*\text{epoch\_num}} \alpha_0
\]</span></p>
<p>其中 <span class="math inline">\(\alpha_0\)</span> 为初始学习率; <span class="math inline">\(\text{epoch\_num}\)</span> 为当前迭代的代数; <span class="math inline">\(decay\_rate\)</span> 是衰减率, 一个需要调整的超参数.</p>
<p>法二:</p>
<p><span class="math display">\[
\alpha = 0.95^{\text{epoch\_num}} \alpha_0
\]</span></p>
<p>其中 0.95 自然也能是一些其他的小于 1 的数字.</p>
<p>法三:</p>
<p><span class="math display">\[
\alpha = \frac{k}{\sqrt{\text{epoch\_num}}} \alpha_0
\]</span></p>
<p>法四:</p>
<p>离散下降(discrete stair cease), 过一阵子学习率减半, 过一会又减半.</p>
<p>法五:</p>
<p>手动衰减, 感觉慢了就调快点, 感觉快了就调慢点.</p>
<h1 id="局部最优问题local-optima">局部最优问题(Local Optima)</h1>
<p>人们经常担心算法困在局部最优点, 而事实上算法更经常被困在鞍点, 尤其是在高维空间中. 成熟的优化算法如 Adam 算法，能够加快速度，让你尽早往下走出平稳段.</p>
]]></content>
      <categories>
        <category>Machine Learning</category>
        <category>Coursera Deep Learning</category>
      </categories>
      <tags>
        <tag>Deep Learning</tag>
        <tag>Machine Learning</tag>
        <tag>Coursera</tag>
        <tag>Gradient Descent</tag>
      </tags>
  </entry>
  <entry>
    <title>Coursera Deep Learning笔记 正则化与梯度相关</title>
    <url>/posts/41302.html</url>
    <content><![CDATA[<h1 id="训练集验证集测试集train-dev-test-sets">训练集、验证集、测试集(Train, Dev, Test Sets)</h1>
<p>当数据量小的时候, 70% 训练, 30% 测试；或 60% 训练、20% 验证、20%测试. 当我们有大于100万条数据时, 测试集验证集各取1万条即可, 足以评估单个分类器.</p>
<p>确保验证集和测试集的数据来自同一分布.</p>
<p>如果不需要无偏估计, 可以不设置测试集. 当没设立测试集的时候, 验证集通常被人们称为测试集.</p>
<h1 id="偏差方差bias-variance">偏差、方差(Bias, Variance)</h1>
<p>高偏差(high bias)称为&quot;欠拟合&quot;(underfitting), 练集误差与验证集误差都高. 高方差(high variance)称为过拟合(overfitting), 训练集误差很低而验证集误差很高. 解决方法是正则化或准备更多的数据.</p>
<h1 id="正则化regularization">正则化(Regularization)</h1>
<h2 id="逻辑回归中的l1正则化-l2正则化">逻辑回归中的L1正则化, L2正则化</h2>
<p>对于L1正则化, 为代价函数添加L1范数: <span class="math display">\[
J(w, b) = \frac{1}{m} \sum^{m}_{i=1} \mathcal{L}(a^{(i)}, y^{(i)}) + \frac{\lambda}{2m} ||w||_1
\]</span></p>
<p>其中 <span class="math display">\[
||w||_1 = \sum^{n_x}_{j=1} |w_j|
\]</span></p>
<p>使用L1正则化, w最终会是稀疏的(w中含很多0), 有利于压缩模型, 但也没有降低太多内存, 所以不能将压缩作为L1正则化的目的. 通常我们使用L2正则化.</p>
<p>对于L2正则化, 为代价函数添加L2范数: <span class="math display">\[
J(w, b) = \frac{1}{m} \sum^{m}_{i=1} \mathcal{L}(a^{(i)}, y^{(i)}) + \frac{\lambda}{2m} ||w||_2^2
\]</span></p>
<p>其中 <span class="math display">\[
||w||^2_2 = \sum^{n_x}_{j=1} w_j^2 = w^Tw
\]</span></p>
<p>尽管 <span class="math inline">\(b\)</span> 也是参数, 但我们没有必要添加 <span class="math inline">\(\frac{\lambda}{2m}b^2\)</span> 项, 因为 <span class="math inline">\(w\)</span> 几乎涵盖了所有参数, 而 <span class="math inline">\(b\)</span> 只是众多参数中的一个, 可以忽略不计(当然加上也没问题).</p>
<h2 id="神经网络中的l2正则化">神经网络中的L2正则化</h2>
<p>弗罗贝尼乌斯范数(相当于矩阵的L2范数): <span class="math display">\[
||w^{[l]}||_F^2 = \sum_{i=1}^{n^{[l-1]}} \sum_{j=1}^{n^{[l]}} (w_{ij}^{[l]})^2
\]</span></p>
<p>则</p>
<p><span class="math display">\[
J(w, b) = \frac{1}{m} \sum^{m}_{i=1} \mathcal{L}(\hat{y}^{(i)}, y^{(i)}) + \frac{\lambda}{2m} \sum_{l=1}^{L}||w||_F^2
\]</span></p>
<p>则在反向传播时, <span class="math display">\[
\begin{aligned}
dw^{[l]} &amp; = (\text{from backprop}) + \frac{\lambda}{m}w^{[l]} \\
w^{[l]} &amp; = w^{[l]} -\alpha dw^{[l]} \\
\end{aligned}
\]</span></p>
<p>正则项说明, 无论 <span class="math inline">\(w^{[l]}\)</span> 是什么, 我们都试图使之更小(趋于0). 则计算得的 <span class="math inline">\(z^{[l]} = w^{[l]}a^{[l-1]} + b^{[l]}\)</span>此时也更小, <span class="math inline">\(z^{[l]}\)</span> 更容易(以tanh例)落在激活函数 <span class="math inline">\(g(z^{[l]})\)</span> 中间那一段接近线性的部分, 以达到简化网络的目的(线性的激活函数使得无论多少层的网络, 效果都和一层一样).</p>
<h2 id="随机失活dropout正则化">随机失活(Dropout)正则化</h2>
<p>对每一轮的训练, Dropout 遍历网络的每一层, 设置神经网络中每一层每个节点的失活概率, 被随机选中失活的节点临时被消除, 不参与本轮的训练, 于是得到一个更小的网络.</p>
<p>最常用的为反向随机失活(Inverted Dropout).</p>
<p>该方法在向前传播时, 根据随机失活的概率 (例如0.2), 将每一层(例如 <span class="math inline">\(l\)</span> 层)的 <span class="math inline">\(a^{[l]}\)</span> 矩阵(a=g(z))中被选中失活的元素置为0. 则该层的 <span class="math inline">\(a^{[l]}\)</span> 相当于少了 20% 的元素. 为了不影响下一层 <span class="math inline">\(z^{[l+1]}\)</span> 的期望值, 我们需要 <span class="math inline">\(a^{[l]}\)</span> /= 0.8 以修正权重.</p>
<p>由于训练时的 &quot;<span class="math inline">\(a^{[l]}\)</span> /= 0.8&quot; 修复了权重, 在测试阶段无需使用 Dropout.</p>
<p>Dropout 不能与梯度检验同时使用, 因为 Dropout 在梯度下降上的代价函数J难以计算.</p>
<h2 id="其他正则化">其他正则化</h2>
<p>数据扩增: 比如训练分类猫咪的图片, 将图片左右翻转、旋转一个小角度、稍微变形处理等, 可以人工合成数据.</p>
<p>Early Stopping: 运行梯度下降时, 我们可以绘制训练误差, 当验证集误差不降反增的时候, 停止训练. 缺点是可能导致代价J值不够小, 却又没解决继续训练可能导致的过拟合问题.</p>
<h1 id="归一化normalizing">归一化(Normalizing)</h1>
<p>输入的归一化有两个步骤: 均值调整为0, 方差归一化. 归一化直观的理解就是使得代价函数更圆, 更容易优化代价函数.</p>
<h1 id="梯度消失爆炸vanishing-exploding-gradients">梯度消失/爆炸(Vanishing / Exploding Gradients)</h1>
<p>为了方便理解，假设使用了线性激活函数 g(z)=z , 且 <span class="math display">\[
W=W^{[L-1]}=...=W^{[2]}=W^{[1]}
\]</span></p>
<p>则 <span class="math display">\[
\begin{aligned}
\hat{y} &amp; = W^{[L]}W^{[L-1]}...W^{[2]}W^{[1]}x \\
&amp; = W^{[L]}W^{L-1}x
\end{aligned}
\]</span></p>
<p>可知若 <span class="math inline">\(W\)</span> 中有元素权重为 1.5 , 则最终得到 <span class="math inline">\(1.5^{L-1}\)</span> , 若层数很深, 计算得 <span class="math inline">\(\hat{y}\)</span> 也很大; 同理若权重为 0.5 , 进行 <span class="math inline">\(L-1\)</span> 次幂运算后值会很小. 这便是梯度爆炸与梯度消失.</p>
<p>有效的解决方案: 由于 <span class="math inline">\(z=w_1x_1+w_2x_2+...+w_nx_n\)</span> (忽略 <span class="math inline">\(b\)</span> ), 为了预防 <span class="math inline">\(z\)</span> 太大或太小, 则<span class="math inline">\(n\)</span> 越大时, 期望 <span class="math inline">\(w_i\)</span> 越小, 则在随机(0~1)初始化 <span class="math inline">\(W\)</span> 时, 我们对其乘上一个小于1的倍数, 使之更小.</p>
<p>对于Tanh, 权重乘上 <span class="math inline">\(\sqrt{\frac{1}{n^{[l-1]}}}\)</span>, 或者 <span class="math inline">\(\sqrt{\frac{2}{n^{[l-1]}+n^{[l]}}}\)</span></p>
<p>对于Relu, 权重乘上 <span class="math inline">\(\sqrt{\frac{2}{n^{[l-1]}}}\)</span></p>
<h1 id="梯度检验">梯度检验</h1>
<p>在反向传播的时候, 如果怕自己 <span class="math inline">\(d\theta[i] = \frac{\partial J}{\partial \theta_i}\)</span> 等算错, 可以用导数的定义, 计算 <span class="math display">\[
d\theta_{approx}[i] = \frac{J(\theta_1, \theta_2, ..., \theta_i + \varepsilon, ...) - J(\theta_1, \theta_2, ..., \theta_i - \varepsilon, ...)}{2\varepsilon}
\]</span></p>
<p>然后根据两者误差估计自己是否算错. 该方法仅用来调试, 且不能同 Dropout 同时使用.</p>
]]></content>
      <categories>
        <category>Machine Learning</category>
        <category>Coursera Deep Learning</category>
      </categories>
      <tags>
        <tag>Deep Learning</tag>
        <tag>Machine Learning</tag>
        <tag>Coursera</tag>
        <tag>Gradient Descent</tag>
        <tag>Regularization</tag>
      </tags>
  </entry>
  <entry>
    <title>Coursera Deep Learning笔记 神经网络一些要点</title>
    <url>/posts/12524.html</url>
    <content><![CDATA[<p>[TOC]</p>
<h1 id="激活函数">激活函数</h1>
<ol type="1">
<li><p>Sigmoid 不怎么用了. <span class="math inline">\(a = g(z) = \sigma(z) = \frac{1}{1+e^{-z}} \\ g&#39;(z) = a(1-a)\)</span> <img src="/posts/12524/1.png" alt="Sigmoid"></p></li>
<li><p>Tanh 比Sigmoid好. 因为其值域为(-1, 1), 计算得a的平均值靠近0, 更好的centers the data(不知道怎么翻译比较好), 有利于下一层的计算. <span class="math inline">\(a = g(z) = tanh(z) = \frac{e^{z}-e^{-z}}{e^{z}+e^{-z}} \\ g&#39;(z) = 1 - (tanh(z))^2\)</span> <img src="/posts/12524/2.png" alt="Tanh"></p></li>
<li><p>ReLU(Rectified Linear Unit) 收敛快. <span class="math inline">\(a = g(z) = max(0, z) \\ g&#39;(z) = \begin{cases} 0 &amp;\text{if } z&lt;0 \\ 1 &amp;\text{if } z&gt;0 \\ undefined &amp;\text{if } z=0 \end{cases}\)</span> <img src="/posts/12524/3.png" alt="ReLU"></p></li>
<li><p>Leaky ReLU 比ReLU更优, 但不怎么用? <span class="math inline">\(a = g(z) = max(0.01z, z) \\ g&#39;(z) = \begin{cases} 0.01 &amp;\text{if } z&lt;0 \\ 1 &amp;\text{if } z&gt;0 \\ undefined &amp;\text{if } z=0 \end{cases}\)</span> <img src="/posts/12524/4.png" alt="Leaky ReLU"></p></li>
</ol>
<h1 id="为什么需要一个非线性的激活函数non-linear-activation-function">为什么需要一个非线性的激活函数(Non-linear Activation Function)</h1>
<p>因为如果是线性的, 即直接令 <span class="math inline">\(A = g(Z) = Z\)</span> 那么对于每一层，都有: <span class="math display">\[
a^{[i]} = z^{[i]} = w^{[i]}a^{[i-1]} + b^{[i]} \tag{*}
\]</span></p>
<p>则对于第 <span class="math inline">\(i+1\)</span> 层, 将 <span class="math inline">\((*)\)</span> 带入:</p>
<p><span class="math display">\[
\begin{aligned}
a^{[i+1]} &amp; = z^{[i+1]} \\
&amp; = w^{[i+1]}a^{[i]} + b^{[i+1]} \\
&amp; = w^{[i+1]}(w^{[i]}a^{[i-1]} + b^{[i]} + b^{[i+1]} \\
&amp; = (w^{[i+1]}w^{[i]})a^{[i-1]} + (w^{[i+1]}b^{[i]}+b^{[i+1]}) \\
&amp; = w&#39;a^{[i-1]} + b&#39;
\end{aligned}
\]</span></p>
<p>即最终的模型相当于一个标准的, 没有隐藏层的逻辑回归. 即无论你的模型有多少层，最终效果也相当于只有一层。</p>
<p>如果要用线性激活函数, 一般也只用在回归问题的输出层(预测一些结果为实数的值), 隐藏层还是用 tanh, ReLU 等.</p>
<h1 id="为什么神经网络要随机初始化参数而逻辑回归不须要">为什么神经网络要随机初始化参数(而逻辑回归不须要)</h1>
<p>如果神经网络不随机初始化, 比如 w, b 都初始化为0, 则每次对隐藏层反向传播的时候计算得的导数 <span class="math inline">\(dz^{[i]}_1\)</span> , <span class="math inline">\(dz^{[i]}_2\)</span> , <span class="math inline">\(dz^{[i]}_3\)</span> 等相同, <span class="math inline">\(dw\)</span> 也是, 每个隐藏层单元都计算着一模一样的式子(不过b不受这种Symmetry Breaking Problem影响, 可以初始化为0).</p>
<p>而对于逻辑回归, 它没有隐藏层, 其导数取决于x, 问题不大.</p>
<p>随机初始化时参数范围可以设置在0~0.01(对于 sigmoid 和 tanh 而言), 如果参数过大(比如w=100) 在 sigmoid 或 tanh 的函数图像上可以看到参数十分靠右，导致导数趋于零, 梯度趋于零, 导致收敛很慢.</p>
<h1 id="向前向后传播">向前向后传播</h1>
<p>向前传播:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \text{Input: } a^{[l-1]} \\
&amp; \text{Output: } a^{[l]} , \text{Cache: } z^{[l]} \\
&amp; z^{[l]} = W^{[l]}a^{[l-1]} + b^{[l]} &amp;&amp; Z^{[l]} = W^{[l]}A^{[l-1]} + b^{[l]} \\
&amp; a^{[l]} = g^{[l]}(z^{[l]}) &amp;&amp; A^{[l]} = g^{[l]}(Z^{[l]}) \\
\end{aligned}
\]</span></p>
<p>向后传播:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \text{Input: } da^{[l]} \\
&amp; \text{Output: } da^{[l-1]} , dW^{[l]} , db^{[l]} \\
&amp; dz^{[l]} = da^{[l]}*g^{[l]&#39;}(z^{[l]}) &amp;&amp; dZ^{[l]} = dA^{[l]}*g^{[l]&#39;}(Z^{[l]}) \\
&amp; dW^{[l]} = dz^{[l]}a^{[l-1]} &amp;&amp; dW^{[l]} = \frac{1}{m} dZ^{[l]}A^{[l-1]^T} \\
&amp; db^{[l]} = dz^{[l]} &amp;&amp; db^{[l]} = \frac{1}{m} np.sum(dZ^{[l]}, axis=1, keepdims=True) \\
&amp; da^{[l-1]} = w^{[l]^T}dz^{[l]} &amp;&amp; dA^{[l-1]} = W^{[l]^T}dZ^{[l]}
\end{aligned}
\]</span></p>
]]></content>
      <categories>
        <category>Machine Learning</category>
        <category>Coursera Deep Learning</category>
      </categories>
      <tags>
        <tag>Deep Learning</tag>
        <tag>Machine Learning</tag>
        <tag>Coursera</tag>
        <tag>Neural Network</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript几何星空连线(鼠标跟随)完善</title>
    <url>/posts/10178.html</url>
    <content><![CDATA[<p>完善了一下星空连线背景效果. 添加了粒子的鼠标跟随的效果. 参考的类似功能的JS源码都处理压缩过, 没有换行缩进, 变量名都是a, b, c... 看着真累啊.</p>
<p>把两次遍历改成了一次遍历, 把鼠标所在的点 <code>p0</code> 与 <code>points</code> 数组 <code>concat</code> 到一起处理了.</p>
<p>舍弃了原来按时间间隔计算移动距离的方法, 直接每一帧移动一定距离. 优化了代码, 提高了些性能.</p>
<p>鼠标跟随的原理是, 当粒子靠近鼠标指针到一定距离区间内, 就每帧向鼠标靠近对应距离. 所以当粒子一边远离一边被吸引时在边界会有些许鬼畜.</p>
<p><a href="https://xienaoban.github.io/resources/DEMO_%E6%98%9F%E7%A9%BA%E8%BF%9E%E7%BA%BF.html">点此访问演示DEMO</a></p>
<p>截图:</p>
<figure>
<img src="/posts/10178/1.png" alt="演示图片"><figcaption>演示图片</figcaption>
</figure>
<p>源码:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//==========================================</span></span><br><span class="line"><span class="comment">// File:    background.js</span></span><br><span class="line"><span class="comment">// Title:   星空连线(鼠标跟随)</span></span><br><span class="line"><span class="comment">// Auther:  XieNaoban</span></span><br><span class="line"><span class="comment">// Version: v1.1</span></span><br><span class="line"><span class="comment">// Note:    直接扔在&lt;body&gt;里</span></span><br><span class="line"><span class="comment">//==========================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 可调参数</span></span><br><span class="line"><span class="keyword">var</span> BACKGROUND_COLOR = <span class="string">"rgba(0,43,54,1)"</span>;   <span class="comment">// 背景色</span></span><br><span class="line"><span class="keyword">var</span> POINT_NUM = <span class="number">99</span>;                         <span class="comment">// 屏幕上点的数目</span></span><br><span class="line"><span class="keyword">var</span> POINT_COLOR = <span class="string">"rgba(255,255,255,0.7)"</span>;  <span class="comment">// 点的颜色</span></span><br><span class="line"><span class="keyword">var</span> LINE_LENGTH = <span class="number">10000</span>;                    <span class="comment">// 点之间连线长度(的平方)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建背景画布</span></span><br><span class="line"><span class="keyword">var</span> cvs = <span class="built_in">document</span>.createElement(<span class="string">"canvas"</span>);</span><br><span class="line">cvs.width = <span class="built_in">window</span>.innerWidth;</span><br><span class="line">cvs.height = <span class="built_in">window</span>.innerHeight;</span><br><span class="line">cvs.style.cssText = <span class="string">"\</span></span><br><span class="line"><span class="string">    position:fixed;\</span></span><br><span class="line"><span class="string">    top:0px;\</span></span><br><span class="line"><span class="string">    left:0px;\</span></span><br><span class="line"><span class="string">    z-index:-1;\</span></span><br><span class="line"><span class="string">    opacity:1.0;\</span></span><br><span class="line"><span class="string">    "</span>;</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(cvs);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = cvs.getContext(<span class="string">"2d"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> startTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line"></span><br><span class="line"><span class="comment">//随机数函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">randomInt</span>(<span class="params">min, max</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.floor((max - min + <span class="number">1</span>) * <span class="built_in">Math</span>.random() + min);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">randomFloat</span>(<span class="params">min, max</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (max - min) * <span class="built_in">Math</span>.random() + min;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//构造点类</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Point</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = randomFloat(<span class="number">0</span>, cvs.width);</span><br><span class="line">    <span class="keyword">this</span>.y = randomFloat(<span class="number">0</span>, cvs.height);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> speed = randomFloat(<span class="number">0.3</span>, <span class="number">1.4</span>);</span><br><span class="line">    <span class="keyword">var</span> angle = randomFloat(<span class="number">0</span>, <span class="number">2</span> * <span class="built_in">Math</span>.PI);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.dx = <span class="built_in">Math</span>.sin(angle) * speed;</span><br><span class="line">    <span class="keyword">this</span>.dy = <span class="built_in">Math</span>.cos(angle) * speed;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.r = <span class="number">1.2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.color = POINT_COLOR;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Point.prototype.move = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x += <span class="keyword">this</span>.dx;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.x &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.dx = -<span class="keyword">this</span>.dx;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.x &gt; cvs.width) &#123;</span><br><span class="line">        <span class="keyword">this</span>.x = cvs.width;</span><br><span class="line">        <span class="keyword">this</span>.dx = -<span class="keyword">this</span>.dx;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.y += <span class="keyword">this</span>.dy;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.y &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.dy = -<span class="keyword">this</span>.dy;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.y &gt; cvs.height) &#123;</span><br><span class="line">        <span class="keyword">this</span>.y = cvs.height;</span><br><span class="line">        <span class="keyword">this</span>.dy = -<span class="keyword">this</span>.dy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Point.prototype.draw = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    ctx.fillStyle = <span class="keyword">this</span>.color;</span><br><span class="line">    ctx.beginPath();</span><br><span class="line">    ctx.arc(<span class="keyword">this</span>.x, <span class="keyword">this</span>.y, <span class="keyword">this</span>.r, <span class="number">0</span>, <span class="built_in">Math</span>.PI * <span class="number">2</span>);</span><br><span class="line">    ctx.closePath();</span><br><span class="line">    ctx.fill();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> points = [];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initPoints</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; num; ++i) &#123;</span><br><span class="line">        points.push(<span class="keyword">new</span> Point());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p0 = <span class="keyword">new</span> Point(); <span class="comment">//鼠标</span></span><br><span class="line">p0.dx = p0.dy = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> degree = <span class="number">2.5</span>;</span><br><span class="line"><span class="built_in">document</span>.onmousemove = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span><br><span class="line">    p0.x = ev.clientX;</span><br><span class="line">    p0.y = ev.clientY;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.onmousedown = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span><br><span class="line">    degree = <span class="number">5.0</span>;</span><br><span class="line">    p0.x = ev.clientX;</span><br><span class="line">    p0.y = ev.clientY;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.onmouseup = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span><br><span class="line">    degree = <span class="number">2.5</span>;</span><br><span class="line">    p0.x = ev.clientX;</span><br><span class="line">    p0.y = ev.clientY;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.onmouseout = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    p0.x = <span class="literal">null</span>;</span><br><span class="line">    p0.y = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawLine</span>(<span class="params">p1, p2, deg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> dx = p1.x - p2.x;</span><br><span class="line">    <span class="keyword">var</span> dy = p1.y - p2.y;</span><br><span class="line">    <span class="keyword">var</span> dis2 = dx * dx + dy * dy;</span><br><span class="line">    <span class="keyword">if</span> (dis2 &lt; <span class="number">2</span> * LINE_LENGTH) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dis2 &gt; LINE_LENGTH) &#123;</span><br><span class="line">            <span class="keyword">if</span> (p1 === p0) &#123;</span><br><span class="line">                p2.x += dx * <span class="number">0.03</span>;</span><br><span class="line">                p2.y += dy * <span class="number">0.03</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> t = (<span class="number">1.05</span> - dis2 / LINE_LENGTH) * <span class="number">0.2</span> * deg;</span><br><span class="line">        ctx.strokeStyle = <span class="string">"rgba(255,255,255,"</span> + t + <span class="string">")"</span>;</span><br><span class="line">        ctx.beginPath();</span><br><span class="line">        ctx.lineWidth = <span class="number">1.5</span>;</span><br><span class="line">        ctx.moveTo(p1.x, p1.y);</span><br><span class="line">        ctx.lineTo(p2.x, p2.y);</span><br><span class="line">        ctx.closePath();</span><br><span class="line">        ctx.stroke();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制每一帧</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawFrame</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    cvs.width = <span class="built_in">window</span>.innerWidth;</span><br><span class="line">    cvs.height = <span class="built_in">window</span>.innerHeight;</span><br><span class="line">    ctx.fillStyle = BACKGROUND_COLOR;</span><br><span class="line">    ctx.fillRect(<span class="number">0</span>, <span class="number">0</span>, cvs.width, cvs.height);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> arr = (p0.x == <span class="literal">null</span> ? points : [p0].concat(points));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> j = i + <span class="number">1</span>; j &lt; arr.length; ++j) &#123;</span><br><span class="line">            drawLine(arr[i], arr[j], <span class="number">1.0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        arr[i].draw();</span><br><span class="line">        arr[i].move();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">window</span>.requestAnimationFrame(drawFrame);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">initPoints(POINT_NUM);</span><br><span class="line">drawFrame();</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>造轮子</tag>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>Coursera Deep Learning笔记 逻辑回归典型的训练过程</title>
    <url>/posts/59595.html</url>
    <content><![CDATA[<p>Deep Learning 用逻辑回归训练图片的典型步骤. 学习Coursera上吴恩达老师Deep Learning第一课程前两周的笔记.</p>
<h1 id="处理数据">1. 处理数据</h1>
<h2 id="向量化vectorization">1.1. 向量化(Vectorization)</h2>
<p>将每张图片的高和宽和RGB展为向量, 最终X的shape为 <code>(height*width*3, m)</code> .</p>
<h2 id="特征归一化normalization">1.2. 特征归一化(Normalization)</h2>
<p>对于一般数据，使用标准化(Standardization), <code>z_i = (x_i - mean) / delta</code> , <code>mean</code> 与 <code>delta</code> 代表X的均值和标准差. 最终特征处于[-1, 1]区间.</p>
<p>对于图片, 可直接使用Min-Max Scaling, 即将每个特征除以255(每个像素分为R, G, B, 范围在0~255)使得值处于[0, 1].</p>
<h1 id="初始化参数">2. 初始化参数</h1>
<p>一般将 <code>w</code> 和 <code>b</code> 随机选择. 作业为了方便设为0了.</p>
<h1 id="梯度下降gradient-descent">3. 梯度下降(Gradient descent)</h1>
<p>根据 <code>w</code> , <code>b</code> 和训练集，来训练数据. 需要设定迭代次数与学习率.</p>
<p>以下为大循环(迭代次数)中内容:</p>
<h2 id="计算代价函数">3.1. 计算代价函数</h2>
<p>对于<span class="math inline">\(x^{(i)} \in X\)</span>, 有</p>
<p><span class="math display">\[z^{(i)} = w^T x^{(i)} + b\]</span></p>
<p><span class="math display">\[
a^{(i)} = \hat{y}^{(i)}
        = sigmoid(z^{(i)})
        = \sigma (z^{(i)})
        = \frac{1}{1 + e^{-z^{(i)}}}
\]</span></p>
<p><span class="math display">\[\mathcal{L}(a^{(i)}, y^{(i)}) =  - y^{(i)}  \log(a^{(i)}) - (1-y^{(i)} )  \log(1-a^{(i)})\]</span></p>
<p><span class="math display">\[
A = (a^{(1)}, a^{(2)}, ... , a^{(m-1)}, a^{(m)}) 
  = \sigma(w^TX+b) 
  = \dfrac{1}{1+e^{-(w^TX+b)}} 
\]</span></p>
<p><span class="math display">\[
J = -\dfrac{1}{m} \sum^{m}_{i=1} \mathcal{L}(a^{(i)}, y^{(i)}) 
  = -\dfrac{1}{m} \sum^{m}_{i=1} (y^{(i)} log(a^{(i)}) + (1-y^{(i)}) log(1-a^{(i)}))
\]</span></p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 激活函数</span></span><br><span class="line"><span class="attr">A</span> = sigmoid(w.T.dot(X) + b)</span><br><span class="line"><span class="comment"># 代价函数</span></span><br><span class="line"><span class="attr">cost</span> = -np.sum(Y * np.log(A) + (<span class="number">1</span>-Y) * np.log(<span class="number">1</span> - A)) / m</span><br></pre></td></tr></table></figure>
<h2 id="计算反向传播的梯度">3.2. 计算反向传播的梯度</h2>
<p>即计算导数. &gt; 注: 此处 <span class="math inline">\(L(a, y)\)</span> 即上面公式的 <span class="math inline">\(\mathcal{L}(a^{(i)}, y^{(i)})\)</span> . 即 <span class="math inline">\(L(a, y) = -y \log (a) -(1-y) \log (1-a)\)</span> . 以下公式都省略了上标.</p>
<p><span class="math display">\[
  \dfrac{\partial L}{\partial a}
= \dfrac{\partial L(a, y)}{\partial a}
= -\frac{y}{a} + \frac{1-y}{1-a}
\]</span></p>
<p><span class="math display">\[
  \dfrac{da}{dz}
= (\frac{1}{1 + e^{-z}})&#39;
= \dfrac{e^{-z}}{(1+e^{-z})^2}
= \dfrac{1}{1+e^{-z}} - \dfrac{1}{(1+e^{-z})^2}
= a-a^2
= a · (1-a)
\]</span></p>
<p><span class="math display">\[
  \dfrac{\partial L}{\partial z}
= \dfrac{\partial L}{\partial a} \dfrac{da}{dz}
= (-\dfrac{y}{a} + \dfrac{1-y}{1-a}) · a · (1-a)
= a - y
\]</span></p>
<p><span class="math display">\[
  \dfrac{\partial L}{\partial w}
= \dfrac{\partial L}{\partial z} \dfrac{\partial z}{\partial w}
= (a-y) · x
\]</span></p>
<p><span class="math display">\[
  \dfrac{\partial L}{\partial b}
= \dfrac{\partial L}{\partial z} \dfrac{\partial z}{\partial b}
= a-y
\]</span></p>
<p>根据 <span class="math inline">\(J = -\dfrac{1}{m} \sum L(a, y)\)</span> 最终可得：</p>
<p><span class="math display">\[
  \dfrac{\partial J}{\partial w}
= \dfrac{\partial J}{\partial a} \dfrac{\partial a}{\partial w}
= \dfrac{1}{m} X(A-Y)^T
\]</span></p>
<p><span class="math display">\[\dfrac{\partial J}{\partial b} = \dfrac{1}{m} \sum^{m}_{i=1} (a^{(i)} - y^{(i)})\]</span></p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">dw</span> = X.dot((A - Y).T) / m</span><br><span class="line"><span class="attr">db</span> = np.sum(A - Y) / m</span><br></pre></td></tr></table></figure>
<h2 id="更新-w-b">3.3. 更新 <code>w</code> , <code>b</code></h2>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">w</span> = w - learning_rate * dw</span><br><span class="line"><span class="attr">b</span> = b - learning_rate * db</span><br></pre></td></tr></table></figure>
<h1 id="预测测试集">4. 预测测试集</h1>
<p>使用训练出来的 <code>w</code> , <code>b</code> , 对测试集使用 <code>y_pred = sigmoid(wx+b)</code> , 计算得预测的概率, 对其取整, 例如大于0.7则判定为'是', 否则为'否'. Coursera作业是0.5就判定为'是', 那么使用内建函数四舍五入即可.</p>
]]></content>
      <categories>
        <category>Machine Learning</category>
        <category>Coursera Deep Learning</category>
      </categories>
      <tags>
        <tag>Deep Learning</tag>
        <tag>Machine Learning</tag>
        <tag>Coursera</tag>
        <tag>Logistic Regression</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu一些装机用到的指令</title>
    <url>/posts/30914.html</url>
    <content><![CDATA[<h1 id="ubuntu一些装机用到的指令">Ubuntu一些装机用到的指令</h1>
<h2 id="修改分辨率">修改分辨率</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo gedit /etc/default/grub</span><br></pre></td></tr></table></figure>
<p>找到以下行： <figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="comment"># The resolution used on graphical terminal </span></span><br><span class="line"><span class="comment"># note that you can use only modes which your graphic card supports via VBE </span></span><br><span class="line"><span class="comment"># you can see them in real GRUB with the command 'vbeinfo' </span></span><br><span class="line"><span class="comment"># GRUB_GFXMODE=640×480</span></span><br></pre></td></tr></table></figure></p>
<p>下面添加一行： <figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">GRUB_GFXMODE=1920×1080 <span class="comment">#这里分辨率自行设置</span></span><br></pre></td></tr></table></figure></p>
<p>然后保存返回终端： <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo update-grub</span><br></pre></td></tr></table></figure>   重新启动ubuntu使之生效。</p>
<h2 id="固件刷入">固件刷入</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo dpkg -i linux-xxx.deb 重启</span><br></pre></td></tr></table></figure>
<h2 id="修改更新源">修改更新源</h2>
<p>在系统设置里，清华的源速度蛮快的。</p>
<h2 id="小键盘开机启动">小键盘开机启动</h2>
<p>安装numlockx： <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install numlockx</span><br></pre></td></tr></table></figure></p>
<p>编辑： <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo gedit /usr/share/lightdm/lightdm.conf.d/50-unity-greeter.conf</span><br></pre></td></tr></table></figure> 在最后添加： <figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">greeter-setup-<span class="keyword">script</span>=/usr/bin/numlockx <span class="keyword">on</span></span><br></pre></td></tr></table></figure></p>
<h2 id="设置root密码并进入root">设置root密码并进入root</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo passwd root</span><br><span class="line">su</span><br></pre></td></tr></table></figure>
<h2 id="安装ssrpython">安装SSR(Python)</h2>
<p>打开一键安装脚本，按照里面的步骤来。在<code>ssr start</code>的时候会缺少chacha20的库，使用root安装即可。（提前把它指定的vi改为gedit） <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo cp ssr /usr/<span class="built_in">local</span>/bin</span><br><span class="line">sudo chmod a=rwx /usr/<span class="built_in">local</span>/bin/ssr</span><br></pre></td></tr></table></figure></p>
<p>安装git： <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install git</span><br></pre></td></tr></table></figure></p>
<p>安装tsocks： <figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">sudo</span> <span class="string">apt-get install tsocks</span></span><br><span class="line"><span class="attr">sudo</span> <span class="string">gedit /etc/tsocks.conf</span></span><br></pre></td></tr></table></figure></p>
<p>添加: <figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">server</span> = <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line"><span class="attr">server_type</span> = <span class="number">5</span></span><br><span class="line"><span class="attr">server_port</span> = <span class="number">1080</span></span><br></pre></td></tr></table></figure></p>
<p>安装libsodium获得chacha20： <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用root运行</span></span><br><span class="line"><span class="comment"># 先cd到一个临时目录</span></span><br><span class="line">sudo apt-get install build-essential</span><br><span class="line">wget https://github.com/jedisct1/libsodium/releases/download/1.0.16/libsodium-1.0.16.tar.gz</span><br><span class="line">tar xf libsodium-1.0.16.tar.gz &amp;&amp; <span class="built_in">cd</span> libsodium-1.0.16</span><br><span class="line">./configure &amp;&amp; make -j4 &amp;&amp; make install</span><br><span class="line">ldconfig</span><br></pre></td></tr></table></figure></p>
<p>然后<code>sudo ssr install</code>。 然后<code>ssr config</code>编辑配置文件。 最后<code>ssr start</code>。</p>
<h2 id="运行-apt-get-update-报错">运行 apt-get update 报错</h2>
<p>错误信息： <figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="keyword">E</span>: Problem executing scripts APT::<span class="keyword">Update</span>::<span class="keyword">Post</span>-Invoke-Success '<span class="keyword">if</span> /usr/bin/<span class="keyword">test</span> -w /<span class="keyword">var</span>/cache/<span class="keyword">app</span>-info -a -<span class="keyword">e</span> /usr/bin/appstreamcli; then appstreamcli refresh &gt; /dev/null; fi'</span><br><span class="line"><span class="keyword">E</span>: Sub-process returned <span class="keyword">an</span> <span class="keyword">error</span> code</span><br></pre></td></tr></table></figure></p>
<p>解决方案： <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo pkill -KILL appstreamcli</span><br><span class="line"></span><br><span class="line">wget -P /tmp https://launchpad.net/ubuntu/+archive/primary/+files/appstream_0.9.4-1ubuntu1_amd64.deb https://launchpad.net/ubuntu/+archive/primary/+files/libappstream3_0.9.4-1ubuntu1_amd64.deb</span><br><span class="line"></span><br><span class="line">sudo dpkg -i /tmp/appstream_0.9.4-1ubuntu1_amd64.deb /tmp/libappstream3_0.9.4-1ubuntu1_amd64.deb</span><br></pre></td></tr></table></figure></p>
<h2 id="卸载amazon等web-apps">卸载Amazon等Web Apps</h2>
<p>要卸载干净，不然装Unity Tweak Tool的时候又会回来 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get purge unity-webapps-common</span><br><span class="line">sudo apt-get autoremove</span><br></pre></td></tr></table></figure></p>
<h2 id="安装deb软件时被替换成amazon">安装deb软件时被替换成Amazon</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install -f</span><br></pre></td></tr></table></figure>
<h2 id="安装unity-tweak-tool">安装Unity Tweak Tool</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository ppa:freyja-dev/unity-tweak-tool-daily</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install unity-tweak-tool</span><br></pre></td></tr></table></figure>
<h2 id="切换python版本">切换Python版本</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo update-alternatives --install /usr/bin/python python /usr/bin/python2.7 1</span><br><span class="line">sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.5 2</span><br><span class="line"></span><br><span class="line">sudo update-alternatives --config python</span><br></pre></td></tr></table></figure>
<h2 id="flatabulous主题与numix图标">Flatabulous主题与Numix图标</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository ppa:noobslab/themes</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install flatabulous-theme</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo add-apt-repository ppa:numix/ppa</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install numix-icon-theme numix-icon-theme-circle</span><br></pre></td></tr></table></figure>
<h2 id="java配置">Java配置</h2>
<p><code>sudo gedit /etc/profile</code>里添加： <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/usr/lib/jdk/jdk1.8.0_161</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JRE_HOME</span>=<span class="variable">$JAVA_HOME</span>/jre</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CLASSPATH</span>=.:$JAVA_HOME/lib:$JRE_HOME/lib:$CLASSPATH</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$JAVA_HOME</span>/bin:$JRE_HOME/bin:$PATH</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo update-alternatives --install /usr/bin/java java /usr/lib/jdk/jdk1.8.0_161/bin/java 300</span><br><span class="line">sudo update-alternatives --install /usr/bin/javac javac /usr/lib/jdk/jdk1.8.0_161/bin/javac 300</span><br><span class="line"></span><br><span class="line">sudo update-alternatives --install /usr/bin/jar jar /usr/lib/jdk/jdk1.8.0_161/bin/jar 300   </span><br><span class="line">sudo update-alternatives --install /usr/bin/javah javah /usr/lib/jdk/jdk1.8.0_161/bin/javah 300   </span><br><span class="line">sudo update-alternatives --install /usr/bin/javap javap /usr/lib/jdk/jdk1.8.0_161/bin/javap 300</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>日常配环境</tag>
        <tag>快乐背指令</tag>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Coursera Machine Learning Week4,5 - 神经网络(Neural Networks)</title>
    <url>/posts/1115.html</url>
    <content><![CDATA[<h1 id="概念与表述">概念与表述</h1>
<p>线性回归与逻辑回归的缺点：特征太多的时候计算负荷太大。</p>
<p>神经网络模型是许多逻辑单元按照不同层级组织起来的网络，每一层的输出变量都是下一层的输入变量。 <img src="/posts/1115/1.jpg"></p>
<h2 id="直观理解">直观理解</h2>
<p>神经网络的单层神经元的计算可以用来表示逻辑运算，比如AND、OR。</p>
<p><img src="/posts/1115/2.png"> <img src="/posts/1115/3.png"> <img src="/posts/1115/4.png"></p>
<p>如果用多层的话就可以组成功能复杂的神经网络。</p>
<p><img src="/posts/1115/5.jpg"></p>
<h2 id="多类分类">多类分类</h2>
<p><img src="/posts/1115/6.jpg"> <img src="/posts/1115/7.png"></p>
<h1 id="代价函数">代价函数</h1>
<p>逻辑回归的代价函数：</p>
<p><img src="/posts/1115/8.jpg"></p>
<p>神经网络代价函数：（<span class="math inline">\(h_{\theta}(x)\)</span>为K维度的向量，因为神经网络中可以输出很多变量。训练集中的因变量也是K维度）</p>
<p><img src="/posts/1115/9.jpg"></p>
<h1 id="反向传播算法">反向传播算法</h1>
<p>预测结果时我们正向传播：从第一层正向一层层传播，直到最后一层<span class="math inline">\(h_{\theta}(x)\)</span> 。</p>
<p><img src="/posts/1115/11.jpg"></p>
<p><img src="/posts/1115/10.jpg"></p>
<p>计算代价函数的偏导数时，从最后一层的误差算起，一层层反向求出各层误差，直到倒数第二层。设误差为<span class="math inline">\(\delta\)</span> ：</p>
<p><span class="math inline">\(\delta^{(n)}=a^{(n)}-y\)</span> <span class="math inline">\(\delta^{(n-1)}=(\theta^{(n-1)})^{T}\delta^{(n)}.*g&#39;(z^{(n-1)})\)</span> <span class="math inline">\(...\)</span> <span class="math inline">\(\delta^{(2)}=(\theta^{(2)})^{T}\delta^{(3)}.*g&#39;(z^{(2)})\)</span></p>
<p>于是偏导数的表达式即为：$ J()=a_{ij}^{(l)}_{i}^{l+1}$ 。</p>
<p>l代表目前所计算的是第几层。 j代表目前计算层中的激活单元（神经元）的下标，也将是下一层的第j个输入变量的下标。 i代表下一层中误差单元的下标，是受到权重矩阵中第i行影响的下一层中的误差单元的下标。</p>
<h1 id="步骤总结">步骤总结</h1>
<ol type="1">
<li><p>参数的随机初始化</p></li>
<li><p>利用正向传播方法计算所有的hθ(x)</p></li>
<li><p>编写计算代价函数J的代码</p></li>
<li><p>利用反向传播方法计算所有偏导数</p></li>
<li><p>利用数值检验方法检验这些偏导数</p></li>
<li><p>使用优化算法来最小化代价函数</p></li>
</ol>
]]></content>
      <categories>
        <category>Machine Learning</category>
        <category>Coursera Machine Learning</category>
      </categories>
      <tags>
        <tag>Machine Learning</tag>
        <tag>Coursera</tag>
        <tag>Neural Network</tag>
      </tags>
  </entry>
  <entry>
    <title>JS实现几何星空</title>
    <url>/posts/38878.html</url>
    <content><![CDATA[<p>ACM忙完啦，最近想给自己的xienaoban.github.io做个博客网页，刚好没学过html之类的东西，就从零开始一边学一边做。之前一直对html5做的各种特效很感兴趣，就从网页背景开始写起吧。</p>
<p>曾经看到过别人的博客的背景有种特效，就是背景随机散布若干点不停移动，当两个点足够近的时候就会产生一条线连接两点，就像星座的连线一样；当点离鼠标很近的时候还会被吸引。于是自己也来实现个。</p>
<p>感觉js真的是个很神奇的语言，没有类，就把函数“假装”为类，并作为类似构造函数而存在，然后用prototype添加成员函数。看上去还真像那么回事，哈哈。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//==========================================</span></span><br><span class="line"><span class="comment">// File: background.js</span></span><br><span class="line"><span class="comment">// Title: 几何星空背景</span></span><br><span class="line"><span class="comment">// Auther: XieNaoban</span></span><br><span class="line"><span class="comment">// Version: v0.9</span></span><br><span class="line"><span class="comment">//==========================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//创建背景画布</span></span><br><span class="line"><span class="keyword">var</span> cvs = <span class="built_in">document</span>.createElement(<span class="string">"canvas"</span>);</span><br><span class="line">cvs.width = <span class="built_in">window</span>.innerWidth;</span><br><span class="line">cvs.height = <span class="built_in">window</span>.innerHeight;</span><br><span class="line">cvs.style.cssText=<span class="string">"\</span></span><br><span class="line"><span class="string">    position:fixed;\</span></span><br><span class="line"><span class="string">    top:0px;\</span></span><br><span class="line"><span class="string">    left:0px;\</span></span><br><span class="line"><span class="string">    z-index:-1;\</span></span><br><span class="line"><span class="string">    opacity:1.0;\</span></span><br><span class="line"><span class="string">    "</span>;</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(cvs);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ctx = cvs.getContext(<span class="string">"2d"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> startTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line"></span><br><span class="line"><span class="comment">//随机数函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">randomInt</span>(<span class="params">min,max</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.floor((max-min+<span class="number">1</span>)*<span class="built_in">Math</span>.random()+min);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">randomFloat</span>(<span class="params">min,max</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (max-min)*<span class="built_in">Math</span>.random()+min;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//构造点类</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Point</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = randomFloat(<span class="number">0</span>,cvs.width);</span><br><span class="line">    <span class="keyword">this</span>.y = randomFloat(<span class="number">0</span>,cvs.height);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> maxD = <span class="number">0.08</span>, minD = <span class="number">0.01</span>;</span><br><span class="line">    <span class="keyword">this</span>.speed = randomFloat(minD,maxD);</span><br><span class="line">    <span class="keyword">this</span>.angle = randomFloat(<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">Math</span>.PI);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.r = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> grey = (<span class="keyword">this</span>.r*<span class="number">30</span>+<span class="number">200</span>);</span><br><span class="line">    <span class="keyword">this</span>.color = <span class="string">"rgba("</span>+grey+<span class="string">","</span>+grey+<span class="string">","</span>+grey+<span class="string">",1)"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Point.prototype.move = <span class="function"><span class="keyword">function</span>(<span class="params">dif</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> dx = <span class="built_in">Math</span>.sin(<span class="keyword">this</span>.angle)*<span class="keyword">this</span>.speed;</span><br><span class="line">    <span class="keyword">var</span> dy = <span class="built_in">Math</span>.cos(<span class="keyword">this</span>.angle)*<span class="keyword">this</span>.speed;</span><br><span class="line">    <span class="keyword">this</span>.x += dx*dif;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.x&lt;<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.angle=<span class="number">2</span>*<span class="built_in">Math</span>.PI-<span class="keyword">this</span>.angle;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.x&gt;cvs.width)&#123;</span><br><span class="line">        <span class="keyword">this</span>.x=cvs.width;</span><br><span class="line">        <span class="keyword">this</span>.angle=<span class="number">2</span>*<span class="built_in">Math</span>.PI-<span class="keyword">this</span>.angle;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.y += dy*dif;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.y&lt;<span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.y=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.angle=<span class="built_in">Math</span>.PI-<span class="keyword">this</span>.angle;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.y&gt;cvs.height)&#123;</span><br><span class="line">        <span class="keyword">this</span>.y=cvs.height;</span><br><span class="line">        <span class="keyword">this</span>.angle=<span class="built_in">Math</span>.PI-<span class="keyword">this</span>.angle;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Point.prototype.draw = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    ctx.fillStyle = <span class="keyword">this</span>.color;</span><br><span class="line">    ctx.beginPath();</span><br><span class="line">    ctx.arc(<span class="keyword">this</span>.x,<span class="keyword">this</span>.y,<span class="keyword">this</span>.r,<span class="number">0</span>,<span class="built_in">Math</span>.PI*<span class="number">2</span>);</span><br><span class="line">    ctx.closePath();</span><br><span class="line">    ctx.fill();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制每一帧</span></span><br><span class="line"><span class="keyword">var</span> points = [];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initPoints</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i&lt;num; ++i) &#123;</span><br><span class="line">        points.push(<span class="keyword">new</span> Point());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p0 = <span class="keyword">new</span> Point();</span><br><span class="line"><span class="keyword">var</span> degree=<span class="number">5.0</span>;</span><br><span class="line"><span class="built_in">document</span>.onmousemove = <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">    p0.x = ev.clientX;</span><br><span class="line">    p0.y = ev.clientY;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.onmousedown = <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">    degree = <span class="number">10.0</span>;</span><br><span class="line">    p0.x = ev.clientX;</span><br><span class="line">    p0.y = ev.clientY;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.onmouseup = <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">    degree = <span class="number">5.0</span>;</span><br><span class="line">    p0.x = ev.clientX;</span><br><span class="line">    p0.y = ev.clientY;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawLine</span>(<span class="params">p1,p2,d</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> dis = (p1.x-p2.x)*(p1.x-p2.x)+(p1.y-p2.y)*(p1.y-p2.y);</span><br><span class="line">    <span class="keyword">var</span> t = <span class="number">100</span>/dis;</span><br><span class="line">    t = <span class="built_in">Math</span>.min(t,<span class="number">0.4</span>);</span><br><span class="line">    <span class="keyword">if</span>(t&lt;<span class="number">0.01</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    t = <span class="built_in">Math</span>.min(<span class="number">1</span>,t*d);</span><br><span class="line">    ctx.strokeStyle = <span class="string">"rgba(255,250,250,"</span>+ t +<span class="string">")"</span>;</span><br><span class="line">    ctx.beginPath();</span><br><span class="line">    ctx.lineWidth=<span class="number">1</span>;</span><br><span class="line">    ctx.moveTo(p1.x,p1.y);</span><br><span class="line">    ctx.lineTo(p2.x,p2.y);</span><br><span class="line">    ctx.closePath();</span><br><span class="line">    ctx.stroke();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawFrame</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    cvs.width = <span class="built_in">window</span>.innerWidth;</span><br><span class="line">    cvs.height = <span class="built_in">window</span>.innerHeight;</span><br><span class="line">    ctx.fillStyle = <span class="string">"rgba(0,43,54,1)"</span>;</span><br><span class="line">    ctx.fillRect(<span class="number">0</span>,<span class="number">0</span>,cvs.width,cvs.height);</span><br><span class="line">    <span class="keyword">var</span> endTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">    <span class="keyword">var</span> dif = endTime-startTime;</span><br><span class="line">    startTime = endTime;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i&lt;points.length; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> j = i+<span class="number">1</span>; j&lt;points.length; ++j) &#123;</span><br><span class="line">            <span class="keyword">var</span> p1 = points[i], p2 = points[j];</span><br><span class="line">            drawLine(p1,p2,<span class="number">3.0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i&lt;points.length; ++i) &#123;</span><br><span class="line">        <span class="keyword">var</span> p = points[i];</span><br><span class="line">        drawLine(p0,p,degree);</span><br><span class="line">        p.draw();</span><br><span class="line">        p.move(dif);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">window</span>.requestAnimationFrame(drawFrame);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">initPoints(<span class="number">70</span>);</span><br><span class="line">drawFrame();</span><br></pre></td></tr></table></figure>
<p>没有去实现那个鼠标跟随，因为感觉我以后应该会自己想一个原创的更好玩的特效，这个就练练手好了。不过实现效果还是蛮炫酷的很满意啊，就是当最大化窗口就会显得稀疏，窗口小了看着太密。</p>
<p>还有个问题就是cpu占用太高了。。。每一帧要渲染70个点、判断<span class="math inline">\(70*70=490\)</span>条线（以及70个sin、cos可以优化为dx、dy）。。。果然以后必须得换个背景。。。（或者减少点并放大整个图形倒也不错）。</p>
<p>还有个八(te)哥(xing)，就是切换到别的页面后不是本页面会停止渲染嘛，过半分钟再切回来会发现所有点挤在四个角落。原因是我是按照时间差来定下一帧每个点的位置的，当下一帧与当前帧的时间差太大的时候，每个点的移动距离都跑到屏幕外面了，于是被强制拉回屏幕的边缘。（感觉我这个实现方法会导致动画在低配电脑上看着很卡）。</p>
]]></content>
      <tags>
        <tag>造轮子</tag>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>HDU2242 - 考研路茫茫——空调教室 (双连通分量)</title>
    <url>/posts/52996.html</url>
    <content><![CDATA[<h1 id="problem-description">Problem Description</h1>
<p>众所周知，HDU的考研教室是没有空调的，于是就苦了不少不去图书馆的考研仔们。Lele也是其中一个。而某教室旁边又摆着两个未装上的空调，更是引起人们无限YY。 一个炎热的下午，Lele照例在教室睡觉的时候，竟然做起了空调教室的美梦。 Lele梦到学校某天终于大发慈悲给某个教室安上了一个空调。而且建造了了M条通气管道，让整个教学楼的全部教室都直接或间接和空调教室连通上，构成了教室群，于是，全部教室都能吹到空调了。 不仅仅这样，学校发现教室人数越来越多，单单一个空调已经不能满足大家的需求。于是，学校决定封闭掉一条通气管道，把全部教室分成两个连通的教室群，再在那个没有空调的教室群里添置一个空调。 当然，为了让效果更好，学校想让这两个教室群里的学生人数尽量平衡。于是学校找到了你，问你封闭哪条通气管道，使得两个教室群的人数尽量平衡，并且输出人数差值的绝对值。</p>
<h1 id="input">Input</h1>
<p>本题目包含多组数据，请处理到文件结束。 每组测试第一行包含两个整数N和M(0&lt;N&lt;=10000,0&lt;M&lt;20000)。其中N表示教室的数目(教室编号从0到N-1)，M表示通气管道的数目。 第二行有N个整数Vi(0&lt;=Vi&lt;=1000)，分别代表每个教室的人数。 接下来有M行，每行两个整数Ai，Bi(0&lt;=Ai,Bi&lt;N)，表示教室Ai和教室Bi之间建了一个通气管道。</p>
<h1 id="output">Output</h1>
<p>对于每组数据，请在一行里面输出所求的差值。 如果不管封闭哪条管道都不能把教室分成两个教室群，就输出&quot;impossible&quot;。</p>
<h1 id="sample-input">Sample Input</h1>
<figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="symbol">4 </span><span class="number">3</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="symbol">0 </span><span class="number">1</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">2</span></span><br><span class="line"><span class="symbol">2 </span><span class="number">3</span></span><br><span class="line"><span class="symbol">4 </span><span class="number">3</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">2</span> <span class="number">3</span> <span class="number">5</span></span><br><span class="line"><span class="symbol">0 </span><span class="number">1</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">2</span></span><br><span class="line"><span class="symbol">2 </span><span class="number">3</span></span><br></pre></td></tr></table></figure>
<h1 id="sample-output">Sample Output</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<h1 id="key1">Key1</h1>
<p>边的双连通分量。首先是求分量，然后缩点。然后简单的树形DP即可。</p>
<p>要点是，它的图可以有重边。被坑了好久。</p>
<h1 id="code1">Code1</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Maxn = <span class="number">10000</span> + <span class="number">23</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CutEdge</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> N;</span><br><span class="line">	<span class="keyword">int</span> clk, pre[Maxn];</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> lowu = pre[u] = ++clk;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> e = G[u].begin(); e != G[u].end(); ++e) &#123;</span><br><span class="line">			<span class="keyword">int</span> v = *e;</span><br><span class="line">			<span class="keyword">if</span> (!pre[v]) &#123;</span><br><span class="line">				<span class="keyword">int</span> lowv = DFS(v, u);</span><br><span class="line">				lowu = min(lowu, lowv);</span><br><span class="line">				<span class="keyword">if</span> (lowv &gt; pre[u]) &#123;</span><br><span class="line">					Cut[u].insert(v);</span><br><span class="line">					Cut[v].insert(u);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (pre[u] &gt; pre[v]) &#123;</span><br><span class="line">				<span class="keyword">int</span> cnt = <span class="number">0</span>; <span class="comment">//重复边的处理</span></span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;e : G[u]) <span class="keyword">if</span> (e == v) ++cnt;</span><br><span class="line">				<span class="keyword">if</span> (cnt &gt; <span class="number">1</span> || v != f) &#123;</span><br><span class="line">					lowu = min(lowu, pre[v]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> lowu;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//求边双联通部分</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">DFS2</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		ID[u] = id;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;v : G[u]) <span class="keyword">if</span> (!ID[v]) &#123;</span><br><span class="line">			<span class="keyword">if</span> (Cut[u].count(v)) &#123;</span><br><span class="line">				++Num;</span><br><span class="line">				G2[id].push_back(Num);</span><br><span class="line">				G2[Num].push_back(id);</span><br><span class="line">				DFS2(v, Num);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> DFS2(v, id);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[Maxn];</span><br><span class="line">	<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; Cut[Maxn];</span><br><span class="line"></span><br><span class="line">	<span class="comment">//求边双联通部分</span></span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G2[Maxn]; <span class="comment">//缩点后的图（以ID为结点）</span></span><br><span class="line">	<span class="keyword">int</span> ID[Maxn]; <span class="comment">//每个点所在的子图</span></span><br><span class="line">	<span class="keyword">int</span> Num; <span class="comment">//ID个数</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Clear</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">		N = n;</span><br><span class="line">		<span class="built_in">memset</span>(ID, <span class="number">0</span>, <span class="keyword">sizeof</span>(ID));</span><br><span class="line">		<span class="built_in">memset</span>(pre, <span class="number">0</span>, <span class="keyword">sizeof</span>(pre));</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">			G[i].clear();</span><br><span class="line">			G2[i].clear();</span><br><span class="line">			Cut[i].clear();</span><br><span class="line">		&#125;</span><br><span class="line">		clk = <span class="number">0</span>;</span><br><span class="line">		Num = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">		G[u].push_back(v);</span><br><span class="line">		G[v].push_back(u);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Find</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">			<span class="keyword">if</span> (!pre[i])</span><br><span class="line">				DFS(i, <span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//求边双联通部分</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">BCC</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		DFS2(<span class="number">1</span>, Num);</span><br><span class="line">		<span class="keyword">return</span> Num;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> V[Maxn];</span><br><span class="line"><span class="keyword">int</span> V2[Maxn];</span><br><span class="line"><span class="keyword">int</span> DP[Maxn];</span><br><span class="line"><span class="keyword">bool</span> vis[Maxn];</span><br><span class="line">CutEdge C;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">	vis[u] = <span class="literal">true</span>;</span><br><span class="line">	DP[u] = V2[u];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;v : C.G2[u]) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!vis[v]) DP[u] += DFS(v);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> DP[u];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M) &#123;</span><br><span class="line">		<span class="built_in">memset</span>(V2, <span class="number">0</span>, <span class="keyword">sizeof</span>(V2));</span><br><span class="line">		<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">		<span class="built_in">memset</span>(DP, <span class="number">0</span>, <span class="keyword">sizeof</span>(DP));</span><br><span class="line">		C.Clear(N);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) <span class="built_in">cin</span> &gt;&gt; V[i];</span><br><span class="line">		<span class="keyword">int</span> u, v;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			C.AddEdge(++u, ++v);</span><br><span class="line">		&#125;</span><br><span class="line">		C.Find();</span><br><span class="line">		C.BCC();</span><br><span class="line">		<span class="keyword">if</span> (C.Num == <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">"impossible\n"</span>;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">			sum += V[i];</span><br><span class="line">			V2[C.ID[i]] += V[i];</span><br><span class="line">		&#125;</span><br><span class="line">		DFS(<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">int</span> res = sum;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= C.Num; ++i) &#123;</span><br><span class="line">			res = min(<span class="built_in">abs</span>(sum - <span class="number">2</span> * DP[i]), res);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="key2">Key2</h1>
<p>可以的优化是，其实在第一个DFS的时候，由于知道了桥的位置，可以在DFS的时候直接求出v以及v的子节点的和。那么在找到桥{u, v}的时候就直接顺便DP了。</p>
<h1 id="code2">Code2</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Maxn = <span class="number">10000</span>+<span class="number">23</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> V[Maxn];</span><br><span class="line"><span class="keyword">int</span> res,sum;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BCC</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> N;</span><br><span class="line">    <span class="keyword">int</span> clk, pre[Maxn];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> &amp;lowu = ID[u];</span><br><span class="line">        lowu= pre[u] = ++clk;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> e = G[u].begin(); e != G[u].end(); ++e) &#123;</span><br><span class="line">            <span class="keyword">int</span> v = *e;</span><br><span class="line">            <span class="keyword">if</span> (!pre[v]) &#123;</span><br><span class="line">                <span class="keyword">int</span> lowv = DFS(v, u);</span><br><span class="line">                lowu = min(lowu, lowv);</span><br><span class="line">                <span class="keyword">if</span> (lowv &gt; pre[u]) &#123;</span><br><span class="line">                    ++Num;</span><br><span class="line">                    res = min(<span class="built_in">abs</span>(sum - <span class="number">2</span> * V[v]), res);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (pre[u] &gt; pre[v]) &#123;</span><br><span class="line">                <span class="keyword">int</span> cnt = <span class="number">0</span>; <span class="comment">//重复边的处理</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;e : G[u]) <span class="keyword">if</span> (e == v) ++cnt;</span><br><span class="line">                <span class="keyword">if</span> (cnt &gt; <span class="number">1</span> || v != f) &#123;</span><br><span class="line">                    lowu = min(lowu, pre[v]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/*else if (pre[u]&gt;pre[v] &amp;&amp; v != f)</span></span><br><span class="line"><span class="comment">                lowu = min(lowu, pre[v]);*/</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(f!=<span class="number">-1</span>) V[f] += V[u];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> lowu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[Maxn];</span><br><span class="line">    <span class="keyword">int</span> ID[Maxn];</span><br><span class="line">    <span class="keyword">int</span> Num;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Clear</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        N = n;</span><br><span class="line">        <span class="built_in">memset</span>(ID, <span class="number">0</span>, <span class="keyword">sizeof</span>(ID));</span><br><span class="line">        <span class="built_in">memset</span>(pre, <span class="number">0</span>, <span class="keyword">sizeof</span>(pre));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">            G[i].clear();</span><br><span class="line">        &#125;</span><br><span class="line">        clk = <span class="number">0</span>;</span><br><span class="line">        Num = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">        G[u].push_back(v);</span><br><span class="line">        G[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Find</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">            <span class="keyword">if</span> (!pre[i])</span><br><span class="line">                DFS(i, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">return</span> Num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BCC C;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M) &#123;</span><br><span class="line">        C.Clear(N);</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; V[i];</span><br><span class="line">            sum += V[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> u, v;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v;</span><br><span class="line">            C.AddEdge(++u, ++v);</span><br><span class="line">        &#125;</span><br><span class="line">        res = sum;</span><br><span class="line">        <span class="keyword">if</span> (C.Find() == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"impossible\n"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>HDU</category>
      </categories>
      <tags>
        <tag>HDU</tag>
      </tags>
  </entry>
  <entry>
    <title>HDU3157 - Crazy Circuits 和 SGU176 - Flow construction (网络流)</title>
    <url>/posts/6930.html</url>
    <content><![CDATA[<p>两道有上下界有源汇最小流。 步骤之前写的笔记里有。但是原理。。。确实不太懂。 步骤： 1. 按照无源汇有上下界的最大流的做法找出可行流（但不要建立t-&gt;s）； 2. 添加t-&gt;s，流量上界INF； 3. 再次运行最大流，找出ss-&gt;st可行流； 4. 若ss不满载，则无可行流。反之，最小流为t-&gt;s的流量，每条边的流量为逆向边的流量（加上下界b）。</p>
<p>SGU176 - Flow construction <figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//下界网络流</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Maxn 200</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> c, f, id;</span><br><span class="line">	<span class="keyword">unsigned</span> v, flip;</span><br><span class="line">	Edge(<span class="keyword">unsigned</span> v, <span class="keyword">int</span> c, <span class="keyword">int</span> f, <span class="keyword">unsigned</span> flip, <span class="keyword">int</span> id) :v(v), c(c), f(f), flip(flip), id(id) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dinic</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">bool</span> b[Maxn];</span><br><span class="line">	<span class="keyword">int</span> a[Maxn];</span><br><span class="line">	<span class="keyword">unsigned</span> p[Maxn], cur[Maxn], d[Maxn];</span><br><span class="line">	<span class="built_in">vector</span>&lt;Edge&gt; G[Maxn];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">unsigned</span> s, t;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">(<span class="keyword">unsigned</span> n)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">			G[i].clear();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">unsigned</span> u, <span class="keyword">unsigned</span> v, <span class="keyword">int</span> c, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		G[u].push_back(Edge(v, c, <span class="number">0</span>, G[v].size(),<span class="number">0</span>));</span><br><span class="line">		G[v].push_back(Edge(u, <span class="number">0</span>, <span class="number">0</span>, G[u].size() - <span class="number">1</span>, id)); <span class="comment">// 使用无向图时将0改为c即可</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">unsigned</span> u, v;</span><br><span class="line">		<span class="built_in">queue</span>&lt;<span class="keyword">unsigned</span>&gt; q;</span><br><span class="line">		<span class="built_in">memset</span>(b, <span class="number">0</span>, <span class="keyword">sizeof</span>(b));</span><br><span class="line">		q.push(s);</span><br><span class="line">		d[s] = <span class="number">0</span>;</span><br><span class="line">		b[s] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">			u = q.front();</span><br><span class="line">			q.pop();</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> it = G[u].begin(); it != G[u].end(); ++it) &#123;</span><br><span class="line">				Edge &amp;e = *it;</span><br><span class="line">				<span class="keyword">if</span> (!b[e.v] &amp;&amp; e.c&gt;e.f) &#123;</span><br><span class="line">					b[e.v] = <span class="number">1</span>;</span><br><span class="line">					d[e.v] = d[u] + <span class="number">1</span>;</span><br><span class="line">					q.push(e.v);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> b[t];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">DFS</span><span class="params">(<span class="keyword">unsigned</span> u, <span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (u == t || a == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> a;</span><br><span class="line">		<span class="keyword">int</span> flow = <span class="number">0</span>, f;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">unsigned</span> &amp;i = cur[u]; i&lt;G[u].size(); ++i) &#123;</span><br><span class="line">			Edge &amp;e = G[u][i];</span><br><span class="line">			<span class="keyword">if</span> (d[u] + <span class="number">1</span> == d[e.v] &amp;&amp; (f = DFS(e.v, min(a, e.c - e.f)))&gt;<span class="number">0</span>) &#123;</span><br><span class="line">				a -= f;</span><br><span class="line">				e.f += f;</span><br><span class="line">				G[e.v][e.flip].f -= f;</span><br><span class="line">				flow += f;</span><br><span class="line">				<span class="keyword">if</span> (!a) <span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">MaxFlow</span><span class="params">(<span class="keyword">unsigned</span> s, <span class="keyword">unsigned</span> t)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> flow = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">this</span>-&gt;s = s;</span><br><span class="line">		<span class="keyword">this</span>-&gt;t = t;</span><br><span class="line">		<span class="keyword">while</span> (BFS()) &#123;</span><br><span class="line">			<span class="built_in">memset</span>(cur, <span class="number">0</span>, <span class="keyword">sizeof</span>(cur));</span><br><span class="line">			flow += DFS(s, INF);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Flow[<span class="number">10000</span>+<span class="number">23</span>];</span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> Dif[Maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M) &#123;</span><br><span class="line">		<span class="keyword">const</span> <span class="keyword">int</span> ss = N + <span class="number">1</span>, st = N + <span class="number">2</span>;</span><br><span class="line">		<span class="built_in">memset</span>(Dif, <span class="number">0</span>, <span class="keyword">sizeof</span>(Dif));</span><br><span class="line">		<span class="built_in">memset</span>(Flow, <span class="number">0</span>, <span class="keyword">sizeof</span>(Flow));</span><br><span class="line">		Dinic Din;</span><br><span class="line">		Din.Init(N);</span><br><span class="line">		<span class="keyword">int</span> u, v, b, c;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v &gt;&gt; c &gt;&gt; b;</span><br><span class="line">			<span class="keyword">if</span> (b) &#123;</span><br><span class="line">				b = c;</span><br><span class="line">				Dif[u] -= b;</span><br><span class="line">				Dif[v] += b;</span><br><span class="line">				Flow[i] = b;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> Din.AddEdge(u, v, c - b, i);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (Dif[i] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				Din.AddEdge(ss, i, Dif[i], <span class="number">0</span>);</span><br><span class="line">				sum += Dif[i];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (Dif[i] &lt; <span class="number">0</span>) Din.AddEdge(i, st, -Dif[i], <span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> ans = Din.MaxFlow(ss, st);</span><br><span class="line">		Din.AddEdge(N, <span class="number">1</span>, INF, <span class="number">0</span>);</span><br><span class="line">		ans += Din.MaxFlow(ss, st);</span><br><span class="line">		<span class="keyword">if</span> (sum != ans) <span class="built_in">cout</span> &lt;&lt; <span class="string">"Impossible\n"</span>;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; Din.G[N].rbegin()-&gt;f &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;e : Din.G[i]) &#123;</span><br><span class="line">				<span class="keyword">if</span> (e.id) Flow[e.id] += -e.f;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; M; ++i) <span class="built_in">cout</span> &lt;&lt; Flow[i] &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; Flow[M] &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>HDU3157 - Crazy Circuits <figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Maxn = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> N, M, S, T, SS, ST;</span><br><span class="line"><span class="keyword">int</span> Dif[Maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">QIn</span><span class="params">(<span class="keyword">int</span> &amp;x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> c;</span><br><span class="line">	<span class="keyword">while</span> ((c = getchar()) != EOF &amp;&amp; (!<span class="built_in">isdigit</span>(c) &amp;&amp; (c != <span class="string">'+'</span>&amp;&amp;c != <span class="string">'-'</span>)));</span><br><span class="line">	<span class="keyword">switch</span> (c) &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'+'</span>:x = S; <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'-'</span>:x = T; <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">case</span> EOF: <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	x = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		x *= <span class="number">10</span>;</span><br><span class="line">		x += c - <span class="string">'0'</span>;</span><br><span class="line">	&#125; <span class="keyword">while</span> ((c = getchar()) != EOF&amp;&amp;<span class="built_in">isdigit</span>(c));</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> c, f;</span><br><span class="line">	<span class="keyword">unsigned</span> v, flip;</span><br><span class="line">	Edge(<span class="keyword">unsigned</span> v, <span class="keyword">int</span> c, <span class="keyword">int</span> f, <span class="keyword">unsigned</span> flip) :v(v), c(c), f(f), flip(flip) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dinic</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">bool</span> b[Maxn];</span><br><span class="line">	<span class="keyword">int</span> a[Maxn];</span><br><span class="line">	<span class="keyword">unsigned</span> p[Maxn], cur[Maxn], d[Maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">vector</span>&lt;Edge&gt; G[Maxn];</span><br><span class="line">	<span class="keyword">unsigned</span> s, t;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">(<span class="keyword">unsigned</span> n)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">			G[i].clear();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">unsigned</span> u, <span class="keyword">unsigned</span> v, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">		G[u].push_back(Edge(v, c, <span class="number">0</span>, G[v].size()));</span><br><span class="line">		G[v].push_back(Edge(u, <span class="number">0</span>, <span class="number">0</span>, G[u].size() - <span class="number">1</span>));	<span class="comment">//使用无向图时将0改为c即可 </span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">unsigned</span> u, v;</span><br><span class="line">		<span class="built_in">queue</span>&lt;<span class="keyword">unsigned</span>&gt; q;</span><br><span class="line">		<span class="built_in">memset</span>(b, <span class="number">0</span>, <span class="keyword">sizeof</span>(b));</span><br><span class="line">		q.push(s);</span><br><span class="line">		d[s] = <span class="number">0</span>;</span><br><span class="line">		b[s] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">			u = q.front();</span><br><span class="line">			q.pop();</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> it = G[u].begin(); it != G[u].end(); ++it) &#123;</span><br><span class="line">				Edge &amp;e = *it;</span><br><span class="line">				<span class="keyword">if</span> (!b[e.v] &amp;&amp; e.c&gt;e.f) &#123;</span><br><span class="line">					b[e.v] = <span class="number">1</span>;</span><br><span class="line">					d[e.v] = d[u] + <span class="number">1</span>;</span><br><span class="line">					q.push(e.v);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> b[t];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">DFS</span><span class="params">(<span class="keyword">unsigned</span> u, <span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (u == t || a == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> a;</span><br><span class="line">		<span class="keyword">int</span> flow = <span class="number">0</span>, f;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">unsigned</span> &amp;i = cur[u]; i&lt;G[u].size(); ++i) &#123;</span><br><span class="line">			Edge &amp;e = G[u][i];</span><br><span class="line">			<span class="keyword">if</span> (d[u] + <span class="number">1</span> == d[e.v] &amp;&amp; (f = DFS(e.v, min(a, e.c - e.f)))&gt;<span class="number">0</span>) &#123;</span><br><span class="line">				a -= f;</span><br><span class="line">				e.f += f;</span><br><span class="line">				G[e.v][e.flip].f -= f;</span><br><span class="line">				flow += f;</span><br><span class="line">				<span class="keyword">if</span> (!a) <span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">MaxFlow</span><span class="params">(<span class="keyword">unsigned</span> s, <span class="keyword">unsigned</span> t)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> flow = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">this</span>-&gt;s = s;</span><br><span class="line">		<span class="keyword">this</span>-&gt;t = t;</span><br><span class="line">		<span class="keyword">while</span> (BFS()) &#123;</span><br><span class="line">			<span class="built_in">memset</span>(cur, <span class="number">0</span>, <span class="keyword">sizeof</span>(cur));</span><br><span class="line">			flow += DFS(s, INF);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Input</span><span class="params">(Dinic &amp;d)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(Dif, <span class="number">0</span>, <span class="keyword">sizeof</span>(Dif));</span><br><span class="line">	<span class="keyword">int</span> u, v, b;</span><br><span class="line">	<span class="keyword">char</span> c;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">		QIn(u);</span><br><span class="line">		QIn(v);</span><br><span class="line">		QIn(b);</span><br><span class="line">		d.AddEdge(u, v, INF); <span class="comment">//由于无上界，直接写INF好了，反正流量不可能达到INF-b</span></span><br><span class="line">		Dif[u] -= b;</span><br><span class="line">		Dif[v] += b;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>,&amp;N,&amp;M) &amp;&amp; M) &#123; <span class="comment">//N可以等于0！</span></span><br><span class="line">		S = N + <span class="number">1</span>, T = N + <span class="number">2</span>;</span><br><span class="line">		SS = S + <span class="number">2</span>, ST = T + <span class="number">2</span>;</span><br><span class="line">		Dinic D;</span><br><span class="line">		Input(D);</span><br><span class="line">		<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; ++i) &#123; <span class="comment">//建立与超级源汇点ss、st的边（别漏了源汇点！）</span></span><br><span class="line">			<span class="keyword">if</span> (Dif[i] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				D.AddEdge(SS, i, Dif[i]);</span><br><span class="line">				sum += Dif[i];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (Dif[i] &lt; <span class="number">0</span>) D.AddEdge(i, ST, -Dif[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> ans=D.MaxFlow(SS, ST);</span><br><span class="line">		D.AddEdge(T, S, INF);</span><br><span class="line">		ans += D.MaxFlow(SS, ST);</span><br><span class="line">		<span class="keyword">if</span> (ans != sum) &#123;</span><br><span class="line">			<span class="built_in">puts</span>(<span class="string">"impossible"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, D.G[T].rbegin()-&gt;f);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>HDU</category>
      </categories>
      <tags>
        <tag>HDU</tag>
      </tags>
  </entry>
  <entry>
    <title>UVA11248 - Frequency Hopping (网络流)</title>
    <url>/posts/28286.html</url>
    <content><![CDATA[<h1 id="description">Description</h1>
<p>uva的pdf格式题目复制有问题，直接贴原题链接了。 <a href="https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;category=24&amp;page=show_problem&amp;problem=2205" target="_blank" rel="noopener">UVA11248 - Frequency Hopping</a></p>
<h1 id="key">Key</h1>
<p>给一个N点E条边的网络流，问能否找出1-&gt;N的一条流量等于C的流。若不能，若修改一条弧的上界，可否找到？列出所有可修改的弧。</p>
<p>先求出最大流，若大于C，输出“possible”。 若小于C，枚举修改每一条弧再次运行最大流（记得记录每条修改过的弧，本次最大流运行过后再重新把每条弧的流量恢复。不能每次都从头开始计算最大流，会超时）。</p>
<p>可以如下优化，不需要求最大流，只需流量大于等于C时就可以停止。不过既然已经AC了就不管了。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">UIF</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> u, i, f;</span><br><span class="line">	UIF(<span class="keyword">const</span> <span class="keyword">int</span> &amp;u, <span class="keyword">const</span> <span class="keyword">int</span> &amp;i, <span class="keyword">const</span> <span class="keyword">int</span> &amp;f) :u(u), i(i), f(f) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Maxn = <span class="number">150</span>;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; UV;</span><br><span class="line"><span class="keyword">int</span> N, E, C;</span><br><span class="line"><span class="built_in">vector</span>&lt;UV&gt; Q;</span><br><span class="line"><span class="built_in">vector</span>&lt;UIF&gt; Chg;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> c, f;</span><br><span class="line">	<span class="keyword">unsigned</span> v, flip;</span><br><span class="line">	Edge(<span class="keyword">unsigned</span> v, <span class="keyword">int</span> c, <span class="keyword">int</span> f, <span class="keyword">unsigned</span> flip) :v(v), c(c), f(f), flip(flip) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dinic</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">bool</span> b[Maxn];</span><br><span class="line">	<span class="keyword">int</span> a[Maxn];</span><br><span class="line">	<span class="keyword">unsigned</span> p[Maxn], cur[Maxn], d[Maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">vector</span>&lt;Edge&gt; G[Maxn];</span><br><span class="line">	<span class="keyword">unsigned</span> s, t;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">(<span class="keyword">unsigned</span> n)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">			G[i].clear();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">unsigned</span> u, <span class="keyword">unsigned</span> v, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">		G[u].push_back(Edge(v, c, <span class="number">0</span>, G[v].size()));</span><br><span class="line">		G[v].push_back(Edge(u, <span class="number">0</span>, <span class="number">0</span>, G[u].size() - <span class="number">1</span>));	<span class="comment">//使用无向图时将0改为c即可 </span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">unsigned</span> u, v;</span><br><span class="line">		<span class="built_in">queue</span>&lt;<span class="keyword">unsigned</span>&gt; q;</span><br><span class="line">		<span class="built_in">memset</span>(b, <span class="number">0</span>, <span class="keyword">sizeof</span>(b));</span><br><span class="line">		q.push(s);</span><br><span class="line">		d[s] = <span class="number">0</span>;</span><br><span class="line">		b[s] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">			u = q.front();</span><br><span class="line">			q.pop();</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> it = G[u].begin(); it != G[u].end(); ++it) &#123;</span><br><span class="line">				Edge &amp;e = *it;</span><br><span class="line">				<span class="keyword">if</span> (!b[e.v] &amp;&amp; e.c &gt; e.f) &#123;</span><br><span class="line">					b[e.v] = <span class="number">1</span>;</span><br><span class="line">					d[e.v] = d[u] + <span class="number">1</span>;</span><br><span class="line">					q.push(e.v);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> b[t];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">DFS</span><span class="params">(<span class="keyword">unsigned</span> u, <span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (u == t || a == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> a;</span><br><span class="line">		<span class="keyword">int</span> flow = <span class="number">0</span>, f;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">unsigned</span> &amp;i = cur[u]; i &lt; G[u].size(); ++i) &#123;</span><br><span class="line">			Edge &amp;e = G[u][i];</span><br><span class="line">			<span class="keyword">if</span> (d[u] + <span class="number">1</span> == d[e.v] &amp;&amp; (f = DFS(e.v, min(a, e.c - e.f))) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				a -= f;</span><br><span class="line">				e.f += f;</span><br><span class="line">				G[e.v][e.flip].f -= f;</span><br><span class="line">				flow += f;</span><br><span class="line">				Chg.push_back(UIF(u, i, f));</span><br><span class="line">				Chg.push_back(UIF(e.v, e.flip, -f));</span><br><span class="line">				<span class="keyword">if</span> (!a) <span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">MaxFlow</span><span class="params">(<span class="keyword">unsigned</span> s, <span class="keyword">unsigned</span> t)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> flow = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">this</span>-&gt;s = s;</span><br><span class="line">		<span class="keyword">this</span>-&gt;t = t;</span><br><span class="line">		<span class="keyword">while</span> (BFS()) &#123;</span><br><span class="line">			<span class="built_in">memset</span>(cur, <span class="number">0</span>, <span class="keyword">sizeof</span>(cur));</span><br><span class="line">			flow += DFS(s, INF);</span><br><span class="line">			<span class="comment">//if (flow &gt;= C) break;</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Traverse</span><span class="params">(Dinic &amp;din, <span class="keyword">int</span> lf)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> u = <span class="number">1</span>; u &lt;= N; ++u) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;e : din.G[u]) <span class="keyword">if</span> (e.c) &#123;</span><br><span class="line">			<span class="keyword">int</span> tmp = e.c;</span><br><span class="line">			e.c = C;</span><br><span class="line">			Chg.clear();</span><br><span class="line">			<span class="keyword">int</span> f = din.MaxFlow(<span class="number">1</span>, N);</span><br><span class="line">			<span class="keyword">if</span> (f &gt;= lf) Q.push_back(make_pair(u, e.v));</span><br><span class="line">			e.c = tmp;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;e : Chg) din.G[e.u][e.i].f -= e.f;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> Case = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;N, &amp;E, &amp;C) &amp;&amp; (N | E | C)) &#123;</span><br><span class="line">		Dinic Din;</span><br><span class="line">		<span class="keyword">int</span> u, v, c;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= E; ++i) &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;u, &amp;v, &amp;c);</span><br><span class="line">			Din.AddEdge(u, v, c);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> f = Din.MaxFlow(<span class="number">1</span>, N);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Case %d: "</span>, ++Case);</span><br><span class="line">		<span class="keyword">if</span> (f &gt;= C) &#123;</span><br><span class="line">			<span class="built_in">puts</span>(<span class="string">"possible"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			Q.clear();</span><br><span class="line">			Traverse(Din, C - f);</span><br><span class="line">			<span class="keyword">if</span> (Q.empty()) &#123;</span><br><span class="line">				<span class="built_in">puts</span>(<span class="string">"not possible"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"possible option:"</span>);</span><br><span class="line">				sort(Q.begin(), Q.end());</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">auto</span> p = Q.begin(); p != Q.end(); ++p) &#123;</span><br><span class="line">					<span class="built_in">printf</span>(<span class="string">"(%d,%d)%c"</span>, p-&gt;first, p-&gt;second, <span class="string">",\n"</span>[p + <span class="number">1</span> == Q.end()]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>UVa</category>
      </categories>
      <tags>
        <tag>UVa</tag>
      </tags>
  </entry>
  <entry>
    <title>有上下界的网络流笔记</title>
    <url>/posts/30673.html</url>
    <content><![CDATA[<p>从<a href="http://www.cnblogs.com/kane0526/archive/2013/04/05/3001108.html" target="_blank" rel="noopener">大佬的博客</a>里学到了很多东西，以下是自己的小总结。</p>
<h1 id="无源汇有上下界可行流">无源汇有上下界可行流</h1>
<h2 id="步骤">步骤</h2>
<ol type="1">
<li>建立超级源点ss与汇点st；</li>
<li>像普通网络流一样建图，但其中边的上界为c-b（上界-下界）；</li>
<li>计算所有点的Dif（流入下界之和 - 流出下界之和）。 如果Dif[u]大于0，建立ss到u的上界为Dif的附加边； 如果Dif[u]小于0，建立u到st的上界为-Dif的附加边；</li>
<li>计算从ss到st的最大流；</li>
<li>计算每条附加边的流量。若每条附加边u的流量均为Dif[u]（即每条附加边都满载），则说明找到了可行流。</li>
</ol>
<p>算竞训练指南上说还要建立一条st到ss的流量上界INF的边，翻了很多资料博客，其实应该不可以添加。应该是书上错了？</p>
<h2 id="模板题">模板题</h2>
<p><a href="http://acm.sgu.ru/problem.php?contest=0&amp;problem=194" target="_blank" rel="noopener">SGU194 - Reactor Cooling</a> <figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//上下界网络流</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x7FFFFFFF</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Maxn 22222</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> c, f,id;</span><br><span class="line">	<span class="keyword">unsigned</span> v, flip;</span><br><span class="line">	Edge(<span class="keyword">unsigned</span> v, <span class="keyword">int</span> c, <span class="keyword">int</span> f, <span class="keyword">unsigned</span> flip,<span class="keyword">int</span> id) :v(v), c(c), f(f), flip(flip),id(id) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dinic</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">bool</span> b[Maxn];</span><br><span class="line">	<span class="keyword">int</span> a[Maxn];</span><br><span class="line">	<span class="keyword">unsigned</span> p[Maxn], cur[Maxn], d[Maxn];</span><br><span class="line">	<span class="built_in">vector</span>&lt;Edge&gt; G[Maxn];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">unsigned</span> s, t;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">(<span class="keyword">unsigned</span> n)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">			G[i].clear();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">unsigned</span> u, <span class="keyword">unsigned</span> v, <span class="keyword">int</span> c,<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		G[u].push_back(Edge(v, c, <span class="number">0</span>, G[v].size(),id));</span><br><span class="line">		G[v].push_back(Edge(u, <span class="number">0</span>, <span class="number">0</span>, G[u].size() - <span class="number">1</span>,<span class="number">0</span>)); <span class="comment">// 使用无向图时将0改为c即可</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">unsigned</span> u, v;</span><br><span class="line">		<span class="built_in">queue</span>&lt;<span class="keyword">unsigned</span>&gt; q;</span><br><span class="line">		<span class="built_in">memset</span>(b, <span class="number">0</span>, <span class="keyword">sizeof</span>(b));</span><br><span class="line">		q.push(s);</span><br><span class="line">		d[s] = <span class="number">0</span>;</span><br><span class="line">		b[s] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">			u = q.front();</span><br><span class="line">			q.pop();</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> it = G[u].begin(); it != G[u].end(); ++it) &#123;</span><br><span class="line">				Edge &amp;e = *it;</span><br><span class="line">				<span class="keyword">if</span> (!b[e.v] &amp;&amp; e.c&gt;e.f) &#123;</span><br><span class="line">					b[e.v] = <span class="number">1</span>;</span><br><span class="line">					d[e.v] = d[u] + <span class="number">1</span>;</span><br><span class="line">					q.push(e.v);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> b[t];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">DFS</span><span class="params">(<span class="keyword">unsigned</span> u, <span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (u == t || a == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> a;</span><br><span class="line">		<span class="keyword">int</span> flow = <span class="number">0</span>, f;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">unsigned</span> &amp;i = cur[u]; i&lt;G[u].size(); ++i) &#123;</span><br><span class="line">			Edge &amp;e = G[u][i];</span><br><span class="line">			<span class="keyword">if</span> (d[u] + <span class="number">1</span> == d[e.v] &amp;&amp; (f = DFS(e.v, min(a, e.c - e.f)))&gt;<span class="number">0</span>) &#123;</span><br><span class="line">				a -= f;</span><br><span class="line">				e.f += f;</span><br><span class="line">				G[e.v][e.flip].f -= f;</span><br><span class="line">				flow += f;</span><br><span class="line">				<span class="keyword">if</span> (!a) <span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">MaxFlow</span><span class="params">(<span class="keyword">unsigned</span> s, <span class="keyword">unsigned</span> t)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> flow = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">this</span>-&gt;s = s;</span><br><span class="line">		<span class="keyword">this</span>-&gt;t = t;</span><br><span class="line">		<span class="keyword">while</span> (BFS()) &#123;</span><br><span class="line">			<span class="built_in">memset</span>(cur, <span class="number">0</span>, <span class="keyword">sizeof</span>(cur));</span><br><span class="line">			flow += DFS(s, INF);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Flow[<span class="number">1000000</span>];</span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> Dif[Maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M) &#123;</span><br><span class="line">		<span class="keyword">const</span> <span class="keyword">int</span> ss = N + <span class="number">1</span>, st = N + <span class="number">2</span>;</span><br><span class="line">		<span class="built_in">memset</span>(Dif, <span class="number">0</span>, <span class="keyword">sizeof</span>(Dif));</span><br><span class="line">		<span class="built_in">memset</span>(Flow, <span class="number">0</span>, <span class="keyword">sizeof</span>(Flow));</span><br><span class="line">		Dinic Din;</span><br><span class="line">		Din.Init(N);</span><br><span class="line">		<span class="keyword">int</span> u, v, b, c;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v &gt;&gt; b &gt;&gt; c;</span><br><span class="line">			Din.AddEdge(u, v, c - b,i);</span><br><span class="line">			Dif[u] -= b;</span><br><span class="line">			Dif[v] += b;</span><br><span class="line">			Flow[i] = b;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (Dif[i] &gt; <span class="number">0</span>) Din.AddEdge(ss, i, Dif[i],<span class="number">0</span>);</span><br><span class="line">			<span class="keyword">if</span> (Dif[i] &lt; <span class="number">0</span>) Din.AddEdge(i, st, -Dif[i],<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		Din.MaxFlow(ss, st);</span><br><span class="line">		<span class="keyword">bool</span> flg = <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;e : Din.G[ss]) &#123;</span><br><span class="line">			<span class="keyword">if</span> (e.f != e.c) &#123;</span><br><span class="line">				flg = <span class="literal">true</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (flg) <span class="built_in">cout</span> &lt;&lt; <span class="string">"NO\n"</span>;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">"YES\n"</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M;++i) <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;e : Din.G[i]) &#123;</span><br><span class="line">				<span class="keyword">if</span> (e.id) Flow[e.id] += e.f;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) <span class="built_in">cout</span> &lt;&lt; Flow[i] &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="有源汇有上下界最大流">有源汇有上下界最大流</h1>
<h2 id="步骤-1">步骤</h2>
<ol type="1">
<li>从t到s连一条流量下界为0，上界INF的边，将其转换为无源汇有上下界的最大流；</li>
<li>按照无源汇有上下界可行流的做法找出可行流（保证了每条边的流量大于下界）；</li>
<li>在2的基础上删除超级源汇点ss、st与附加边（名义上说是要先删除ss、st，但实际上，此时每条附加边已经满流，在运行s-t的最大流时，ss与st的流量不会再变化，所以其实不用做任何操作），从s到t再次寻找一次最大流。（可以直接在上面的建图中运行，然后给每条边加上对应b）。</li>
</ol>
<h2 id="模板题-1">模板题</h2>
<p>在 <span class="math display">\[
大大大大大大\\
大大大大大大\\
大大大大大大\\
大
\]</span> 期间各大学校的OJ都挂了。。。以后更新吧。</p>
<h1 id="有源汇有上下界最小流">有源汇有上下界最小流</h1>
<h2 id="步骤-2">步骤</h2>
<ol type="1">
<li>按照无源汇有上下界的最大流的做法找出可行流（但不要建立t-&gt;s）；</li>
<li>添加t-&gt;s，流量上界INF；</li>
<li>再次运行最大流，找出ss-&gt;st可行流；</li>
<li>若ss不满载，则无可行流。反之，最小流为t-&gt;s的流量，每条边的流量为逆向边的流量（加上下界b）。</li>
</ol>
<h2 id="模板题-2">模板题</h2>
<p>HDU3157 - Crazy Circuits <figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Maxn = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> N, M, S, T, SS, ST;</span><br><span class="line"><span class="keyword">int</span> Dif[Maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">QIn</span><span class="params">(<span class="keyword">int</span> &amp;x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">char</span> c;</span><br><span class="line">	<span class="keyword">while</span> ((c = getchar()) != EOF &amp;&amp; (!<span class="built_in">isdigit</span>(c) &amp;&amp; (c != <span class="string">'+'</span>&amp;&amp;c != <span class="string">'-'</span>)));</span><br><span class="line">	<span class="keyword">switch</span> (c) &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'+'</span>:x = S; <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'-'</span>:x = T; <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">case</span> EOF: <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	x = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		x *= <span class="number">10</span>;</span><br><span class="line">		x += c - <span class="string">'0'</span>;</span><br><span class="line">	&#125; <span class="keyword">while</span> ((c = getchar()) != EOF&amp;&amp;<span class="built_in">isdigit</span>(c));</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> c, f;</span><br><span class="line">	<span class="keyword">unsigned</span> v, flip;</span><br><span class="line">	Edge(<span class="keyword">unsigned</span> v, <span class="keyword">int</span> c, <span class="keyword">int</span> f, <span class="keyword">unsigned</span> flip) :v(v), c(c), f(f), flip(flip) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dinic</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">bool</span> b[Maxn];</span><br><span class="line">	<span class="keyword">int</span> a[Maxn];</span><br><span class="line">	<span class="keyword">unsigned</span> p[Maxn], cur[Maxn], d[Maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">vector</span>&lt;Edge&gt; G[Maxn];</span><br><span class="line">	<span class="keyword">unsigned</span> s, t;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">(<span class="keyword">unsigned</span> n)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">			G[i].clear();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">unsigned</span> u, <span class="keyword">unsigned</span> v, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">		G[u].push_back(Edge(v, c, <span class="number">0</span>, G[v].size()));</span><br><span class="line">		G[v].push_back(Edge(u, <span class="number">0</span>, <span class="number">0</span>, G[u].size() - <span class="number">1</span>));	<span class="comment">//使用无向图时将0改为c即可 </span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">unsigned</span> u, v;</span><br><span class="line">		<span class="built_in">queue</span>&lt;<span class="keyword">unsigned</span>&gt; q;</span><br><span class="line">		<span class="built_in">memset</span>(b, <span class="number">0</span>, <span class="keyword">sizeof</span>(b));</span><br><span class="line">		q.push(s);</span><br><span class="line">		d[s] = <span class="number">0</span>;</span><br><span class="line">		b[s] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">			u = q.front();</span><br><span class="line">			q.pop();</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> it = G[u].begin(); it != G[u].end(); ++it) &#123;</span><br><span class="line">				Edge &amp;e = *it;</span><br><span class="line">				<span class="keyword">if</span> (!b[e.v] &amp;&amp; e.c&gt;e.f) &#123;</span><br><span class="line">					b[e.v] = <span class="number">1</span>;</span><br><span class="line">					d[e.v] = d[u] + <span class="number">1</span>;</span><br><span class="line">					q.push(e.v);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> b[t];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">DFS</span><span class="params">(<span class="keyword">unsigned</span> u, <span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (u == t || a == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> a;</span><br><span class="line">		<span class="keyword">int</span> flow = <span class="number">0</span>, f;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">unsigned</span> &amp;i = cur[u]; i&lt;G[u].size(); ++i) &#123;</span><br><span class="line">			Edge &amp;e = G[u][i];</span><br><span class="line">			<span class="keyword">if</span> (d[u] + <span class="number">1</span> == d[e.v] &amp;&amp; (f = DFS(e.v, min(a, e.c - e.f)))&gt;<span class="number">0</span>) &#123;</span><br><span class="line">				a -= f;</span><br><span class="line">				e.f += f;</span><br><span class="line">				G[e.v][e.flip].f -= f;</span><br><span class="line">				flow += f;</span><br><span class="line">				<span class="keyword">if</span> (!a) <span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">MaxFlow</span><span class="params">(<span class="keyword">unsigned</span> s, <span class="keyword">unsigned</span> t)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> flow = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">this</span>-&gt;s = s;</span><br><span class="line">		<span class="keyword">this</span>-&gt;t = t;</span><br><span class="line">		<span class="keyword">while</span> (BFS()) &#123;</span><br><span class="line">			<span class="built_in">memset</span>(cur, <span class="number">0</span>, <span class="keyword">sizeof</span>(cur));</span><br><span class="line">			flow += DFS(s, INF);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Input</span><span class="params">(Dinic &amp;d)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(Dif, <span class="number">0</span>, <span class="keyword">sizeof</span>(Dif));</span><br><span class="line">	<span class="keyword">int</span> u, v, b;</span><br><span class="line">	<span class="keyword">char</span> c;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</span><br><span class="line">		QIn(u);</span><br><span class="line">		QIn(v);</span><br><span class="line">		QIn(b);</span><br><span class="line">		d.AddEdge(u, v, INF); <span class="comment">//由于无上界，直接写INF好了，反正流量不可能达到INF-b</span></span><br><span class="line">		Dif[u] -= b;</span><br><span class="line">		Dif[v] += b;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>,&amp;N,&amp;M) &amp;&amp; M) &#123; <span class="comment">//N可以等于0！</span></span><br><span class="line">		S = N + <span class="number">1</span>, T = N + <span class="number">2</span>;</span><br><span class="line">		SS = S + <span class="number">2</span>, ST = T + <span class="number">2</span>;</span><br><span class="line">		Dinic D;</span><br><span class="line">		Input(D);</span><br><span class="line">		<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; ++i) &#123; <span class="comment">//建立与超级源汇点ss、st的边（别漏了源汇点！）</span></span><br><span class="line">			<span class="keyword">if</span> (Dif[i] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				D.AddEdge(SS, i, Dif[i]);</span><br><span class="line">				sum += Dif[i];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (Dif[i] &lt; <span class="number">0</span>) D.AddEdge(i, ST, -Dif[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> ans=D.MaxFlow(SS, ST);</span><br><span class="line">		D.AddEdge(T, S, INF);</span><br><span class="line">		ans += D.MaxFlow(SS, ST);</span><br><span class="line">		<span class="keyword">if</span> (ans != sum) &#123;</span><br><span class="line">			<span class="built_in">puts</span>(<span class="string">"impossible"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, D.G[T].rbegin()-&gt;f);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
      </categories>
      <tags>
        <tag>笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>UVA11082 - Matrix Decompressing (上下界网络流)</title>
    <url>/posts/55526.html</url>
    <content><![CDATA[<h1 id="description">Description</h1>
<p><a href="https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=2023" target="_blank" rel="noopener">UVA11082 - Matrix Decompressing</a> Some RxC matrix of positive integers is encoded and represented by its R cumulative row sum and C column sum entries. Given, R, C and those R+C cumulative row sum and column sums, you want to decode the matrix (i.e., find all the individual R * C entries).</p>
<p>In other words, the i-th row sum is the sum of all the entries in row i. And the cumulative i-th row sum is the sum of all the row sums from row 1 to row i (inclusive).</p>
<h1 id="input">Input</h1>
<p>There can be multiple test cases. The first line of input contains the number of test cases, T (1 ≤T ≤ 100). Each test case contains 3 lines of input. The first line of the test case gives the size of the matrix: the number of rows, R (1 ≤ R ≤ 20) and the number of columns C (1 ≤ C ≤20). The next line contains all the R cumulative row sums, and the last line of the test case contains the C cumulative column sums. Any two successive numbers in the same line is separated by a single space.</p>
<h1 id="output">Output</h1>
<p>For each test case print the label of the test case in the first line. The format of this label should be “Matrix x” where x would be replaced by the serial number of the test case starting at 1. In each of the following R lines print C integers giving all the individual entries of the matrix. You can assume that there is at least one solution for each of the given encodings. To simplify the problem further, we add the constraint that each entry in the matrix must be an integer between 1 and 20. In case of multiple solutions, you can output any one of them.</p>
<h1 id="sample-input">Sample Input</h1>
<figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="number">2</span></span><br><span class="line"><span class="symbol">3 </span><span class="number">4</span></span><br><span class="line"><span class="symbol">10 </span><span class="number">31</span> <span class="number">58</span></span><br><span class="line"><span class="symbol">10 </span><span class="number">20</span> <span class="number">37</span> <span class="number">58</span></span><br><span class="line"><span class="symbol">3 </span><span class="number">4</span></span><br><span class="line"><span class="symbol">10 </span><span class="number">31</span> <span class="number">58</span></span><br><span class="line"><span class="symbol">10 </span><span class="number">20</span> <span class="number">37</span> <span class="number">58</span></span><br></pre></td></tr></table></figure>
<h1 id="sample-output">Sample Output</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Matrix <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">6</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">16</span></span><br><span class="line"><span class="number">8</span> <span class="number">2</span> <span class="number">14</span> <span class="number">3</span></span><br><span class="line">Matrix <span class="number">2</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">7</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">7</span> <span class="number">12</span></span><br><span class="line"><span class="number">8</span> <span class="number">8</span> <span class="number">9</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>
<h1 id="key1">Key1</h1>
<p>给一矩阵每一行每一列的和，求一个可行矩阵。行数列数在[1, 20]之间，每个元素大小在[1,20]之间。</p>
<p>从输入可以得到没一行、每一列的和。以行、列建立二分图。以所有行、所有列为结点，建立源汇点s、t。s向所有行结点建边，上界为该行的和。所有列结点向t建边，上界为该列的和。所有行向所有列建边，上界为20。 由于矩阵每个元素都大于零，可以知道，每条行-列的边下界为1。</p>
<p>使用有源汇有上下界的最大流的方法。s-&gt;每个行结点 的c减去m，每个行节点-&gt;每个列结点的c减去1（则都变成了19），每个列结点-&gt;t的c减去n。然后就是按照通用方法连接t-&gt;s，建立超级源汇点ss、st并建立附加边，运行maxflow(ss, st)，然后去除附加边与ss、st，再次运行maxflow(s, t)。行节点-&gt;列结点的flow+1即为矩阵元素值。</p>
<h1 id="code1">Code1</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x7FFFFFFF</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> c, f;</span><br><span class="line">	<span class="keyword">unsigned</span> v, flip;</span><br><span class="line">	Edge(<span class="keyword">unsigned</span> v, <span class="keyword">int</span> c, <span class="keyword">int</span> f, <span class="keyword">unsigned</span> flip) :v(v), c(c), f(f), flip(flip) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dinic</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">bool</span> b[maxn];</span><br><span class="line">	<span class="keyword">int</span> a[maxn];</span><br><span class="line">	<span class="keyword">unsigned</span> p[maxn], cur[maxn], d[maxn];</span><br><span class="line">	<span class="built_in">vector</span>&lt;Edge&gt; G[maxn];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">unsigned</span> s, t;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">(<span class="keyword">unsigned</span> n)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">			G[i].clear();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">unsigned</span> u, <span class="keyword">unsigned</span> v, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">		G[u].push_back(Edge(v, c, <span class="number">0</span>, G[v].size()));</span><br><span class="line">		G[v].push_back(Edge(u, <span class="number">0</span>, <span class="number">0</span>, G[u].size() - <span class="number">1</span>));	<span class="comment">//使用无向图时将0改为c即可 </span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">BFS</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">unsigned</span> u, v;</span><br><span class="line">		<span class="built_in">queue</span>&lt;<span class="keyword">unsigned</span>&gt; q;</span><br><span class="line">		<span class="built_in">memset</span>(b, <span class="number">0</span>, <span class="keyword">sizeof</span>(b));</span><br><span class="line">		q.push(s);</span><br><span class="line">		d[s] = <span class="number">0</span>;</span><br><span class="line">		b[s] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">			u = q.front();</span><br><span class="line">			q.pop();</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> it = G[u].begin(); it != G[u].end(); ++it) &#123;</span><br><span class="line">				Edge &amp;e = *it;</span><br><span class="line">				<span class="keyword">if</span> (!b[e.v] &amp;&amp; e.c&gt;e.f) &#123;</span><br><span class="line">					b[e.v] = <span class="number">1</span>;</span><br><span class="line">					d[e.v] = d[u] + <span class="number">1</span>;</span><br><span class="line">					q.push(e.v);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> b[t];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">DFS</span><span class="params">(<span class="keyword">unsigned</span> u, <span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (u == t || a == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> a;</span><br><span class="line">		<span class="keyword">int</span> flow = <span class="number">0</span>, f;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">unsigned</span> &amp;i = cur[u]; i&lt;G[u].size(); ++i) &#123;</span><br><span class="line">			Edge &amp;e = G[u][i];</span><br><span class="line">			<span class="keyword">if</span> (d[u] + <span class="number">1</span> == d[e.v] &amp;&amp; (f = DFS(e.v, min(a, e.c - e.f)))&gt;<span class="number">0</span>) &#123;</span><br><span class="line">				a -= f;</span><br><span class="line">				e.f += f;</span><br><span class="line">				G[e.v][e.flip].f -= f;</span><br><span class="line">				flow += f;</span><br><span class="line">				<span class="keyword">if</span> (!a) <span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">MaxFlow</span><span class="params">(<span class="keyword">unsigned</span> s, <span class="keyword">unsigned</span> t)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> flow = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">this</span>-&gt;s = s;</span><br><span class="line">		<span class="keyword">this</span>-&gt;t = t;</span><br><span class="line">		<span class="keyword">while</span> (BFS()) &#123;</span><br><span class="line">			<span class="built_in">memset</span>(cur, <span class="number">0</span>, <span class="keyword">sizeof</span>(cur));</span><br><span class="line">			flow += DFS(s, INF);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> flow;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Dif[maxn];</span><br><span class="line"><span class="keyword">int</span> T, R, C;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; ++Case) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;R, &amp;C);</span><br><span class="line">		<span class="built_in">memset</span>(Dif, <span class="number">0</span>, <span class="keyword">sizeof</span>(Dif));</span><br><span class="line">		Dinic din;</span><br><span class="line">		<span class="keyword">const</span> <span class="keyword">int</span> s = R + C + <span class="number">1</span>, t = R + C + <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">const</span> <span class="keyword">int</span> ss = s+<span class="number">2</span>, st = t + <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">int</span> ipt, last_ipt;</span><br><span class="line">		last_ipt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; ++i) &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;ipt);</span><br><span class="line">			din.AddEdge(s, i, ipt - last_ipt - C);</span><br><span class="line">			last_ipt = ipt;</span><br><span class="line">			Dif[s] -= C;</span><br><span class="line">			Dif[i] += C;</span><br><span class="line">		&#125;</span><br><span class="line">		last_ipt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= C; ++i) &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;ipt);</span><br><span class="line">			din.AddEdge(R + i, t, ipt - last_ipt - R);</span><br><span class="line">			last_ipt = ipt;</span><br><span class="line">			Dif[R + i] -= R;</span><br><span class="line">			Dif[t] += R;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; ++i) <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= C; ++j) &#123;</span><br><span class="line">			din.AddEdge(i, R + j, <span class="number">20</span> - <span class="number">1</span>);</span><br><span class="line">			Dif[i] -= <span class="number">1</span>;</span><br><span class="line">			Dif[R + j] += <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		din.AddEdge(t, s, INF);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R*C+<span class="number">2</span>; ++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (Dif[i] &gt; <span class="number">0</span>) din.AddEdge(ss, i, Dif[i]);</span><br><span class="line">			<span class="keyword">if</span> (Dif[i] &lt; <span class="number">0</span>) din.AddEdge(i, st, -Dif[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		din.MaxFlow(ss, st);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;e : din.G[ss]) din.G[e.v][e.flip].f = din.G[e.v][e.flip].c = e.c = e.f = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;e : din.G[st]) din.G[e.v][e.flip].f = din.G[e.v][e.flip].c = e.c = e.f = <span class="number">0</span>;</span><br><span class="line">		din.MaxFlow(s, t);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Matrix %d\n"</span>, Case);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; ++i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;e : din.G[i]) <span class="keyword">if</span> (e.c) &#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%d "</span>, e.f + <span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="key2">Key2</h1>
<p>上述有源汇有上下界最大流的通用解法之所以通用，是因为“上界减去下界后图中的流量不一定平衡”。而本题的每条边的流量下界被减去后，流量依然是平衡的，所以可以优化。（即上述代码运行完后会发现，Dif[i]均为0，即ss和st没有边连接原图。）</p>
<p>在把s-&gt;行的c减去m、行-&gt;列的c减去1、列-&gt;t的c减去n后，直接运行maxflow(s, t)，行-&gt;列的flow加上1即为答案。</p>
<h1 id="code2">Code2</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//main函数之前内容一样</span></span><br><span class="line"><span class="keyword">int</span> T, R, C;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; ++Case) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;R, &amp;C);</span><br><span class="line">		Dinic din;</span><br><span class="line">		<span class="keyword">const</span> <span class="keyword">int</span> s = R + C + <span class="number">1</span>, t = R + C + <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">int</span> ipt, last_ipt;</span><br><span class="line">		last_ipt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; ++i) &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;ipt);</span><br><span class="line">			din.AddEdge(s, i, ipt - last_ipt-C);</span><br><span class="line">			last_ipt = ipt;</span><br><span class="line">		&#125;</span><br><span class="line">		last_ipt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= C; ++i) &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;ipt);</span><br><span class="line">			din.AddEdge(R + i, t, ipt - last_ipt-R);</span><br><span class="line">			last_ipt = ipt;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; ++i) <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= C;++j) &#123;</span><br><span class="line">			din.AddEdge(i, R + j, <span class="number">20</span><span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		din.MaxFlow(s, t);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Matrix %d\n"</span>, Case);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= R; ++i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;e : din.G[i]) <span class="keyword">if</span> (e.c) &#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%d "</span>, e.f+<span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>UVa</category>
      </categories>
      <tags>
        <tag>UVa</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces Round 441(Div. 2) - D. Sorting the Coins</title>
    <url>/posts/39930.html</url>
    <content><![CDATA[<h1 id="description">Description</h1>
<p>Recently, Dima met with Sasha in a philatelic store, and since then they are collecting coins together. Their favorite occupation is to sort collections of coins. Sasha likes having things in order, that is why he wants his coins to be arranged in a row in such a way that firstly come coins out of circulation, and then come coins still in circulation.</p>
<p>For arranging coins Dima uses the following algorithm. One step of his algorithm looks like the following:</p>
<p>He looks through all the coins from left to right; If he sees that the i-th coin is still in circulation, and (i + 1)-th coin is already out of circulation, he exchanges these two coins and continues watching coins from (i + 1)-th. Dima repeats the procedure above until it happens that no two coins were exchanged during this procedure. Dima calls hardness of ordering the number of steps required for him according to the algorithm above to sort the sequence, e.g. the number of times he looks through the coins from the very beginning. For example, for the ordered sequence hardness of ordering equals one.</p>
<p>Today Sasha invited Dima and proposed him a game. First he puts n coins in a row, all of them are out of circulation. Then Sasha chooses one of the coins out of circulation and replaces it with a coin in circulation for n times. During this process Sasha constantly asks Dima what is the hardness of ordering of the sequence.</p>
<p>The task is more complicated because Dima should not touch the coins and he should determine hardness of ordering in his mind. Help Dima with this task.</p>
<h1 id="input">Input</h1>
<p>The first line contains single integer n (1 ≤ n ≤ 300 000) — number of coins that Sasha puts behind Dima.</p>
<p>Second line contains n distinct integers p1, p2, ..., pn (1 ≤ pi ≤ n) — positions that Sasha puts coins in circulation to. At first Sasha replaces coin located at position p1, then coin located at position p2 and so on. Coins are numbered from left to right.</p>
<h1 id="output">Output</h1>
<p>Print n + 1 numbers a0, a1, ..., an, where a0 is a hardness of ordering at the beginning, a1 is a hardness of ordering after the first replacement and so on.</p>
<h1 id="examples">Examples</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">input</span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">1</span> <span class="number">3</span> <span class="number">4</span> <span class="number">2</span></span><br><span class="line">output</span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">input</span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="number">6</span> <span class="number">8</span> <span class="number">3</span> <span class="number">4</span> <span class="number">7</span> <span class="number">2</span> <span class="number">1</span> <span class="number">5</span></span><br><span class="line">output</span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h1 id="note">Note</h1>
<p>Let's denote as O coin out of circulation, and as X — coin is circulation.</p>
<p>At the first sample, initially in row there are coins that are not in circulation, so Dima will look through them from left to right and won't make any exchanges.</p>
<p>After replacement of the first coin with a coin in circulation, Dima will exchange this coin with next three times and after that he will finally look through the coins and finish the process.</p>
<p>XOOO  →  OOOX</p>
<p>After replacement of the third coin, Dima's actions look this way:</p>
<p>XOXO  →  OXOX  →  OOXX</p>
<p>After replacement of the fourth coin, Dima's actions look this way:</p>
<p>XOXX  →  OXXX</p>
<p>Finally, after replacement of the second coin, row becomes consisting of coins that are in circulation and Dima will look through coins from left to right without any exchanges.</p>
<h1 id="key">Key</h1>
<p>读题读了半天才懂。n个硬币O面朝上排成一个序列。游戏一共n轮，在每一轮的一开始，所有硬币O面朝上，然后把第p[1]~p[i]个硬币（共i个硬币）翻转为X面。然后进行如下操作： 从左往右遍历整个序列，如果第j个硬币为X且第j+1个硬币为O，交换两者，然后从j+1个硬币继续进行。 持续进行上述遍历，直至最后一遍遍历没有交换任何硬币。把第i轮进行的遍历次数记为a[i]。要求求出每一轮游戏的a[i]（以及初始状态下的遍历次数a[0]）。</p>
<p>规律是，找出序列最右的O的下标idx（则其右侧为一个连续的X序列或为空），每一轮维护之。计算idx左边有多少X即可。实际计算时，只需判断当前轮翻转的硬币是否使得idx向左移动，若是，a[i]=a[i-1]+1-(new_idx-idx)。否则，a[i]=a[i-1]+1。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">300000</span> + <span class="number">17</span>;</span><br><span class="line"><span class="keyword">int</span> n, p;</span><br><span class="line"><span class="keyword">bool</span> s[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="keyword">int</span> idx = n + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"1"</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; p;</span><br><span class="line">		s[p] = <span class="literal">true</span>;</span><br><span class="line">		++res;</span><br><span class="line">		<span class="keyword">if</span> (idx == p + <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">int</span> pre_idx = idx;</span><br><span class="line">			<span class="keyword">while</span> (s[--pre_idx]);</span><br><span class="line">			++pre_idx;</span><br><span class="line">			res -= idx - pre_idx;</span><br><span class="line">			idx = pre_idx;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; res;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>2017 ACM Qingdao Online - Brute Force Sorting</title>
    <url>/posts/63088.html</url>
    <content><![CDATA[<p>2017 ACM-ICPC Asia Regional Qingdao Online - 1010 - Brute Force Sorting（HDU6215）</p>
<p><strong>Time Limit: 1000/1000 MS (Java/Others) Memory Limit: 65535/32768 K (Java/Others)Total Submission(s): 1195 Accepted Submission(s): 309</strong></p>
<h1 id="problem-description">Problem Description</h1>
<p>Beerus needs to sort an array of N integers. Algorithms are not Beerus's strength. Destruction is what he excels. He can destroy all unsorted numbers in the array simultaneously. A number A[i] of the array is sorted if it satisfies the following requirements. 1. A[i] is the first element of the array, or it is no smaller than the left one A[i−1]. 2. A[i] is the last element of the array, or it is no bigger than the right one A[i+1]. In [1,4,5,2,3], for instance, the element 5 and the element 2 would be destoryed by Beerus. The array would become [1,4,3]. If the new array were still unsorted, Beerus would do it again. Help Beerus predict the final array.</p>
<h1 id="input">Input</h1>
<p>The first line of input contains an integer T (1≤T≤10) which is the total number of test cases. For each test case, the first line provides the size of the inital array which would be positive and no bigger than 100000. The second line describes the array with N positive integers A[1],A[2],⋯,A[N] where each integer A[i] satisfies 1≤A[i]≤100000.</p>
<h1 id="output">Output</h1>
<p>For eact test case output two lines. The first line contains an integer M which is the size of the final array. The second line contains M integers describing the final array. If the final array is empty, M should be 0 and the second line should be an empty line.</p>
<h1 id="sample-input">Sample Input</h1>
<figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="symbol">5 </span><span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">2</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">3</span> <span class="number">5</span> <span class="number">4</span> <span class="number">2</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="symbol">2 </span><span class="number">4</span> <span class="number">1</span> <span class="number">3</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>
<h1 id="sample-output">Sample Output</h1>
<figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="number">5</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> </span><br><span class="line"><span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">2</span> </span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">3</span> </span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="symbol">2 </span><span class="number">3</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>
<h1 id="source">Source</h1>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2017+ACM%2FICPC+Asia+Regional+Qingdao+Online&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2017 ACM/ICPC Asia Regional Qingdao Online</a></p>
<h1 id="key">Key</h1>
<p>比赛时想不出怎么做，暴力模拟了一遍，果不其然TLE。。。。大佬对我表示很无奈。</p>
<blockquote>
<p>大佬：不是让你这么模拟啊！！！</p>
</blockquote>
<p>大佬提醒说用个审查队列维护，猛然醒悟。。。事后看了大佬的AC代码，又自己撸了一遍，终于AC了。（以及大佬的代码是真的优美）</p>
<p>用链表模拟，方便删除。关键点：模拟的时候用一个审查队列维护下一轮需要更新（可能删除）的点。每一轮删除都O(n)检查整个剩余序列肯定是不行的，把可能需要删除的点加入审查队列，每次只要检查队列里的每个元素即可。</p>
<p>哪些属于下一轮可能删除的点呢？上一轮删除的结点的左右结点。以及有一些小坑要注意。以下是我事后的AC的代码。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Maxn = <span class="number">100000</span> + <span class="number">23</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">	Node *l, *r;</span><br><span class="line">	<span class="keyword">int</span> v;</span><br><span class="line">	Node(<span class="keyword">int</span> _v, Node *_l) :v(_v), l(_l), r(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, N;</span><br><span class="line"></span><br><span class="line"><span class="built_in">queue</span>&lt;Node*&gt; ToDel, ToChk;</span><br><span class="line">Node *head;</span><br><span class="line"></span><br><span class="line"><span class="function">Node *<span class="title">Del</span><span class="params">(Node *p)</span> </span>&#123;</span><br><span class="line">	Node *pl = p-&gt;l;</span><br><span class="line">	Node *pr = p-&gt;r;</span><br><span class="line">	pl-&gt;r = pr;</span><br><span class="line">	pr-&gt;l = pl;</span><br><span class="line">	<span class="keyword">delete</span> p;</span><br><span class="line">	<span class="keyword">return</span> pl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Input</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N;</span><br><span class="line">	head = <span class="keyword">new</span> Node(<span class="number">0</span>, <span class="literal">nullptr</span>);</span><br><span class="line">	Node *now = head;</span><br><span class="line">	<span class="keyword">int</span> v;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; v;</span><br><span class="line">		now-&gt;r = <span class="keyword">new</span> Node(v, now);</span><br><span class="line">		now = now-&gt;r;</span><br><span class="line">	&#125;</span><br><span class="line">	now-&gt;r = <span class="keyword">new</span> Node(Maxn, now);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">	Node *i;</span><br><span class="line">	<span class="keyword">for</span> (i = head-&gt;r; i-&gt;v != Maxn; i = i-&gt;r) ++num;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; num &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (i = head-&gt;r; i-&gt;v != Maxn; i = i-&gt;r) &#123;</span><br><span class="line">		<span class="keyword">delete</span> i-&gt;l;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; i-&gt;v &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">delete</span> i;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span> (T--) &#123;</span><br><span class="line">		Input();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (Node *i = head-&gt;r; i-&gt;v != Maxn; i = i-&gt;r) &#123;</span><br><span class="line">			<span class="keyword">if</span> (i-&gt;v &lt; i-&gt;l-&gt;v || i-&gt;v &gt; i-&gt;r-&gt;v) &#123;</span><br><span class="line">				ToDel.push(i);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> (!ToDel.empty()) &#123;</span><br><span class="line">			<span class="keyword">do</span> &#123;</span><br><span class="line">				Node *now = ToDel.front();</span><br><span class="line">				ToDel.pop();</span><br><span class="line">				Node *pre = now-&gt;l;</span><br><span class="line">				Node *nxt = now-&gt;r;</span><br><span class="line">				Del(now);</span><br><span class="line">				<span class="keyword">if</span> (pre-&gt;v != <span class="number">0</span> &amp;&amp; (ToChk.empty() || ToChk.back() != pre)) ToChk.push(pre);</span><br><span class="line">				<span class="keyword">if</span> (nxt-&gt;v != Maxn &amp;&amp; (ToDel.empty() || ToDel.front() != nxt)) ToChk.push(nxt);</span><br><span class="line">			&#125; <span class="keyword">while</span> (!ToDel.empty());</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span> (!ToChk.empty()) &#123;</span><br><span class="line">				Node *now = ToChk.front();</span><br><span class="line">				ToChk.pop();</span><br><span class="line">				Node *pre = now-&gt;l;</span><br><span class="line">				Node *nxt = now-&gt;r;</span><br><span class="line">				<span class="keyword">if</span> (now-&gt;v&lt;pre-&gt;v || now-&gt;v&gt;nxt-&gt;v) ToDel.push(now);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		Output();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>ACM</category>
      </categories>
      <tags>
        <tag>ACM</tag>
      </tags>
  </entry>
  <entry>
    <title>Python实现备份CSDN博客(未完成)</title>
    <url>/posts/12203.html</url>
    <content><![CDATA[<p>想着把我CSDN上所有博客的markdown源文件备份一遍，但其实没学过这方面的东西，就做了个半成品。。。以后完善吧（应该）</p>
<p>实现了提取所有文章的名字与其对应文章ID和发布时间，并找到编辑文档的网页。 <img src="/posts/12203/1.png" alt="1"></p>
<p>上面这些信息提取很方便，网页源码里翻就找得到。 然后按照文件名与日期给每一篇文章建立每一个空文件夹。 <img src="/posts/12203/2.png" alt="2"></p>
<p>但是最关键的一步是，我不知道怎么提取每一篇.md文件。。。 渲染好的已经发布的文本我不要，我要.md源文件。只有编辑文本的时候遇得到md文件，所以就得实现模拟浏览器登陆。。。然而并不会做。。。 <code>http://write.blog.csdn.net/postedit/xxxxxxxx</code>是文章的编辑页面，（打开来可以是markdown编辑器也可以是传统的那个），传统的编辑器的源码里倒是可以看到带样式的每个字，但是md编辑器的源码里面就没有。。。</p>
<p>md编辑器有个功能叫导出到本地，可以直接把.md文件下载下来。但是每次下载生成的链接都是随机的，我也不知道怎么找到这个函数。</p>
<p>有没有大神会的求留言:P。</p>
<p>半成品代码： <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Created on 2017年8月19日</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@author: XieNaoban</span></span><br><span class="line"><span class="string">@github: https://github.com/xienaoban</span></span><br><span class="line"><span class="string">@blog: http://blog.csdn.net/xienaoban</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="comment">#########################################################################</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(str)</span>:</span></span><br><span class="line">    print(<span class="string">"log: "</span> + str + <span class="string">"."</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#########################################################################</span></span><br><span class="line"><span class="comment">#参数设定</span></span><br><span class="line">auth = <span class="string">"xienaoban"</span></span><br><span class="line">wsp = <span class="string">"C:\\Users\\xjf19\\Desktop\\"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#########################################################################</span></span><br><span class="line">s = urllib.request.urlopen(<span class="string">"http://blog.csdn.net/"</span> + auth).read().decode(<span class="string">'utf-8'</span>)</span><br><span class="line">pages = ord(s[s.find(<span class="string">"尾页"</span>) - <span class="number">3</span>]) - ord(<span class="string">'0'</span>) + <span class="number">1</span></span><br><span class="line">fout = open(wsp + <span class="string">"articles.txt"</span>,<span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">log(str(pages) + <span class="string">" page(s) found"</span>)</span><br><span class="line"></span><br><span class="line">key = <span class="string">"&lt;span class=\"link_title\"&gt;&lt;a href=\"/"</span> + auth + <span class="string">"/article/details/"</span></span><br><span class="line">key2 = <span class="string">"link_postdate"</span></span><br><span class="line">edit = <span class="string">"http://write.blog.csdn.net/postedit/"</span></span><br><span class="line">articles = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> page <span class="keyword">in</span> range(<span class="number">1</span>, pages):</span><br><span class="line">    url = <span class="string">"http://blog.csdn.net/"</span> + auth + <span class="string">"/article/list/"</span>+str(page)</span><br><span class="line">    sc = urllib.request.urlopen(url).read().decode(<span class="string">'utf-8'</span>)</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        tmp = sc.find(key, i)</span><br><span class="line">        <span class="keyword">if</span>(tmp &lt; i): <span class="keyword">break</span></span><br><span class="line">        i = tmp + len(key)</span><br><span class="line">        fout.write(edit)</span><br><span class="line">        <span class="keyword">while</span> sc[i]!=<span class="string">'\"'</span>:</span><br><span class="line">            fout.write(sc[i])</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        i += <span class="number">12</span></span><br><span class="line">        </span><br><span class="line">        d = sc.find(key2, i) + len(key2) + <span class="number">2</span></span><br><span class="line">        fout.write(<span class="string">"    "</span> + sc[d]+sc[d+<span class="number">1</span>]+sc[d+<span class="number">2</span>]+sc[d+<span class="number">3</span>] + sc[d+<span class="number">5</span>]+sc[d+<span class="number">6</span>] + sc[d+<span class="number">8</span>]+sc[d+<span class="number">9</span>])</span><br><span class="line">        </span><br><span class="line">        ed = sc.find(<span class="string">"&lt;/a&gt;"</span>,i) - <span class="number">22</span></span><br><span class="line">        <span class="keyword">while</span> i != ed:</span><br><span class="line">            <span class="keyword">if</span> sc[i] !=<span class="string">'/'</span> <span class="keyword">and</span> sc[i] != <span class="string">'*'</span> <span class="keyword">and</span> sc[i] != <span class="string">'?'</span>: fout.write(sc[i])</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        fout.write(<span class="string">"\n"</span>)</span><br><span class="line">        articles += <span class="number">1</span></span><br><span class="line">fout.close()</span><br><span class="line">log(str(articles) + <span class="string">" article(s) found"</span>)</span><br><span class="line"></span><br><span class="line">fin = open(wsp + <span class="string">"articles.txt"</span>, <span class="string">"r"</span>, encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">wsp += <span class="string">"Blog\\"</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(wsp): os.mkdir(wsp)</span><br><span class="line">new_dir = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> arti <span class="keyword">in</span> range(<span class="number">0</span>, articles):</span><br><span class="line">    line = fin.readline()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> line: <span class="keyword">break</span></span><br><span class="line">    line = line[len(edit) + <span class="number">4</span> + <span class="number">8</span>:<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(wsp + line):</span><br><span class="line">        os.mkdir(wsp + line)</span><br><span class="line">        new_dir += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">log(str(new_dir) + <span class="string">" directory(s) added"</span>)</span><br><span class="line">log(<span class="string">"program finished"</span>)</span><br><span class="line"><span class="comment">#########################################################################</span></span><br></pre></td></tr></table></figure></p>
]]></content>
      <tags>
        <tag>造轮子</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>ACM ICPC 2015合肥网络赛 - Removed Interval</title>
    <url>/posts/21829.html</url>
    <content><![CDATA[<h1 id="problem-description">Problem Description</h1>
<p>Given a sequence of numbers A=a1,a2,…,aN, a subsequence b1,b2,…,bk of A is referred as increasing if b1&lt;b2&lt;…&lt;bk. LY has just learned how to find the longest increasing subsequence (LIS). Now that he has to select L consecutive numbers and remove them from A for some mysterious reasons. He can choose arbitrary starting position of the selected interval so that the length of the LIS of the remaining numbers is maximized. Can you help him with this problem?</p>
<h1 id="input">Input</h1>
<p>The first line of input contains a number T indicating the number of test cases (T≤100). For each test case, the first line consists of two numbers N and L as described above (1≤N≤100000,0≤L≤N). The second line consists of N integers indicating the sequence. The absolute value of the numbers is no greater than <span class="math inline">\(10^9\)</span>. The sum of N over all test cases will not exceed 500000.</p>
<h1 id="output">Output</h1>
<p>For each test case, output a single line consisting of “Case #X: Y”. X is the test case number starting from 1. Y is the maximum length of LIS after removing the interval.</p>
<h1 id="sample-input">Sample Input</h1>
<figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="number">2</span></span><br><span class="line"><span class="symbol">5 </span><span class="number">2</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="symbol">5 </span><span class="number">3</span></span><br><span class="line"><span class="symbol">5 </span><span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h1 id="sample-output">Sample Output</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Case #<span class="number">1</span>: <span class="number">3</span></span><br><span class="line">Case #<span class="number">2</span>: <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h1 id="source">Source</h1>
<p><a href="http://acm.hdu.edu.cn/search.php?field=problem&amp;key=2015+ACM%2FICPC+Asia+Regional+Hefei+Online&amp;source=1&amp;searchmode=source" target="_blank" rel="noopener">2015 ACM/ICPC Asia Regional Hefei Online</a></p>
<h1 id="key">Key</h1>
<p>啊被这题折磨了两天。最后发现是我数据范围错了。。题目说“The absolute value of the numbers is no greater than <span class="math inline">\(10^9\)</span>”，我理解成<span class="math inline">\([1,1^9)\)</span>了。。。</p>
<p>LIS题的一个变种。用<span class="math inline">\(O(n^2)\)</span>的DP做是没法做的，<span class="math inline">\(O(n^2)\)</span>本身就超时了，更别说别的处理。得用<span class="math inline">\(O(n \log n)\)</span>的那个算法。</p>
<p>基本思路是，先计算出以每个<span class="math inline">\(A[i]\)</span>为开头的LIS（即从右向左找以<span class="math inline">\(A[i]\)</span>结尾的最大降序子序列）。 然后枚举所有挖掉的连续字串的位置：对于挖掉的<span class="math inline">\([i-L, i-1]\)</span> <span class="math inline">\((i&gt;L)\)</span>，LIS最大值为右侧以<span class="math inline">\(A[i]\)</span>打头时的LIS加上左侧以比<span class="math inline">\(A[i]\)</span>小的值结尾的最大LIS。</p>
<p>于是关键是怎么在左侧找出一个以<span class="math inline">\(A[i-L-1]\)</span>结尾的LIS，要求LIS尽量大且<span class="math inline">\(A[i-L-1]&lt;A[i]\)</span>。查了题解，才知道可以利用那个<span class="math inline">\(O(n \log n)\)</span>算法，二分找出在左侧x个值中小于A[i]的最大LIS。真是太强了。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Maxn = <span class="number">100000</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, N, L;</span><br><span class="line"><span class="keyword">int</span> A[Maxn], LIS[Maxn], BG[Maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("F:\\Projects\\ConsoleApplication2\\ConsoleApplication2\\in.txt", "r", stdin);</span></span><br><span class="line">	<span class="comment">//freopen("F:\\Projects\\Debug Tools\\Comparison1.txt", "w", stdout);</span></span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> Case = <span class="number">1</span>; Case &lt;= T; ++Case) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; L;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; A[i];</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> len, idx;</span><br><span class="line">		len = <span class="number">1</span>;</span><br><span class="line">		LIS[<span class="number">0</span>] = <span class="number">0x7fffffff</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">			idx = lower_bound(LIS, LIS + len, A[i], greater&lt;<span class="keyword">int</span>&gt;()) - LIS;</span><br><span class="line">			<span class="keyword">if</span> (idx == len) ++len;</span><br><span class="line">			LIS[idx] = A[i];</span><br><span class="line">			BG[i] = idx;</span><br><span class="line">			<span class="keyword">if</span> (i &gt;= L) res = max(res, idx);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		len = <span class="number">1</span>;</span><br><span class="line">		LIS[<span class="number">0</span>] = <span class="number">0x80000000</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = L; i &lt; N; ++i) &#123;</span><br><span class="line">			idx = lower_bound(LIS, LIS + len, A[i], less&lt;<span class="keyword">int</span>&gt;()) - LIS;</span><br><span class="line">			res = max(res, BG[i] + idx - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">			idx = lower_bound(LIS, LIS + len, A[i - L], less&lt;<span class="keyword">int</span>&gt;()) - LIS;</span><br><span class="line">			<span class="keyword">if</span> (idx == len) ++len;</span><br><span class="line">			LIS[idx] = A[i - L];</span><br><span class="line">			res = max(res, idx);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>, Case, res);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>ACM</category>
      </categories>
      <tags>
        <tag>ACM</tag>
      </tags>
  </entry>
  <entry>
    <title>2017百度之星资格赛 - 度度熊与邪恶大魔王</title>
    <url>/posts/30936.html</url>
    <content><![CDATA[<h1 id="problem-description">Problem Description</h1>
<p>度度熊为了拯救可爱的公主，于是与邪恶大魔王战斗起来。 邪恶大魔王的麾下有n个怪兽，每个怪兽有a[i]的生命值，以及b[i]的防御力。 度度熊一共拥有m种攻击方式，第i种攻击方式，需要消耗k[i]的晶石，造成p[i]点伤害。 当然，如果度度熊使用第i个技能打在第j个怪兽上面的话，会使得第j个怪兽的生命值减少p[i]-b[j]，当然如果伤害小于防御，那么攻击就不会奏效。 如果怪兽的生命值降为0或以下，那么怪兽就会被消灭。 当然每个技能都可以使用无限次。 请问度度熊最少携带多少晶石，就可以消灭所有的怪兽。</p>
<h1 id="input">Input</h1>
<p>本题包含若干组测试数据。 第一行两个整数n，m,表示有n个怪兽，m种技能。 接下来n行，每行两个整数，a[i],b[i]，分别表示怪兽的生命值和防御力。 再接下来m行，每行两个整数k[i]和p[i]，分别表示技能的消耗晶石数目和技能的伤害值。</p>
<p>数据范围: 1&lt;=n&lt;=100000 1&lt;=m&lt;=1000 1&lt;=a[i]&lt;=1000 0&lt;=b[i]&lt;=10 0&lt;=k[i]&lt;=100000 0&lt;=p[i]&lt;=1000</p>
<h1 id="output">Output</h1>
<p>对于每组测试数据，输出最小的晶石消耗数量，如果不能击败所有的怪兽，输出-1</p>
<h1 id="sample-input">Sample Input</h1>
<figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="symbol">1 </span><span class="number">2</span></span><br><span class="line"><span class="symbol">3 </span><span class="number">5</span></span><br><span class="line"><span class="symbol">7 </span><span class="number">10</span></span><br><span class="line"><span class="symbol">6 </span><span class="number">8</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">2</span></span><br><span class="line"><span class="symbol">3 </span><span class="number">5</span></span><br><span class="line"><span class="symbol">10 </span><span class="number">7</span></span><br><span class="line"><span class="symbol">8 </span><span class="number">6</span></span><br></pre></td></tr></table></figure>
<h1 id="sample-output">Sample Output</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">18</span></span><br></pre></td></tr></table></figure>
<h1 id="key">Key</h1>
<p>完全背包DP。防御力最高就10，则枚举每个防御力的情况。</p>
<p>在每个防御力b下，枚举所有技能，对于第c个攻击： 令<code>atk=p[c]-b</code>，DP血量a从1到1000， 若血量小于等于atk（一刀秒杀），则<code>dp[a] = min(dp[a], k[c])</code>； 若血量大于atk，则<code>dp[a] = min(dp[a], dp[a-atk] + k[c])</code>； 统计b防御力的所有怪物血量与其对应所需最小晶石。</p>
<p>若在b防御力下所有怪物的防御力均大于大于所有技能，则输出-1。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">100000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxm = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line">LL num[<span class="number">1000</span> + <span class="number">10</span>][<span class="number">13</span>];</span><br><span class="line">LL k[maxm], p[maxm];</span><br><span class="line">LL dp[<span class="number">1000</span> + <span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m) &#123;</span><br><span class="line">		<span class="built_in">memset</span>(num, <span class="number">0</span>, <span class="keyword">sizeof</span>(num));</span><br><span class="line">		LL ipt1, ipt2;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; ipt1 &gt;&gt; ipt2;</span><br><span class="line">			++num[ipt1][ipt2];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; k[i] &gt;&gt; p[i];</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		LL res = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> b = <span class="number">0</span>; b &lt;= <span class="number">10</span>; ++b) &#123;</span><br><span class="line">			<span class="built_in">memset</span>(dp, <span class="number">0x7f</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">			dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">bool</span> fail = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">0</span>; c &lt; m; ++c) &#123;</span><br><span class="line">				LL atk = p[c] - b;</span><br><span class="line">				<span class="keyword">if</span> (atk &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				fail = <span class="literal">false</span>;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> a = <span class="number">1</span>; a &lt;= <span class="number">1000</span>; ++a) &#123;</span><br><span class="line">					<span class="keyword">if</span> (a - atk &lt;= <span class="number">0</span>)dp[a] = min(dp[a], k[c]);</span><br><span class="line">					<span class="keyword">else</span> &#123;</span><br><span class="line">						dp[a] = min(dp[a], dp[a - atk] + k[c]);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (fail) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">1000</span>; ++i) &#123;</span><br><span class="line">					<span class="keyword">if</span> (num[i][b]) <span class="keyword">goto</span> NOO;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">1000</span>; ++i) &#123;</span><br><span class="line">					res += num[i][b] * dp[i];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		<span class="keyword">continue</span>;</span><br><span class="line">	NOO:<span class="built_in">cout</span> &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
      </categories>
  </entry>
  <entry>
    <title>Win10一周年更新冻屏可能原因解决方案</title>
    <url>/posts/41520.html</url>
    <content><![CDATA[<p>辣鸡Win10要折腾死我啊。一开始还以为硬件烧坏了。写下来方自己以后使用。</p>
<h1 id="条件">条件</h1>
<ol type="1">
<li>win10一周年更新；</li>
<li>SSD、HDD混合，SSD作为系统盘</li>
<li>BIOS的：AHCI、SATA、IDE模式：BIOS里面没找到这玩意。。。Acer宏碁VN7的笔记本，BIOS里面选项很少，仿佛很老旧的感觉。。。</li>
<li>设备管理器-&gt;IDE ATA/ATAPI 控制器驱动：标准 SATA AHCI 控制器。</li>
</ol>
<h1 id="症状">症状</h1>
<p>长时间挂机导致冻屏：比如启动了电脑而没有登陆，过一会回来登录界面就卡住了；又比如开着电脑出去了一趟，回来就卡住了。 卡住的症状：鼠标可以灵活的移动，鼠标移动到任务栏的图标有高亮显示，但是点击、右击无反应；开始菜单第一次点击可以弹出，关了重按就卡住；前台软件无响应且无法弹出”程序无响应，等待还是强制关闭？“的弹窗；前台软件按关闭无响应，但拖动窗口很流畅；ctrl+alt+delete启动任务管理器没有任何动静。。。 玩GTA卡住：背景声音没有停，但是屏幕冻住了，半分钟后恢复了；后来又卡住了，这次没有恢复。 症状产生后，尝试强制重启，无线加载进不去登录界面；再强制重启，安全模式也进不去；尝试重装系统，U盘启动也无限加载。。。（于是以为是硬件坏了。的确，休息片刻散散热过后又很正常的开机了）</p>
<p>但是又感觉不是硬件问题，卡住前夕已经感觉哪里不对，但是卡住的瞬间是在执行某条命令时实现的：比如按了浏览器的收藏、比如试图启动别的程序。</p>
<p>综上，所有在前台正在运行的东西可以勉强反应一下，但已无法进行任何操作，给人一种无限卡在缺页中断的感觉。</p>
<h1 id="网上教程">网上教程</h1>
<p><a href="https://answers.microsoft.com/zh-hans/windows/forum/windows_10-performance/%E5%AE%89%E8%A3%85windows/b3f3a31d-a118-4c65-8b2a-7896c37bfb4e?rtAction=1475154264985" target="_blank" rel="noopener">&quot;安装Windows 10周年更新后出现冻屏&quot; - Microsoft Community</a></p>
<p><a href="https://support.microsoft.com/en-us/help/3083595/task-manager-might-show-100-disk-utilization-on-windows-10-devices-wit" target="_blank" rel="noopener">&quot;Task Manager might show 100% disk utilization on Windows 10 devices with Message Signaled Interrupt (MSI) mode enabled&quot; - Microsoft Support</a></p>
<p><a href="http://www.pconline.com.cn/win10/739/7395324.html" target="_blank" rel="noopener">&quot;WIN10卡顿？&quot; - 知乎</a></p>
<p><a href="https://www.zhihu.com/question/50821797" target="_blank" rel="noopener">&quot;win10周年版 SSD+加机械双硬盘假死的问题。？&quot; - 知乎</a></p>
<h1 id="或许可行的方案">或许可行的方案</h1>
<h2 id="关闭msi">关闭MSI</h2>
<p><a href="http://www.pconline.com.cn/win10/739/7395324.html" target="_blank" rel="noopener">SSD也卡机？驱动人生解决Win10 SSD卡顿</a> 我的MSI地址： <code>计算机\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\PCI\VEN_8086&amp;DEV_8C03&amp;SUBSYS_09261025&amp;REV_05\3&amp;11583659&amp;0&amp;FA\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties</code></p>
<h2 id="关闭虚拟内存">关闭虚拟内存</h2>
<p>听说会好很多。。</p>
<h2 id="更新英特尔的sata-ahci驱动">更新英特尔的SATA AHCI驱动</h2>
<p>在英特尔官网搜索: <a href="https://downloadcenter.intel.com/zh-cn/search?keyword=rst%20%E5%BF%AB%E9%80%9F%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF" target="_blank" rel="noopener">rst, 快速存储技术</a> <a href="https://downloadcenter.intel.com/zh-cn/download/26865/-" target="_blank" rel="noopener">具体驱动（最新版）</a> <a href="https://downloadcenter.intel.com/zh-cn//download/25165/Intel-Rapid-Storage-Technology-Intel-RST-RAID-Driver?_ga=1.79719383.1725512768.1472622887" target="_blank" rel="noopener">具体驱动（比最新版老一点的版本）</a></p>
<p>页面左侧的下载界面往下翻，找到SetupRST，下载安装驱动。</p>
]]></content>
  </entry>
  <entry>
    <title>Codeforces Round 425(Div. 2) - D. Misha, Grisha and Underground</title>
    <url>/posts/39929.html</url>
    <content><![CDATA[<h1 id="description">Description</h1>
<p>Misha and Grisha are funny boys, so they like to use new underground. The underground has <em>n</em> stations connected with <em>n</em> - 1 routes so that each route connects two stations, and it is possible to reach every station from any other.</p>
<p>The boys decided to have fun and came up with a plan. Namely, in some day in the morning Misha will ride the underground from station <em>s</em>to station <em>f</em> by the shortest path, and will draw with aerosol an ugly text &quot;Misha was here&quot; on every station he will pass through (including <em>s</em>and <em>f</em>). After that on the same day at evening Grisha will ride from station <em>t</em> to station <em>f</em> by the shortest path and will count stations with Misha's text. After that at night the underground workers will wash the texts out, because the underground should be clean.</p>
<p>The boys have already chosen three stations <em>a</em>, <em>b</em> and <em>c</em> for each of several following days, one of them should be station <em>s</em> on that day, another should be station <em>f</em>, and the remaining should be station <em>t</em>. They became interested how they should choose these stations <em>s</em>, <em>f</em>, <em>t</em> so that the number Grisha will count is as large as possible. They asked you for help.</p>
<h1 id="input">Input</h1>
<p>The first line contains two integers <em>n</em> and <em>q</em> (2 ≤ <em>n</em> ≤ 105, 1 ≤ <em>q</em> ≤ 105) — the number of stations and the number of days.</p>
<p>The second line contains <em>n</em> - 1 integers <em>p</em>2, <em>p</em>3, ..., <em>p</em> <em>n</em> (1 ≤ <em>p</em> <em>i</em> ≤ <em>n</em>). The integer <em>p</em> <em>i</em> means that there is a route between stations <em>p</em> <em>i</em> and <em>i</em>. It is guaranteed that it's possible to reach every station from any other.</p>
<p>The next <em>q</em> lines contains three integers <em>a</em>, <em>b</em> and <em>c</em> each (1 ≤ <em>a</em>, <em>b</em>, <em>c</em> ≤ <em>n</em>) — the ids of stations chosen by boys for some day. Note that some of these ids could be same.</p>
<h1 id="output">Output</h1>
<p>Print <em>q</em> lines. In the <em>i</em>-th of these lines print the maximum possible number Grisha can get counting when the stations <em>s</em>, <em>t</em> and <em>f</em> are chosen optimally from the three stations on the <em>i</em>-th day.</p>
<h1 id="examples">Examples</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">input</span><br><span class="line"><span class="number">3</span> <span class="number">2</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="number">2</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line">output</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line">input</span><br><span class="line"><span class="number">4</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line">output</span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>
<h1 id="note">Note</h1>
<p>In the first example on the first day if <em>s</em> = 1, <em>f</em> = 2, <em>t</em> = 3, Misha would go on the route 1 <img src="http://codeforces.com/predownloaded/9e/58/9e58594e343ae98e6885aaa282186965f4b9653b.png" alt="img"> 2, and Grisha would go on the route 3 <img src="http://codeforces.com/predownloaded/9e/58/9e58594e343ae98e6885aaa282186965f4b9653b.png" alt="img"> 1 <img src="http://codeforces.com/predownloaded/9e/58/9e58594e343ae98e6885aaa282186965f4b9653b.png" alt="img"> 2. He would see the text at the stations 1 and 2. On the second day, if <em>s</em> = 3, <em>f</em> = 2, <em>t</em> = 3, both boys would go on the route 3 <img src="http://codeforces.com/predownloaded/9e/58/9e58594e343ae98e6885aaa282186965f4b9653b.png" alt="img"> 1 <img src="http://codeforces.com/predownloaded/9e/58/9e58594e343ae98e6885aaa282186965f4b9653b.png" alt="img"> 2. Grisha would see the text at 3 stations.</p>
<p>In the second examle if <em>s</em> = 1, <em>f</em> = 3, <em>t</em> = 2, Misha would go on the route 1 <img src="http://codeforces.com/predownloaded/9e/58/9e58594e343ae98e6885aaa282186965f4b9653b.png" alt="img"> 2 <img src="http://codeforces.com/predownloaded/9e/58/9e58594e343ae98e6885aaa282186965f4b9653b.png" alt="img"> 3, and Grisha would go on the route 2 <img src="http://codeforces.com/predownloaded/9e/58/9e58594e343ae98e6885aaa282186965f4b9653b.png" alt="img"> 3 and would see the text at both stations.</p>
<h1 id="key">Key</h1>
<p>给一棵树，从中取三点<span class="math inline">\(a\)</span>、<span class="math inline">\(b\)</span>、<span class="math inline">\(c\)</span>，任取其中两点作为起点<span class="math inline">\(s\)</span>、<span class="math inline">\(t\)</span>，剩余一点作为终点<span class="math inline">\(f\)</span>。问“s到f的最短路径”与“t到f的最短路径”重叠部分最大有多少。</p>
<p>使用了LCA与倍增。可以看到，三个点两两搭配的最近公共祖先中，必至少有两对是同一个祖先。</p>
<p>三个点只有以下两种情况：（令<span class="math inline">\(dep[lca(b,c)]&gt;=dep[lca(a,b)]\)</span>，这样就可以把b、c看作一个整体了（b、c是不是处于一条链、是不是重叠也不影响bc整体与a的判断），此时<span class="math inline">\(dep[lca(a,b)]\)</span>必等于<span class="math inline">\(dep[lca(a,c)]\)</span>。） 第一种情况： <img src="/posts/39929/1.png" alt="这里写图片描述"> a与bc不在一条链上。·可以看到答案要么是a到<span class="math inline">\(lca(b,c)\)</span>的距离，要么是b、c分别到<span class="math inline">\(lca(b,c)\)</span>的距离。</p>
<p>第二种情况： <img src="/posts/39929/2.png" alt="这里写图片描述"> a与bc处于一条链。答案与上面类似，也是三种情况，但是没有经过分叉，计算上略微不同。</p>
<p>然而输入的abc位置随机，直接判断很麻烦。可以像上图一样，把lca深度大的设为b、c，就很方便了。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mset(a,b) memset(a,b,sizeof(a))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = (<span class="keyword">int</span>)<span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, q;</span><br><span class="line"><span class="keyword">int</span> a, b, c;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; T[maxn];</span><br><span class="line"><span class="keyword">int</span> d[maxn];</span><br><span class="line"><span class="keyword">int</span> p[maxn][<span class="number">28</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i:T[u]) &#123;</span><br><span class="line">		<span class="keyword">if</span> (i == p[u][<span class="number">0</span>]) <span class="keyword">continue</span>;</span><br><span class="line">		d[i] = d[u] + <span class="number">1</span>;</span><br><span class="line">		p[i][<span class="number">0</span>] = u;</span><br><span class="line">		dfs(i);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; (<span class="number">1</span> &lt;&lt; j) &lt;= n; j++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">			p[i][j] = p[p[i][j - <span class="number">1</span>]][j - <span class="number">1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (d[a]&gt;d[b])swap(a, b);</span><br><span class="line">	<span class="keyword">int</span> f = d[b] - d[a];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; (<span class="number">1</span> &lt;&lt; i) &lt;= f; i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> ((<span class="number">1</span> &lt;&lt; i)&amp;f)b = p[b][i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (a != b) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = (<span class="keyword">int</span>)log2(n); i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">			<span class="keyword">if</span> (p[a][i] != p[b][i]) &#123;</span><br><span class="line">				a = p[a][i]; b = p[b][i];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		a = p[a][<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	mset(d, <span class="number">0</span>); mset(p, <span class="number">0</span>);</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="keyword">int</span> p;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; p;</span><br><span class="line">		T[i].push_back(p);</span><br><span class="line">		T[p].push_back(i);</span><br><span class="line">	&#125;</span><br><span class="line">	dfs(<span class="number">1</span>);</span><br><span class="line">	init();</span><br><span class="line">	<span class="keyword">while</span> (q--) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">		<span class="keyword">int</span> f1 = lca(a, b);</span><br><span class="line">		<span class="keyword">int</span> f2 = lca(a, c);</span><br><span class="line">		<span class="keyword">int</span> f3 = lca(b, c);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (d[f1] &gt; d[f2]) &#123;</span><br><span class="line">			swap(b, c);</span><br><span class="line">			swap(f1, f2);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (d[f2] &gt; d[f3]) &#123;</span><br><span class="line">			swap(a, b);</span><br><span class="line">			swap(f2, f3);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> res1 = (f1 == a ? (d[f3] - d[f1]) : (d[a] - d[f1]) + (d[f3] - d[f1]));</span><br><span class="line">		<span class="keyword">int</span> res2 = max(d[b] - d[f3], d[c] - d[f3]);</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; max(res1, res2) + <span class="number">1</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces Round 420(Div. 2) - D. Okabe and City</title>
    <url>/posts/39927.html</url>
    <content><![CDATA[<h1 id="description">Description</h1>
<p>Okabe likes to be able to walk through his city on a path lit by street lamps. That way, he doesn't get beaten up by schoolchildren.</p>
<p>Okabe's city is represented by a 2D grid of cells. Rows are numbered from 1 to <em>n</em> from top to bottom, and columns are numbered 1 to <em>m</em>from left to right. Exactly <em>k</em> cells in the city are lit by a street lamp. It's guaranteed that the top-left cell is lit.</p>
<p>Okabe starts his walk from the top-left cell, and wants to reach the bottom-right cell. Of course, Okabe will only walk on lit cells, and he can only move to adjacent cells in the up, down, left, and right directions. However, Okabe can also temporarily light all the cells in any single row or column at a time if he pays 1 coin, allowing him to walk through some cells not lit initially.</p>
<p>Note that Okabe can only light a single row or column at a time, and has to pay a coin every time he lights a new row or column. To change the row or column that is temporarily lit, he must stand at a cell that is lit initially. Also, once he removes his temporary light from a row or column, all cells in that row/column not initially lit are now not lit.</p>
<p>Help Okabe find the minimum number of coins he needs to pay to complete his walk!</p>
<h1 id="input">Input</h1>
<p>The first line of input contains three space-separated integers <em>n</em>, <em>m</em>, and <em>k</em> (2 ≤ <em>n</em>, <em>m</em>, <em>k</em> ≤ 104).</p>
<p>Each of the next <em>k</em> lines contains two space-separated integers <em>r</em> <em>i</em> and <em>c</em> <em>i</em> (1 ≤ <em>r</em> <em>i</em> ≤ <em>n</em>, 1 ≤ <em>c</em> <em>i</em> ≤ <em>m</em>) — the row and the column of the <em>i</em>-th lit cell.</p>
<p>It is guaranteed that all <em>k</em> lit cells are distinct. It is guaranteed that the top-left cell is lit.</p>
<h1 id="output">Output</h1>
<p>Print the minimum number of coins Okabe needs to pay to complete his walk, or -1 if it's not possible.</p>
<h1 id="examples">Examples</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">input</span><br><span class="line"><span class="number">4</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">4</span> <span class="number">3</span></span><br><span class="line">output</span><br><span class="line"><span class="number">2</span></span><br><span class="line">input</span><br><span class="line"><span class="number">5</span> <span class="number">5</span> <span class="number">4</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">3</span> <span class="number">1</span></span><br><span class="line"><span class="number">3</span> <span class="number">2</span></span><br><span class="line">output</span><br><span class="line"><span class="number">-1</span></span><br><span class="line">input</span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">4</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span></span><br><span class="line">output</span><br><span class="line"><span class="number">0</span></span><br><span class="line">input</span><br><span class="line"><span class="number">5</span> <span class="number">5</span> <span class="number">4</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span></span><br><span class="line"><span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">4</span> <span class="number">4</span></span><br><span class="line">output</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<h1 id="note">Note</h1>
<p>In the first sample test, Okabe can take the path <img src="http://codeforces.com/predownloaded/7b/fa/7bfa6afb81a3a341171b4d6ff9c74cc77ee5e932.png" alt="img">, paying only when moving to (2, 3) and (4, 4).</p>
<p>In the fourth sample, Okabe can take the path <img src="http://codeforces.com/predownloaded/f0/06/f0069b44dd98505eb3b837a9423d0939c0e929cd.png" alt="img"> <img src="http://codeforces.com/predownloaded/c7/e0/c7e0941eb95208913c1b351808feff9e47375f58.png" alt="img">, paying when moving to (1, 2), (3, 4), and (5, 4).</p>
<h1 id="key">Key</h1>
<p>看了好多题解终于写了出来。。。 题意：<span class="math inline">\(n \times m\)</span>的图中有<span class="math inline">\(k\)</span>个点，若某每个点周围四个方向有点，则可耗费0代价到达，若某点的周围的上下五行（向上两行，向下两行，当前行）、左右五列也有点，则可耗费1代价到达。求从左上角到右下角的最短路径。</p>
<p>以<span class="math inline">\(k\)</span>个点建图，可以看见由于和周围5行5列的点均有边，边非常多，所以不能直接连边。在运行时枚举所有周围的点即可。本质上就是一张无负权边的图，用Dijkstra跑即可。</p>
<p>右下角的点<span class="math inline">\((n,m)\)</span>可能不在<span class="math inline">\(k\)</span>个结点里，有点难处理，但思路是赋予它一个结点。一开始我跟着一个题解的思路做，他是把右下角的点赋值一个1。还是挺烦的。后来看到一个高级的：若<span class="math inline">\((n,m)\)</span>不是<span class="math inline">\(k\)</span>点中之一，则<span class="math inline">\(++n\)</span>，<span class="math inline">\(++m\)</span>，再把<span class="math inline">\((n,m)\)</span>加入为<span class="math inline">\(k+1\)</span>个点。很巧妙啊。</p>
<p>不要试图开二维数组，哪怕是开了个<span class="math inline">\(bool vis[10000][10000]\)</span>，也会在第36个案例MLE。一开始不懂，感觉应该不要紧，因为在本地没什么问题。。。结果为此疯狂WA。</p>
<p>既然不能开二维数组，就只能给每个点编号了，于是一共开了三个类，越写越乱。。。也想过用哈希，但对此不是很熟练，不敢写。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mset(a, b) memset(a,b,sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> abs(a) ((a)&gt;0?(a):-(a))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = (<span class="keyword">unsigned</span>)<span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> r, c, d;</span><br><span class="line">	<span class="keyword">bool</span> v;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> Point &amp;p) <span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (r == p.r) <span class="keyword">return</span> c &lt; p.c;</span><br><span class="line">		<span class="keyword">return</span> r &lt; p.r;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;P[maxn];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> rc, id;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QNode</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> d, id;</span><br><span class="line">	QNode(<span class="keyword">int</span> _d, <span class="keyword">int</span> _id) :d(_d), id(_id) &#123;&#125;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> QNode &amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> d &gt; p.d;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> n, m, k;</span><br><span class="line"><span class="built_in">vector</span>&lt;Node&gt; R[maxn], C[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">	<span class="keyword">bool</span> flg = <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">		<span class="keyword">auto</span> &amp;now = P[i];</span><br><span class="line">		now.d = INF; now.v = <span class="literal">false</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; now.r &gt;&gt; now.c;</span><br><span class="line">		<span class="keyword">if</span> (now.r == n&amp;&amp;now.c == m) &#123;</span><br><span class="line">			flg = <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (flg) &#123;</span><br><span class="line">		<span class="keyword">auto</span> &amp;now = P[k];</span><br><span class="line">		now.r = ++n;</span><br><span class="line">		now.c = ++m;</span><br><span class="line">		now.d = INF;</span><br><span class="line">		now.v = <span class="literal">false</span>;</span><br><span class="line">		++k;</span><br><span class="line">	&#125;</span><br><span class="line">	sort(P, P + k);</span><br><span class="line">	Node nod;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">		<span class="keyword">auto</span> &amp;now = P[i];</span><br><span class="line">		nod.id = i;</span><br><span class="line">		nod.rc = now.c;</span><br><span class="line">		R[now.r].push_back(nod);</span><br><span class="line">		nod.rc = now.r;</span><br><span class="line">		C[now.c].push_back(nod);</span><br><span class="line">	&#125;</span><br><span class="line">	priority_queue&lt;QNode&gt; que;</span><br><span class="line">	P[<span class="number">0</span>].d = <span class="number">0</span>;</span><br><span class="line">	que.push(QNode(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">	<span class="keyword">while</span> (!que.empty()) &#123;</span><br><span class="line">		<span class="keyword">auto</span> &amp;now = P[que.top().id];</span><br><span class="line">		que.pop();</span><br><span class="line">		<span class="keyword">if</span> (now.v) <span class="keyword">continue</span>;</span><br><span class="line">		now.v = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">if</span> (now.r == n&amp;&amp;now.c == m) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; now.d;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">-2</span>; i &lt;= <span class="number">2</span>; ++i) &#123;</span><br><span class="line">			<span class="keyword">int</span> r = now.r + i;</span><br><span class="line">			<span class="keyword">if</span> (r &gt;= <span class="number">1</span> &amp;&amp; r &lt;= n) <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; c : R[r]) &#123;</span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">abs</span>(i) == <span class="number">1</span> &amp;&amp; c.rc == now.c) &#123;</span><br><span class="line">					<span class="keyword">if</span> (now.d &lt; P[c.id].d) &#123;</span><br><span class="line">						P[c.id].d = now.d;</span><br><span class="line">						que.push(QNode(P[c.id].d, c.id));</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span> (now.d + <span class="number">1</span> &lt; P[c.id].d) &#123;</span><br><span class="line">					P[c.id].d = now.d + <span class="number">1</span>;</span><br><span class="line">					que.push(QNode(P[c.id].d, c.id));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> c = now.c + i;</span><br><span class="line">			<span class="keyword">if</span> (c &gt;= <span class="number">1</span> &amp;&amp; c &lt;= m) <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : C[c]) &#123;</span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">abs</span>(i) == <span class="number">1</span> &amp;&amp; r.rc == now.r) &#123;</span><br><span class="line">					<span class="keyword">if</span> (now.d &lt; P[r.id].d) &#123;</span><br><span class="line">						P[r.id].d = now.d;</span><br><span class="line">						que.push(QNode(P[r.id].d, r.id));</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span> (now.d + <span class="number">1</span> &lt; P[r.id].d) &#123;</span><br><span class="line">					P[r.id].d = now.d + <span class="number">1</span>;</span><br><span class="line">					que.push(QNode(P[r.id].d, r.id));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces Round 420(Div. 2) - E. Okabe and El Psy Kongroo</title>
    <url>/posts/39928.html</url>
    <content><![CDATA[<h1 id="description">Description</h1>
<p>Okabe likes to take walks but knows that spies from the Organization could be anywhere; that's why he wants to know how many different walks he can take in his city safely. Okabe's city can be represented as all points (<em>x</em>, <em>y</em>) such that <em>x</em> and <em>y</em> are non-negative. Okabe starts at the origin (point (0, 0)), and needs to reach the point (<em>k</em>, 0). If Okabe is currently at the point (<em>x</em>, <em>y</em>), in one step he can go to (<em>x</em> + 1, <em>y</em> + 1), (<em>x</em> + 1, <em>y</em>), or (<em>x</em> + 1, <em>y</em> - 1).</p>
<p>Additionally, there are <em>n</em> horizontal line segments, the <em>i</em>-th of which goes from <em>x</em> = <em>a</em> <em>i</em> to <em>x</em> = <em>b</em> <em>i</em> inclusive, and is at <em>y</em> = <em>c</em> <em>i</em>. It is guaranteed that <em>a</em>1 = 0, <em>a</em> <em>n</em> ≤ <em>k</em> ≤ <em>b</em> <em>n</em>, and <em>a</em> <em>i</em> = <em>b</em> <em>i</em> - 1 for 2 ≤ <em>i</em> ≤ <em>n</em>. The <em>i</em>-th line segment forces Okabe to walk with <em>y</em>-value in the range 0 ≤ <em>y</em> ≤ <em>c</em> <em>i</em> when his <em>x</em> value satisfies <em>a</em> <em>i</em> ≤ <em>x</em> ≤ <em>b</em> <em>i</em>, or else he might be spied on. This also means he is required to be under two line segments when one segment ends and another begins.</p>
<p>Okabe now wants to know how many walks there are from the origin to the point (<em>k</em>, 0) satisfying these conditions, modulo 109 + 7.</p>
<h1 id="input">Input</h1>
<p>The first line of input contains the integers <em>n</em> and <em>k</em> (1 ≤ <em>n</em> ≤ 100, 1 ≤ <em>k</em> ≤ 1018) — the number of segments and the destination <em>x</em> coordinate.</p>
<p>The next <em>n</em> lines contain three space-separated integers <em>a</em> <em>i</em>, <em>b</em> <em>i</em>, and <em>c</em> <em>i</em> (0 ≤ <em>a</em> <em>i</em> &lt; <em>b</em> <em>i</em> ≤ 1018, 0 ≤ <em>c</em> <em>i</em> ≤ 15) — the left and right ends of a segment, and its <em>y</em> coordinate.</p>
<p>It is guaranteed that <em>a</em>1 = 0, <em>a</em> <em>n</em> ≤ <em>k</em> ≤ <em>b</em> <em>n</em>, and <em>a</em> <em>i</em> = <em>b</em> <em>i</em> - 1 for 2 ≤ <em>i</em> ≤ <em>n</em>.</p>
<h1 id="output">Output</h1>
<p>Print the number of walks satisfying the conditions, modulo 1000000007 (109 + 7).</p>
<h1 id="examples">Examples</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">input</span><br><span class="line"><span class="number">1</span> <span class="number">3</span></span><br><span class="line"><span class="number">0</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line">output</span><br><span class="line"><span class="number">4</span></span><br><span class="line">input</span><br><span class="line"><span class="number">2</span> <span class="number">6</span></span><br><span class="line"><span class="number">0</span> <span class="number">3</span> <span class="number">0</span></span><br><span class="line"><span class="number">3</span> <span class="number">10</span> <span class="number">2</span></span><br><span class="line">output</span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>
<h1 id="note">Note</h1>
<figure>
<img src="http://codeforces.com/predownloaded/ef/2d/ef2ddb7a49988a896668e135a2429a6d0c1751c8.png" alt="img"><figcaption>img</figcaption>
</figure>
<p>The graph above corresponds to sample 1. The possible walks are:</p>
<ul>
<li><img src="http://codeforces.com/predownloaded/60/6c/606c75b4e3d573594f9bad8877589b3168b1d329.png" alt="img"></li>
<li><img src="http://codeforces.com/predownloaded/71/d1/71d1534d7ba4eca5317ccd6c22e2d90ed0f26299.png" alt="img"></li>
<li><img src="http://codeforces.com/predownloaded/6e/a0/6ea05cb9478dce26bec79d6c613f2463998adc9f.png" alt="img"></li>
<li><img src="http://codeforces.com/predownloaded/9f/aa/9faa6ee6afce00ab0dee4846948153acf3b23b45.png" title="fig:" alt="img"></li>
</ul>
<figure>
<img src="http://codeforces.com/predownloaded/09/c6/09c6b971fe5d780a11e55f494f95be573fa5f1bd.png" alt="img"><figcaption>img</figcaption>
</figure>
<p>The graph above corresponds to sample 2. There is only one walk for Okabe to reach (3, 0). After this, the possible walks are:</p>
<ul>
<li><img src="http://codeforces.com/predownloaded/ce/64/ce64869940605d0f698017b34d0d39a59d1fa41a.png" alt="img"></li>
<li><img src="http://codeforces.com/predownloaded/5e/0e/5e0e843d81ac07a6a04b52246cb0fd09a68e6d7d.png" alt="img"></li>
<li><img src="http://codeforces.com/predownloaded/d3/08/d3087c1b8a4f4cfd2be75cc0e8124ea745b14dc2.png" alt="img"></li>
<li><img src="http://codeforces.com/predownloaded/cd/4c/cd4cd0e38bc315cc6c07425cab2dd433940f3d09.png" title="fig:" alt="img"></li>
</ul>
<h1 id="key">Key</h1>
<p>看了题解才知道矩阵快速幂是这么用的。。。用了之后才知道原来这么简单。。</p>
<p>首先每个点只能向3个方向向右行动，明显的DP问题。 一步步dp肯定不行，要走18次方步呢。使用矩阵快速幂可以针对每一个段计算，一共就最多一百个段。每个段中，每一步将上一步的结果乘以如下矩阵： <span class="math display">\[
\left[
 \begin{matrix}
   1 &amp; 1 &amp; 0 &amp; 0 &amp; ...\\
   1 &amp; 1 &amp; 1 &amp; 0 &amp; ...\\
   0 &amp; 1 &amp; 1 &amp; 1 &amp; ...\\
   0 &amp; 0 &amp; 1 &amp; 1 &amp; ...\\
   ... &amp; ... &amp; ... &amp; ... 
  \end{matrix}
  \right]
\]</span> 就得到这一步的dp答案。一个段有<span class="math inline">\(b_i-a_i\)</span>次dp，即进行<span class="math inline">\(b_i-a_i\)</span>次幂。</p>
<p>边界处也好处理，若<span class="math inline">\(c_{i+1}&lt;c_{i}\)</span>，就直接取dp数组的低<span class="math inline">\(c_{i}\)</span>位结果即可；若<span class="math inline">\(c_{i+1}&gt;c_{i}\)</span>，dp数组<span class="math inline">\(c_{i+1}\)</span>以上的高位补0即可。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Maxn = <span class="number">17</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Pr = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span> &#123;</span></span><br><span class="line">	LL n, m;</span><br><span class="line">	LL mat[Maxn][Maxn];</span><br><span class="line"></span><br><span class="line">	Matrix() = <span class="keyword">default</span>;</span><br><span class="line">	Matrix(LL _n, LL _m) :n(_n), m(_m) &#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="keyword">sizeof</span>(mat));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Matrix <span class="keyword">operator</span> +(<span class="keyword">const</span> Matrix &amp;M) <span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="function">Matrix <span class="title">res</span><span class="params">(n, m)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (LL i = <span class="number">0</span>; i &lt; n; ++i) <span class="keyword">for</span> (LL j = <span class="number">0</span>; j &lt; m; ++j) &#123;</span><br><span class="line">			res.mat[i][j] = (mat[i][j] + M.mat[i][j]) % Pr;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Matrix <span class="keyword">operator</span> *(<span class="keyword">const</span> Matrix &amp;M) <span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (m != M.n) <span class="keyword">return</span> Matrix(<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">		<span class="function">Matrix <span class="title">res</span><span class="params">(n, M.m)</span></span>;</span><br><span class="line">		res.Clear();</span><br><span class="line">		<span class="keyword">for</span> (LL i = <span class="number">0</span>; i &lt; n; ++i) <span class="keyword">for</span> (LL j = <span class="number">0</span>; j &lt; M.m; ++j) &#123;</span><br><span class="line">			<span class="keyword">for</span> (LL k = <span class="number">0</span>; k &lt; m; ++k) &#123;</span><br><span class="line">				res.mat[i][j] += mat[i][k] * M.mat[k][j];</span><br><span class="line">				res.mat[i][j] %= Pr;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Matrix <span class="keyword">operator</span> ^(LL b) <span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (n != m) <span class="keyword">return</span> Matrix(<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">		<span class="function">Matrix <span class="title">a</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">		<span class="function">Matrix <span class="title">res</span><span class="params">(n, n)</span></span>;</span><br><span class="line">		res.Clear();</span><br><span class="line">		<span class="keyword">for</span> (LL i = <span class="number">0</span>; i &lt; n; ++i) res.mat[i][i] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (b &amp; <span class="number">1</span>) &#123;</span><br><span class="line">				res = a*res;</span><br><span class="line">			&#125;</span><br><span class="line">			a = a*a;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> res;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; ++j)</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; mat[i][j] &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">LL N, K;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K;</span><br><span class="line">	<span class="function">Matrix <span class="title">pwr</span><span class="params">(Maxn, Maxn)</span></span>;</span><br><span class="line">	pwr.Clear();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Maxn; ++i) &#123;</span><br><span class="line">		pwr.mat[i][i] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (i &gt; <span class="number">0</span>) pwr.mat[i][i - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (i + <span class="number">1</span> &lt; Maxn) pwr.mat[i][i + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">Matrix <span class="title">dp</span><span class="params">(Maxn, <span class="number">1</span>)</span></span>;</span><br><span class="line">	dp.Clear();</span><br><span class="line">	dp.mat[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	LL a, b, c;</span><br><span class="line">	<span class="keyword">while</span> (N--) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">		++c;</span><br><span class="line">		<span class="keyword">if</span> (b &gt; K) b = K;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = dp.n; i &lt; Maxn; ++i)</span><br><span class="line">			dp.mat[i][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">		dp.n = c;</span><br><span class="line">		pwr.n = pwr.m = c;</span><br><span class="line">		dp = (pwr ^ (b - a)) * dp;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; dp.mat[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 6-14UVa12118 - Inspector&#39;s Dilemma</title>
    <url>/posts/62830.html</url>
    <content><![CDATA[<h1 id="desicription">Desicription</h1>
<p>In a country, there are a number of cities. Each pair of city is connected by a highway, bi-directional of course. A road-inspector s task is to travel through the highways (in either direction) and to check if everything is in order. Now, a road-inspector has a list of highways he must inspect. However, it might not be possible for him to travel through all the highways on his list without using other highways. He needs a constant amount of time to traverse any single highway. As you can understand, the inspector is a busy fellow does not want to waste his precious time. He needs to know the minimum possible time to complete his task. He has the liberty to start from and end with any city he likes. Please help him out.</p>
<h1 id="input">Input</h1>
<p>The input file has several test cases. First line of each case has three integers: <span class="math inline">\(V (1 &lt;= V &lt;= 1000)\)</span>, the number of cities, <span class="math inline">\(E (0 &lt;= E &lt;= V * (V-1) / 2)\)</span>, the number of highways the inspector needs to check and$ T (1 &lt;= T &lt;= 10)$, time needed to pass a single highway. Each of the next E lines contains two integers a and b <span class="math inline">\((1 &lt;= a,b &lt;= V, a!=b)\)</span> meaning the inspector has to check the highway between cities a and b. The input is terminated by a case with <span class="math inline">\(V=E=T=0\)</span>. This case should not be processed.</p>
<h1 id="output">Output</h1>
<p>For each test case, print the serial of output followed by the minimum possible time the inspector needs to inspect all the highways on his list. Look at the output for sample input for details.</p>
<h1 id="sample">Sample</h1>
<p>Input <figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="symbol">5 </span><span class="number">3</span> <span class="number">1</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">2</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">3</span></span><br><span class="line"><span class="symbol">4 </span><span class="number">5</span></span><br><span class="line"><span class="symbol">4 </span><span class="number">4</span> <span class="number">1</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">2</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">4</span></span><br><span class="line"><span class="symbol">2 </span><span class="number">3</span></span><br><span class="line"><span class="symbol">3 </span><span class="number">4</span></span><br><span class="line"><span class="symbol">0 </span><span class="number">0</span> <span class="number">0</span></span><br></pre></td></tr></table></figure></p>
<p>Output <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Case <span class="number">1</span>: <span class="number">4</span></span><br><span class="line">Case <span class="number">2</span>: <span class="number">4</span></span><br></pre></td></tr></table></figure></p>
<h1 id="key">Key</h1>
<p>题意：V个点每个点均可两两相连。现已连E条边，要求添加k条边使得E+k条边组成的图是个欧拉通路。求k。</p>
<p>思路：讲道理V不告诉你都可以，没什么用的条件。在题意里也说的很明白了，要求一个欧拉通路。E条边可组成若干张子图，每张图可能是颗复杂的树、可能是个欧拉通路、可能是个欧拉回路、也可能只是一条孤立的边、一条链。搜索子图个数用DFS即可。</p>
<p>我的思路是，首先把每个子图加边连成一个欧拉通路，然后把所有通路连接。 其中，若子图有大于2个奇数节点（奇数节点必为偶数）则需要额外的<span class="math inline">\((奇数节点/2-1)\)</span>条边；若子图无奇数节点或只有2个，则无需额外边。 另外，连接n个通路需要n-1条边。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa12118 - Inspector's Dilemma</span></span><br><span class="line"><span class="comment">//Accepted 0.070s</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> V, E, T;</span><br><span class="line"><span class="keyword">int</span> Case = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &gt; mp;</span><br><span class="line"><span class="keyword">bool</span> vis[<span class="number">1010</span>];</span><br><span class="line"><span class="keyword">int</span> num;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> idx)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (vis[idx]) <span class="keyword">return</span>;</span><br><span class="line">	vis[idx] = <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">if</span> (mp[idx].size() &amp; <span class="number">1</span>) ++num;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;e : mp[idx]) &#123;</span><br><span class="line">		DFS(e);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="keyword">while</span> ((<span class="built_in">cin</span> &gt;&gt; V &gt;&gt; E &gt;&gt; T)&amp;&amp;(V+E+T)) &#123;</span><br><span class="line">		<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">		mp.clear();</span><br><span class="line">		<span class="keyword">int</span> u, v;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; E; ++i) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			mp[u].push_back(v);</span><br><span class="line">			mp[v].push_back(u);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> res = <span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;e : mp) &#123;</span><br><span class="line">			<span class="keyword">if</span> (vis[e.first]) <span class="keyword">continue</span>;</span><br><span class="line">			num = <span class="number">0</span>;</span><br><span class="line">			DFS(e.first);</span><br><span class="line">			<span class="keyword">if</span> (num == <span class="number">0</span>) num = <span class="number">2</span>;</span><br><span class="line">			res += num/<span class="number">2</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (res &lt; <span class="number">0</span>) res = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"Case "</span> &lt;&lt; ++Case &lt;&lt; <span class="string">": "</span> &lt;&lt; T*(res + E) &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces Round 393(Div. 2) - A. Petr and a calendar</title>
    <url>/posts/39925.html</url>
    <content><![CDATA[<h1 id="description">Description</h1>
<p>Petr wants to make a calendar for current month. For this purpose he draws a table in which columns correspond to weeks (a week is seven consequent days from Monday to Sunday), rows correspond to weekdays, and cells contain dates. For example, a calendar for January 2017 should look like on the picture:</p>
<figure>
<img src="http://codeforces.com/predownloaded/ca/26/ca26abffc774467d105ce266640bda655e2dd61f.png" alt="img"><figcaption>img</figcaption>
</figure>
<p>Petr wants to know how many columns his table should have given the month and the weekday of the first date of that month? Assume that the year is non-leap.</p>
<h1 id="input">Input</h1>
<p>The only line contain two integers <em>m</em> and <em>d</em> (1 ≤ <em>m</em> ≤ 12, 1 ≤ <em>d</em> ≤ 7) — the number of month (January is the first month, December is the twelfth) and the weekday of the first date of this month (1 is Monday, 7 is Sunday).</p>
<h1 id="output">Output</h1>
<p>Print single integer: the number of columns the table should have.</p>
<h1 id="examples">Examples</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">input</span><br><span class="line"><span class="number">1</span> <span class="number">7</span></span><br><span class="line">output</span><br><span class="line"><span class="number">6</span></span><br><span class="line">input</span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line">output</span><br><span class="line"><span class="number">5</span></span><br><span class="line">input</span><br><span class="line"><span class="number">11</span> <span class="number">6</span></span><br><span class="line">output</span><br><span class="line"><span class="number">5</span></span><br></pre></td></tr></table></figure>
<h1 id="note">Note</h1>
<p>The first example corresponds to the January 2017 shown on the picture in the statements.</p>
<p>In the second example 1-st January is Monday, so the whole month fits into 5 columns.</p>
<p>In the third example 1-st November is Saturday and 5 columns is enough.</p>
<h1 id="key">Key</h1>
<p>写过的最短的题哈哈哈，贴上来以表纪念。其中用到了老司机教我的除法向上取整的方法。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> m, d;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> D[] = &#123; <span class="number">0</span>,<span class="number">31</span>,<span class="number">28</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span> &#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; m &gt;&gt; d;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (D[m] + (d - <span class="number">1</span>) - <span class="number">1</span>) / <span class="number">7</span> + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces Round 389(Div. 2) - D. Santa Claus and a Palindrome</title>
    <url>/posts/39924.html</url>
    <content><![CDATA[<h1 id="description">Description</h1>
<p>Santa Claus likes palindromes very much. There was his birthday recently. k of his friends came to him to congratulate him, and each of them presented to him a string si having the same length n. We denote the beauty of the i-th string by ai. It can happen that ai is negative — that means that Santa doesn't find this string beautiful at all.</p>
<p>Santa Claus is crazy about palindromes. He is thinking about the following question: what is the maximum possible total beauty of a palindrome which can be obtained by concatenating some (possibly all) of the strings he has? Each present can be used at most once. Note that all strings have the same length n.</p>
<p>Recall that a palindrome is a string that doesn't change after one reverses it.</p>
<p>Since the empty string is a palindrome too, the answer can't be negative. Even if all ai's are negative, Santa can obtain the empty string.</p>
<h1 id="input">Input</h1>
<p>The first line contains two positive integers k and n divided by space and denoting the number of Santa friends and the length of every string they've presented, respectively (1 ≤ k, n ≤ 100 000; n·k  ≤ 100 000).</p>
<p>k lines follow. The i-th of them contains the string si and its beauty ai ( - 10 000 ≤ ai ≤ 10 000). The string consists of n lowercase English letters, and its beauty is integer. Some of strings may coincide. Also, equal strings can have different beauties.</p>
<h1 id="output">Output</h1>
<p>In the only line print the required maximum possible beauty.</p>
<h1 id="examples">Examples</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">input</span><br><span class="line"><span class="number">7</span> <span class="number">3</span></span><br><span class="line">abb <span class="number">2</span></span><br><span class="line">aaa <span class="number">-3</span></span><br><span class="line">bba <span class="number">-1</span></span><br><span class="line">zyz <span class="number">-4</span></span><br><span class="line">abb <span class="number">5</span></span><br><span class="line">aaa <span class="number">7</span></span><br><span class="line">xyx <span class="number">4</span></span><br><span class="line">output</span><br><span class="line"><span class="number">12</span></span><br><span class="line">input</span><br><span class="line"><span class="number">3</span> <span class="number">1</span></span><br><span class="line">a <span class="number">1</span></span><br><span class="line">a <span class="number">2</span></span><br><span class="line">a <span class="number">3</span></span><br><span class="line">output</span><br><span class="line"><span class="number">6</span></span><br><span class="line">input</span><br><span class="line"><span class="number">2</span> <span class="number">5</span></span><br><span class="line">abcde <span class="number">10000</span></span><br><span class="line">abcde <span class="number">10000</span></span><br><span class="line">output</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>
<h1 id="note">Note</h1>
<p>In the first example Santa can obtain abbaaaxyxaaabba by concatenating strings 5, 2, 7, 6 and 3 (in this order).</p>
<h1 id="key">Key</h1>
<p>给出若干等长字符串与其对应价值（可重复，重复的字符串价值可不同），从字符串中选出若干字符串，组成一个回文串，问最大价值多少。</p>
<p>一个字符串要被使用，就必须有对应的逆序字符串，比如要使用abb，就必须有对应的bba。先预处理将重复字符串的价值们放在数组里从大到小排列。对于abb、bba式的自身非回文的串很简单，只要两两价值相加大于零就选中（贪心）。</p>
<p>对于aba式的自身就是回文的，可以选择如上的成对出现，也可以选择放在正中间（然而最多只能有一个放在目标回文串的正中间，为了方便描述称其为“中间串”）。首先成对的处理，两两价值相加大于零就选中（贪心）。若该串重复的个数为奇数，可能有唯一落单的正价值，将其成为“中间串”候补。但还有个有问题，比如输入： <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">2</span> <span class="number">3</span></span><br><span class="line">aba <span class="number">5</span></span><br><span class="line">aba <span class="number">-1</span></span><br></pre></td></tr></table></figure> 两者结合结果为4，大于0。但是此处只选择第一个更优。因而当成对串的第二个串为负时，第一个串也成为“中间串”候补。</p>
<p>以上两种成为“中间串”候补的情况，对于第一种情况：若选中，则总价值+=该串价值。 对于第二种情况：若选中，则<span class="math inline">\(V_{总}-=V_{该串对应的负价值串}\)</span>，即<span class="math inline">\(V_{总}+=-V_{该串对应的负价值串}\)</span>。 则找出最大的<span class="math inline">\(|V_{候补串}|\)</span>或<span class="math inline">\(|V_{候补串对应的负价值串}|\)</span>即可。若没有候补串就不要中间串了。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> k, n;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &gt; mp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> sp[<span class="number">100000</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pal</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> idx = n;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; c : s) &#123;</span><br><span class="line">		sp[--idx] = c;</span><br><span class="line">	&#125;</span><br><span class="line">	sp[n] = <span class="string">'\0'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a &gt; b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; k &gt;&gt; n;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">		<span class="built_in">string</span> s;</span><br><span class="line">		<span class="keyword">int</span> v;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; s &gt;&gt; v;</span><br><span class="line">		mp[s].push_back(v);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> mid = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;e : mp) &#123;</span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;now = e.second;</span><br><span class="line">		<span class="keyword">if</span> (now.empty()) <span class="keyword">continue</span>;</span><br><span class="line">		sort(now.begin(), now.end(), cmp);</span><br><span class="line">		pal(e.first);</span><br><span class="line">		<span class="keyword">if</span> (e.first == sp) &#123;</span><br><span class="line">			<span class="keyword">int</span> l = now.size();</span><br><span class="line">			<span class="keyword">int</span> i;</span><br><span class="line">			<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; l - <span class="number">1</span>; i += <span class="number">2</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (now[i] + now[i + <span class="number">1</span>] &lt;= <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">				res += now[i] + now[i + <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (i &amp;&amp; i<span class="number">-1</span>&lt;l &amp;&amp; now[i - <span class="number">1</span>] &lt; <span class="number">0</span>) &#123;</span><br><span class="line">				mid = max(-now[i - <span class="number">1</span>], mid);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(i&lt;l) &#123;</span><br><span class="line">				mid = max(now[i],mid);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;nxt = mp[sp];</span><br><span class="line">			sort(nxt.begin(), nxt.end(), cmp);</span><br><span class="line">			<span class="keyword">int</span> l = min(nxt.size(), now.size());</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; l; ++i) &#123;</span><br><span class="line">				<span class="keyword">if</span> (nxt[i] + now[i] &lt;= <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">				res += nxt[i] + now[i];</span><br><span class="line">			&#125;</span><br><span class="line">			nxt.clear();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; res + mid;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces Round 412(Div. 2) - C. Success Rate</title>
    <url>/posts/39926.html</url>
    <content><![CDATA[<p>PROBLEMSET里面神tm搜不到这题，很迷。所以标题就只好注明比赛出处而没法标明题号了。</p>
<h1 id="description">Description</h1>
<p>You are an experienced Codeforces user. Today you found out that during your activity on Codeforces you have made y submissions, out of which x have been successful. Thus, your current success rate on Codeforces is equal to x / y.</p>
<p>Your favorite rational number in the [0;1] range is p / q. Now you wonder: what is the smallest number of submissions you have to make if you want your success rate to be p / q?</p>
<h1 id="input">Input</h1>
<p>The first line contains a single integer t (1 ≤ t ≤ 1000) — the number of test cases.</p>
<p>Each of the next t lines contains four integers x, y, p and q (0 ≤ x ≤ y ≤ 109; 0 ≤ p ≤ q ≤ 109; y &gt; 0; q &gt; 0).</p>
<p>It is guaranteed that p / q is an irreducible fraction.</p>
<p>Hacks. For hacks, an additional constraint of t ≤ 5 must be met.</p>
<h1 id="output">Output</h1>
<p>For each test case, output a single integer equal to the smallest number of submissions you have to make if you want your success rate to be equal to your favorite rational number, or -1 if this is impossible to achieve.</p>
<h1 id="example">Example</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">input</span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">3</span> <span class="number">10</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="number">7</span> <span class="number">14</span> <span class="number">3</span> <span class="number">8</span></span><br><span class="line"><span class="number">20</span> <span class="number">70</span> <span class="number">2</span> <span class="number">7</span></span><br><span class="line"><span class="number">5</span> <span class="number">6</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">output</span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">-1</span></span><br></pre></td></tr></table></figure>
<h1 id="note">Note</h1>
<p>In the first example, you have to make 4 successful submissions. Your success rate will be equal to 7 / 14, or 1 / 2.</p>
<p>In the second example, you have to make 2 successful and 8 unsuccessful submissions. Your success rate will be equal to 9 / 24, or 3 / 8.</p>
<p>In the third example, there is no need to make any new submissions. Your success rate is already equal to 20 / 70, or 2 / 7.</p>
<p>In the fourth example, the only unsuccessful submission breaks your hopes of having the success rate equal to 1.</p>
<h1 id="key">Key</h1>
<p>给你参加的总场次<span class="math inline">\(y\)</span>与其中胜利的场次<span class="math inline">\(x\)</span>，现要求胜率达到<span class="math inline">\(p/q\)</span>，问还要再比多少场（每一场可胜可负）。 想明白了其实是个巨简单的题目。为了达到目标，比赛的总场次必为<span class="math inline">\(q\)</span>的倍数（现设倍数为<span class="math inline">\(k\)</span>），则<span class="math inline">\(k*q&gt;=y\)</span>；在比了<span class="math inline">\(k*q\)</span>场次的情况下，必须胜利<span class="math inline">\(k*p\)</span>次，则<span class="math inline">\(k*p&gt;=x\)</span>。胜利的场数肯定不大于总场数，则只要找到<span class="math inline">\(k*p-x&lt;=k*q-y\)</span>的最小k即获得了答案。 综合一下三个条件，找出满足以下条件的k的最小值： <figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">k&gt;=<span class="keyword">y</span>/<span class="keyword">q</span>;</span><br><span class="line">k&gt;=<span class="keyword">x</span>/p;</span><br><span class="line">k&gt;=(<span class="keyword">y</span>-<span class="keyword">x</span>)/(<span class="keyword">q</span>-p);</span><br></pre></td></tr></table></figure> 即<span class="math inline">\(k=max(y/q, x/p, (y-x)/(q-p))\)</span>。其中除法结果若为小数则向上取整。 因此<span class="math inline">\(O(1)\)</span>时间复杂度即可求出。 至于无法达到的情况，只有<span class="math inline">\(x/y\)</span>不为0而<span class="math inline">\(p/q\)</span>为0、或<span class="math inline">\(x/y\)</span>不为1而<span class="math inline">\(p/q\)</span>为1两种。一开始判断掉就行。</p>
<h1 id="code">Code</h1>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line">LL T, x, y, p, q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span> (T--) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y &gt;&gt; p &gt;&gt; q;</span><br><span class="line">		<span class="keyword">if</span> (x*q == p*y) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">"0\n"</span>;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (p == <span class="number">0</span> || p == q) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">"-1\n"</span>;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		LL k = (y - x - <span class="number">1</span>) / (q - p) +<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (k*p &lt; x) k = (x - <span class="number">1</span>) / p + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (k*q &lt; y) k = (y - <span class="number">1</span>) / q + <span class="number">1</span>;</span><br><span class="line">		LL res = k*q - y;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces 815A - Karen and Game</title>
    <url>/posts/17492.html</url>
    <content><![CDATA[<p>千年两小时只写出2题，这次终于把C题写出来了。。。</p>
<h1 id="description">Description</h1>
<p>On the way to school, Karen became fixated on the puzzle game on her phone! <img src="http://codeforces.com/predownloaded/13/27/1327478902a073d7774242480818f1d4d93d7270.png" alt="这里写图片描述"></p>
<p>The game is played as follows. In each level, you have a grid with n rows and m columns. Each cell originally contains the number 0.</p>
<p>One move consists of choosing one row or column, and adding 1 to all of the cells in that row or column.</p>
<p>To win the level, after all the moves, the number in the cell at the i-th row and j-th column should be equal to gi, j.</p>
<p>Karen is stuck on one level, and wants to know a way to beat this level using the minimum number of moves. Please, help her with this task!</p>
<h1 id="input">Input</h1>
<p>The first line of input contains two integers, n and m (1 ≤ n, m ≤ 100), the number of rows and the number of columns in the grid, respectively.</p>
<p>The next n lines each contain m integers. In particular, the j-th integer in the i-th of these rows contains gi, j (0 ≤ gi, j ≤ 500).</p>
<h1 id="output">Output</h1>
<p>If there is an error and it is actually not possible to beat the level, output a single integer -1.</p>
<p>Otherwise, on the first line, output a single integer k, the minimum number of moves necessary to beat the level.</p>
<p>The next k lines should each contain one of the following, describing the moves in the order they must be done:</p>
<p>row x, (1 ≤ x ≤ n) describing a move of the form &quot;choose the x-th row&quot;. col x, (1 ≤ x ≤ m) describing a move of the form &quot;choose the x-th column&quot;. If there are multiple optimal solutions, output any one of them.</p>
<h1 id="examples">Examples</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">input</span><br><span class="line"><span class="number">3</span> <span class="number">5</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">2</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">output</span><br><span class="line"><span class="number">4</span></span><br><span class="line">row <span class="number">1</span></span><br><span class="line">row <span class="number">1</span></span><br><span class="line">col <span class="number">4</span></span><br><span class="line">row <span class="number">3</span></span><br><span class="line">input</span><br><span class="line"><span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">output</span><br><span class="line"><span class="number">-1</span></span><br><span class="line">input</span><br><span class="line"><span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">output</span><br><span class="line"><span class="number">3</span></span><br><span class="line">row <span class="number">1</span></span><br><span class="line">row <span class="number">2</span></span><br><span class="line">row <span class="number">3</span></span><br></pre></td></tr></table></figure>
<h1 id="note">Note</h1>
<p>In the first test case, Karen has a grid with 3 rows and 5 columns. She can perform the following 4 moves to beat the level: <img src="http://codeforces.com/predownloaded/dd/0f/dd0fcb1e5b1fe4c79e563210a46087f050e31b23.png" alt="这里写图片描述"></p>
<p>In the second test case, Karen has a grid with 3 rows and 3 columns. It is clear that it is impossible to beat the level; performing any move will create three 1s on the grid, but it is required to only have one 1 in the center.</p>
<p>In the third test case, Karen has a grid with 3 rows and 3 columns. She can perform the following 3 moves to beat the level: <img src="http://codeforces.com/predownloaded/e5/66/e56682602939194f6486566eb2bf1a2c106dca6b.png" alt="这里写图片描述"></p>
<p>Note that this is not the only solution; another solution, among others, is col 1, col 2, col 3.</p>
<h1 id="key">Key</h1>
<p>有一个有n*m个单元的、每个单元填有数字的网格，每次操作可将某一整行、一整列的单元数值-1，问最少进行多少次操作可以将网格所有单元减到0。</p>
<p>模拟。对每一行/列模拟即可。对于3*5的网格，如果要把每一个单元的数值-1，按行减，要3次，按列减，要5次。所以模拟的时候肯定是优先按行数/列数小的那一个开始减，每次减到该行/列出现0则无法再减，跳转下一行/列。模拟到最后遍历一遍查看有没有个别单元无法减到0，若有则输出-1。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> arr[<span class="number">123</span>][<span class="number">123</span>];</span><br><span class="line"><span class="keyword">int</span> minr[<span class="number">123</span>], minc[<span class="number">123</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">memset</span>(minr, <span class="number">1</span>, <span class="keyword">sizeof</span>(minr));</span><br><span class="line">	<span class="built_in">memset</span>(minc, <span class="number">1</span>, <span class="keyword">sizeof</span>(minc));</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; ++j) &#123;</span><br><span class="line">			<span class="keyword">int</span> &amp;now = arr[i][j];</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; now;</span><br><span class="line">			<span class="keyword">if</span> (minr[i] &gt; now) minr[i] = now;</span><br><span class="line">			<span class="keyword">if</span> (minc[j] &gt; now) minc[j] = now;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span> (n &lt;= m) &#123;</span><br><span class="line">		<span class="keyword">int</span> rminr = <span class="number">9999999</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			res += minr[i];</span><br><span class="line">			<span class="keyword">if</span> (rminr &gt; minr[i]) rminr = minr[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">			res += (minc[i] -= rminr);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">int</span> cminc = <span class="number">9999999</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">			res += minc[i];</span><br><span class="line">			<span class="keyword">if</span> (cminc &gt; minc[i]) cminc = minc[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			res += (minr[i] -= cminc);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; ++j) &#123;</span><br><span class="line">			<span class="keyword">if</span> (arr[i][j] - minr[i] - minc[j]) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">"-1\n"</span>;</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">while</span> (minr[i]--) <span class="built_in">cout</span> &lt;&lt; <span class="string">"row "</span> &lt;&lt; (i + <span class="number">1</span>) &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">		<span class="keyword">while</span> (minc[i]--) <span class="built_in">cout</span> &lt;&lt; <span class="string">"col "</span> &lt;&lt; (i + <span class="number">1</span>) &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces 816B - Karen and Coffee</title>
    <url>/posts/59704.html</url>
    <content><![CDATA[<h1 id="description">Description</h1>
<p>To stay woke and attentive during classes, Karen needs some coffee! <img src="http://codeforces.com/predownloaded/02/15/02159e70847762eaf87fdca280025a766c8a564b.png" alt="emmmmm.."> Karen, a coffee aficionado, wants to know the optimal temperature for brewing the perfect cup of coffee. Indeed, she has spent some time reading several recipe books, including the universally acclaimed &quot;The Art of the Covfefe&quot;.</p>
<p>She knows n coffee recipes. The i-th recipe suggests that coffee should be brewed between li and ri degrees, inclusive, to achieve the optimal taste.</p>
<p>Karen thinks that a temperature is admissible if at least k recipes recommend it.</p>
<p>Karen has a rather fickle mind, and so she asks q questions. In each question, given that she only wants to prepare coffee with a temperature between a and b, inclusive, can you tell her how many admissible integer temperatures fall within the range?</p>
<h1 id="input">Input</h1>
<p>The first line of input contains three integers, n, k (1 ≤ k ≤ n ≤ 200000), and q (1 ≤ q ≤ 200000), the number of recipes, the minimum number of recipes a certain temperature must be recommended by to be admissible, and the number of questions Karen has, respectively.</p>
<p>The next n lines describe the recipes. Specifically, the i-th line among these contains two integers li and ri (1 ≤ li ≤ ri ≤ 200000), describing that the i-th recipe suggests that the coffee be brewed between li and ri degrees, inclusive.</p>
<p>The next q lines describe the questions. Each of these lines contains a and b, (1 ≤ a ≤ b ≤ 200000), describing that she wants to know the number of admissible integer temperatures between a and b degrees, inclusive.</p>
<h1 id="output">Output</h1>
<p>For each question, output a single integer on a line by itself, the number of admissible integer temperatures between a and b degrees, inclusive.</p>
<h1 id="examples">Examples</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">input</span><br><span class="line"><span class="number">3</span> <span class="number">2</span> <span class="number">4</span></span><br><span class="line"><span class="number">91</span> <span class="number">94</span></span><br><span class="line"><span class="number">92</span> <span class="number">97</span></span><br><span class="line"><span class="number">97</span> <span class="number">99</span></span><br><span class="line"><span class="number">92</span> <span class="number">94</span></span><br><span class="line"><span class="number">93</span> <span class="number">97</span></span><br><span class="line"><span class="number">95</span> <span class="number">96</span></span><br><span class="line"><span class="number">90</span> <span class="number">100</span></span><br><span class="line">output</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line">input</span><br><span class="line"><span class="number">2</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">200000</span> <span class="number">200000</span></span><br><span class="line"><span class="number">90</span> <span class="number">100</span></span><br><span class="line">output</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>
<h1 id="note">Note</h1>
<p>In the first test case, Karen knows 3 recipes.</p>
<p>The first one recommends brewing the coffee between 91 and 94 degrees, inclusive. The second one recommends brewing the coffee between 92 and 97 degrees, inclusive. The third one recommends brewing the coffee between 97 and 99 degrees, inclusive. A temperature is admissible if at least 2 recipes recommend it.</p>
<p>She asks 4 questions.</p>
<p>In her first question, she wants to know the number of admissible integer temperatures between 92 and 94 degrees, inclusive. There are 3: 92, 93 and 94 degrees are all admissible.</p>
<p>In her second question, she wants to know the number of admissible integer temperatures between 93 and 97 degrees, inclusive. There are 3: 93, 94 and 97 degrees are all admissible.</p>
<p>In her third question, she wants to know the number of admissible integer temperatures between 95 and 96 degrees, inclusive. There are none.</p>
<p>In her final question, she wants to know the number of admissible integer temperatures between 90 and 100 degrees, inclusive. There are 4: 92, 93, 94 and 97 degrees are all admissible.</p>
<p>In the second test case, Karen knows 2 recipes.</p>
<p>The first one, &quot;wikiHow to make Cold Brew Coffee&quot;, recommends brewing the coffee at exactly 1 degree. The second one, &quot;What good is coffee that isn't brewed at at least 36.3306 times the temperature of the surface of the sun?&quot;, recommends brewing the coffee at exactly 200000 degrees. A temperature is admissible if at least 1 recipe recommends it.</p>
<p>In her first and only question, she wants to know the number of admissible integer temperatures that are actually reasonable. There are none.</p>
<h1 id="key">Key</h1>
<p>输入若干闭区间，闭区间内每个整数点的Value+1。输入若干查询，查询在某个区间内的所有整数点Value&gt;=k的个数。</p>
<p>一开始预处理的时候比较傻。。。由于预处理的原因TLE了两次。开始我用了树状树组，基友们也是有用线段树的、有用差分数组的、前缀和的。超时了两次后最后我也换回了用前缀和（但是又超时了一次。。。预处理部分写的太无脑了。没有想到数据量这么大）。</p>
<h1 id="code">Code</h1>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">200000</span>;</span><br><span class="line"><span class="keyword">int</span> n, k, q;</span><br><span class="line"><span class="keyword">int</span> A[maxn + <span class="number">233</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">memset</span>(A, <span class="number">0</span>, <span class="keyword">sizeof</span>(A));</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k &gt;&gt; q;</span><br><span class="line">	<span class="keyword">int</span> in1, in2;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; in1 &gt;&gt; in2;</span><br><span class="line">		++A[in1]; --A[in2 + <span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= maxn; ++i) A[i] += A[i - <span class="number">1</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= maxn; ++i) A[i] = A[i - <span class="number">1</span>] + (A[i] &gt;= k ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">while</span> (q--) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; in1 &gt;&gt; in2;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; A[in2] - A[in1 - <span class="number">1</span>] &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 6-11UVa10410 6-13UVa215</title>
    <url>/posts/54931.html</url>
    <content><![CDATA[<p>最近刷题量大，不高兴写题解了。以后算竟的题目可能只是跳着做做了。</p>
<p>题目：6-11 UVa10410 - Tree Reconstruction <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa10410 - Tree Reconstruction</span></span><br><span class="line"><span class="comment">//Accepted 0.000s</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1000</span> + <span class="number">6</span>;</span><br><span class="line"><span class="keyword">int</span> n, bfs[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; n) &#123;</span><br><span class="line">		<span class="keyword">int</span> now;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; now;</span><br><span class="line">			bfs[now] = i;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; st;</span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vc[maxn];</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; now;</span><br><span class="line">		st.push(now);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i)&#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; now;</span><br><span class="line">			<span class="keyword">while</span> (!st.empty()) &#123;</span><br><span class="line">				<span class="keyword">int</span> top = st.top();</span><br><span class="line">				<span class="keyword">if</span> (bfs[now] &gt; bfs[top]+<span class="number">1</span> || st.size()==<span class="number">1</span>) &#123;</span><br><span class="line">					vc[top].push_back(now);</span><br><span class="line">					st.push(now);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> &#123;</span><br><span class="line">					st.pop();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">": "</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; e : vc[i])</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; e &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>题目：6-13 UVa215 - Spreadsheet Calculator <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa215 - Spreadsheet Calculator</span></span><br><span class="line"><span class="comment">//Accepted 	0.000s</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> vl[<span class="number">24</span>][<span class="number">14</span>];		<span class="comment">//value</span></span><br><span class="line"><span class="built_in">string</span> xp[<span class="number">24</span>][<span class="number">14</span>];	<span class="comment">//expr</span></span><br><span class="line"><span class="keyword">bool</span> ve[<span class="number">24</span>][<span class="number">14</span>];	<span class="comment">//kind</span></span><br><span class="line"><span class="keyword">bool</span> vis[<span class="number">24</span>][<span class="number">14</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">val</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (ve[x][y]) <span class="keyword">return</span> vl[x][y];</span><br><span class="line">	<span class="keyword">if</span> (vis[x][y]) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">int</span> op = <span class="number">1</span>;</span><br><span class="line">	vl[x][y] = <span class="number">0</span>;</span><br><span class="line">	vis[x][y] = <span class="literal">true</span>;</span><br><span class="line">	<span class="built_in">string</span> &amp;now = xp[x][y];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; xp[x][y].size(); ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (now[i] &gt;= <span class="string">'0'</span>&amp;&amp;now[i] &lt;= <span class="string">'9'</span>) &#123;</span><br><span class="line">			<span class="keyword">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span> (now[i] &gt;= <span class="string">'0'</span>&amp;&amp;now[i] &lt;= <span class="string">'9'</span>) &#123;</span><br><span class="line">				tmp *= <span class="number">10</span>;</span><br><span class="line">				tmp += now[i] - <span class="number">0x30</span>;</span><br><span class="line">				++i;</span><br><span class="line">			&#125;</span><br><span class="line">			--i;</span><br><span class="line">			vl[x][y] += tmp*op;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (now[i] &gt;= <span class="string">'A'</span>&amp;&amp;now[i] &lt;= <span class="string">'Z'</span>) &#123;</span><br><span class="line">			vl[x][y] += val(now[i] - <span class="string">'A'</span>, now[i + <span class="number">1</span>] - <span class="string">'0'</span>)*op;</span><br><span class="line">			<span class="keyword">if</span> (!ve[now[i] - <span class="string">'A'</span>][now[i + <span class="number">1</span>] - <span class="string">'0'</span>]) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">			++i;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			op = (now[i] == <span class="string">'+'</span> ? <span class="number">1</span> : <span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	ve[x][y] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> vl[x][y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);//----------------------------------</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &amp;&amp; N != <span class="number">0</span> &amp;&amp; M != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; M; ++j) &#123;</span><br><span class="line">				<span class="built_in">cin</span> &gt;&gt; xp[i][j];</span><br><span class="line">				<span class="keyword">if</span> (xp[i][j][<span class="number">0</span>] &gt;= <span class="string">'A'</span>&amp;&amp;xp[i][j][<span class="number">0</span>] &lt;= <span class="string">'Z'</span>) &#123;</span><br><span class="line">					ve[i][j] = <span class="literal">false</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> &#123;</span><br><span class="line">					ve[i][j] = <span class="literal">true</span>;</span><br><span class="line">					<span class="function"><span class="built_in">istringstream</span> <span class="title">in</span><span class="params">(xp[i][j])</span></span>;</span><br><span class="line">					in &gt;&gt; vl[i][j];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; M; ++j) &#123;</span><br><span class="line">				<span class="keyword">if</span> (ve[i][j]) <span class="keyword">continue</span>;</span><br><span class="line">				<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">				val(i, j);</span><br><span class="line">				<span class="keyword">if</span> (!ve[i][j]) ++cnt;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (cnt) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; M; ++j) &#123;</span><br><span class="line">					<span class="keyword">if</span> (ve[i][j]) <span class="keyword">continue</span>;</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="keyword">char</span>(i + <span class="string">'A'</span>) &lt;&lt; <span class="keyword">char</span>(j + <span class="string">'0'</span>) &lt;&lt; <span class="string">": "</span> &lt;&lt; xp[i][j] &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; ++i)</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; setw(<span class="number">6</span>) &lt;&lt; i;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="keyword">char</span>(<span class="string">'A'</span> + i);</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; M; ++j)</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; setw(<span class="number">6</span>) &lt;&lt; vl[i][j];</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces 811C - Vladik and Memorable Trip</title>
    <url>/posts/25981.html</url>
    <content><![CDATA[<p>哇咔咔，终于期末考完啦，终于放暑假啦，我终于又有时间学习啦！！(o゜▽゜)o☆</p>
<h1 id="description">Description</h1>
<p>Vladik often travels by trains. He remembered some of his trips especially well and I would like to tell you about one of these trips:</p>
<p>Vladik is at initial train station, and now n people (including Vladik) want to get on the train. They are already lined up in some order, and for each of them the city code ai is known (the code of the city in which they are going to).</p>
<p>Train chief selects some number of disjoint segments of the original sequence of people (covering entire sequence by segments is not necessary). People who are in the same segment will be in the same train carriage. The segments are selected in such way that if at least one person travels to the city x, then all people who are going to city x should be in the same railway carriage. This means that they can’t belong to different segments. Note, that all people who travel to the city x, either go to it and in the same railway carriage, or do not go anywhere at all.</p>
<p>Comfort of a train trip with people on segment from position l to position r is equal to XOR of all distinct codes of cities for people on the segment from position l to position r. XOR operation also known as exclusive OR.</p>
<p>Total comfort of a train trip is equal to sum of comfort for each segment.</p>
<p>Help Vladik to know maximal possible total comfort.</p>
<h1 id="input">Input</h1>
<p>First line contains single integer n (1 ≤ n ≤ 5000) — number of people.</p>
<p>Second line contains n space-separated integers a1, a2, ..., an (0 ≤ ai ≤ 5000), where ai denotes code of the city to which i-th person is going.</p>
<h1 id="output">Output</h1>
<p>The output should contain a single integer — maximal possible total comfort.</p>
<h1 id="examples">Examples</h1>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">input</span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">4</span> <span class="number">4</span> <span class="number">2</span> <span class="number">5</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line">output</span><br><span class="line"><span class="number">14</span></span><br><span class="line">input</span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="number">5</span> <span class="number">1</span> <span class="number">3</span> <span class="number">1</span> <span class="number">5</span> <span class="number">2</span> <span class="number">4</span> <span class="number">2</span> <span class="number">5</span></span><br><span class="line">output</span><br><span class="line"><span class="number">9</span></span><br></pre></td></tr></table></figure>
<h1 id="note">Note</h1>
<p>In the first test case best partition into segments is: <span class="math inline">\([4, 4][2, 5, 2] [3]\)</span>, answer is calculated as follows: <span class="math inline">\(4 + (2 xor 5) + 3 = 4 + 7 + 3 = 14\)</span></p>
<p>In the second test case best partition into segments is:$ 5 1 [3] 1 5 [2, 4, 2] 5$, answer calculated as follows: <span class="math inline">\(3 + (2 xor 4) = 3 + 6 = 9\)</span>.</p>
<h1 id="key">Key</h1>
<p>给一个n个元素（可含有重名元素）的序列，按照原来的顺序分割出若干段，要求所有重名元素要么全部出现在一个段里，要么全部不在段里。问分割出的所有段的价值和。其中每个段的价值为段内所有不同名元素按照名字的二进制异或。</p>
<p>明显的DP问题，但当时还是没写出来。。。果然一个月没写就生疏了。</p>
<p>当时就觉得这个异或有猫腻。什么意思呢？对于两个二进制数<span class="math inline">\(x\)</span>和<span class="math inline">\(y\)</span>，<span class="math inline">\(x+y \geq x \oplus y\)</span>（就相当于异或比加法少一个进位情况）。也就是说，每个段中不同名的元素越少越好。</p>
<p>先预处理一下，每种元素只需要知道其最左侧与最右侧的元素位置即可。</p>
<p>对于这个序列中的每一个元素：有选中与不选中（或无法选中）两种情况。若试图选中当前元素，则要求出包含此类元素的段的最小区间<span class="math inline">\([l, r]\)</span>及其价值<span class="math inline">\(Value\)</span>。若<span class="math inline">\(r\)</span>大于当前元素位置，则不选中，<span class="math inline">\(DP_{i} \gets DP_{i - 1}\)</span>；否则<span class="math inline">\(DP_{i} \gets max(DP_{i - 1}, DP_{l - 1} + Value)\)</span>。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> l(t) s[t][0]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> r(t) s[t][1]</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> a[maxn];</span><br><span class="line"><span class="keyword">int</span> s[maxn][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> tv[maxn];</span><br><span class="line"><span class="keyword">int</span> dp[maxn];</span><br><span class="line"><span class="keyword">bool</span> vis[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">	<span class="built_in">memset</span>(tv, <span class="number">0</span>, <span class="keyword">sizeof</span>(tv));</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">		<span class="keyword">if</span> (!l(a[i])) l(a[i]) = i;</span><br><span class="line">		r(a[i]) = i;</span><br><span class="line">	&#125;</span><br><span class="line">	dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		dp[i] = dp[i - <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">if</span> (r(a[i]) &gt; i) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">int</span> val = a[i];</span><br><span class="line">		<span class="keyword">int</span> ml = l(a[i]);</span><br><span class="line">		<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">		vis[a[i]] = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">int</span> j;</span><br><span class="line">		<span class="keyword">for</span> (j = i; j &gt; ml; --j) &#123;</span><br><span class="line">			<span class="keyword">if</span> (vis[a[j]]) <span class="keyword">continue</span>;</span><br><span class="line">			vis[a[j]] = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">if</span> (r(a[j]) &gt; i) <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">if</span> (l(a[j]) &lt; ml) ml = l(a[j]);</span><br><span class="line">			val ^= a[j];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (j == ml) dp[i] = max(dp[i - <span class="number">1</span>], val + dp[j - <span class="number">1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; dp[n];</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces 758C - Unfair Poll</title>
    <url>/posts/645.html</url>
    <content><![CDATA[<h1 id="description">Description</h1>
<p>On the Literature lesson Sergei noticed an awful injustice, it seems that some students are asked more often than others.</p>
<p>Seating in the class looks like a rectangle, where n rows with m pupils in each.</p>
<p>The teacher asks pupils in the following order: at first, she asks all pupils from the first row in the order of their seating, then she continues to ask pupils from the next row. If the teacher asked the last row, then the direction of the poll changes, it means that she asks the previous row. The order of asking the rows looks as follows: the 1-st row, the 2-nd row, ..., the n - 1-st row, the n-th row, the n - 1-st row, ..., the 2-nd row, the 1-st row, the 2-nd row, ...</p>
<p>The order of asking of pupils on the same row is always the same: the 1-st pupil, the 2-nd pupil, ..., the m-th pupil.</p>
<p>During the lesson the teacher managed to ask exactly k questions from pupils in order described above. Sergei seats on the x-th row, on the y-th place in the row. Sergei decided to prove to the teacher that pupils are asked irregularly, help him count three values:</p>
<p>the maximum number of questions a particular pupil is asked, the minimum number of questions a particular pupil is asked, how many times the teacher asked Sergei. If there is only one row in the class, then the teacher always asks children from this row.</p>
<h1 id="input">Input</h1>
<p>The first and the only line contains five integers n, m, k, x and y (1 ≤ n, m ≤ 100, 1 ≤ k ≤ 1018, 1 ≤ x ≤ n, 1 ≤ y ≤ m).</p>
<h1 id="output">Output</h1>
<p>Print three integers:</p>
<p>the maximum number of questions a particular pupil is asked, the minimum number of questions a particular pupil is asked, how many times the teacher asked Sergei. # Examples</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">input</span><br><span class="line"><span class="number">1</span> <span class="number">3</span> <span class="number">8</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">output</span><br><span class="line"><span class="number">3</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line">input</span><br><span class="line"><span class="number">4</span> <span class="number">2</span> <span class="number">9</span> <span class="number">4</span> <span class="number">2</span></span><br><span class="line">output</span><br><span class="line"><span class="number">2</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">input</span><br><span class="line"><span class="number">5</span> <span class="number">5</span> <span class="number">25</span> <span class="number">4</span> <span class="number">3</span></span><br><span class="line">output</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">input</span><br><span class="line"><span class="number">100</span> <span class="number">100</span> <span class="number">1000000000000000000</span> <span class="number">100</span> <span class="number">100</span></span><br><span class="line">output</span><br><span class="line"><span class="number">101010101010101</span> <span class="number">50505050505051</span> <span class="number">50505050505051</span></span><br></pre></td></tr></table></figure>
<h1 id="note">Note</h1>
<p>The order of asking pupils in the first test:</p>
<p>the pupil from the first row who seats at the first table, it means it is Sergei; the pupil from the first row who seats at the second table; the pupil from the first row who seats at the third table; the pupil from the first row who seats at the first table, it means it is Sergei; the pupil from the first row who seats at the second table; the pupil from the first row who seats at the third table; the pupil from the first row who seats at the first table, it means it is Sergei; the pupil from the first row who seats at the second table; The order of asking pupils in the second test:</p>
<p>the pupil from the first row who seats at the first table; the pupil from the first row who seats at the second table; the pupil from the second row who seats at the first table; the pupil from the second row who seats at the second table; the pupil from the third row who seats at the first table; the pupil from the third row who seats at the second table; the pupil from the fourth row who seats at the first table; the pupil from the fourth row who seats at the second table, it means it is Sergei; the pupil from the third row who seats at the first table;</p>
<h1 id="key">Key</h1>
<p>如此简单的题目竟然当时没做出来，心态爆炸。死在了边界和自作聪明上。 每个人从0开始编号，即0~m-1，以便于取模运算等。以提问第<span class="math inline">\(1, 2, 3, ....., n-1, n, n-1, ...4, 3, 2\)</span>排的所有人为一轮，提问次数记为round，计算出除了最后一轮外一共的轮数rounds以及最后一轮被提问的最后一个人的位置。 若n=1或者n=2，单独考虑，此时相当于每一个人在每一轮里只被问了一遍。否则：</p>
<ol type="1">
<li>当最后一个人在第一排，则最小值为rounds，最大值为max(rounds+1,2*rounds)，讨论Sergei有没有在最后一轮被提问且Sergei是不是第一排或最后一排的；</li>
<li>当最后一个人在第一排与最后一排之间且是第一次被提问，则最小值为rounds，最大值为2*rounds+1，讨论Sergei有没有在最后一轮被提问且Sergei是不是第一排或最后一排的；</li>
<li>当最后一个人在最后一排且不是最后一排最后一个人，则最小值为rounds，最大值为2*rounds+1，一样的还是要讨论Sergei情况；</li>
<li>当最后一个人在最后一排最后一个人时，则最小值为rounds+1，最大值为2*rounds+1，一样的还是要讨论Sergei情况；</li>
<li>当最后一个人在从后向前提问顺序（即第二次被提问）时，则最小值为rounds+1，最大值为2*rounds+2，一样的还是要讨论Sergei情况；</li>
</ol>
<p>所以可能性还是稍微有点复杂的，尤其是讨论Sergei在不在第一排或最后一排的问题上。我还吃力不讨好地在一两种情况上面把完全不耗时间的<code>(x == 1 || x == n) ? :</code>优化成<code>(x == 1) ? :</code>与<code>(x == n) ? :</code>，结果就优化出问题了。你说我何必呢。。。</p>
<p>最气的是，网上看到的题解都是模拟。。。二维数组一开，美滋滋。。。心态崩了。</p>
<h1 id="code">Code</h1>
<figure class="highlight gml"><table><tr><td class="code"><pre><span class="line">#include&lt;iostream&gt;</span><br><span class="line">#include&lt;algorithm&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">typedef long long LL;</span><br><span class="line">LL n, m, k, <span class="symbol">x</span>, <span class="symbol">y</span>;</span><br><span class="line">LL maxn, minn, midn;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	cin &gt;&gt; n &gt;&gt; m &gt;&gt; k &gt;&gt; <span class="symbol">x</span> &gt;&gt; <span class="symbol">y</span>;</span><br><span class="line">	--k;</span><br><span class="line">	LL <span class="built_in">round</span> = (n == <span class="number">1</span> ? m : (<span class="number">2</span> * n - <span class="number">2</span>)*m);</span><br><span class="line">	LL rounds = k / <span class="built_in">round</span>;</span><br><span class="line">	LL last = k % <span class="built_in">round</span>;</span><br><span class="line">	<span class="keywords">if</span> (n &lt; <span class="number">3</span>) &#123;</span><br><span class="line">		maxn = rounds + <span class="number">1</span>;</span><br><span class="line">		minn = ((last == <span class="built_in">round</span> - <span class="number">1</span>) ? rounds + <span class="number">1</span> : rounds);</span><br><span class="line">		midn = ((<span class="symbol">x</span> - <span class="number">1</span>)*m + <span class="symbol">y</span> - <span class="number">1</span> &gt; last ? minn : maxn);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keywords">else</span> &#123;</span><br><span class="line">		maxn = rounds * <span class="number">2</span>;</span><br><span class="line">		minn = rounds;</span><br><span class="line">		<span class="keywords">if</span> (last &lt; m) &#123;</span><br><span class="line">			maxn = <span class="built_in">max</span>(rounds * <span class="number">2</span>, rounds + <span class="number">1</span>);</span><br><span class="line">			<span class="keywords">if</span> ((<span class="symbol">x</span> - <span class="number">1</span>)*m + <span class="symbol">y</span> - <span class="number">1</span> &gt; last) midn = ((<span class="symbol">x</span> == <span class="number">1</span> || <span class="symbol">x</span> == n) ? rounds : rounds * <span class="number">2</span>);</span><br><span class="line">			<span class="keywords">else</span> midn = rounds + <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keywords">else</span> <span class="keywords">if</span> (last &lt; m*(n - <span class="number">1</span>)) &#123;</span><br><span class="line">			++maxn;</span><br><span class="line">			<span class="keywords">if</span> ((<span class="symbol">x</span> - <span class="number">1</span>)*m + <span class="symbol">y</span> - <span class="number">1</span> &gt; last) midn = ((<span class="symbol">x</span> == n) ? rounds : rounds * <span class="number">2</span>);</span><br><span class="line">			<span class="keywords">else</span> midn = ((<span class="symbol">x</span> == <span class="number">1</span>) ? rounds + <span class="number">1</span> : rounds * <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keywords">else</span> <span class="keywords">if</span> (last &lt; m*n) &#123;</span><br><span class="line">			++maxn;</span><br><span class="line">			<span class="keywords">if</span> (last == m*n - <span class="number">1</span>)++minn;</span><br><span class="line">			<span class="keywords">if</span> ((<span class="symbol">x</span> - <span class="number">1</span>)*m + <span class="symbol">y</span> - <span class="number">1</span> &gt; last) midn = rounds;</span><br><span class="line">			<span class="keywords">else</span> midn = ((<span class="symbol">x</span> == <span class="number">1</span> || <span class="symbol">x</span> == n) ? rounds + <span class="number">1</span> : rounds * <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keywords">else</span> &#123;</span><br><span class="line">			maxn += <span class="number">2</span>;</span><br><span class="line">			++minn;</span><br><span class="line">			<span class="keywords">if</span> (n*m + (n - <span class="symbol">x</span> - <span class="number">1</span>)*m + <span class="symbol">y</span> - <span class="number">1</span> &gt; last) midn = ((<span class="symbol">x</span> == <span class="number">1</span> || <span class="symbol">x</span> == n) ? rounds + <span class="number">1</span> : rounds * <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line">			<span class="keywords">else</span> midn = ((<span class="symbol">x</span> == <span class="number">1</span> || <span class="symbol">x</span> == n) ? rounds + <span class="number">1</span> : rounds * <span class="number">2</span> + <span class="number">2</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; maxn &lt;&lt; <span class="string">' '</span> &lt;&lt; minn &lt;&lt; <span class="string">' '</span> &lt;&lt; midn;</span><br><span class="line">	<span class="keywords">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>ACM ICPC 2016北京赛站网络赛 D - Pick Your Players</title>
    <url>/posts/51300.html</url>
    <content><![CDATA[<h1 id="description">Description</h1>
<p>You are the manager of a small soccer team. After seeing the shameless behavior of your team during the match, you are mad at all of the current players. Therefore, you have made a huge decision: put these players on the substitution bench, and buy the entire starting line-up from other teams.</p>
<p>You have received a list of available players from your assistant manager. Each player has three properties: Position, Value, and Cost. The Position of a player is one of the four kinds: Goalkeeper, Defender, Midfielder and Forward. The Value shows the ability of the player (the higher, the better), and the Cost is the money you need to spend to buy him.</p>
<p>You are going to pick some players to buy from the list, in order to form the starting line-up. Several rules should be followed:</p>
<ol type="1">
<li><p>The starting line-up consists of exactly eleven players.</p></li>
<li><p>There should be exactly one Goalkeeper, at least three but at most five Defenders, at least two but at most five Midfielders, and at least one but at most three Forwards in the starting line-up.</p></li>
<li><p>There should be exactly one captain in the starting line-up.The captain must be chosen from the eleven players.</p></li>
<li><p>The total value of the starting line-up is the sum of the Values of picked players plus the Value of the captain. In another word, the Value of the captain is counted twice.</p></li>
<li><p>The total cost of the starting line-up is the sum of the Costs of picked players, which should not exceed the given cost limitation.</p></li>
</ol>
<p>Now you have to give a plan to your boss before taking the actual actions. In the plan, you should report three numbers which your boss really interests in: Vt, Ct, N, where Vt is the maximum total value you can get; Ct is the minimum total cost when the total value is Vt; And N is the number of different ways to pick players when the total value is Vt and the total cost is Ct. Since your boss does not care the precise number of N if it is larger than 1,000,000,000, just report N = 1,000,000,000 when that happens.</p>
<p>Note that if two or more ways that pick the same eleven players and are only different in captain chosen, they should be regarded as the same.</p>
<h1 id="input">Input</h1>
<p>There are several test cases in the input.</p>
<p>The first line contains an integer T (1 &lt;= T &lt;= 10) -- the number of test cases.</p>
<p>For each case:</p>
<p>The first line contains an integer M (11 &lt;= M &lt;= 500) -- the number of players on the list.</p>
<p>Then follows M lines, each line contains a string P and two integers V and C (0 &lt;= V &lt;= 1000, 0 &lt;= C &lt;= 1000), separated by a single space, describing the properties of a player. P is the position of the player, which is one of the strings “Goalkeeper”, “Defender”, “Midfielder”, and “Forward”; V is the Value of the player and C is the Cost of the player.</p>
<p>The last line contains an integer L (0 &lt;= L &lt;= 1000) -- the cost limitation.</p>
<h1 id="output">Output</h1>
<p>For each test case, output three integers Vt, Ct and N on a single line, separated by a single space. We assure that there is at least one possible way to pick your players.</p>
<h1 id="note">Note</h1>
<p>In the sample, you should pick all five Defenders, four Midfielders with Value 178, 20, 64 and 109, one Forward with Value 6, and one of two Goalkeepers with Value 57. The Midfielder with Value 178 should be the captain.</p>
<h1 id="sample">Sample</h1>
<p>input <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">15</span></span><br><span class="line">Defender <span class="number">23</span> <span class="number">45</span></span><br><span class="line">Midfielder <span class="number">178</span> <span class="number">85</span></span><br><span class="line">Goalkeeper <span class="number">57</span> <span class="number">50</span></span><br><span class="line">Goalkeeper <span class="number">57</span> <span class="number">50</span></span><br><span class="line">Defender <span class="number">0</span> <span class="number">45</span></span><br><span class="line">Forward <span class="number">6</span> <span class="number">60</span></span><br><span class="line">Midfielder <span class="number">20</span> <span class="number">50</span></span><br><span class="line">Goalkeeper <span class="number">0</span> <span class="number">50</span></span><br><span class="line">Midfielder <span class="number">64</span> <span class="number">65</span></span><br><span class="line">Midfielder <span class="number">109</span> <span class="number">70</span></span><br><span class="line">Forward <span class="number">211</span> <span class="number">100</span></span><br><span class="line">Defender <span class="number">0</span> <span class="number">40</span></span><br><span class="line">Defender <span class="number">29</span> <span class="number">45</span></span><br><span class="line">Midfielder <span class="number">57</span> <span class="number">60</span></span><br><span class="line">Defender <span class="number">52</span> <span class="number">45</span></span><br><span class="line"><span class="number">600</span></span><br></pre></td></tr></table></figure> output <figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="symbol">716 </span><span class="number">600</span> <span class="number">2</span></span><br></pre></td></tr></table></figure></p>
<h1 id="key">Key</h1>
<p>来自ICPCCamp.Post的题解： &gt;题意：你需要买一个足球队（11个球员），每个球员有位置、价值。花费，有以下限制： 位置分为前锋（1-3人）、中腰（2-5）、后卫（3-5）、守门员（1） 每个人有value，总的value 是每个人的value加起来 ，选一个队长，队长的加两次 每个人有个 cost，总花费不能超过给定值 求：最大的 value，相应的最小的 cost，相应的购买方案数（大于1e9输出1e9） 10组数据，500个候选人，value和cost：V and C (0 &lt;= V &lt;= 1000, 0 &lt;= C &lt;= 1000)，花费上界：1000 题解：考虑dp(i,cost,j,k,r,w)=(value,way)表示考虑前ii个球员，费用和为cost，选了j个前锋kk个中腰r个后卫w个守门员这个状态，价值和是value,方案数是way。然后按照dp字面意思转移就可以了。然后第一维的ii这里是为了看起来方便，其实是不用开的。 为了方便处理队长，把球员们按照价值从大到小排序，挑的第一个人当队长就可以了。</p>
<p>不太清楚从如果按照题解大到小排序的话选队长为什么一定是对的（虽然它的确是这样），所以我选择从小到大排序，至少这样我会做一点。。。这样的话每个当前运动员都要考虑做一次队长，效率是差一点点。不过即便如此还是没做出来。。。。老是WA，甚至开始怀疑<a href="http://hihocoder.com/problemset/problem/1386" target="_blank" rel="noopener">hihocoder上的测试数据</a>是错的（这题有事没事debug了1个月了，老是WA，WA到怀疑人生）。 总这贴这里以后不管了。。。</p>
<h1 id="codewa">Code（WA）</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> dfor(i,l,r) for(int i=l;i&gt;=r;--i)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> lld;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxl = <span class="number">1000000000</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mg = <span class="number">1</span>, md = <span class="number">5</span>, mm = <span class="number">5</span>, mf = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">int</span> arr[<span class="number">2</span>][<span class="number">6</span>][<span class="number">6</span>][<span class="number">4</span>][maxn][<span class="number">3</span>]; <span class="comment">// G, D, M, F , cost, value/num/captain's value</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">member</span> &#123;</span></span><br><span class="line">	<span class="keyword">char</span> P;</span><br><span class="line">	<span class="keyword">int</span> V, C;</span><br><span class="line">&#125;lst[maxn + <span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, M;</span><br><span class="line">lld L;</span><br><span class="line"><span class="keyword">char</span> ipt_tmp[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> member &amp;arg1, <span class="keyword">const</span> member &amp;arg2)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (arg1.V == arg2.V) <span class="keyword">return</span> arg1.C &lt; arg2.C;</span><br><span class="line">	<span class="keyword">return</span> arg1.V &lt; arg2.V;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span> (T--) &#123;</span><br><span class="line">		<span class="built_in">memset</span>(arr, <span class="number">0</span>, <span class="keyword">sizeof</span>(arr));</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; M;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i != M; ++i) &#123;</span><br><span class="line">			member &amp;now = lst[i];</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; ipt_tmp &gt;&gt; now.V &gt;&gt; now.C;</span><br><span class="line">			now.P = *ipt_tmp;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; L;</span><br><span class="line">		sort(lst, lst + M, cmp);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i != M; ++i) &#123;</span><br><span class="line">			<span class="keyword">const</span> member &amp;nowp = lst[i];</span><br><span class="line">			<span class="keyword">if</span> (nowp.P == <span class="string">'G'</span>) &#123; <span class="comment">// exactly one Goalkeeper</span></span><br><span class="line">				dfor(g, mg, <span class="number">1</span>)dfor(d, md, <span class="number">0</span>)dfor(m, mm, <span class="number">0</span>)dfor(f, mf, <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">int</span>(&amp;predp)[maxn][<span class="number">3</span>] = arr[g - <span class="number">1</span>][d][m][f];</span><br><span class="line">					<span class="keyword">int</span>(&amp;nowdp)[maxn][<span class="number">3</span>] = arr[g][d][m][f];</span><br><span class="line">					<span class="keyword">if</span> (g + d + m + f &gt; <span class="number">11</span>) <span class="keyword">continue</span>;</span><br><span class="line">					dfor(c, L, nowp.C) &#123;</span><br><span class="line">						<span class="keyword">int</span>(&amp;nowc)[<span class="number">3</span>] = nowdp[c];</span><br><span class="line">						<span class="keyword">int</span>(&amp;prec)[<span class="number">3</span>] = predp[c - nowp.C];</span><br><span class="line">						<span class="keyword">if</span> (prec[<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">						<span class="keyword">if</span> (nowc[<span class="number">0</span>] + nowc[<span class="number">2</span>] &lt;= prec[<span class="number">0</span>] + nowp.V + nowp.V) &#123;</span><br><span class="line">							<span class="keyword">if</span> (nowc[<span class="number">0</span>] + nowc[<span class="number">2</span>] &lt; prec[<span class="number">0</span>] + nowp.V + nowp.V) &#123;</span><br><span class="line">								nowc[<span class="number">0</span>] = prec[<span class="number">0</span>] + nowp.V;</span><br><span class="line">								nowc[<span class="number">1</span>] = prec[<span class="number">1</span>];</span><br><span class="line">							&#125;</span><br><span class="line">							<span class="keyword">else</span> &#123;</span><br><span class="line">								<span class="keyword">if</span> ((nowc[<span class="number">1</span>] += prec[<span class="number">1</span>]) &gt; maxl) &#123;</span><br><span class="line">									nowc[<span class="number">1</span>] = maxl;</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							nowc[<span class="number">2</span>] = nowp.V;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (nowp.V + nowp.V &gt;= arr[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">0</span>] + arr[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">2</span>] &amp;&amp; nowp.C &lt; L) &#123;</span><br><span class="line">					<span class="keyword">if</span> (nowp.V + nowp.V &gt; arr[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">0</span>] + arr[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">2</span>]) &#123;</span><br><span class="line">						arr[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">0</span>] = nowp.V;</span><br><span class="line">						arr[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">						arr[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">2</span>] = nowp.V;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span> &#123;</span><br><span class="line">						++arr[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">1</span>];</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (nowp.P == <span class="string">'D'</span>) &#123; <span class="comment">// at least 3 but at most 5 Defenders</span></span><br><span class="line">				dfor(d, md, <span class="number">1</span>)dfor(g, mg, <span class="number">0</span>)dfor(m, mm, <span class="number">0</span>)dfor(f, mf, <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">int</span>(&amp;predp)[maxn][<span class="number">3</span>] = arr[g][d - <span class="number">1</span>][m][f];</span><br><span class="line">					<span class="keyword">int</span>(&amp;nowdp)[maxn][<span class="number">3</span>] = arr[g][d][m][f];</span><br><span class="line">					<span class="keyword">if</span> (g + d + m + f &gt; <span class="number">11</span>) <span class="keyword">continue</span>;</span><br><span class="line">					dfor(c, L, nowp.C) &#123;</span><br><span class="line">						<span class="keyword">int</span>(&amp;nowc)[<span class="number">3</span>] = nowdp[c];</span><br><span class="line">						<span class="keyword">int</span>(&amp;prec)[<span class="number">3</span>] = predp[c - nowp.C];</span><br><span class="line">						<span class="keyword">if</span> (prec[<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">						<span class="keyword">if</span> (nowc[<span class="number">0</span>] + nowc[<span class="number">2</span>] &lt;= prec[<span class="number">0</span>] + nowp.V + nowp.V) &#123;</span><br><span class="line">							<span class="keyword">if</span> (nowc[<span class="number">0</span>] + nowc[<span class="number">2</span>] &lt; prec[<span class="number">0</span>] + nowp.V + nowp.V) &#123;</span><br><span class="line">								nowc[<span class="number">0</span>] = prec[<span class="number">0</span>] + nowp.V;</span><br><span class="line">								nowc[<span class="number">1</span>] = prec[<span class="number">1</span>];</span><br><span class="line">							&#125;</span><br><span class="line">							<span class="keyword">else</span> &#123;</span><br><span class="line">								<span class="keyword">if</span> ((nowc[<span class="number">1</span>] += prec[<span class="number">1</span>]) &gt; maxl) &#123;</span><br><span class="line">									nowc[<span class="number">1</span>] = maxl;</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							nowc[<span class="number">2</span>] = nowp.V;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (nowp.V + nowp.V &gt;= arr[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">0</span>] + arr[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">2</span>] &amp;&amp; nowp.C &lt; L) &#123;</span><br><span class="line">					<span class="keyword">if</span> (nowp.V + nowp.V &gt; arr[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">0</span>] + arr[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">2</span>]) &#123;</span><br><span class="line">						arr[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">0</span>] = nowp.V;</span><br><span class="line">						arr[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">						arr[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">2</span>] = nowp.V;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span> &#123;</span><br><span class="line">						++arr[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][nowp.C][<span class="number">1</span>];</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (nowp.P == <span class="string">'M'</span>) &#123; <span class="comment">// at least 2 but at most 5 Midfielders</span></span><br><span class="line">				dfor(m, mm, <span class="number">1</span>)dfor(g, mg, <span class="number">0</span>)dfor(d, md, <span class="number">0</span>)dfor(f, mf, <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">int</span>(&amp;predp)[maxn][<span class="number">3</span>] = arr[g][d][m - <span class="number">1</span>][f];</span><br><span class="line">					<span class="keyword">int</span>(&amp;nowdp)[maxn][<span class="number">3</span>] = arr[g][d][m][f];</span><br><span class="line">					<span class="keyword">if</span> (g + d + m + f &gt; <span class="number">11</span>) <span class="keyword">continue</span>;</span><br><span class="line">					dfor(c, L, nowp.C) &#123;</span><br><span class="line">						<span class="keyword">int</span>(&amp;nowc)[<span class="number">3</span>] = nowdp[c];</span><br><span class="line">						<span class="keyword">int</span>(&amp;prec)[<span class="number">3</span>] = predp[c - nowp.C];</span><br><span class="line">						<span class="keyword">if</span> (prec[<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">						<span class="keyword">if</span> (nowc[<span class="number">0</span>] + nowc[<span class="number">2</span>] &lt;= prec[<span class="number">0</span>] + nowp.V + nowp.V) &#123;</span><br><span class="line">							<span class="keyword">if</span> (nowc[<span class="number">0</span>] + nowc[<span class="number">2</span>] &lt; prec[<span class="number">0</span>] + nowp.V + nowp.V) &#123;</span><br><span class="line">								nowc[<span class="number">0</span>] = prec[<span class="number">0</span>] + nowp.V;</span><br><span class="line">								nowc[<span class="number">1</span>] = prec[<span class="number">1</span>];</span><br><span class="line">							&#125;</span><br><span class="line">							<span class="keyword">else</span> &#123;</span><br><span class="line">								<span class="keyword">if</span> ((nowc[<span class="number">1</span>] += prec[<span class="number">1</span>]) &gt; maxl) &#123;</span><br><span class="line">									nowc[<span class="number">1</span>] = maxl;</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							nowc[<span class="number">2</span>] = nowp.V;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (nowp.V + nowp.V &gt;= arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][nowp.C][<span class="number">0</span>] + arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][nowp.C][<span class="number">2</span>] &amp;&amp; nowp.C &lt; L) &#123;</span><br><span class="line">					<span class="keyword">if</span> (nowp.V + nowp.V &gt; arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][nowp.C][<span class="number">0</span>] + arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][nowp.C][<span class="number">2</span>]) &#123;</span><br><span class="line">						arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][nowp.C][<span class="number">0</span>] = nowp.V;</span><br><span class="line">						arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][nowp.C][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">						arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][nowp.C][<span class="number">2</span>] = nowp.V;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span> &#123;</span><br><span class="line">						++arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][nowp.C][<span class="number">1</span>];</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123; <span class="comment">// at least 1 but at most 3 Forwards</span></span><br><span class="line">				dfor(f, mf, <span class="number">1</span>)dfor(g, mg, <span class="number">0</span>)dfor(d, md, <span class="number">0</span>)dfor(m, mm, <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">int</span>(&amp;predp)[maxn][<span class="number">3</span>] = arr[g][d][m][f - <span class="number">1</span>];</span><br><span class="line">					<span class="keyword">int</span>(&amp;nowdp)[maxn][<span class="number">3</span>] = arr[g][d][m][f];</span><br><span class="line">					<span class="keyword">if</span> (g + d + m + f &gt; <span class="number">11</span>) <span class="keyword">continue</span>;</span><br><span class="line">					dfor(c, L, nowp.C) &#123;</span><br><span class="line">						<span class="keyword">int</span>(&amp;nowc)[<span class="number">3</span>] = nowdp[c];</span><br><span class="line">						<span class="keyword">int</span>(&amp;prec)[<span class="number">3</span>] = predp[c - nowp.C];</span><br><span class="line">						<span class="keyword">if</span> (prec[<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">						<span class="keyword">if</span> (nowc[<span class="number">0</span>] + nowc[<span class="number">2</span>] &lt;= prec[<span class="number">0</span>] + nowp.V + nowp.V) &#123;</span><br><span class="line">							<span class="keyword">if</span> (nowc[<span class="number">0</span>] + nowc[<span class="number">2</span>] &lt; prec[<span class="number">0</span>] + nowp.V + nowp.V) &#123;</span><br><span class="line">								nowc[<span class="number">0</span>] = prec[<span class="number">0</span>] + nowp.V;</span><br><span class="line">								nowc[<span class="number">1</span>] = prec[<span class="number">1</span>];</span><br><span class="line">							&#125;</span><br><span class="line">							<span class="keyword">else</span> &#123;</span><br><span class="line">								<span class="keyword">if</span> ((nowc[<span class="number">1</span>] += prec[<span class="number">1</span>]) &gt; maxl) &#123;</span><br><span class="line">									nowc[<span class="number">1</span>] = maxl;</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">							nowc[<span class="number">2</span>] = nowp.V;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (nowp.V + nowp.V &gt;= arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][nowp.C][<span class="number">0</span>] + arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][nowp.C][<span class="number">2</span>] &amp;&amp; nowp.C &lt; L) &#123;</span><br><span class="line">					<span class="keyword">if</span> (nowp.V + nowp.V &gt; arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][nowp.C][<span class="number">0</span>] + arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][nowp.C][<span class="number">2</span>]) &#123;</span><br><span class="line">						arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][nowp.C][<span class="number">0</span>] = nowp.V;</span><br><span class="line">						arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][nowp.C][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">						arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][nowp.C][<span class="number">2</span>] = nowp.V;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span> &#123;</span><br><span class="line">						++arr[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>][nowp.C][<span class="number">1</span>];</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// DP finished</span></span><br><span class="line">		<span class="keyword">int</span> max_value = <span class="number">-1</span>, min_cost = maxn, sum_num = <span class="number">0</span>;</span><br><span class="line">		dfor(g, mg, <span class="number">1</span>)dfor(d, md, <span class="number">3</span>)dfor(m, mm, <span class="number">2</span>)dfor(f, mf, <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (g + d + m + f != <span class="number">11</span>) <span class="keyword">continue</span>;</span><br><span class="line">			dfor(c, L, <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="keyword">int</span>(&amp;now)[<span class="number">3</span>] = arr[g][d][m][f][c];</span><br><span class="line">				<span class="comment">//if (now[0]) &#123;</span></span><br><span class="line">				<span class="comment">//	cerr &lt;&lt; "   val: " &lt;&lt; now[0] + now[2] &lt;&lt; "\tnum: " &lt;&lt; now[1] &lt;&lt; "\tcost: " &lt;&lt; c &lt;&lt; '\t';</span></span><br><span class="line">				<span class="comment">//	cerr &lt;&lt; "g: " &lt;&lt; g &lt;&lt; " d: " &lt;&lt; d &lt;&lt; " m: " &lt;&lt; m &lt;&lt; " f: " &lt;&lt; f &lt;&lt; endl;</span></span><br><span class="line">				<span class="comment">//&#125;</span></span><br><span class="line">				<span class="keyword">if</span> (now[<span class="number">0</span>] + now[<span class="number">2</span>] &gt; max_value) &#123;</span><br><span class="line">					max_value = now[<span class="number">0</span>] + now[<span class="number">2</span>];</span><br><span class="line">					min_cost = c;</span><br><span class="line">					sum_num = now[<span class="number">1</span>];</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span> (now[<span class="number">0</span>] + now[<span class="number">2</span>] == max_value) &#123;</span><br><span class="line">					<span class="keyword">if</span> (min_cost &gt; c) &#123;</span><br><span class="line">						min_cost = c;</span><br><span class="line">						sum_num = now[<span class="number">1</span>];</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span> (min_cost == c) &#123;</span><br><span class="line">						sum_num += now[<span class="number">1</span>];</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; max_value &lt;&lt; <span class="string">' '</span> &lt;&lt; min_cost &lt;&lt; <span class="string">' '</span> &lt;&lt; sum_num &lt;&lt; <span class="string">" \n"</span>[T];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>ACM</category>
      </categories>
      <tags>
        <tag>ACM</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces 794C - Naming Company</title>
    <url>/posts/15668.html</url>
    <content><![CDATA[<p>http://codeforces.com/contest/794/problem/C</p>
<h1 id="description">Description</h1>
<p>Oleg the client and Igor the analyst are good friends. However, sometimes they argue over little things. Recently, they started a new company, but they are having trouble finding a name for the company.</p>
<p>To settle this problem, they've decided to play a game. The company name will consist of n letters. Oleg and Igor each have a set of n letters (which might contain multiple copies of the same letter, the sets can be different). Initially, the company name is denoted by n question marks. Oleg and Igor takes turns to play the game, Oleg moves first. In each turn, a player can choose one of the letters c in his set and replace any of the question marks with c. Then, a copy of the letter c is removed from his set. The game ends when all the question marks has been replaced by some letter.</p>
<p>For example, suppose Oleg has the set of letters {i, o, i} and Igor has the set of letters {i, m, o}. One possible game is as follows :</p>
<p>Initially, the company name is ???.</p>
<p>Oleg replaces the second question mark with 'i'. The company name becomes ?i?. The set of letters Oleg have now is {i, o}.</p>
<p>Igor replaces the third question mark with 'o'. The company name becomes ?io. The set of letters Igor have now is {i, m}.</p>
<p>Finally, Oleg replaces the first question mark with 'o'. The company name becomes oio. The set of letters Oleg have now is {i}.</p>
<p>In the end, the company name is oio.</p>
<p>Oleg wants the company name to be as lexicographically small as possible while Igor wants the company name to be as lexicographically large as possible. What will be the company name if Oleg and Igor always play optimally?</p>
<p>A string <span class="math inline">\(s = s_1s_2...s_m\)</span> is called lexicographically smaller than a string <span class="math inline">\(t = t_1t_2...t_m\)</span> (where <span class="math inline">\(s ≠ t\)</span>) if <span class="math inline">\(si &lt; ti\)</span> where <span class="math inline">\(i\)</span> is the smallest index such that <span class="math inline">\(s_i ≠ t_i\)</span>. (so <span class="math inline">\(s_j = t_j\)</span> for all <span class="math inline">\(j &lt; i\)</span>)</p>
<h1 id="input">Input</h1>
<p>The first line of input contains a string <span class="math inline">\(s\)</span> of length <span class="math inline">\(n\)</span> (<span class="math inline">\(1 ≤ n ≤ 3·10^5\)</span>). All characters of the string are lowercase English letters. This string denotes the set of letters Oleg has initially.</p>
<p>The second line of input contains a string <span class="math inline">\(t\)</span> of length <span class="math inline">\(n\)</span>. All characters of the string are lowercase English letters. This string denotes the set of letters Igor has initially.</p>
<h1 id="output">Output</h1>
<p>The output should contain a string of <span class="math inline">\(n\)</span> lowercase English letters, denoting the company name if Oleg and Igor plays optimally.</p>
<h1 id="examples">Examples</h1>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="built_in">input</span></span><br><span class="line">tinkoff</span><br><span class="line">zscoder</span><br><span class="line"></span><br><span class="line"><span class="built_in">output</span></span><br><span class="line">fzfsirk</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span></span><br><span class="line">xxxxxx</span><br><span class="line">xxxxxx</span><br><span class="line"></span><br><span class="line"><span class="built_in">output</span></span><br><span class="line">xxxxxx</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span></span><br><span class="line">ioi</span><br><span class="line">imo</span><br><span class="line"></span><br><span class="line"><span class="built_in">output</span></span><br><span class="line">ioi</span><br></pre></td></tr></table></figure>
<h1 id="note">Note</h1>
<p>One way to play optimally in the first sample is as follows :</p>
<p>Initially, the company name is ???????. Oleg replaces the first question mark with 'f'. The company name becomes f??????. Igor replaces the second question mark with 'z'. The company name becomes fz?????. Oleg replaces the third question mark with 'f'. The company name becomes fzf????. Igor replaces the fourth question mark with 's'. The company name becomes fzfs???. Oleg replaces the fifth question mark with 'i'. The company name becomes fzfsi??. Igor replaces the sixth question mark with 'r'. The company name becomes fzfsir?. Oleg replaces the seventh question mark with 'k'. The company name becomes fzfsirk. For the second sample, no matter how they play, the company name will always be xxxxxx.</p>
<h1 id="announcement">Announcement</h1>
<p>Problem C. Naming Company <span class="math inline">\(*****\)</span> The two players know the letters in both sets.</p>
<h1 id="key">Key</h1>
<p><strong>题意：</strong>甲乙两人各持有一个长度均为n的字符串，轮着向一个新的长也为n的字符串里放字符，甲先行。甲每一步都试图让字符串按字典序最小化，乙每一步都试图让字符串按字典序最大化。问最后这新字符串是什么。</p>
<p><strong>思路：</strong>做题做到一半时出题人推送了一个Announcement（如上面所示）：甲乙均知道对面的情况。这是个很重要的提示。 显然的是，先排个序，甲从小到大，乙从大到小。然后两个字符串的后一半肯定是用不上了，砍掉。最后甲字符串长度<span class="math inline">\((len + 1) / 2\)</span>，乙字符串长度<span class="math inline">\((len) / 2\)</span>。 甲乙试图让自己走的每一步最优，那就是贪心无误了。 1.当<span class="math inline">\(甲最小的字符&lt;乙最大的字符\)</span>时，两者均靠左放置最小/大字符。 2.当<span class="math inline">\(甲最小的字符&gt;=乙最大的字符\)</span>时，两者均靠右放置最大/小字符。</p>
<p>如何找当前最优情况想了很久，一开始想的情况很复杂，如何换个角度思考问题很不容易啊。要注意的是第2种情况的等于号，一开始我放在第1种情况上了（“&lt;=”），这是不对的，找了好久最后才发现竟然错在了一个小小的等于号。“=”号一删，瞬间AC。</p>
<h1 id="code">Code</h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> s1[maxn], s2[maxn], ans[maxn];</span><br><span class="line"><span class="keyword">int</span> len;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp1</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> &amp;a, <span class="keyword">const</span> <span class="keyword">char</span> &amp;b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a &lt; b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp2</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> &amp;a, <span class="keyword">const</span> <span class="keyword">char</span> &amp;b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a &gt; b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">	len = <span class="built_in">strlen</span>(s1);</span><br><span class="line">	sort(s1, s1 + len, cmp1);</span><br><span class="line">	sort(s2, s2 + len, cmp2);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> *pl[<span class="number">2</span>] = &#123; s1, s2 &#125;;</span><br><span class="line">	<span class="keyword">for</span> (; (i &lt; len) &amp;&amp; (*pl[<span class="number">0</span>] &lt; *pl[<span class="number">1</span>]); ++i) &#123;</span><br><span class="line">		ans[i] = *(pl[i &amp; <span class="number">1</span>]++);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> j = len - <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> *pr[<span class="number">2</span>] = &#123; s1 + (len + <span class="number">1</span>) / <span class="number">2</span> - <span class="number">1</span>, s2 + (len) / <span class="number">2</span> - <span class="number">1</span> &#125;;</span><br><span class="line">	<span class="keyword">for</span> (; i &lt; len; ++i, --j) &#123;</span><br><span class="line">		ans[j] = *(pr[i &amp; <span class="number">1</span>]--);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ans[len] = <span class="string">'\0'</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; ans;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>C++控制台扫雷</title>
    <url>/posts/52546.html</url>
    <content><![CDATA[<p>其实是大一还不会GUI时闲着无聊写的。都是硬编码，也不支持自定义棋盘大小，现在看看这代码惨不忍睹。下载地址：http://download.csdn.net/download/xienaoban/9835259</p>
<p>#实现 输入P x y 模拟插下小旗，输入I x y 模拟点下去，输入O x y 模拟探测，输入R重玩。 原理嘛就是开局生成8个雷，并将所有点周围的雷计算好填入棋盘。当输入Ixy点下去时若该点为0，则显示该点并DFS递归遍历周围所有点并显示；若为非零，则直接显示它；若为雷则输了。 唯一与别人不同的特性是，输入本人的名字首字母xjf（必须小写）可以作弊<sub>(￣▽￣)</sub>，就是显示棋盘上所有的雷~</p>
<p>#截图</p>
<figure>
<img src="/posts/52546/1.png" alt="这里写图片描述"><figcaption>这里写图片描述</figcaption>
</figure>
<figure>
<img src="/posts/52546/2.png" alt="这里写图片描述"><figcaption>这里写图片描述</figcaption>
</figure>
<figure>
<img src="/posts/52546/3.png" alt="这里写图片描述"><figcaption>这里写图片描述</figcaption>
</figure>
<p>#代码 <figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">o</span><span class="params">(<span class="keyword">int</span> i)</span><span class="comment">//防止超出数组范围</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (i &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">xianshi</span><span class="params">(<span class="keyword">char</span> p[][<span class="number">11</span>])</span><span class="comment">//显示棋盘</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	system(<span class="string">"cls"</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"-------------------------------------------------------------------------------\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                    0   1   2   3   4   5   6   7   8   9                    |\n"</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">9</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"|                  "</span> &lt;&lt; i;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">9</span>;j++) <span class="built_in">cout</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; p[i][j] &lt;&lt; <span class="string">" |"</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; p[i][<span class="number">9</span>] &lt;&lt; <span class="string">' '</span> &lt;&lt; i &lt;&lt; <span class="string">"                  |\n"</span></span><br><span class="line">			&lt;&lt; <span class="string">"|                   ---+---+---+---+---+---+---+---+---+---                   |\n"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"|                  9"</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">9</span>;j++) <span class="built_in">cout</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; p[<span class="number">9</span>][j] &lt;&lt; <span class="string">" |"</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; p[<span class="number">9</span>][<span class="number">9</span>] &lt;&lt; <span class="string">" 9                  |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                    0   1   2   3   4   5   6   7   8   9                    |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                                                                             |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"-------------------------------------------------------------------------------\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">panduan</span><span class="params">(<span class="keyword">char</span> p[][<span class="number">11</span>], <span class="keyword">char</span> cx, <span class="keyword">char</span> cy, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y, <span class="keyword">char</span> &amp;lei)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">switch</span> (cx)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'0'</span>: x = <span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'1'</span>: x = <span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'2'</span>: x = <span class="number">2</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'3'</span>: x = <span class="number">3</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'4'</span>: x = <span class="number">4</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'5'</span>: x = <span class="number">5</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'6'</span>: x = <span class="number">6</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'7'</span>: x = <span class="number">7</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'8'</span>: x = <span class="number">8</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'9'</span>: x = <span class="number">9</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>: <span class="built_in">cout</span> &lt;&lt; <span class="string">"错误：数据不合法。\n"</span>;<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">switch</span> (cy)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'0'</span>: y = <span class="number">0</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'1'</span>: y = <span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'2'</span>: y = <span class="number">2</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'3'</span>: y = <span class="number">3</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'4'</span>: y = <span class="number">4</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'5'</span>: y = <span class="number">5</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'6'</span>: y = <span class="number">6</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'7'</span>: y = <span class="number">7</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'8'</span>: y = <span class="number">8</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'9'</span>: y = <span class="number">9</span>;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>: <span class="built_in">cout</span> &lt;&lt; <span class="string">"错误：数据不合法。\n"</span>;<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (lei == <span class="string">'o'</span> || lei == <span class="string">'O'</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (p[y][x] != <span class="string">' '</span>&amp;&amp;p[y][x] != <span class="string">'P'</span>) &#123; <span class="built_in">cout</span> &lt;&lt; <span class="string">"错误：数据不合法。\n"</span>;<span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">kaiju</span><span class="params">(<span class="keyword">int</span> a[<span class="number">11</span>][<span class="number">11</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> tx, ty;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">10</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		tx = rand() % <span class="number">10</span>, ty = rand() % <span class="number">10</span>;</span><br><span class="line">		<span class="keyword">while</span> (a[ty][tx] != <span class="number">0</span>) &#123; tx = rand() % <span class="number">10</span>; ty = rand() % <span class="number">10</span>; &#125;</span><br><span class="line">		a[ty][tx] = <span class="number">9</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">10</span>;j++)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">10</span>;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (a[j][i] == <span class="number">9</span>) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span> (a[o(j - <span class="number">1</span>)][o(i - <span class="number">1</span>)] == <span class="number">9</span>) a[j][i]++;</span><br><span class="line">			<span class="keyword">if</span> (a[o(j - <span class="number">1</span>)][o(i)] == <span class="number">9</span>) a[j][i]++;</span><br><span class="line">			<span class="keyword">if</span> (a[o(j - <span class="number">1</span>)][o(i + <span class="number">1</span>)] == <span class="number">9</span>) a[j][i]++;</span><br><span class="line">			<span class="keyword">if</span> (a[o(j)][o(i - <span class="number">1</span>)] == <span class="number">9</span>) a[j][i]++;</span><br><span class="line">			<span class="keyword">if</span> (a[o(j)][o(i + <span class="number">1</span>)] == <span class="number">9</span>) a[j][i]++;</span><br><span class="line">			<span class="keyword">if</span> (a[o(j + <span class="number">1</span>)][o(i - <span class="number">1</span>)] == <span class="number">9</span>) a[j][i]++;</span><br><span class="line">			<span class="keyword">if</span> (a[o(j + <span class="number">1</span>)][o(i)] == <span class="number">9</span>) a[j][i]++;</span><br><span class="line">			<span class="keyword">if</span> (a[o(j + <span class="number">1</span>)][o(i + <span class="number">1</span>)] == <span class="number">9</span>) a[j][i]++;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">kong</span><span class="params">(<span class="keyword">int</span> pp[][<span class="number">11</span>], <span class="keyword">char</span> p[][<span class="number">11</span>], <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (p[y][x] == <span class="string">' '</span> &amp;&amp; x != <span class="number">10</span> &amp;&amp; y != <span class="number">10</span> &amp;&amp; p[y][x] != <span class="string">'P'</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (pp[y][x] == <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			p[y][x] = <span class="string">'0'</span>;</span><br><span class="line">			kong(pp, p, o(x - <span class="number">1</span>), o(y - <span class="number">1</span>));</span><br><span class="line">			kong(pp, p, x, o(y - <span class="number">1</span>));</span><br><span class="line">			kong(pp, p, x + <span class="number">1</span>, o(y - <span class="number">1</span>));</span><br><span class="line">			kong(pp, p, o(x - <span class="number">1</span>), y);</span><br><span class="line">			kong(pp, p, x + <span class="number">1</span>, y);</span><br><span class="line">			kong(pp, p, o(x - <span class="number">1</span>), y + <span class="number">1</span>);</span><br><span class="line">			kong(pp, p, x, y + <span class="number">1</span>);</span><br><span class="line">			kong(pp, p, o(x + <span class="number">1</span>), o(y + <span class="number">1</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> p[y][x] = (<span class="keyword">char</span>)(<span class="number">48</span> + pp[y][x]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">zhongjian</span><span class="params">(<span class="keyword">int</span> pp[][<span class="number">11</span>], <span class="keyword">char</span> p[][<span class="number">11</span>], <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (p[y][x] != <span class="string">' '</span> &amp;&amp;</span><br><span class="line">		(pp[o(y - <span class="number">1</span>)][o(x - <span class="number">1</span>)] != <span class="number">9</span> || (p[o(y - <span class="number">1</span>)][o(x - <span class="number">1</span>)] == <span class="string">'P'</span>&amp;&amp;pp[o(y - <span class="number">1</span>)][o(x - <span class="number">1</span>)] == <span class="number">9</span>)) &amp;&amp;</span><br><span class="line">		(pp[o(y - <span class="number">1</span>)][x] != <span class="number">9</span> || (p[o(y - <span class="number">1</span>)][x] == <span class="string">'P'</span>&amp;&amp;pp[o(y - <span class="number">1</span>)][x] == <span class="number">9</span>)) &amp;&amp;</span><br><span class="line">		(pp[o(y - <span class="number">1</span>)][x + <span class="number">1</span>] != <span class="number">9</span> || (p[o(y - <span class="number">1</span>)][x + <span class="number">1</span>] == <span class="string">'P'</span>&amp;&amp;pp[o(y - <span class="number">1</span>)][x + <span class="number">1</span>] == <span class="number">9</span>)) &amp;&amp;</span><br><span class="line">		(pp[y][o(x - <span class="number">1</span>)] != <span class="number">9</span> || (p[y][o(x - <span class="number">1</span>)] == <span class="string">'P'</span>&amp;&amp;pp[y][o(x - <span class="number">1</span>)] == <span class="number">9</span>)) &amp;&amp;</span><br><span class="line">		(pp[y][x + <span class="number">1</span>] != <span class="number">9</span> || (p[y][x + <span class="number">1</span>] == <span class="string">'P'</span>&amp;&amp;pp[y][x + <span class="number">1</span>] == <span class="number">9</span>)) &amp;&amp;</span><br><span class="line">		(pp[y + <span class="number">1</span>][o(x - <span class="number">1</span>)] != <span class="number">9</span> || (p[y + <span class="number">1</span>][o(x - <span class="number">1</span>)] == <span class="string">'P'</span>&amp;&amp;pp[y + <span class="number">1</span>][o(x - <span class="number">1</span>)] == <span class="number">9</span>)) &amp;&amp;</span><br><span class="line">		(pp[y + <span class="number">1</span>][x] != <span class="number">9</span> || (p[y + <span class="number">1</span>][x] == <span class="string">'P'</span>&amp;&amp;pp[y + <span class="number">1</span>][x] == <span class="number">9</span>)) &amp;&amp;</span><br><span class="line">		(pp[y + <span class="number">1</span>][x + <span class="number">1</span>] != <span class="number">9</span> || (p[y + <span class="number">1</span>][x + <span class="number">1</span>] == <span class="string">'P'</span>&amp;&amp;pp[y + <span class="number">1</span>][x + <span class="number">1</span>] != <span class="number">9</span>)))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (p[o(y - <span class="number">1</span>)][o(x - <span class="number">1</span>)] == <span class="string">' '</span>) kong(pp, p, o(x - <span class="number">1</span>), o(y - <span class="number">1</span>));</span><br><span class="line">		<span class="keyword">if</span> (p[o(y - <span class="number">1</span>)][x] == <span class="string">' '</span>) kong(pp, p, x, o(y - <span class="number">1</span>));</span><br><span class="line">		<span class="keyword">if</span> (p[o(y - <span class="number">1</span>)][x + <span class="number">1</span>] == <span class="string">' '</span>) kong(pp, p, x+<span class="number">1</span>, o(y - <span class="number">1</span>));</span><br><span class="line">		<span class="keyword">if</span> (p[y][o(x - <span class="number">1</span>)] == <span class="string">' '</span>) kong(pp, p, o(x<span class="number">-1</span>), y);</span><br><span class="line">		<span class="keyword">if</span> (p[y][x + <span class="number">1</span>] == <span class="string">' '</span>) kong(pp, p,x+<span class="number">1</span>, y);</span><br><span class="line">		<span class="keyword">if</span> (p[y + <span class="number">1</span>][o(x - <span class="number">1</span>)] == <span class="string">' '</span>) kong(pp, p, o(x - <span class="number">1</span>), y+<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">if</span> (p[y + <span class="number">1</span>][x] == <span class="string">' '</span>) kong(pp, p, x, y + <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">if</span> (p[y + <span class="number">1</span>][x + <span class="number">1</span>] == <span class="string">' '</span>) kong(pp, p, x + <span class="number">1</span>, y + <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	system(<span class="string">"mode con cols=80 lines=33"</span>);</span><br><span class="line">	system(<span class="string">"cls"</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"-------------------------------------------------------------------------------\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                    0   1   2   3   4   5   6   7   8   9                    |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                  0   |   |   |   |   |   |   |   |   |   0                  |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                   ---+---+---+---+---+---+---+---+---+---                   |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                  1   |   |   |   |   |   |   |   |   |   1                  |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                   ---+---+---+---+---+---+---+---+---+---                   |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                  2   |   |   |   |   |   |   |   |   |   2                  |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                   ---+---+---+---+---+---+---+---+---+---                   |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                  3   |   |   |   |   |   |   |   |   |   3                  |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                   ---+---+---+---+---+---+---+---+---+---                   |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                  4   |   |   |   |   |   |   |   |   |   4                  |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                   ---+---+---+---+---+---+---+---+---+---                   |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                  5   |   |   |   |   |   |   |   |   |   5                  |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                   ---+---+---+---+---+---+---+---+---+---                   |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                  6   |   |   |   |   |   |   |   |   |   6                  |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                   ---+---+---+---+---+---+---+---+---+---                   |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                  7   |   |   |   |   |   |   |   |   |   7                  |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                   ---+---+---+---+---+---+---+---+---+---                   |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                  8   |   |   |   |   |   |   |   |   |   8                  |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                   ---+---+---+---+---+---+---+---+---+---                   |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                  9   |   |   |   |   |   |   |   |   |   9                  |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                    0   1   2   3   4   5   6   7   8   9                    |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"|                                                                             |\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"-------------------------------------------------------------------------------\n"</span></span><br><span class="line">		&lt;&lt; <span class="string">"输入P x y 模拟插下小旗\n输入I x y 模拟点下去\n输入O x y 模拟探测。\n"</span>;</span><br><span class="line">	<span class="keyword">char</span> cx = <span class="string">'0'</span>, cy = <span class="string">'0'</span>;</span><br><span class="line">	<span class="keyword">int</span> x = <span class="number">0</span>, y = <span class="number">0</span>;<span class="comment">//玩家下的子</span></span><br><span class="line">	<span class="keyword">char</span> lei = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> jieju = <span class="number">0</span>;<span class="comment">//1:玩家赢 2:玩家输</span></span><br><span class="line">	<span class="keyword">char</span> p[<span class="number">11</span>][<span class="number">11</span>];<span class="comment">//显示的</span></span><br><span class="line">	<span class="keyword">int</span> pp[<span class="number">11</span>][<span class="number">11</span>] = &#123; <span class="number">0</span> &#125;;<span class="comment">//表示的</span></span><br><span class="line">	srand((<span class="keyword">unsigned</span>)time(<span class="number">0</span>));</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">11</span>;i++)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">11</span>;j++)</span><br><span class="line">			p[i][j] = <span class="string">' '</span>;</span><br><span class="line">	kaiju(pp);</span><br><span class="line">	<span class="keyword">while</span> (!jieju)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">"Player&gt; "</span>;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; lei;</span><br><span class="line">			<span class="keyword">if</span> (lei == <span class="string">'R'</span> || lei == <span class="string">'r'</span>) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">"重新开局？再次输入R 确定，输入其他继续当前游戏。"</span>;</span><br><span class="line">				<span class="built_in">cin</span> &gt;&gt; lei;</span><br><span class="line">				<span class="keyword">if</span> (lei == <span class="string">'R'</span> || lei == <span class="string">'r'</span>)</span><br><span class="line">					main();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; cx &gt;&gt; cy;</span><br><span class="line">			<span class="keyword">if</span> (lei == <span class="string">'x'</span>&amp;&amp;cx == <span class="string">'j'</span>&amp;&amp;cy == <span class="string">'f'</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> tpp[<span class="number">11</span>][<span class="number">11</span>];</span><br><span class="line">				<span class="keyword">char</span> tp[<span class="number">11</span>][<span class="number">11</span>];</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">11</span>;i++)</span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">11</span>;j++)</span><br><span class="line">						tpp[j][i] = pp[j][i];</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">11</span>;i++)</span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">11</span>;j++)</span><br><span class="line">						tp[i][j] = <span class="string">' '</span>;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">10</span>;i++)</span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">10</span>;j++)</span><br><span class="line">						<span class="keyword">if</span> (tpp[j][i] == <span class="number">9</span>) tp[j][i] = <span class="string">'*'</span>;</span><br><span class="line">				xianshi(tp);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (panduan(p, cx, cy, x, y, lei)) <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (lei != <span class="string">'P'</span> &amp;&amp; lei != <span class="string">'p'</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (lei != <span class="string">'o'</span> &amp;&amp; lei != <span class="string">'O'</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (pp[y][x] == <span class="number">9</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					p[y][x] = <span class="string">'*'</span>;</span><br><span class="line">					xianshi(p);</span><br><span class="line">					jieju = <span class="number">2</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span> (pp[y][x] != <span class="number">0</span> &amp;&amp; pp[y][x] != <span class="number">9</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					p[y][x] = (<span class="keyword">char</span>)(pp[y][x] + <span class="number">48</span>);</span><br><span class="line">					xianshi(p);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">				&#123;</span><br><span class="line">					kong(pp, p, x, y);</span><br><span class="line">					xianshi(p);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				zhongjian(pp, p, x, y);</span><br><span class="line">				xianshi(p);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (p[y][x] == <span class="string">' '</span>) p[y][x] = <span class="string">'P'</span>;</span><br><span class="line">			<span class="keyword">else</span> p[y][x] = <span class="string">' '</span>;</span><br><span class="line">			xianshi(p);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> temp = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">10</span>;i++)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">10</span>;j++)</span><br><span class="line">				<span class="keyword">if</span> (p[i][j] == <span class="string">' '</span> || p[i][j] == <span class="string">'P'</span>) temp++;</span><br><span class="line">		<span class="keyword">if</span> (temp == <span class="number">10</span>) jieju = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (jieju == <span class="number">1</span>) <span class="built_in">cout</span> &lt;&lt; <span class="string">"You win!\n"</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; <span class="string">"You fail!\n"</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"输入R再玩一局；输入其他结束。\n"</span>;</span><br><span class="line">	<span class="keyword">char</span> r;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; r;</span><br><span class="line">	<span class="keyword">if</span> (r == <span class="string">'R'</span> || r == <span class="string">'r'</span>) main();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <tags>
        <tag>扫雷</tag>
        <tag>造轮子</tag>
      </tags>
  </entry>
  <entry>
    <title>八皇后问题动态演示</title>
    <url>/posts/4561.html</url>
    <content><![CDATA[<p>学校组织的计算机技能大赛，题目解八皇后并做程序演示，顺便就贴博客上来。</p>
<h1 id="八皇后问题">八皇后问题</h1>
<p>简述：8*8的棋盘，有八个皇后，每个皇后不能在同一行同一列同一斜线上，问有多少种可能的摆法。答案是92，这大家都知道。</p>
<p>#解法与优化 首先肯定是遍历嘛，关键是要剪枝。</p>
<p>##1.暴力枚举 8个子所有点遍历一遍，8个嵌套for，一共<span class="math inline">\(C_{64}^{8}\)</span>种情况。曰曰</p>
<p>##2.回溯法 由于每个皇后不能在一行，那八个皇后就在八个不同行上面嘛，对于每个皇后/每一行，采用回溯法先第一行放一个，在第二行剩下7个位置中找第二个皇后可能的位置，以此类推，一共<span class="math inline">\(8^8 = 16777216\)</span>种情况。</p>
<p>##3.全排列 由于每个皇后不同行不同列，那么在每个皇后占一行的基础上，每个皇后在0-7个列只能占一个，就相当于一个全排列，要考虑<span class="math inline">\(A_8^8 = 8! = 40320\)</span>种情况，较上述两个方法已经快了很多了。网上也都是回溯和全排列的算法。但是事实上还能再剪枝。</p>
<p>##4.全排列再剪枝 对于全排列，依然可以剪枝。例如下图情况： <img src="/posts/4561/1.jpg" alt="这里写图片描述"> 它的下一个排列是： <img src="/posts/4561/2.jpg" alt="这里写图片描述"> 但是我们很明显的看到，第一、第二个皇后已经不满足条件了，后面的皇后无需再看了。因此我们直接跳到第1、2个皇后满足条件的排列： <img src="/posts/4561/3.jpg" alt="这里写图片描述"></p>
<p>最终，我们只需遍历3576种情况（根据实践得到的数据），这在全排列的基础上又优化了十倍多。这对八皇后适用，对n皇后都适用。</p>
<p>#程序实现 ##概况 使用C#编写，平台是win10，环境是.Net Framework 4.6.1。 <img src="/posts/4561/4.png" alt="这里写图片描述"> 下载地址：http://download.csdn.net/download/xienaoban/9835240</p>
<p>##特性 按“重置”即重置进度；</p>
<p>按“下一个”查找下一个符合条件的解并展示； <img src="/posts/4561/5.png" alt="这里写图片描述"></p>
<p>按“直接得出结果”不显示动画直接输出结果； <img src="/posts/4561/6.png" alt="这里写图片描述"></p>
<p>勾选“显示所有动画情况”演示所有遍历情况，勾选后再次点击“下一个”或“直接得出结果”演示所有遍历的情况；</p>
<p>遍历到当前方案时的遍历次数统计与可行方案统计显示在下方；</p>
<p>演示窗口自适应，修改窗口尺寸时始终保证棋盘最大化地显示在窗口中间；</p>
<p>演示画布采用双缓冲，防止演示动画时的窗口动画闪屏。</p>
<p>##代码 八皇后类EnumQueens.cs（实现查找下一排列、重置排列等）： <figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">System</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">System</span>.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">System</span>.Drawing;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">System</span>.Linq;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">System</span>.Text;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">System</span>.Threading.Tasks;</span><br><span class="line"></span><br><span class="line">namespace EightQueen</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> EnumQueens</span><br><span class="line">    &#123;</span><br><span class="line">        private <span class="type">int</span>[] Board;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">public</span> EnumQueens()</span><br><span class="line">        &#123;</span><br><span class="line">            Board = <span class="built_in">new</span> <span class="type">int</span>[<span class="number">8</span>];</span><br><span class="line">            <span class="keyword">Reset</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">public</span> <span class="type">void</span> <span class="keyword">Reset</span>()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                Board[i] = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">public</span> <span class="type">bool</span> Next()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = Board.Length - <span class="number">1</span>; i &gt; <span class="number">0</span>; <span class="comment">--i)</span></span><br><span class="line">            &#123; </span><br><span class="line">                <span class="keyword">if</span> (Board[i] &gt; Board[i - <span class="number">1</span>])</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="type">int</span> val = Board[i - <span class="number">1</span>];</span><br><span class="line">                    <span class="type">int</span> j = Board.Length - <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">for</span> (; j &gt;= i; <span class="comment">--j)</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (Board[j] &gt; val)</span><br><span class="line">                            break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    SwapBoard(i - <span class="number">1</span>, j);</span><br><span class="line">                    <span class="type">int</span> l = i;</span><br><span class="line">                    <span class="type">int</span> r = Board.Length - <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">while</span> (l &lt; r)</span><br><span class="line">                    &#123;</span><br><span class="line">                        SwapBoard(l, r);</span><br><span class="line">                        l++;</span><br><span class="line">                        r<span class="comment">--;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">Reset</span>();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">public</span> <span class="type">Point</span> <span class="keyword">Check</span>()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">Point</span> ans = <span class="built_in">new</span> <span class="type">Point</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; Board.Length; ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; Board.Length; ++j)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (Math.Abs(i - j) == Math.Abs(Board[i] - Board[j]))</span><br><span class="line">                    &#123;</span><br><span class="line">                        ans.X = i;ans.Y = j;</span><br><span class="line">                        <span class="keyword">return</span> ans;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ans.X = <span class="number">-1</span>; ans.Y = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">public</span> <span class="type">int</span> <span class="keyword">Get</span>(<span class="type">int</span> i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Board[i];</span><br><span class="line">        &#125; </span><br><span class="line"></span><br><span class="line">        private <span class="type">void</span> SwapBoard(<span class="type">int</span> i, <span class="type">int</span> j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> t = Board[i];</span><br><span class="line">            Board[i] = Board[j];</span><br><span class="line">            Board[j] = t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>含棋盘的演示窗口：MainForm.cs： <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.ComponentModel;</span><br><span class="line">using System.Data;</span><br><span class="line">using System.Drawing;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Runtime.InteropServices;</span><br><span class="line">using System.Text;</span><br><span class="line">using System.Threading;</span><br><span class="line">using System.Threading.Tasks;</span><br><span class="line">using System.Windows.Forms;</span><br><span class="line"></span><br><span class="line">namespace EightQueen</span><br><span class="line">&#123;</span><br><span class="line">    public partial class MainForm : Form</span><br><span class="line">    &#123;</span><br><span class="line">        private int FrameLength &#x3D; 30;</span><br><span class="line">        private int Fwidth, Fheight, Fleft, Fright, Ftop, Fbottom, Flength, Fdiameter;</span><br><span class="line"></span><br><span class="line">        private float Dif;</span><br><span class="line"></span><br><span class="line">        [DllImport(&quot;user32 &quot;)]</span><br><span class="line">        private static extern IntPtr FindWindow(string lpClassName, string lpWindowName);</span><br><span class="line">        [DllImport(&quot;user32 &quot;)]</span><br><span class="line">        private static extern IntPtr SetParent(IntPtr hWndChild, IntPtr hWndNewParent);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        public MainForm()</span><br><span class="line">        &#123;</span><br><span class="line">            InitializeComponent();</span><br><span class="line">            Dif &#x3D; 0.8f;</span><br><span class="line">            Width &#x3D; 400;</span><br><span class="line">            Height &#x3D; 600;</span><br><span class="line"></span><br><span class="line">            PannelForm pForm &#x3D; new PannelForm();</span><br><span class="line">            pForm.Show();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private void MainForm_SizeChanged(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            if (Program.Board.Get(0) &#x3D;&#x3D; 0 &amp;&amp; Program.Board.Get(1) &#x3D;&#x3D; 1) PaintQueens(Color.Orange);</span><br><span class="line">            else PaintQueens(Color.LightGreen);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private void MainForm_Paint(object sender, PaintEventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            if (Program.Board.Get(0) &#x3D;&#x3D; 0 &amp;&amp; Program.Board.Get(1) &#x3D;&#x3D; 1) PaintQueens(Color.Orange);</span><br><span class="line">            else PaintQueens(Color.LightGreen);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void PaintQueens(Color c)</span><br><span class="line">        &#123;</span><br><span class="line">            Bitmap bmp &#x3D; new Bitmap(Width, Height);</span><br><span class="line">            Graphics grp &#x3D; Graphics.FromImage(bmp);</span><br><span class="line">            grp.Clear(Color.Azure);</span><br><span class="line">            Pen pen;</span><br><span class="line"></span><br><span class="line">            CalFrame();</span><br><span class="line"></span><br><span class="line">            pen &#x3D; new Pen(Brushes.DeepSkyBlue, Flength &#x2F; 160);</span><br><span class="line">            for (int i &#x3D; 1; i &lt; 8; ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                grp.DrawLine(pen, new Point(Fleft + i * Fdiameter, Ftop), new Point(Fleft + i * Fdiameter, Fbottom));</span><br><span class="line">                grp.DrawLine(pen, new Point(Fleft, Ftop + i * Fdiameter), new Point(Fright, Ftop + i * Fdiameter));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            pen &#x3D; new Pen(Brushes.DodgerBlue, Flength &#x2F; 100);</span><br><span class="line">            grp.DrawLine(pen, new Point(Fleft, Ftop), new Point(Fright, Ftop));</span><br><span class="line">            grp.DrawLine(pen, new Point(Fright, Ftop), new Point(Fright, Fbottom));</span><br><span class="line">            grp.DrawLine(pen, new Point(Fleft, Fbottom), new Point(Fright, Fbottom));</span><br><span class="line">            grp.DrawLine(pen, new Point(Fleft, Ftop), new Point(Fleft, Fbottom));</span><br><span class="line"></span><br><span class="line">            SolidBrush brush &#x3D; new SolidBrush(c);</span><br><span class="line">            Rectangle rect;</span><br><span class="line">            int dif &#x3D; (int)((1.0f - Dif) * Fdiameter&#x2F;2);</span><br><span class="line"></span><br><span class="line">            for (int i &#x3D; 0; i &lt; 8; ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                rect &#x3D; new Rectangle(Fleft + Program.Board.Get(i) * Fdiameter + dif, Ftop + i * Fdiameter + dif, Fdiameter - 2 * dif, Fdiameter - 2 * dif);</span><br><span class="line">                grp.FillEllipse(brush, rect);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            this.CreateGraphics().DrawImage(bmp, 0, 0);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private void CalFrame()</span><br><span class="line">        &#123;</span><br><span class="line">            int width &#x3D; this.Width - 17;</span><br><span class="line">            int height &#x3D; this.Height - 40;</span><br><span class="line">            Fwidth &#x3D; width - FrameLength * 2;</span><br><span class="line">            Fheight &#x3D; height - FrameLength * 2;</span><br><span class="line">            Flength &#x3D; (Math.Min(Fwidth, Fheight) &#x2F; 8) * 8;</span><br><span class="line">            Fleft &#x3D; (width - Flength) &#x2F; 2;</span><br><span class="line">            Fright &#x3D; Fleft + Flength;</span><br><span class="line">            Ftop &#x3D; (height - Flength) &#x2F; 2;</span><br><span class="line">            Fbottom &#x3D; Ftop + Flength;</span><br><span class="line"></span><br><span class="line">            Fdiameter &#x3D; Flength &#x2F; 8;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>控制面板窗口PannelForm.cs： <figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Drawing;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Text;</span><br><span class="line">using System.Threading;</span><br><span class="line">using System.Threading.Tasks;</span><br><span class="line">using System.Windows.Forms;</span><br><span class="line"></span><br><span class="line">namespace EightQueen</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> partial <span class="class"><span class="keyword">class</span> <span class="title">PannelForm</span> : <span class="type">Form</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> Button button1;</span><br><span class="line">        <span class="keyword">private</span> Button button2;</span><br><span class="line">        <span class="keyword">private</span> Label label1;</span><br><span class="line">        <span class="keyword">private</span> Label label2;</span><br><span class="line">        <span class="keyword">private</span> Label label3;</span><br><span class="line">        <span class="keyword">private</span> Label label4;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> int Ergodic, Solution;</span><br><span class="line">        <span class="keyword">private</span> Button button3;</span><br><span class="line">        <span class="keyword">private</span> Button button4;</span><br><span class="line">        <span class="keyword">private</span> Button button5;</span><br><span class="line">        <span class="keyword">private</span> CheckBox checkBox1;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> PannelForm()</span><br><span class="line">        &#123;</span><br><span class="line">            InitializeComponent();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> void InitializeComponent()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.button1 = new System.Windows.Forms.Button();</span><br><span class="line">            <span class="keyword">this</span>.button2 = new System.Windows.Forms.Button();</span><br><span class="line">            <span class="keyword">this</span>.label1 = new System.Windows.Forms.Label();</span><br><span class="line">            <span class="keyword">this</span>.label2 = new System.Windows.Forms.Label();</span><br><span class="line">            <span class="keyword">this</span>.label3 = new System.Windows.Forms.Label();</span><br><span class="line">            <span class="keyword">this</span>.label4 = new System.Windows.Forms.Label();</span><br><span class="line">            <span class="keyword">this</span>.button3 = new System.Windows.Forms.Button();</span><br><span class="line">            <span class="keyword">this</span>.button4 = new System.Windows.Forms.Button();</span><br><span class="line">            <span class="keyword">this</span>.checkBox1 = new System.Windows.Forms.CheckBox();</span><br><span class="line">            <span class="keyword">this</span>.button5 = new System.Windows.Forms.Button();</span><br><span class="line">            <span class="keyword">this</span>.SuspendLayout();</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="comment">// button1</span></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">this</span>.button1.FlatStyle = System.Windows.Forms.FlatStyle.Flat;</span><br><span class="line">            <span class="keyword">this</span>.button1.Font = new System.Drawing.Font(<span class="string">"微软雅黑"</span>, <span class="number">15F</span>);</span><br><span class="line">            <span class="keyword">this</span>.button1.ForeColor = System.Drawing.SystemColors.HotTrack;</span><br><span class="line">            <span class="keyword">this</span>.button1.Location = new System.Drawing.Point(<span class="number">12</span>, <span class="number">12</span>);</span><br><span class="line">            <span class="keyword">this</span>.button1.Name = <span class="string">"button1"</span>;</span><br><span class="line">            <span class="keyword">this</span>.button1.Size = new System.Drawing.Size(<span class="number">268</span>, <span class="number">51</span>);</span><br><span class="line">            <span class="keyword">this</span>.button1.TabIndex = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">this</span>.button1.Text = <span class="string">"重置"</span>;</span><br><span class="line">            <span class="keyword">this</span>.button1.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;</span><br><span class="line">            <span class="keyword">this</span>.button1.UseVisualStyleBackColor = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">this</span>.button1.Click += new System.EventHandler(<span class="keyword">this</span>.button1_Click);</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="comment">// button2</span></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">this</span>.button2.BackgroundImageLayout = System.Windows.Forms.ImageLayout.None;</span><br><span class="line">            <span class="keyword">this</span>.button2.FlatStyle = System.Windows.Forms.FlatStyle.Flat;</span><br><span class="line">            <span class="keyword">this</span>.button2.Font = new System.Drawing.Font(<span class="string">"微软雅黑"</span>, <span class="number">15F</span>);</span><br><span class="line">            <span class="keyword">this</span>.button2.ForeColor = System.Drawing.SystemColors.HotTrack;</span><br><span class="line">            <span class="keyword">this</span>.button2.Location = new System.Drawing.Point(<span class="number">12</span>, <span class="number">69</span>);</span><br><span class="line">            <span class="keyword">this</span>.button2.Name = <span class="string">"button2"</span>;</span><br><span class="line">            <span class="keyword">this</span>.button2.Size = new System.Drawing.Size(<span class="number">268</span>, <span class="number">51</span>);</span><br><span class="line">            <span class="keyword">this</span>.button2.TabIndex = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">this</span>.button2.Text = <span class="string">"下一个"</span>;</span><br><span class="line">            <span class="keyword">this</span>.button2.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;</span><br><span class="line">            <span class="keyword">this</span>.button2.UseVisualStyleBackColor = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">this</span>.button2.Click += new System.EventHandler(<span class="keyword">this</span>.button2_Click);</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="comment">// label1</span></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">this</span>.label1.AutoSize = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">this</span>.label1.Font = new System.Drawing.Font(<span class="string">"微软雅黑"</span>, <span class="number">15F</span>, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(<span class="number">134</span>)));</span><br><span class="line">            <span class="keyword">this</span>.label1.ForeColor = System.Drawing.SystemColors.HotTrack;</span><br><span class="line">            <span class="keyword">this</span>.label1.Location = new System.Drawing.Point(<span class="number">17</span>, <span class="number">231</span>);</span><br><span class="line">            <span class="keyword">this</span>.label1.Name = <span class="string">"label1"</span>;</span><br><span class="line">            <span class="keyword">this</span>.label1.Size = new System.Drawing.Size(<span class="number">132</span>, <span class="number">27</span>);</span><br><span class="line">            <span class="keyword">this</span>.label1.TabIndex = <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">this</span>.label1.Text = <span class="string">"遍历次数统计"</span>;</span><br><span class="line">            <span class="keyword">this</span>.label1.Click += new System.EventHandler(<span class="keyword">this</span>.label1_Click);</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="comment">// label2</span></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">this</span>.label2.AutoSize = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">this</span>.label2.Font = new System.Drawing.Font(<span class="string">"华文彩云"</span>, <span class="number">60F</span>);</span><br><span class="line">            <span class="keyword">this</span>.label2.ForeColor = System.Drawing.SystemColors.HotTrack;</span><br><span class="line">            <span class="keyword">this</span>.label2.Location = new System.Drawing.Point(<span class="number">23</span>, <span class="number">258</span>);</span><br><span class="line">            <span class="keyword">this</span>.label2.Name = <span class="string">"label2"</span>;</span><br><span class="line">            <span class="keyword">this</span>.label2.Size = new System.Drawing.Size(<span class="number">80</span>, <span class="number">83</span>);</span><br><span class="line">            <span class="keyword">this</span>.label2.TabIndex = <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">this</span>.label2.Text = <span class="string">"0"</span>;</span><br><span class="line">            <span class="keyword">this</span>.label2.Click += new System.EventHandler(<span class="keyword">this</span>.label2_Click);</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="comment">// label3</span></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">this</span>.label3.AutoSize = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">this</span>.label3.Font = new System.Drawing.Font(<span class="string">"微软雅黑"</span>, <span class="number">15F</span>, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(<span class="number">134</span>)));</span><br><span class="line">            <span class="keyword">this</span>.label3.ForeColor = System.Drawing.SystemColors.HotTrack;</span><br><span class="line">            <span class="keyword">this</span>.label3.Location = new System.Drawing.Point(<span class="number">17</span>, <span class="number">377</span>);</span><br><span class="line">            <span class="keyword">this</span>.label3.Name = <span class="string">"label3"</span>;</span><br><span class="line">            <span class="keyword">this</span>.label3.Size = new System.Drawing.Size(<span class="number">132</span>, <span class="number">27</span>);</span><br><span class="line">            <span class="keyword">this</span>.label3.TabIndex = <span class="number">4</span>;</span><br><span class="line">            <span class="keyword">this</span>.label3.Text = <span class="string">"可行方案统计"</span>;</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="comment">// label4</span></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">this</span>.label4.AutoSize = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">this</span>.label4.Font = new System.Drawing.Font(<span class="string">"华文彩云"</span>, <span class="number">71.99999F</span>, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(<span class="number">134</span>)));</span><br><span class="line">            <span class="keyword">this</span>.label4.ForeColor = System.Drawing.SystemColors.HotTrack;</span><br><span class="line">            <span class="keyword">this</span>.label4.Location = new System.Drawing.Point(<span class="number">23</span>, <span class="number">404</span>);</span><br><span class="line">            <span class="keyword">this</span>.label4.Name = <span class="string">"label4"</span>;</span><br><span class="line">            <span class="keyword">this</span>.label4.Size = new System.Drawing.Size(<span class="number">97</span>, <span class="number">100</span>);</span><br><span class="line">            <span class="keyword">this</span>.label4.TabIndex = <span class="number">5</span>;</span><br><span class="line">            <span class="keyword">this</span>.label4.Text = <span class="string">"0"</span>;</span><br><span class="line">            <span class="keyword">this</span>.label4.Click += new System.EventHandler(<span class="keyword">this</span>.label4_Click);</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="comment">// button3</span></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">this</span>.button3.BackgroundImageLayout = System.Windows.Forms.ImageLayout.None;</span><br><span class="line">            <span class="keyword">this</span>.button3.FlatStyle = System.Windows.Forms.FlatStyle.Flat;</span><br><span class="line">            <span class="keyword">this</span>.button3.Font = new System.Drawing.Font(<span class="string">"微软雅黑"</span>, <span class="number">15F</span>);</span><br><span class="line">            <span class="keyword">this</span>.button3.ForeColor = System.Drawing.SystemColors.HotTrack;</span><br><span class="line">            <span class="keyword">this</span>.button3.Location = new System.Drawing.Point(<span class="number">12</span>, <span class="number">227</span>);</span><br><span class="line">            <span class="keyword">this</span>.button3.Name = <span class="string">"button3"</span>;</span><br><span class="line">            <span class="keyword">this</span>.button3.Size = new System.Drawing.Size(<span class="number">268</span>, <span class="number">140</span>);</span><br><span class="line">            <span class="keyword">this</span>.button3.TabIndex = <span class="number">6</span>;</span><br><span class="line">            <span class="keyword">this</span>.button3.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;</span><br><span class="line">            <span class="keyword">this</span>.button3.UseVisualStyleBackColor = <span class="literal">true</span>;</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="comment">// button4</span></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">this</span>.button4.BackgroundImageLayout = System.Windows.Forms.ImageLayout.None;</span><br><span class="line">            <span class="keyword">this</span>.button4.FlatStyle = System.Windows.Forms.FlatStyle.Flat;</span><br><span class="line">            <span class="keyword">this</span>.button4.Font = new System.Drawing.Font(<span class="string">"微软雅黑"</span>, <span class="number">15F</span>);</span><br><span class="line">            <span class="keyword">this</span>.button4.ForeColor = System.Drawing.SystemColors.HotTrack;</span><br><span class="line">            <span class="keyword">this</span>.button4.Location = new System.Drawing.Point(<span class="number">12</span>, <span class="number">373</span>);</span><br><span class="line">            <span class="keyword">this</span>.button4.Name = <span class="string">"button4"</span>;</span><br><span class="line">            <span class="keyword">this</span>.button4.Size = new System.Drawing.Size(<span class="number">268</span>, <span class="number">140</span>);</span><br><span class="line">            <span class="keyword">this</span>.button4.TabIndex = <span class="number">7</span>;</span><br><span class="line">            <span class="keyword">this</span>.button4.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;</span><br><span class="line">            <span class="keyword">this</span>.button4.UseVisualStyleBackColor = <span class="literal">true</span>;</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="comment">// checkBox1</span></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">this</span>.checkBox1.Font = new System.Drawing.Font(<span class="string">"微软雅黑"</span>, <span class="number">9F</span>, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(<span class="number">134</span>)));</span><br><span class="line">            <span class="keyword">this</span>.checkBox1.ForeColor = System.Drawing.SystemColors.HotTrack;</span><br><span class="line">            <span class="keyword">this</span>.checkBox1.Location = new System.Drawing.Point(<span class="number">17</span>, <span class="number">194</span>);</span><br><span class="line">            <span class="keyword">this</span>.checkBox1.Name = <span class="string">"checkBox1"</span>;</span><br><span class="line">            <span class="keyword">this</span>.checkBox1.Size = new System.Drawing.Size(<span class="number">123</span>, <span class="number">21</span>);</span><br><span class="line">            <span class="keyword">this</span>.checkBox1.TabIndex = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">this</span>.checkBox1.Text = <span class="string">"显示所有遍历情况"</span>;</span><br><span class="line">            <span class="keyword">this</span>.checkBox1.UseVisualStyleBackColor = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">this</span>.checkBox1.CheckedChanged += new System.EventHandler(<span class="keyword">this</span>.checkBox1_CheckedChanged);</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="comment">// button5</span></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">this</span>.button5.BackgroundImageLayout = System.Windows.Forms.ImageLayout.None;</span><br><span class="line">            <span class="keyword">this</span>.button5.FlatStyle = System.Windows.Forms.FlatStyle.Flat;</span><br><span class="line">            <span class="keyword">this</span>.button5.Font = new System.Drawing.Font(<span class="string">"微软雅黑"</span>, <span class="number">15F</span>);</span><br><span class="line">            <span class="keyword">this</span>.button5.ForeColor = System.Drawing.SystemColors.HotTrack;</span><br><span class="line">            <span class="keyword">this</span>.button5.Location = new System.Drawing.Point(<span class="number">12</span>, <span class="number">126</span>);</span><br><span class="line">            <span class="keyword">this</span>.button5.Name = <span class="string">"button5"</span>;</span><br><span class="line">            <span class="keyword">this</span>.button5.Size = new System.Drawing.Size(<span class="number">268</span>, <span class="number">51</span>);</span><br><span class="line">            <span class="keyword">this</span>.button5.TabIndex = <span class="number">8</span>;</span><br><span class="line">            <span class="keyword">this</span>.button5.Text = <span class="string">"直接得出结果"</span>;</span><br><span class="line">            <span class="keyword">this</span>.button5.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;</span><br><span class="line">            <span class="keyword">this</span>.button5.UseVisualStyleBackColor = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">this</span>.button5.Click += new System.EventHandler(<span class="keyword">this</span>.button5_Click);</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="comment">// PannelForm</span></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">this</span>.BackColor = System.Drawing.Color.Azure;</span><br><span class="line">            <span class="keyword">this</span>.ClientSize = new System.Drawing.Size(<span class="number">292</span>, <span class="number">535</span>);</span><br><span class="line">            <span class="keyword">this</span>.Controls.Add(<span class="keyword">this</span>.button5);</span><br><span class="line">            <span class="keyword">this</span>.Controls.Add(<span class="keyword">this</span>.checkBox1);</span><br><span class="line">            <span class="keyword">this</span>.Controls.Add(<span class="keyword">this</span>.label4);</span><br><span class="line">            <span class="keyword">this</span>.Controls.Add(<span class="keyword">this</span>.label3);</span><br><span class="line">            <span class="keyword">this</span>.Controls.Add(<span class="keyword">this</span>.label2);</span><br><span class="line">            <span class="keyword">this</span>.Controls.Add(<span class="keyword">this</span>.label1);</span><br><span class="line">            <span class="keyword">this</span>.Controls.Add(<span class="keyword">this</span>.button2);</span><br><span class="line">            <span class="keyword">this</span>.Controls.Add(<span class="keyword">this</span>.button1);</span><br><span class="line">            <span class="keyword">this</span>.Controls.Add(<span class="keyword">this</span>.button3);</span><br><span class="line">            <span class="keyword">this</span>.Controls.Add(<span class="keyword">this</span>.button4);</span><br><span class="line">            <span class="keyword">this</span>.DoubleBuffered = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">this</span>.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle;</span><br><span class="line">            <span class="keyword">this</span>.Name = <span class="string">"PannelForm"</span>;</span><br><span class="line">            <span class="keyword">this</span>.Text = <span class="string">"控制面板"</span>;</span><br><span class="line">            <span class="keyword">this</span>.Load += new System.EventHandler(<span class="keyword">this</span>.PannelForm_Load);</span><br><span class="line">            <span class="keyword">this</span>.ResumeLayout(<span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">this</span>.PerformLayout();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> void button2_Click(<span class="keyword">object</span> sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!Next())</span><br><span class="line">            &#123;</span><br><span class="line">                label4.Text = (Solution).ToString();</span><br><span class="line">                label2.Text = (Ergodic).ToString();</span><br><span class="line">                MessageBox.Show(<span class="string">"所有情况已遍历！"</span>, <span class="string">"Duang！！！"</span>);</span><br><span class="line">                Reset();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                label4.Text = (Solution).ToString();</span><br><span class="line">                label2.Text = (Ergodic).ToString();</span><br><span class="line">                Program.mForm.PaintQueens(Color.LightGreen);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> void button5_Click(<span class="keyword">object</span> sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (Next())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (checkBox1.Checked)</span><br><span class="line">                &#123;</span><br><span class="line">                    label4.Text = (Solution).ToString();</span><br><span class="line">                    label2.Text = (Ergodic).ToString();</span><br><span class="line">                    Program.mForm.PaintQueens(Color.LightGreen);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            label4.Text = (Solution).ToString();</span><br><span class="line">            label2.Text = (Ergodic).ToString();</span><br><span class="line">            Program.mForm.PaintQueens(Color.LightGreen);</span><br><span class="line">            MessageBox.Show(<span class="string">"所有情况已遍历！"</span>, <span class="string">"Duang！！！"</span>);</span><br><span class="line">            Reset();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> void button1_Click(<span class="keyword">object</span> sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            Reset();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> void label1_Click(<span class="keyword">object</span> sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> void PannelForm_Load(<span class="keyword">object</span> sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> bool Next()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span> (Program.Board.Next())</span><br><span class="line">            &#123;</span><br><span class="line">                ++Ergodic;</span><br><span class="line">                Point index = Program.Board.Check();</span><br><span class="line">                <span class="keyword">if</span> (index.X != -<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    Point <span class="keyword">val</span> = new Point();</span><br><span class="line">                    <span class="keyword">val</span>.X = Program.Board.Get(index.X);</span><br><span class="line">                    <span class="keyword">val</span>.Y = Program.Board.Get(index.Y);</span><br><span class="line">                    bool flg = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">while</span> (flg = Program.Board.Next())</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (Program.Board.Get(index.X) != <span class="keyword">val</span>.X|| Program.Board.Get(index.Y) != <span class="keyword">val</span>.Y)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (!flg) <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">if</span>(checkBox1.Checked) Program.mForm.PaintQueens(Color.Orange);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (index.X != -<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    index = Program.Board.Check();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (index.X == -<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    ++Solution;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> void label4_Click(<span class="keyword">object</span> sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> void label2_Click(<span class="keyword">object</span> sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> void checkBox1_CheckedChanged(<span class="keyword">object</span> sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> void Reset()</span><br><span class="line">        &#123;</span><br><span class="line">            label2.Text = (Ergodic = <span class="number">0</span>).ToString();</span><br><span class="line">            label4.Text = (Solution = <span class="number">0</span>).ToString();</span><br><span class="line">            Program.Board.Reset();</span><br><span class="line">            Program.mForm.PaintQueens(Color.Orange);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>程序入口Program.cs： <figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">EightQueen</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 应用程序的主入口点。</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">public</span> EnumQueens Board;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">public</span> MainForm mForm;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">STAThread</span>]</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Board = <span class="keyword">new</span> EnumQueens();</span><br><span class="line">            Application.EnableVisualStyles();</span><br><span class="line">            Application.SetCompatibleTextRenderingDefault(<span class="literal">false</span>);</span><br><span class="line">            Application.Run(mForm = <span class="keyword">new</span> MainForm());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 其他系统自动产生的文件代码不贴了。</p>
]]></content>
      <tags>
        <tag>造轮子</tag>
        <tag>八皇后</tag>
      </tags>
  </entry>
  <entry>
    <title>Google Code Jam 2017 - Round1 C Problem A. Ample Syrup</title>
    <url>/posts/16776.html</url>
    <content><![CDATA[<p>https://code.google.com/codejam/contest/3274486/dashboard</p>
<p>#Problem</p>
<p>The kitchen at the Infinite House of Pancakes has just received an order for a stack of K pancakes! The chef currently has N pancakes available, where N ≥ K. Each pancake is a cylinder, and different pancakes may have different radii and heights.</p>
<p>As the sous-chef, you must choose K out of the N available pancakes, discard the others, and arrange those K pancakes in a stack on a plate as follows. First, take the pancake that has the largest radius, and lay it on the plate on one of its circular faces. (If multiple pancakes have the same radius, you can use any of them.) Then, take the remaining pancake with the next largest radius and lay it on top of that pancake, and so on, until all K pancakes are in the stack and the centers of the circular faces are aligned in a line perpendicular to the plate, as illustrated by this example: <img src="https://code.google.com/codejam/contest/images/?image=pancake_stack.png&amp;p=5768968631484416&amp;c=3274486" alt="https://code.google.com/codejam/contest/3274486/dashboard"></p>
<p>A stack of pancakes with varying radii and thicknesses, obeying the rules in the statement.</p>
<p>You know that there is only one thing your diners love as much as they love pancakes: syrup! It is best to maximize the total amount of exposed pancake surface area in the stack, since more exposed pancake surface area means more places to pour on delicious syrup. Any part of a pancake that is not touching part of another pancake or the plate is considered to be exposed.</p>
<p>If you choose the K pancakes optimally, what is the largest total exposed pancake surface area you can achieve?</p>
<p>#Input</p>
<p>The first line of the input gives the number of test cases, T. T test cases follow. Each begins with one line with two integers N and K: the total number of available pancakes, and the size of the stack that the diner has ordered. Then, N more lines follow. Each contains two integers Ri and Hi: the radius and height of the i-th pancake, in millimeters.</p>
<p>#Output</p>
<p>For each test case, output one line containing Case #x: y, where x is the test case number (starting from 1) and y is the maximum possible total exposed pancake surface area, in millimeters squared. y will be considered correct if it is within an absolute or relative error of 10-6 of the correct answer. See the FAQ for an explanation of what that means, and what formats of real numbers we accept.</p>
<p>#Limits</p>
<p>1 ≤ T ≤ 100. 1 ≤ K ≤ N. 1 ≤ Ri ≤ 106, for all i. 1 ≤ Hi ≤ 106, for all i.</p>
<p>Small dataset 1 ≤ N ≤ 10.</p>
<p>Large dataset 1 ≤ N ≤ 1000.</p>
<p>#Sample</p>
<p>##Input <figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="number">4</span></span><br><span class="line"><span class="symbol">2 </span><span class="number">1</span></span><br><span class="line"><span class="symbol">100 </span><span class="number">20</span></span><br><span class="line"><span class="symbol">200 </span><span class="number">10</span></span><br><span class="line"><span class="symbol">2 </span><span class="number">2</span></span><br><span class="line"><span class="symbol">100 </span><span class="number">20</span></span><br><span class="line"><span class="symbol">200 </span><span class="number">10</span></span><br><span class="line"><span class="symbol">3 </span><span class="number">2</span></span><br><span class="line"><span class="symbol">100 </span><span class="number">10</span></span><br><span class="line"><span class="symbol">100 </span><span class="number">10</span></span><br><span class="line"><span class="symbol">100 </span><span class="number">10</span></span><br><span class="line"><span class="symbol">4 </span><span class="number">2</span></span><br><span class="line"><span class="symbol">9 </span><span class="number">3</span></span><br><span class="line"><span class="symbol">7 </span><span class="number">1</span></span><br><span class="line"><span class="symbol">10 </span><span class="number">1</span></span><br><span class="line"><span class="symbol">8 </span><span class="number">4</span></span><br></pre></td></tr></table></figure></p>
<p>##Output <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Case #<span class="number">1</span>: <span class="number">138230.076757951</span></span><br><span class="line">Case #<span class="number">2</span>: <span class="number">150796.447372310</span></span><br><span class="line">Case #<span class="number">3</span>: <span class="number">43982.297150257</span></span><br><span class="line">Case #<span class="number">4</span>: <span class="number">625.176938064</span></span><br></pre></td></tr></table></figure></p>
<p>In Sample Case #1, the &quot;stack&quot; consists only of one pancake. A stack of just the first pancake would have an exposed area of π × R02 + 2 × π * R0 × H0 = 14000π mm2. A stack of just the second pancake would have an exposed area of 44000π mm2. So it is better to use the second pancake.</p>
<p>In Sample Case #2, we can use both of the same pancakes from case #1. The first pancake contributes its top area and its side, for a total of 14000π mm2. The second pancake contributes some of its top area (the part not covered by the first pancake) and its side, for a total of 34000π mm2. The combined exposed surface area is 48000π mm2.</p>
<p>In Sample Case #3, all of the pancakes have radius 100 and height 10. If we stack two of these together, we effectively have a single new cylinder of radius 100 and height 20. The exposed surface area is 14000π mm2.</p>
<p>In Sample Case #4, the optimal stack uses the pancakes with radii of 8 and 9.</p>
<p>#Key 可以用DP做。对DP还是不太熟练，一开始没排序，于是考虑的情况就多一些，总有小规模案例不正确，偏小。后来排个序考虑起来就方便多了。时间复杂度<span class="math inline">\(O(n^2)\)</span>。难倒是不难，之前没Debug出来才是最气的。时间复杂度<span class="math inline">\(O(n^2)\)</span>。</p>
<p>其实贪心就可以了，同学贪心做的但是时间复杂度也要<span class="math inline">\(O(n^2)\)</span>，就是少很多赋值。</p>
<p>#Code <figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> lld;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> pi = <span class="number">3.1415926535897932</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, N, K;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">RH</span> &#123;</span> lld R, H, A; &#125; arr[maxn];</span><br><span class="line">lld dp[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(RH &amp;a, RH &amp;b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (a.R == b.R) <span class="keyword">return</span> a.H &gt; b.H;</span><br><span class="line">	<span class="keyword">return</span> a.R &gt; b.R;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("A-small-practice.in", "r", stdin);</span></span><br><span class="line">	<span class="comment">//freopen("A-small-practice.out", "w", stdout);</span></span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> now_case = <span class="number">1</span>; now_case &lt;= T; ++now_case) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; arr[i].R &gt;&gt; arr[i].H;</span><br><span class="line">			arr[i].A = arr[i].R * arr[i].H * <span class="number">2</span>;</span><br><span class="line">			arr[i].R *= arr[i].R;</span><br><span class="line">		&#125;</span><br><span class="line">		sort(arr, arr + N, cmp);</span><br><span class="line">		<span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = K; j &gt; <span class="number">1</span>; --j) &#123;</span><br><span class="line">				<span class="keyword">if</span> (dp[j - <span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">				lld tmp = dp[j - <span class="number">1</span>] + arr[i].A;</span><br><span class="line">				<span class="keyword">if</span> (dp[j] &lt; tmp) dp[j] = tmp;</span><br><span class="line">			&#125;</span><br><span class="line">			lld tmp = arr[i].A + arr[i].R;</span><br><span class="line">			<span class="keyword">if</span> (dp[<span class="number">1</span>] &lt; tmp) dp[<span class="number">1</span>] = tmp;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"Case #"</span> &lt;&lt; now_case &lt;&lt; <span class="string">": "</span> &lt;&lt; fixed &lt;&lt; setprecision(<span class="number">9</span>) &lt;&lt; ((<span class="keyword">long</span> <span class="keyword">double</span>)dp[K] * pi) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
      </categories>
  </entry>
  <entry>
    <title>ACM笔记 - 利用FFT求卷积(求多项式乘法)</title>
    <url>/posts/32822.html</url>
    <content><![CDATA[<h1 id="卷积">卷积</h1>
<p>给定向量：<span class="math inline">\(a=(a_0,a_1,...,a_{n-1})\)</span>，<span class="math inline">\(b=(b_0,b_1,...,b_{n-1})\)</span></p>
<p>向量和：<span class="math inline">\(a+b=(a_0+b_0,a_1+b_1,...,a_{n-1}+b_{n-1})\)</span> 数量积（内积、点积）：<span class="math inline">\(a·b=a_0b_0+a_1b_1+...+a_{n-1}b_{n-1}\)</span> <strong>卷积</strong>：<span class="math inline">\(a \otimes b=(c_0,c_1,...,c_{2n-2})\)</span>，其中<span class="math inline">\(c_k=\sum_{i+j=k}(a_ib_j)\)</span></p>
<p>例如：<span class="math inline">\(c_{n-1}=a_0b_{n-1}+a_1b_{n-2}+...+a_{n-2}b_1+a_{n-1}b_0\)</span></p>
<p>卷积的最典型的应用就是多项式乘法（多项式乘法就是求卷积）。以下就用多项式乘法来描述、举例卷积与DFT。</p>
<h1 id="关于多项式">关于多项式</h1>
<p>对于多项式<span class="math inline">\(A(x)\)</span>，系数为<span class="math inline">\(a_i\)</span>,设最高非零系数为<span class="math inline">\(a_k\)</span>，则其次数就是<span class="math inline">\(k\)</span>，记作<span class="math inline">\(degree(A)=k\)</span>。任何大于<span class="math inline">\(k\)</span>的整数都是<span class="math inline">\(A(x)\)</span>的<strong>次数界</strong>。</p>
<p>多项式的<strong>系数表达方式</strong>：<span class="math inline">\(A(x)=a_0+a_1x+a_2x^2+...+a_{n-1}x^{n-1}=\sum^{n-1}_{i=0} a_jx^j\)</span>（次数界为<span class="math inline">\(n\)</span>）。 则多项式的<strong>系数向量</strong>即为<span class="math inline">\(a=(a_0,a_1,...,a_{n-1})\)</span>。 多项式的<strong>点值表达方式</strong>：<span class="math inline">\(\{(x_0,y_0),(x_1,y_1),...,(x_{n-1},y_{n-1})\}\)</span>，其中<span class="math inline">\(x_k\)</span>各不相同，<span class="math inline">\(y_k=A(x_k)\)</span>。</p>
<h1 id="离散傅里叶变换dft">离散傅里叶变换（DFT）</h1>
<p>离散傅里叶变换（Discrete Fourier Transform，DFT）。在信号处理很重要的一个东西，这里物理意义以及其他应用暂不予理睬。在多项式中，DFT就是<strong>系数表式</strong>转换成<strong>点值表示</strong>的过程。</p>
<h1 id="快速傅里叶变换fft">快速傅里叶变换（FFT）</h1>
<p>快速傅里叶变换（Fast Fourier Transformation，FFT）：快速计算DFT的算法，能够在<span class="math inline">\(O(n\log n)\)</span>的时间里完成DFT。FFT只是快速的求DFT的方法罢了，不是一个新的概念。 在ACM-ICPC竞赛中, FFT算法常被用来为多项式乘法加速。FFT与其逆变换IFFT类似，稍微加几行代码。</p>
<p>求FFT要用到复数。一个简单的模板： <figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> Complex <span class="comment">// 复数</span></span><br><span class="line">&#123;</span><br><span class="line">	double r, i;</span><br><span class="line">	<span class="constructor">Complex(<span class="params">double</span> <span class="params">_r</span> = 0, <span class="params">double</span> <span class="params">_i</span> = 0)</span> :r(_r), i(_i) &#123;&#125;</span><br><span class="line">	Complex operator +(const Complex &amp;b) &#123;</span><br><span class="line">		return <span class="constructor">Complex(<span class="params">r</span> + <span class="params">b</span>.<span class="params">r</span>, <span class="params">i</span> + <span class="params">b</span>.<span class="params">i</span>)</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	Complex operator -(const Complex &amp;b) &#123;</span><br><span class="line">		return <span class="constructor">Complex(<span class="params">r</span> - <span class="params">b</span>.<span class="params">r</span>, <span class="params">i</span> - <span class="params">b</span>.<span class="params">i</span>)</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	Complex operator *(const Complex &amp;b) &#123;</span><br><span class="line">		return <span class="constructor">Complex(<span class="params">r</span><span class="operator">*</span><span class="params">b</span>.<span class="params">r</span> - <span class="params">i</span><span class="operator">*</span><span class="params">b</span>.<span class="params">i</span>, <span class="params">r</span><span class="operator">*</span><span class="params">b</span>.<span class="params">i</span> + <span class="params">i</span><span class="operator">*</span><span class="params">b</span>.<span class="params">r</span>)</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure> 递归实现FFT模板：<a href="http://www.gatevin.moe/acm/fft%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">来源</a> <figure class="highlight excel"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Complex</span>* RecursiveFFT(<span class="built_in">Complex</span> a[], <span class="built_in">int</span> <span class="built_in">n</span>)//<span class="built_in">n</span>表示向量a的维数</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">if</span>(<span class="built_in">n</span> == <span class="number">1</span>)</span><br><span class="line">        return a;</span><br><span class="line">    <span class="built_in">Complex</span> wn = <span class="built_in">Complex</span>(<span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">PI</span>/<span class="built_in">n</span>), <span class="built_in">sin</span>(<span class="number">2</span>*<span class="built_in">PI</span>/<span class="built_in">n</span>));</span><br><span class="line">    <span class="built_in">Complex</span> w = <span class="built_in">Complex</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">Complex</span>* <span class="symbol">a0</span> = new <span class="built_in">Complex</span>[<span class="built_in">n</span> &gt;&gt; <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">Complex</span>* <span class="symbol">a1</span> = new <span class="built_in">Complex</span>[<span class="built_in">n</span> &gt;&gt; <span class="number">1</span>];</span><br><span class="line">    for(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">n</span>; i++)</span><br><span class="line">        <span class="built_in">if</span>(i &amp; <span class="number">1</span>) <span class="symbol">a1</span>[(i - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>] = a[i];</span><br><span class="line">        else <span class="symbol">a0</span>[i &gt;&gt; <span class="number">1</span>] = a[i];</span><br><span class="line">    <span class="built_in">Complex</span> *<span class="symbol">y0</span>, *<span class="symbol">y1</span>;</span><br><span class="line">    <span class="symbol">y0</span> = RecursiveFFT(<span class="symbol">a0</span>, <span class="built_in">n</span> &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="symbol">y1</span> = RecursiveFFT(<span class="symbol">a1</span>, <span class="built_in">n</span> &gt;&gt; <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">Complex</span>* y = new <span class="built_in">Complex</span>[<span class="built_in">n</span>];</span><br><span class="line">    for(<span class="built_in">int</span> k = <span class="number">0</span>; k &lt; (<span class="built_in">n</span> &gt;&gt; <span class="number">1</span>); k++)</span><br><span class="line">    &#123;</span><br><span class="line">        y[k] = <span class="symbol">y0</span>[k] + w*<span class="symbol">y1</span>[k];</span><br><span class="line">        y[k + (<span class="built_in">n</span> &gt;&gt; <span class="number">1</span>)] = <span class="symbol">y0</span>[k] - w*<span class="symbol">y1</span>[k];</span><br><span class="line">        w = w*wn;</span><br><span class="line">    &#125;</span><br><span class="line">    delete <span class="symbol">a0</span>;</span><br><span class="line">    delete <span class="symbol">a1</span>;</span><br><span class="line">    delete <span class="symbol">y0</span>;</span><br><span class="line">    delete <span class="symbol">y1</span>;</span><br><span class="line">    return y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 非递归实现。模板：（来源忘了） <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">void</span> change(Complex y[], <span class="built_in">int</span> len) <span class="comment">// 二进制平摊反转置换 O(logn)  </span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">int</span> i, j, k;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>, j = len / <span class="number">2</span>;i &lt; len - <span class="number">1</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (i &lt; j)swap(y[i], y[j]);</span><br><span class="line">		k = len / <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">while</span> (j &gt;= k)</span><br><span class="line">		&#123;</span><br><span class="line">			j -= k;</span><br><span class="line">			k /= <span class="number">2</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (j &lt; k)j += k;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">void</span> fft(Complex y[], <span class="built_in">int</span> len, <span class="built_in">int</span> on) <span class="comment">//FFT:on=1; IFFT:on=-1</span></span><br><span class="line">&#123;</span><br><span class="line">	change(y, len);</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> h = <span class="number">2</span>;h &lt;= len;h &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		Complex wn(cos(-on * <span class="number">2</span> * PI / h), sin(-on * <span class="number">2</span> * PI / h));</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>;j &lt; len;j += h)</span><br><span class="line">		&#123;</span><br><span class="line">			Complex w(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="built_in">int</span> k = j;k &lt; j + h / <span class="number">2</span>;k++)</span><br><span class="line">			&#123;</span><br><span class="line">				Complex u = y[k];</span><br><span class="line">				Complex t = w*y[k + h / <span class="number">2</span>];</span><br><span class="line">				y[k] = u + t;</span><br><span class="line">				y[k + h / <span class="number">2</span>] = u - t;</span><br><span class="line">				w = w*wn;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (on == <span class="number">-1</span>)</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>;i &lt; len;i++)</span><br><span class="line">			y[i].r /= len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="利用fft求卷积">利用FFT求卷积</h1>
<p>普通的计算多项式乘法的计算，时间复杂度<span class="math inline">\(O(n^2)\)</span>。而FFT先将多项式点值表示（<span class="math inline">\(O(n\log n)\)</span>），在<span class="math inline">\(O(n)\)</span>下完成对点值的乘法，再以<span class="math inline">\(O(n\log n)\)</span>完成IFFT，重新得到系数表示。</p>
<h3 id="步骤一补0">步骤一（补0）</h3>
<p>在两个多项式前面补0，得到两个2n次多项式，设系数向量分别为<span class="math inline">\(v_1\)</span>和<span class="math inline">\(v_2\)</span>。</p>
<h3 id="步骤二求值">步骤二（求值）</h3>
<p>使用FFT计算<span class="math inline">\(f_1=DFT(v_1)\)</span>和<span class="math inline">\(f_2=DFT(v_2)\)</span>。则<span class="math inline">\(f_1\)</span>与<span class="math inline">\(f_2\)</span>为两个多项式在<span class="math inline">\(2n\)</span>次单位根处的取值（即点值表示）。</p>
<h3 id="步骤三乘法">步骤三（乘法）</h3>
<p>把<span class="math inline">\(f_1\)</span>与<span class="math inline">\(f_2\)</span>每一维对应相乘，得到<span class="math inline">\(f\)</span>，代表对应输入多项式乘积的点值表示。</p>
<h3 id="步骤四插值">步骤四（插值）</h3>
<p>使用IFFT计算<span class="math inline">\(v=IDFT(f)\)</span>，其中<span class="math inline">\(v\)</span>就是乘积的系数向量。</p>
<h3 id="综上">综上</h3>
<p><span class="math inline">\(a \otimes b=IDFT_{2n}(DFT_{2n}(a)·DFT_{2n}(b))\)</span>，即：<span class="math inline">\(a \otimes b=DFT^{-1}_{2n}(DFT_{2n}(a)·DFT_{2n}(b))\)</span></p>
<p><span class="math inline">\(A(x1)\otimes B(x2)\)</span>： <figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">fft(x1, len, <span class="number">1</span>);</span><br><span class="line">fft(x2, len, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (int <span class="built_in">i</span> = <span class="number">0</span>;<span class="built_in">i</span> &lt; len;<span class="built_in">i</span>++) &#123;</span><br><span class="line">	x[<span class="built_in">i</span>] = x1[<span class="built_in">i</span>] * x2[<span class="built_in">i</span>];</span><br><span class="line">&#125;</span><br><span class="line">fft(x, len, <span class="number">-1</span>);</span><br></pre></td></tr></table></figure></p>
<p>#例题 ##1.2016 acm香港网络赛 A题 A+B Problem 网上的代码（当时没保留出处。。。） <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 200005</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3ffffff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Complex</span> // 复数</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">double</span> r, i;</span><br><span class="line">	Complex(<span class="keyword">double</span> _r = <span class="number">0</span>, <span class="keyword">double</span> _i = <span class="number">0</span>) :r(_r), i(_i) &#123;&#125;</span><br><span class="line">	Complex <span class="keyword">operator</span> +(<span class="keyword">const</span> Complex &amp;b)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> Complex(r + b.r, i + b.i);</span><br><span class="line">	&#125;</span><br><span class="line">	Complex <span class="keyword">operator</span> -(<span class="keyword">const</span> Complex &amp;b)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> Complex(r - b.r, i - b.i);</span><br><span class="line">	&#125;</span><br><span class="line">	Complex <span class="keyword">operator</span> *(<span class="keyword">const</span> Complex &amp;b)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> Complex(r*b.r - i*b.i, r*b.i + i*b.r);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(Complex y[], <span class="keyword">int</span> len)</span> <span class="comment">// 二进制平摊反转置换 O(logn)  </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i, j, k;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>, j = len / <span class="number">2</span>;i &lt; len - <span class="number">1</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (i &lt; j)swap(y[i], y[j]);</span><br><span class="line">		k = len / <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">while</span> (j &gt;= k)</span><br><span class="line">		&#123;</span><br><span class="line">			j -= k;</span><br><span class="line">			k /= <span class="number">2</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (j &lt; k)j += k;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fft</span><span class="params">(Complex y[], <span class="keyword">int</span> len, <span class="keyword">int</span> on)</span> <span class="comment">//DFT和FFT</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	change(y, len);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">2</span>;h &lt;= len;h &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="function">Complex <span class="title">wn</span><span class="params">(<span class="built_in">cos</span>(-on * <span class="number">2</span> * PI / h), <span class="built_in">sin</span>(-on * <span class="number">2</span> * PI / h))</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; len;j += h)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="function">Complex <span class="title">w</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = j;k &lt; j + h / <span class="number">2</span>;k++)</span><br><span class="line">			&#123;</span><br><span class="line">				Complex u = y[k];</span><br><span class="line">				Complex t = w*y[k + h / <span class="number">2</span>];</span><br><span class="line">				y[k] = u + t;</span><br><span class="line">				y[k + h / <span class="number">2</span>] = u - t;</span><br><span class="line">				w = w*wn;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (on == <span class="number">-1</span>)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++)</span><br><span class="line">			y[i].r /= len;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">50000</span>;          <span class="comment">// a数组所有元素+M，使a[i]&gt;=0</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">800040</span>;</span><br><span class="line"></span><br><span class="line">Complex x1[MAXN];</span><br><span class="line"><span class="keyword">int</span> a[MAXN / <span class="number">4</span>];                <span class="comment">//原数组</span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> num[MAXN];     <span class="comment">//利用FFT得到的数组</span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> tt[MAXN];        <span class="comment">//统计数组每个元素出现个数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = <span class="number">0</span>;                   <span class="comment">// n表示除了0之外数组元素个数</span></span><br><span class="line">	<span class="keyword">int</span> tot;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;tot);</span><br><span class="line">	<span class="built_in">memset</span>(num, <span class="number">0</span>, <span class="keyword">sizeof</span>(num));</span><br><span class="line">	<span class="built_in">memset</span>(tt, <span class="number">0</span>, <span class="keyword">sizeof</span>(tt));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> cnt0 = <span class="number">0</span>;             <span class="comment">//cnt0 统计0的个数</span></span><br><span class="line">	<span class="keyword">int</span> aa;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; tot;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;aa);</span><br><span class="line">		<span class="keyword">if</span> (aa == <span class="number">0</span>) &#123; cnt0++;<span class="keyword">continue</span>; &#125;  <span class="comment">//先把0全删掉，最后特殊考虑0</span></span><br><span class="line">		<span class="keyword">else</span> a[n] = aa;</span><br><span class="line">		num[a[n] + M]++;</span><br><span class="line">		tt[a[n] + M]++;</span><br><span class="line">		n++;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	sort(a, a + n);</span><br><span class="line">	<span class="keyword">int</span> len1 = a[n - <span class="number">1</span>] + M + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> len = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (len &lt; <span class="number">2</span> * len1) len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len1;i++) &#123;</span><br><span class="line">		x1[i] = Complex(num[i], <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = len1;i &lt; len;i++) &#123;</span><br><span class="line">		x1[i] = Complex(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	fft(x1, len, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++) &#123;</span><br><span class="line">		x1[i] = x1[i] * x1[i];</span><br><span class="line">	&#125;</span><br><span class="line">	fft(x1, len, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; len;i++) &#123;</span><br><span class="line">		num[i] = (<span class="keyword">long</span> <span class="keyword">long</span>)(x1[i].r + <span class="number">0.5</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	len = <span class="number">2</span> * (a[n - <span class="number">1</span>] + M);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++) <span class="comment">//删掉ai+ai的情况</span></span><br><span class="line">		num[a[i] + a[i] + <span class="number">2</span> * M]--;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	for(int i = 0;i &lt; len;i++)&#123;</span></span><br><span class="line"><span class="comment">	if(num[i]) cout&lt;&lt;i-2*M&lt;&lt;' '&lt;&lt;num[i]&lt;&lt;endl;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> l = a[n - <span class="number">1</span>] + M;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= l; i++)   <span class="comment">//ai,aj,ak都不为0的情况</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (tt[i]) ret += (<span class="keyword">long</span> <span class="keyword">long</span>)(num[i + M] * tt[i]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ret += (<span class="keyword">long</span> <span class="keyword">long</span>)(num[<span class="number">2</span> * M] * cnt0);        <span class="comment">// ai+aj=0的情况</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (cnt0 != <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (cnt0 &gt;= <span class="number">3</span>) &#123;                   <span class="comment">//ai,aj,ak都为0的情况</span></span><br><span class="line">			<span class="keyword">long</span> <span class="keyword">long</span> tmp = <span class="number">1</span>;</span><br><span class="line">			tmp *= (<span class="keyword">long</span> <span class="keyword">long</span>)(cnt0);</span><br><span class="line">			tmp *= (<span class="keyword">long</span> <span class="keyword">long</span>)(cnt0 - <span class="number">1</span>);</span><br><span class="line">			tmp *= (<span class="keyword">long</span> <span class="keyword">long</span>)(cnt0 - <span class="number">2</span>);</span><br><span class="line">			ret += tmp;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= l; i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (tt[i] &gt;= <span class="number">2</span>) &#123;             <span class="comment">// x+0=x的情况      </span></span><br><span class="line">				<span class="keyword">long</span> <span class="keyword">long</span> tmp = (<span class="keyword">long</span> <span class="keyword">long</span>)cnt0;</span><br><span class="line">				tmp *= (<span class="keyword">long</span> <span class="keyword">long</span>)(tt[i]);</span><br><span class="line">				tmp *= (<span class="keyword">long</span> <span class="keyword">long</span>)(tt[i] - <span class="number">1</span>);</span><br><span class="line">				ret += tmp * <span class="number">2</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ret);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
      </categories>
      <tags>
        <tag>笔记</tag>
        <tag>FFT</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces 786A - Berzerk</title>
    <url>/posts/31985.html</url>
    <content><![CDATA[<p>http://codeforces.com/problemset/problem/786/A</p>
<p>#Description Rick and Morty are playing their own version of Berzerk (which has nothing in common with the famous Berzerk game). This game needs a huge space, so they play it with a computer.</p>
<p>In this game there are n objects numbered from 1 to n arranged in a circle (in clockwise order). Object number 1 is a black hole and the others are planets. There's a monster in one of the planet. Rick and Morty don't know on which one yet, only that he's not initially in the black hole, but Unity will inform them before the game starts. But for now, they want to be prepared for every possible scenario.</p>
<p>Each one of them has a set of numbers between 1 and n - 1 (inclusive). Rick's set is s1 with k1 elements and Morty's is s2 with k2 elements. One of them goes first and the player changes alternatively. In each player's turn, he should choose an arbitrary number like x from his set and the monster will move to his x-th next object from its current position (clockwise). If after his move the monster gets to the black hole he wins.</p>
<p>Your task is that for each of monster's initial positions and who plays first determine if the starter wins, loses, or the game will stuck in an infinite loop. In case when player can lose or make game infinity, it more profitable to choose infinity game.</p>
<p>#Input The first line of input contains a single integer n (2 ≤ n ≤ 7000) — number of objects in game.</p>
<p>The second line contains integer k1 followed by k1 distinct integers s1, 1, s1, 2, ..., s1, k1 — Rick's set.</p>
<p>The third line contains integer k2 followed by k2 distinct integers s2, 1, s2, 2, ..., s2, k2 — Morty's set</p>
<p>1 ≤ ki ≤ n - 1 and 1 ≤ si, 1, si, 2, ..., si, ki ≤ n - 1 for 1 ≤ i ≤ 2.</p>
<p>#Output In the first line print n - 1 words separated by spaces where i-th word is &quot;Win&quot; (without quotations) if in the scenario that Rick plays first and monster is initially in object number i + 1 he wins, &quot;Lose&quot; if he loses and &quot;Loop&quot; if the game will never end.</p>
<p>Similarly, in the second line print n - 1 words separated by spaces where i-th word is &quot;Win&quot; (without quotations) if in the scenario that Morty plays first and monster is initially in object number i + 1 he wins, &quot;Lose&quot; if he loses and &quot;Loop&quot; if the game will never end.</p>
<p>#Examples <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">input</span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">2</span> <span class="number">3</span> <span class="number">2</span></span><br><span class="line"><span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line">output</span><br><span class="line">Lose Win Win Loop</span><br><span class="line">Loop Win Win Win</span><br><span class="line">input</span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="number">4</span> <span class="number">6</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"><span class="number">2</span> <span class="number">3</span> <span class="number">6</span></span><br><span class="line">output</span><br><span class="line">Win Win Win Win Win Win Win</span><br><span class="line">Lose Win Lose Lose Win Lose Lose</span><br></pre></td></tr></table></figure></p>
<p>#Key <strong>题意</strong>：一个有n个结点的环，第一个结点上是黑洞，其他为行星。现在有一个怪物可能在任意的行星上。甲乙两人可以顺时针驱赶怪物。甲每次可驱赶<span class="math inline">\(s1_1, s1_2,s1_3...\)</span>个格子，共k1个可能。乙每次可驱赶<span class="math inline">\(s2_1, s2_2,s2_3...\)</span>个格子，共k2种可能。谁把怪物刚好驱逐到黑洞里就赢。现在求：当怪物在第i个行星，甲（或乙）第一个驱赶时，甲（或乙）一定赢、一定输还是平局？</p>
<p><strong>思路</strong>：DFS+动态规划。（这里只考虑甲开局的情况，乙一样求）从黑洞开始反向逆推，即分别倒退<span class="math inline">\(s1_1, s1_2,s1_3...\)</span>个格子，只要从这些点驱逐，甲是必赢的；换句话说，乙如果把怪物驱逐到了这些点，乙就输了，所以当乙能驱赶的点都是必输点时，当前点也是乙的必输点。 那么对于当前点：若能够将怪物驱逐到对手的必输点，该点必赢，对当前点DFS；若能够将怪物驱逐到对手的必赢点，为当前点计数，当当前点到所有可驱逐的点都会导致失败时，当前点即为必输点。 使用sch数组保存点是否访问过，即DP的记忆化搜索的思想。</p>
<p>#Code <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 7008</span></span><br><span class="line"><span class="keyword">int</span> n, k[<span class="number">2</span>], s[<span class="number">2</span>][N];</span><br><span class="line"><span class="keyword">int</span> win[<span class="number">2</span>][N], sch[<span class="number">2</span>][N], cnt[<span class="number">2</span>][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> who)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(win[who], <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>)*n);</span><br><span class="line">	<span class="built_in">memset</span>(sch[who], <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>)*n);</span><br><span class="line">	<span class="built_in">memset</span>(cnt[who], <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>)*n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> who)</span> </span>&#123;</span><br><span class="line">	sch[!who][now] = <span class="number">1</span>; <span class="comment">// 能够允许dp递归下来的now都是已经确定输和赢的</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	for (int i = 0;i != n;++i) &#123;</span></span><br><span class="line"><span class="comment">		printf("win&#123;%d %d&#125; sch&#123;%d %d&#125; cnt&#123;%d %d&#125;\n",</span></span><br><span class="line"><span class="comment">			win[0][i], win[1][i],</span></span><br><span class="line"><span class="comment">			sch[0][i], sch[1][i],</span></span><br><span class="line"><span class="comment">			cnt[0][i], cnt[1][i]);</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">	puts("-----");</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i != k[who];++i) &#123;</span><br><span class="line">		<span class="keyword">int</span> pre = (now - s[who][i] + n) % n; <span class="comment">// who让怪物从pre跳到now</span></span><br><span class="line">		<span class="keyword">if</span> (!pre) <span class="keyword">continue</span>; <span class="comment">// 不可能</span></span><br><span class="line">		<span class="keyword">if</span> (sch[who][pre]) <span class="keyword">continue</span>; <span class="comment">// 记忆搜索</span></span><br><span class="line">		<span class="keyword">if</span> (!win[!who][now]) &#123; <span class="comment">// 若从pre到now对面必输. (输的条件是sch[who][i]==1且win[who][i]==0)</span></span><br><span class="line">			win[who][pre] = <span class="number">1</span>; <span class="comment">// 这一步一定赢</span></span><br><span class="line">			dp(pre, !who);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (win[!who][now]) &#123; <span class="comment">// 若从pre到now对面必赢</span></span><br><span class="line">			<span class="keyword">if</span> (++cnt[who][pre] == k[who]) &#123; <span class="comment">// 当这一步怎么走都会导致对面赢</span></span><br><span class="line">				dp(pre, !who);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> who = <span class="number">0</span>;who != <span class="number">2</span>;++who) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, k + who);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i != k[who];++i)</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, s[who] + i);</span><br><span class="line">	&#125;</span><br><span class="line">	init(<span class="number">0</span>), init(<span class="number">1</span>);</span><br><span class="line">	dp(<span class="number">0</span>, <span class="number">0</span>),dp(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> who = <span class="number">0</span>;who != <span class="number">2</span>;++who) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i != n;++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (win[who][i]) <span class="built_in">printf</span>(<span class="string">"Win"</span>);</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (sch[who][i]) <span class="built_in">printf</span>(<span class="string">"Lose"</span>);</span><br><span class="line">			<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"Loop"</span>);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%c"</span>, <span class="string">" \n"</span>[i == n - <span class="number">1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>ACM笔记 - 排序小技巧</title>
    <url>/posts/3607.html</url>
    <content><![CDATA[<p>#Description 一个数组，要求先对前n个数字排序（以方便后续操作）；又要求对前n+i个数字排序；又要求对前n+j ... 前n+k个数字排序（i、j、k的大小远小于n，且i、j、k间没有大小关系）。总之就是对一个不定的范围内数据要进行频繁的按大小顺序调用，但是这个范围边界变化不大，很多数据重叠，这样每次都对此次区间内数据排序，频繁排序的话很费时间。</p>
<p>例如一个数组<span class="math inline">\(\{1,3,6,5,2,4,1,9,0\}\)</span>，一共9个数字，下标0<sub>8。要求： 每次取一个区间，计算区间内<span class="math inline">\((最大值-最小值)^2+(次大值-次小值)^2+(次次大值-次次小值)^2+...\)</span>的值。很容易想到对区间排个序，即可方便获得最大、次大值等。 对1</sub>5排序：<span class="math inline">\(\{2,3,4,5,6\}\)</span> 对1<sub>6排序：<span class="math inline">\(\{1,2,3,4,5,6\}\)</span> 对2</sub>5排序：<span class="math inline">\(\{2,4,5,6\}\)</span> 可以看出2、5、6始终在范围内，但每次都要针对所选区间重新排序，很麻烦。 既然大部分数据一直出现在范围内，现在就希望能够一次排序，应对所有情况。</p>
<p>#Key 继续使用上述的例子：<span class="math inline">\(Array = \{1,3,6,5,2,4,1,9,0\}\)</span> 开个新数组作其索引：<span class="math inline">\(Index = \{0,1,2,3,4,5,6,7,8\}\)</span> 令索引数组按照<span class="math inline">\(Array\)</span>的大小关系排序，得<span class="math inline">\(Index = \{8,0,6,4,1,5,3,2,7\}\)</span></p>
<p>对于区间[1, 5]：从左向右找出第一个在[1, 5]的下标即为最小值：8不符合、0不符合、6不符合，4符合，那么最小值就是<span class="math inline">\(Array[4] = 2\)</span>，次大值就是<span class="math inline">\(Array[1] = 3\)</span> ...</p>
<p>即每次只需检测排序后当前位的数字的下标是否在该区间内即可。</p>
<p>#Sample 题目：https://hihocoder.com/problemset/problem/1384 一道贪心的题，期间需要对下标i到j、i到j+k之间的数字分别排序。是别人家的代码（<a href="http://www.bubuko.com/infodetail-1772326.html" target="_blank" rel="noopener">他的原文链接，虽然我也不知道他是不是转别人的</a>），就是在这学到的技巧。注意观察judge函数与judge2函数的差异，judge2函数即实现了上述排序思想。 <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;  </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;  </span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;  </span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> <span class="keyword">int</span> ll;  </span><br><span class="line">ll m,n,k;  </span><br><span class="line">ll a[<span class="number">500050</span>];  </span><br><span class="line">ll b[<span class="number">500050</span>];  </span><br><span class="line"><span class="keyword">int</span> cnt=<span class="number">0</span>;  </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> a[x]&lt;a[y];  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judge</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">int</span> pos=<span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">while</span>(l+pos&lt;=r)b[pos]=a[l+pos],pos++;  </span><br><span class="line">    sort(b,b+pos);  </span><br><span class="line">    pos--;  </span><br><span class="line">    <span class="keyword">int</span> mid=(pos<span class="number">-1</span>)/<span class="number">2</span>;  </span><br><span class="line">    ll res=<span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;=mid&amp;&amp;i&lt;m; i++)  </span><br><span class="line">    &#123;  </span><br><span class="line">        res+=(b[i]-b[pos-i])*(b[i]-b[pos-i]);  </span><br><span class="line">        <span class="keyword">if</span>(res&gt;k)  </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> res&lt;=k;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    cnt=<span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=l; i&lt;=r; i++)b[cnt++]=i;  </span><br><span class="line">    sort(b,b+cnt,cmp);  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judge2</span><span class="params">(<span class="keyword">int</span> r)</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">int</span> i,j,kk;  </span><br><span class="line">    ll res=<span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>,j=cnt<span class="number">-1</span>,kk=m; kk; i++,j--,kk--)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">while</span>(i&lt;j&amp;&amp;b[i]&gt;r)i++;  </span><br><span class="line">        <span class="keyword">while</span>(i&lt;j&amp;&amp;b[j]&gt;r)j--;  </span><br><span class="line">        <span class="keyword">if</span>(i&gt;=j)<span class="keyword">break</span>;  </span><br><span class="line">        res+=(a[b[i]]-a[b[j]])*(a[b[i]]-a[b[j]]);  </span><br><span class="line">        <span class="keyword">if</span>(res&gt;k)<span class="keyword">break</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> res&lt;=k;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">int</span> T;  </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);  </span><br><span class="line">    <span class="keyword">while</span>(T--)  </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>,&amp;n,&amp;m,&amp;k);  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; i++)  </span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;a[i]);  </span><br><span class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;  </span><br><span class="line">        <span class="keyword">int</span> l=<span class="number">0</span>;  </span><br><span class="line">        <span class="keyword">while</span>(l&lt;n)  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="keyword">int</span> kk=<span class="number">1</span>;  </span><br><span class="line">            <span class="keyword">while</span>(kk+l&lt;n&amp;&amp;judge(l,l+kk))  </span><br><span class="line">                kk*=<span class="number">2</span>;  </span><br><span class="line">            <span class="keyword">int</span> first=l+kk/<span class="number">2</span>,last=l+kk<span class="number">-1</span>&lt;n?l+kk<span class="number">-1</span>:n<span class="number">-1</span>;  </span><br><span class="line">            init(l,last);  </span><br><span class="line">            <span class="keyword">int</span> mid;  </span><br><span class="line">            <span class="keyword">int</span> pos=l;  </span><br><span class="line">            <span class="keyword">while</span>(first&lt;=last)  </span><br><span class="line">            &#123;  </span><br><span class="line">                <span class="keyword">if</span>(judge2(mid=(first+last)/<span class="number">2</span>))  </span><br><span class="line">                &#123;  </span><br><span class="line">                    first=mid+<span class="number">1</span>;  </span><br><span class="line">                    pos=mid;  </span><br><span class="line">                &#125;  </span><br><span class="line">                <span class="keyword">else</span>  </span><br><span class="line">                    last=mid<span class="number">-1</span>;  </span><br><span class="line">            &#125;  </span><br><span class="line">            l=pos+<span class="number">1</span>;  </span><br><span class="line">            ans++;  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
      </categories>
      <tags>
        <tag>笔记</tag>
        <tag>排序</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces 746G - New Roads</title>
    <url>/posts/51189.html</url>
    <content><![CDATA[<p>#Description There are n cities in Berland, each of them has a unique id — an integer from 1 to n, the capital is the one with id 1. Now there is a serious problem in Berland with roads — there are no roads.</p>
<p>That is why there was a decision to build n - 1 roads so that there will be exactly one simple path between each pair of cities.</p>
<p>In the construction plan t integers a1, a2, ..., at were stated, where t equals to the distance from the capital to the most distant city, concerning new roads. ai equals the number of cities which should be at the distance i from the capital. The distance between two cities is the number of roads one has to pass on the way from one city to another.</p>
<p>Also, it was decided that among all the cities except the capital there should be exactly k cities with exactly one road going from each of them. Such cities are dead-ends and can't be economically attractive. In calculation of these cities the capital is not taken into consideration regardless of the number of roads from it.</p>
<p>Your task is to offer a plan of road's construction which satisfies all the described conditions or to inform that it is impossible.</p>
<p>#Input The first line contains three positive numbers n, t and k (2 ≤ n ≤ 2·105, 1 ≤ t, k &lt; n) — the distance to the most distant city from the capital and the number of cities which should be dead-ends (the capital in this number is not taken into consideration).</p>
<p>The second line contains a sequence of t integers a1, a2, ..., at (1 ≤ ai &lt; n), the i-th number is the number of cities which should be at the distance i from the capital. It is guaranteed that the sum of all the values ai equals n - 1.</p>
<p>#Output If it is impossible to built roads which satisfy all conditions, print -1.</p>
<p>Otherwise, in the first line print one integer n — the number of cities in Berland. In the each of the next n - 1 line print two integers — the ids of cities that are connected by a road. Each road should be printed exactly once. You can print the roads and the cities connected by a road in any order.</p>
<p>If there are multiple answers, print any of them. Remember that the capital has id 1.</p>
<p>#Examples <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">input</span><br><span class="line"><span class="number">7</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">2</span> <span class="number">3</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">output</span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">1</span> <span class="number">3</span></span><br><span class="line"><span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">6</span></span><br><span class="line"><span class="number">2</span> <span class="number">4</span></span><br><span class="line"><span class="number">7</span> <span class="number">4</span></span><br><span class="line"><span class="number">3</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line">input</span><br><span class="line"><span class="number">14</span> <span class="number">5</span> <span class="number">6</span></span><br><span class="line"><span class="number">4</span> <span class="number">4</span> <span class="number">2</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">output</span><br><span class="line"><span class="number">14</span></span><br><span class="line"><span class="number">3</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">4</span></span><br><span class="line"><span class="number">11</span> <span class="number">6</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="number">10</span> <span class="number">13</span></span><br><span class="line"><span class="number">6</span> <span class="number">10</span></span><br><span class="line"><span class="number">10</span> <span class="number">12</span></span><br><span class="line"><span class="number">14</span> <span class="number">12</span></span><br><span class="line"><span class="number">8</span> <span class="number">4</span></span><br><span class="line"><span class="number">5</span> <span class="number">1</span></span><br><span class="line"><span class="number">3</span> <span class="number">7</span></span><br><span class="line"><span class="number">2</span> <span class="number">6</span></span><br><span class="line"><span class="number">5</span> <span class="number">9</span></span><br><span class="line"></span><br><span class="line">input</span><br><span class="line"><span class="number">3</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"></span><br><span class="line">output</span><br><span class="line"><span class="number">-1</span></span><br></pre></td></tr></table></figure></p>
<p>#Key <strong>题意</strong>：给一棵一共有<span class="math inline">\(n\)</span>个结点（包括根节点）的树，一共有<span class="math inline">\(t+1\)</span>层。除第一层只有一个根节点外，给出了其他每层的节点数。已知有<span class="math inline">\(k\)</span>个结点没有子节点，要求用<span class="math inline">\(n-1\)</span>个树枝连接所有结点，给出一种可能的连法。 可能的连法（可能）有很多，只要输出随便其中一个即可。</p>
<p><strong>思路</strong>：先遍历一遍所有层，求出可行的最大最小的maxk、mink。如果题目给的k不在此范围内，则说明不能组成符合要求的树。这是唯二输出“-1”的情况。</p>
<p>求能产生的最少的无儿子结点： <img src="/posts/51189/1.png" alt="这里写图片描述"> 求能产生的最多的无儿子结点： <img src="/posts/51189/2.png" alt="这里写图片描述"></p>
<p>令<span class="math inline">\(needk=k-mink\)</span>，则除去一定有的无儿子结点，还有needk个无儿子结点需要手动产生。 然后遍历每一层，自己做出needk个无儿子结点即可。无需建立树，边遍历边输出。</p>
<p>第一次写出了最后一题，开心的一匹(ง •̀▿•́)ง。虽然写了就知道并不难。。。</p>
<p>#Code <figure class="highlight perl"><table><tr><td class="code"><pre><span class="line"><span class="comment">#include&lt;cstdio&gt;</span></span><br><span class="line"><span class="keyword">int</span> n, t, k;</span><br><span class="line"><span class="keyword">int</span> arr[<span class="number">200010</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	scanf(<span class="string">"%d%d%d"</span>, &amp;n, &amp;t, &amp;k);</span><br><span class="line">	arr[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= t;++i) &#123;</span><br><span class="line">		scanf(<span class="string">"%d"</span>, arr + i);</span><br><span class="line">	&#125;</span><br><span class="line">	arr[t + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> mink = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> maxk = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= t;++i) &#123;</span><br><span class="line">		maxk += arr[i] - <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (arr[i] &gt; arr[i + <span class="number">1</span>])</span><br><span class="line">			mink += arr[i] - arr[i + <span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	++maxk;</span><br><span class="line">	<span class="keyword">if</span> (mink &gt; k || maxk &lt; k) &#123;</span><br><span class="line">		<span class="keyword">printf</span>(<span class="string">"-1"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">printf</span>(<span class="string">"%d\n"</span>, n);</span><br><span class="line">	<span class="keyword">int</span> needk = k - mink; <span class="regexp">//</span> dead-ends that needed to created by myself</span><br><span class="line">	<span class="keyword">int</span> nown = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i != t;++i) &#123;</span><br><span class="line">		<span class="keyword">int</span> nextn = nown + arr[i];</span><br><span class="line">		<span class="keyword">if</span> (!needk) &#123;</span><br><span class="line">			<span class="keyword">if</span> (arr[i + <span class="number">1</span>] &gt;= arr[i]) &#123;</span><br><span class="line">				<span class="keyword">int</span> err = arr[i + <span class="number">1</span>] - arr[i] + <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">int</span> rem = arr[i] - <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j != err;++j) &#123;</span><br><span class="line">					<span class="keyword">printf</span>(<span class="string">"%d %d\n"</span>, nown, nextn++);</span><br><span class="line">				&#125;</span><br><span class="line">				++nown;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j != rem;++j) &#123;</span><br><span class="line">					<span class="keyword">printf</span>(<span class="string">"%d %d\n"</span>, nown++, nextn++);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123; <span class="regexp">//</span> arr[i + <span class="number">1</span>] &lt; arr[i]</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j != arr[i + <span class="number">1</span>];++j) &#123;</span><br><span class="line">					<span class="keyword">printf</span>(<span class="string">"%d %d\n"</span>, nown++, nextn++);</span><br><span class="line">				&#125;</span><br><span class="line">				nown += arr[i] - arr[i + <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (arr[i + <span class="number">1</span>] &gt;= arr[i]) &#123;</span><br><span class="line">				<span class="keyword">int</span> nextnown = nextn;</span><br><span class="line">				<span class="keyword">int</span> nextnextn = nextn + arr[i + <span class="number">1</span>];</span><br><span class="line">				<span class="keyword">int</span> err = arr[i + <span class="number">1</span>] - arr[i] + <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j != err;++j) &#123;</span><br><span class="line">					<span class="keyword">printf</span>(<span class="string">"%d %d\n"</span>, nown, nextn++);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">while</span> (nextn != nextnextn) &#123;</span><br><span class="line">					<span class="keyword">if</span> (!needk) <span class="keyword">break</span>;</span><br><span class="line">					--needk;</span><br><span class="line">					<span class="keyword">printf</span>(<span class="string">"%d %d\n"</span>, nown, nextn++);</span><br><span class="line">				&#125;</span><br><span class="line">				++nown;</span><br><span class="line">				<span class="keyword">while</span> (nextn != nextnextn) &#123;</span><br><span class="line">					<span class="keyword">printf</span>(<span class="string">"%d %d\n"</span>, nown++, nextn++);</span><br><span class="line">				&#125;</span><br><span class="line">				nown = nextnown;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123; <span class="regexp">//</span> arr[i + <span class="number">1</span>] &lt; arr[i]</span><br><span class="line">				<span class="keyword">int</span> nextnown = nextn;</span><br><span class="line">				<span class="keyword">int</span> nextnextn = nextn + arr[i + <span class="number">1</span>];</span><br><span class="line">				<span class="keyword">printf</span>(<span class="string">"%d %d\n"</span>, nown, nextn++);</span><br><span class="line">				<span class="keyword">while</span> (nextn != nextnextn) &#123;</span><br><span class="line">					<span class="keyword">if</span> (!needk) <span class="keyword">break</span>;</span><br><span class="line">					--needk;</span><br><span class="line">					<span class="keyword">printf</span>(<span class="string">"%d %d\n"</span>, nown, nextn++);</span><br><span class="line">				&#125;</span><br><span class="line">				++nown;</span><br><span class="line">				<span class="keyword">while</span> (nextn != nextnextn) &#123;</span><br><span class="line">					<span class="keyword">printf</span>(<span class="string">"%d %d\n"</span>, nown++, nextn++);</span><br><span class="line">				&#125;</span><br><span class="line">				nown = nextnown;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>Codeforces 785D - Anton and School - 2</title>
    <url>/posts/64.html</url>
    <content><![CDATA[<p>#Description As you probably know, Anton goes to school. One of the school subjects that Anton studies is Bracketology. On the Bracketology lessons students usually learn different sequences that consist of round brackets (characters &quot;(&quot; and &quot;)&quot; (without quotes)).</p>
<p>On the last lesson Anton learned about the regular simple bracket sequences (RSBS). A bracket sequence s of length n is an RSBS if the following conditions are met:</p>
<p>It is not empty (that is n ≠ 0). The length of the sequence is even. First charactes of the sequence are equal to &quot;(&quot;. Last charactes of the sequence are equal to &quot;)&quot;. For example, the sequence &quot;((()))&quot; is an RSBS but the sequences &quot;((())&quot; and &quot;(()())&quot; are not RSBS.</p>
<p>Elena Ivanovna, Anton's teacher, gave him the following task as a homework. Given a bracket sequence s. Find the number of its distinct subsequences such that they are RSBS. Note that a subsequence of s is a string that can be obtained from s by deleting some of its elements. Two subsequences are considered distinct if distinct sets of positions are deleted.</p>
<p>Because the answer can be very big and Anton's teacher doesn't like big numbers, she asks Anton to find the answer modulo 109 + 7.</p>
<p>Anton thought of this task for a very long time, but he still doesn't know how to solve it. Help Anton to solve this task and write a program that finds the answer for it!</p>
<p>#Input The only line of the input contains a string s — the bracket sequence given in Anton's homework. The string consists only of characters &quot;(&quot; and &quot;)&quot; (without quotes). It's guaranteed that the string is not empty and its length doesn't exceed 200 000.</p>
<p>#Output Output one number — the answer for the task modulo 109 + 7.</p>
<p>#Examples <figure class="highlight lua"><table><tr><td class="code"><pre><span class="line"><span class="built_in">input</span></span><br><span class="line">)(()()</span><br><span class="line"><span class="built_in">output</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span></span><br><span class="line">()()()</span><br><span class="line"><span class="built_in">output</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span></span><br><span class="line">)))</span><br><span class="line"><span class="built_in">output</span></span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure></p>
<p>#Note In the first sample the following subsequences are possible:</p>
<p>If we delete characters at the positions 1 and 5 (numbering starts with one), we will get the subsequence &quot;(())&quot;. If we delete characters at the positions 1, 2, 3 and 4, we will get the subsequence &quot;()&quot;. If we delete characters at the positions 1, 2, 4 and 5, we will get the subsequence &quot;()&quot;. If we delete characters at the positions 1, 2, 5 and 6, we will get the subsequence &quot;()&quot;. If we delete characters at the positions 1, 3, 4 and 5, we will get the subsequence &quot;()&quot;. If we delete characters at the positions 1, 3, 5 and 6, we will get the subsequence &quot;()&quot;. The rest of the subsequnces are not RSBS. So we got 6 distinct subsequences that are RSBS, so the answer is 6.</p>
<p>#Key 题意：给一大串前后括号组成的字符串，长度为n，从中任取若干括号、按原顺序排列，要求取出的括号前一半都是“<code>(</code>”，后一半都是&quot;<code>)</code>&quot;，问有多少种组合（即组成如<code>((((()))))</code>）。如<code>)(()()</code> （没个括号分别编号1~6），有<code>2 4</code>、<code>2 6</code>、<code>3 4</code>、<code>3 6</code>、<code>5 6</code>、<code>2 3 4 6</code> 6种。 事后看了<a href="http://blog.csdn.net/zengaming/article/details/63684635" target="_blank" rel="noopener">题解</a>才AC。很容易想到的是，读取时只存储每一个后括号之前一共有多少个前括号，例如<code>)(()()</code>，有三个后括号，只需存储<code>0 2 3</code>即可（对该数组命名为sum，并假设一共m个后括号）。然后遍历这个sum数组：对于第i个后括号，左侧有<code>sum[i]</code>个前括号，右侧有<code>m-i</code>个后括号（方便起见令<code>ai=sum[i]</code>，<code>bi=m-i</code>），以当前后括号为第一个符合符合“<code>((((()))))</code>”的后括号，则当前后括号左侧的后括号都不可能满足，当前后括号右侧的前括号也不满足。则“以当前后括号为第一个符合的后括号”一共有 <span class="math display">\[
C^{1}_{a_i}*C^{0}_{b_i} + C^{2}_{a_i}*C^{1}_{b_i} + C^{3}_{a_i}*C^{2}_{b_i} + ... + C^{min(a_i,b_i+1)}_{a_i}*C^{min(a_i,b_i+1)-1}_{b_i} = \sum_{i=1}^{min(a_i,b_i+1)} C_{a_i}^{i}*C_{b_i}^{i-1} = \sum_{i=1}^{min(a_i,b_i+1)} C_{a_i}^{a_i-i}*C_{b_i}^{i-1} = \sum_{i=0}^{min(a_i-1,b_i)} C_{a_i}^{a_i-i-1}*C_{b_i}^{i}
\]</span> 注意a指的是当前后括号左侧的前括号个数，b为当前的后括号右侧后括号个数，故b不包括当前后括号。 最后根据范德蒙恒等式推倒： 若<span class="math inline">\(min(a_i-1,b_i) = a_i-1\)</span>： <span class="math display">\[
\sum_{i=0}^{min(a_i-1,b_i)} C_{a_i}^{a_i-i-1}*C_{b_i}^{i} = \sum_{i=0}^{a_i-1} C_{a_i}^{a_i-i-1}*C_{b_i}^{i} = C_{a_i+b_i}^{a_i-1}
\]</span> 若<span class="math inline">\(min(a_i,b_i+1) = b_i+1\)</span>： <span class="math display">\[
\sum_{i=1}^{min(a_i,b_i+1)} C_{a_i}^{i}*C_{b_i}^{i-1} = \sum_{i=1}^{b_i+1} C_{a_i}^{i}*C_{b_i}^{b_i+1-i} = C_{a_i+b_i}^{b_i+1}
\]</span> 合起来还是<span class="math inline">\(C_{a_i+b_i}^{min(a_i,b_i)}\)</span> 那么最终要做的就是把m个组合数求和。因而求组合数也是个难点。这里直接盗用了上面链接的大神的模板。自己写了个求组合数的<a href="http://blog.csdn.net/xienaoban/article/details/65448521" target="_blank" rel="noopener">博客</a>。这里还是预先打表了，这样快很多。</p>
<p>#Code <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MX 200005</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> p = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> sum[MX] = &#123; <span class="number">0</span> &#125;; <span class="comment">// store the sum of all the '(' before the last ')'</span></span><br><span class="line">LL ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">LL fac[<span class="number">200005</span>], fac_exp[<span class="number">200005</span>];</span><br><span class="line"><span class="function">LL <span class="title">ModExp</span><span class="params">(LL a, LL b, LL p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	LL ans = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (b)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">			ans = ans*a%p;</span><br><span class="line">		a = a*a%p;</span><br><span class="line">		b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> fac[n] % p * fac_exp[n - m] % p * fac_exp[m] % p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	fac[<span class="number">0</span>] = fac_exp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">200000</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		fac[i] = (fac[i - <span class="number">1</span>] * i) % p;</span><br><span class="line">		fac_exp[i] = ModExp(fac[i], p - <span class="number">2</span>, p);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="built_in">string</span> s;</span><br><span class="line">	getline(<span class="built_in">cin</span>, s);</span><br><span class="line">	<span class="keyword">int</span> num_left = <span class="number">0</span>, num_right = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">char</span> c : s) &#123;</span><br><span class="line">		<span class="keyword">if</span> (c == <span class="string">'('</span>) ++num_left;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			sum[num_right + <span class="number">1</span>] = sum[num_right] + num_left;</span><br><span class="line">			++num_right;</span><br><span class="line">			num_left = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= num_right;++i) &#123;</span><br><span class="line">		<span class="keyword">int</span> right = num_right - i + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">int</span> left = sum[i];</span><br><span class="line">		ans += C(right - <span class="number">1</span> + left, right);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; (<span class="keyword">int</span>)(ans%p);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>Codeforces</category>
      </categories>
      <tags>
        <tag>Codeforces</tag>
      </tags>
  </entry>
  <entry>
    <title>Coursera Machine Learning Week3 - 正则化(Regularization)</title>
    <url>/posts/13990.html</url>
    <content><![CDATA[<h1 id="欠拟合underfitting与过拟合overfitting">欠拟合（Underfitting）与过拟合（Overfitting）</h1>
<p><img src="/posts/13990/20170217151730329.png" alt="这里写图片描述"> <img src="/posts/13990/20170217151750751.png" alt="这里写图片描述"> 上面两张图分别是回归问题和分类问题的欠拟合和过度拟合的例子。可以看到，如果使用直线（两组图的第一张）来拟合训，并不能很好地适应我们的训练集，这就叫欠拟合（Underfitting），但是如果x的次数太高（两组图的第三张），拟合虽然很好，但是预测能力反而变差了，这就是过拟合（Overfitting）。 对于欠拟合，我们可以适当增加特征，比如加入x的多次方。通常这很少发生，发生的多的都是过拟合。那么如何处理过度拟合呢？ 1. 丢弃一些不能帮助我们正确预测的特征。可以是手工选择保留哪些特征，或者使用一些模型选择的算法来帮忙（例如 PCA）。 2. <strong>正则化</strong>。 保留所有的特征，但是减少参数的大小(magnitude)。</p>
<h1 id="加入正则化的代价函数">加入正则化的代价函数</h1>
<p>假设上面的线性回归过拟合例子使用使用的模型是： <img src="/posts/13990/20170217151913275.png" alt="这里写图片描述"></p>
<p>我们可以看出这些高次项（3次方、4次方）导致了过拟合，高次项参数大了，从图像来看就是会变得非常曲折，高次项参数小了图像就会较为平整。所以这里我们要做的就是一定程度上减小高次项参数，削弱高次项的影响力。我们的做法是修改代价函数，给theta3、theta4一些惩罚，使得最终选出来的theta3、theta4比较小： J(theta)=<img src="/posts/13990/20170217153353687.png" alt="这里写图片描述"></p>
<p>通过这样的代价函数选择出的theta3 和theta4 对预测结果的影响就比之前要小许多，因为theta3、4一试图变大，代价就会变大很多，那么在使用梯度下降最小化J(theta)时，theta3、4就会变得比较小。 假如我们有非常多的特征，我们并不知道其中哪些特征我们要惩罚，我们将对所有的特征进行惩罚，并且让代价函数最优化的软件来选择这些惩罚的程度。这样的结果是得到了一个较为简单的能防止过拟合问题的假设: <img src="/posts/13990/20170217153642074.png" alt="这里写图片描述"></p>
<ul>
<li>其中 lambda 又称为正则化参数（Regularization Parameter）。</li>
<li>根据惯例,我们不对theta0进 行惩罚。否则得到的图像比较靠近x轴，那整个模型就偏离数据了。</li>
</ul>
<p>经过正则化处理的模型与原模型的可能对比如下图所示: <img src="/posts/13990/20170217154024000.png" alt="这里写图片描述"></p>
<p>这里的lambda的选择也是较为关键的一点，如上图，theta太小甚至为0，那可能导致过拟合，而lambda太大，图像就会得到一条类似与平行于x轴的直线。</p>
<h1 id="正则化后的线性回归逻辑回归模型">正则化后的线性回归、逻辑回归模型</h1>
<h2 id="正则化线性回归">正则化线性回归</h2>
<p>重新将新的代价函数带入梯度下降算法，经过求导、化简后，得到的梯度下降如下： <img src="/posts/13990/20170217160238498.png" alt="这里写图片描述"></p>
<p>对于j=1,2,...,n，thetaj的更新式子可以化简为： <img src="/posts/13990/20170217154905340.png" alt="这里写图片描述"></p>
<p>可以看到（不看theta0），算法的变化就在于theta每次减少了一个额外的<code>alpha*lambda/m</code>。</p>
<p>同样的，可以在正规方程使用正则化： <img src="/posts/13990/20170217155832918.png" alt="这里写图片描述"></p>
<h2 id="正则化逻辑回归">正则化逻辑回归</h2>
<p>同样带入化简，得： <img src="/posts/13990/20170217160238498.png" alt="这里写图片描述"></p>
<p>发现得到的式子和线性回归一样，当然，两者的区别之前已经分析过，h(x)不同。</p>
]]></content>
      <categories>
        <category>Machine Learning</category>
        <category>Coursera Machine Learning</category>
      </categories>
      <tags>
        <tag>Machine Learning</tag>
        <tag>Coursera</tag>
        <tag>Regularization</tag>
      </tags>
  </entry>
  <entry>
    <title>Coursera Machine Learning Week3 - 逻辑回归(Logistic Regression)</title>
    <url>/posts/33431.html</url>
    <content><![CDATA[<p>逻辑回归算法是分类算法，虽然这个算法的名字中出现了“回归”，但逻辑回归算法实际上是一种分类算法，我们将它作为分类算法使用。。 分类问题：对于每个样本，判断它属于N个类中的那个类或哪几个类。通常我们判定一个样本，若我们预测它的确属于这个类的可能性大于50%，则认为它属于这个类。当然具体选择50%还是70%还是其他要看具体情况，这里先默认50%。 线性回归的局限性在分类问题的例子中变得不可靠：这是一个用来预测肿瘤是否呈阴性的模型，当一个肿瘤的尺寸大于一个数，我们就认为这个肿瘤呈阴性。我们现在新增了一个数据，结果导致整个模型的参数变化很大。如下图，在新加入最右侧数据后，50%的分水岭右移了不止一点点。而根据常识这个数据本应对我们的预测没有什么影响。 <img src="/posts/33431/20170213211222015.png" alt="这里写图片描述"></p>
<p>对此类问题引入新模型： <img src="/posts/33431/20170213211642298.png" alt="这里写图片描述"></p>
<p>对于g(z)=1/(1+e^(-z))这个模型，对国内读过高中的学生都能看懂都想得出它的函数图像，当z&gt;0时g大于0.5，z&lt;0时g小于0.5，z=0时g=0.5。我们以此判定样本属于一个类的几率。现在上图这个模型就是g(theta.T X)（“.T”代表转置矩阵），即我们需要找到参数区分出50%这一边界。 对于下图的数据，我们只需使用一条直线分出0.5的交界处即可。 <img src="/posts/33431/20170213211947550.png" alt="这里写图片描述"> 而对于下面的数据，我们觉得得使用曲线来适应才能分割y=0与y=1的区域。h(x)如图所示，最终得到一个类似圆形的形状。 <img src="/posts/33431/20170213212122722.png" alt="这里写图片描述"> 对于更复杂的形状，我们可以使用更为复杂的模型。 不过以上的分类问题只有两个类（叫做二元分类问题），只需回答一个数据属于A还是B即可。后面还有复杂些的多类别分类，后面会讲，先仅仅分析叫做二元分类。</p>
<h1 id="二元分类问题的代价函数">1.二元分类问题的代价函数</h1>
<p>对于线性回归模型,我们定义的代价函数是所有模型误差的平方和。理论上来说,我们 也可以对逻辑回归模型沿用这个定义,但是问题在于,当我们将h(x) 带入到线性回归模型适用的代价函数中时,我们得到的代价函数将是一个非凸函数(non-convex function)。 <img src="/posts/33431/20170213212250369.png" alt="这里写图片描述"> 这意味着我们的代价函数有许多局部最小值,这将影响梯度下降算法寻找全局最小值（是的即将讲的新模型能够确保找到全局最小值，因为它是凸函数(convex)，只有一个极小值，那就是最小值。具体下面讲）。 于是重新定义逻辑回归的代价函数： <img src="/posts/33431/20170213212321495.png" alt="这里写图片描述"></p>
<p>其中 <img src="/posts/33431/20170213212349745.png" alt="这里写图片描述"></p>
<p>简化上式得： <img src="/posts/33431/20170213212440473.png" alt="这里写图片描述"></p>
<p>Cost带入J最终得到的代价函数： <img src="/posts/33431/20170213212713922.png" alt="这里写图片描述"></p>
<p>h(x)与 Cost(h(x),y)之间的关系如下图所示： <img src="/posts/33431/20170213212526067.png" alt="这里写图片描述"></p>
<p>这样构建的Cost(h θ (x),y)函数的特点是:当实际的y=1且 h也为1时误差为0，当y=1但h不为1时误差随着h的变小而变大；当实际的y=0且h也为0时代价为0，当y=0但h不为0时误差随着h的变大而变大。</p>
<h1 id="对二元分类问题使用梯度下降">2.对二元分类问题使用梯度下降</h1>
<p>知道了代价函数然后像对线性回归一样使用梯度下降算法： <img src="/posts/33431/20170213212920648.png" alt="这里写图片描述"></p>
<p>求导后得到： <img src="/posts/33431/20170213213037193.png" alt="这里写图片描述"> （原视频少了1/m！我用红色补上了。）</p>
<p>于是乎我们惊奇的发现，这个式子的样子和之前用在线性回归的一样！而他们的J(θ)显然是不一样的。那么,线性回归和逻辑回归是同一个算法吗？ 显然不是，要知道，我们是对x求导，而不是对h(x)求导，而两者的h(x)完全不同，所以求导的过程中要展开h(x)对x进行求导，所以结果其实是完全不同的。只不过这两个求导结果刚好可以重新用h(x)包装起来表示。所以逻辑函数的梯度下降，跟线性回归的梯度下降实际上是两个完全不同的东西。</p>
<h2 id="特征缩放">特征缩放</h2>
<p>与线性回归一样的是，别忘记特征缩放。这很重要，特征缩放后可以更快地到达最优解，并防止反复的震荡。具体不再展开讲了。</p>
<h2 id="梯度下降必能找到该代价函数的全局最小值">梯度下降必能找到该代价函数的全局最小值</h2>
<blockquote>
<p>In this video, we will define the cost function for a single train example. The topic of convexity analysis is now beyond the scope of this course, but it is possible to show that with a particular choice of cost function, this will give a convex optimization problem. Overall cost function j of theta will be convex and local optima free. 在这个视频中，我们定义了单训练样本的代价函数,凸性分析的内容是超出这门课的范围的，但是可以证明我们所选的代价值函数会给我们一个凸优化问题。代价函数 J(θ)会是一个凸函数，并且没有局部最优值。</p>
</blockquote>
<p>吴恩达老师的视频这里说了这个新的代价函数是凸函数，所以使用梯度下降一定能达到全局最小值。证明我也暂时不管它了。</p>
<h1 id="多类别分类multiclass-classification">3.多类别分类（Multiclass Classification）</h1>
<p>上面讲了二元分类问题的计算方法，但是如果问题有很多个类，要你预测样本属于这么多类里的哪一个，要怎么做呢？通常我们使用“一对余”方法。 <img src="/posts/33431/20170213215602759.png" alt="这里写图片描述"></p>
<p>“一对余”方法：将“n类别问题”转换成“n个二元分类问题”。 比如现在有3个类ABC要划分，我们对每个类单独进行分析。比如对于类B，把所有数据划分成两类，属于B的（正样本）和不属于B的（负样本），我们不需要知道它是属于A还是C的，只需知道它不是B即可。于是对于每个类都变成了一个二元问题，一共3个二元问题。我们要做的就是训练这三个分类器。当预测一个新数据的分类时，我们选择3个h(x)里值最高的那个。 <img src="/posts/33431/20170213215634228.png" alt="这里写图片描述"></p>
<h1 id="最小化代价函数的其他算法">4.最小化代价函数的其他算法</h1>
<p>一些梯度下降算法之外的选择：除了梯度下降算法以外，还有一些常被用来令代价函数最小的算法，这些算法更加复杂和优越，而且通常不需要人工选择学习率，通常比梯度下降算法要更加快速。这些算法有：共轭梯度(Conjugate Gradient)，局部优化法(Broyden fletchergoldfarb shann,BFGS，或叫变尺度法)和有限内存局部优化法(L-BFGS，或叫限制变尺度法)。虽然我暂时不打算看，但Mark一下。</p>
]]></content>
      <categories>
        <category>Machine Learning</category>
        <category>Coursera Machine Learning</category>
      </categories>
      <tags>
        <tag>Machine Learning</tag>
        <tag>Coursera</tag>
        <tag>Logistic Regression</tag>
      </tags>
  </entry>
  <entry>
    <title>Coursera Machine Learning Week1,2 - 线性回归(Linear Regression)</title>
    <url>/posts/42401.html</url>
    <content><![CDATA[<p>线性回归属于回归问题。对于回归问题，解决流程为： 给定数据集中每个样本及其正确答案，选择一个模型函数h（hypothesis，假设），并为h找到适应数据的（未必是全局）最优解，即找出最优解下的h的参数。这里给定的数据集取名叫训练集（Training Set）。不能所有数据都拿来训练，要留一部分验证模型好不好使，这点以后说。先列举几个几个典型的模型：</p>
<p>最基本的单变量线性回归： 形如h(x)=theta0+theta1*x1</p>
<p>多变量线性回归： 形如h(x)=theta0+theta1<em>x1+theta2</em>x2+theta3*x3</p>
<p>多项式回归（Polynomial Regression）： 形如h(x)=theta0+theta1<em>x1+theta2</em>(x2^2)+theta3*(x3<sup>3) 或者h(x)=ttheta0+theta1<em>x1+theta2</em>sqr(x2) 但是我们可以令x2=x2</sup>2，x3=x3^3，于是又将其转化为了线性回归模型。虽然不能说多项式回归问题属于线性回归问题，但是一般我们就是这么做的。</p>
<p>所以最终通用表达式就是： <img src="/posts/42401/20170212155723091.png" alt="这里写图片描述"> 不用在意图片h(x)中间夹的theta字符，只是一个习惯而已，不写theta也可以的。还有我不知道怎么在博客里输入theta那些字符，凑合着看。</p>
<h1 id="代价函数cost-function">1.代价函数（Cost Function）</h1>
<p>计算建立的模型对真实数据的误差，叫建模误差（Modeling Error）。误差越低，模型对数据拟合度越高。例如给出： m：训练集的样本个数 n：训练集的特征个数（通常每行数据为一个x(0)=1与n个x(i) (i from 1 to n)构成，所以一般都会将x最左侧加一列“1”，变成n+1个特征） x：训练集（可含有任意多个特征，二维矩阵，行数m，列数n+1，即x0=1与原训练集结合） y：训练集对应的正确答案（m维向量，也就是长度为m的一维数组） h(x)：我们确定的模型对应的函数（返回m维向量） theta：h的初始参数（常为随机生成。n+1维向量）</p>
<p>得代价函数J(theta)： <img src="/posts/42401/20170212160638907.png" alt="这里写图片描述"> （图中等号左侧的theta0,theta1...thetan以后直接用向量theta表示。）</p>
<p>有了代价函数，我们的目的就是找到一组参数theta使得代价最小，稍有常识的人就能知道，这个函数肯定是有最小值的，不会出现负无穷下面两个标题就是讲了最小化J(theta)的两个方法。</p>
<h1 id="正规方程normal-equation">2.正规方程（Normal Equation）</h1>
<p>吴恩达老师这个是放在最后讲的，但是对于中国学生，我觉得其实这个先讲反而更好。 正规方程是针对某些线性回归问题的方案，例如对于我们熟知的 <img src="/posts/42401/20170212161159174.png" alt="这里写图片描述"> 要把上面的代价方程找出theta最小值，本质上就是二次函数嘛。我们直接求导计算导数为0处即为最小值。求解theta轻轻松松一步到位。同样对于多参数的线性回归，只要求偏导即可获得每个theta值到达全局最优解。。 那么现在在矩阵中，假设我们的训练集矩阵为X，“正确答案”为y，则theta可以如上面所说的各自求偏导数直接求出。但是直接这样做非常耗时，因此数学家由此推导出了更好的方法： <img src="/posts/42401/20170212161352926.png" alt="这里写图片描述"> 这个公式本质就是从上面求导这一方法推导出来的。推导过程：https://zhuanlan.zhihu.com/p/22474562</p>
<p>当然很显然的是，如果矩阵不可逆就不能用这个方案了（出现这个情况的原因可能是1.各个特征不独立、有关联，比如出现了重量和质量两个特征（至少在同一个地方两者完全成比例）；2.特征数量大于所给训练集样本个数）。</p>
<h1 id="批量梯度下降算法batch-gradient-descent">3.（批量）梯度下降算法（(Batch) Gradient Descent）</h1>
<p>上述方法简单易使用但是局限高，而梯度下降算法使用更广泛更通用。当然这个算法放到现在也有人说它过时了，但还是很有必要学习个。 先定下一组预设参数，通常可以是随机生成的，不断微调h的参数直到达到代价J的局部最小值（Local Minimum）。因此此算法并不一定能找到全局最小值（Global Minimum）。根据初始theta选择的不同可能找到不同局部最小值、导致不同结果。下图很形象的表现了这一点。 <img src="/posts/42401/20170212161951227.png" alt="这里写图片描述"></p>
<p>具体实现：我们循环以下算法直到到达局部最小值。 <img src="/posts/42401/20170212163327404.png" alt="这里写图片描述"></p>
<ul>
<li>alpha是学习率(Learning Rate)，其大小决定了每次循环中theta改变的大小，决定了梯度下降步子迈多大。寻找alpha很关键。alpha小了，每次循环步子也迈的小，要很多步才能到达最低点，速度慢。alpha太大了，可能一下就迈过头了，越过了最低点，并不断一次次越过来越过去就是下不来，太大了甚至可能导致循环无法收敛、甚至发散。</li>
<li><p>可以看出，随着算法越来越接近局部最小值，J’越小，下降速度越慢，因此alpha只需是个定值，无需在靠近最小值时一起减小alpha。</p></li>
<li><p>注意（FBI Warning），<strong>每个theta i必须是同步变换</strong>，即不能修改了theta1为新计算得的值后再计算要修改的theta2，这样计算出的theta2是基于是修改后的theta1而得到的。因此要计算出全部新theta后统一赋值。</p></li>
<li><p>该梯度下降算法有时也被称为<strong>批量梯度下降</strong>。“批量”指的是在梯度下降的每一步中,我们都用到了所有的训练样本。</p></li>
</ul>
<h2 id="线性回归上运用梯度下降">线性回归上运用梯度下降</h2>
<p>按照梯度下降要求求得代价方程J的导数J’（为了方便书写记J的导数为J’），而对于线性回归模型的J方程上面已经给出，所以将J求导带入，得到： <img src="/posts/42401/20170212163453581.png" alt="这里写图片描述"></p>
<p>将求导部分求出来，即： <img src="/posts/42401/20170212163543436.png" alt="这里写图片描述"></p>
<p>其中 <img src="/posts/42401/20170212155723091.png" alt="这里写图片描述"></p>
<h2 id="特征缩放feature-scaling">特征缩放（Feature Scaling）</h2>
<p>以房价为例子，现在假设房子价格只受房屋的尺寸（对应theta1）和房间的数量（theta2）影响，房子尺寸的值为 0-2000 平方英尺，而房间数量的值是 0-5，以两个参数为横纵坐标绘图，可以看出图像很扁，梯度下降算法需要非常多次迭代才能收敛。 <img src="/posts/42401/20170212164150808.png" alt="这里写图片描述"></p>
<p>具体为什么会导致迭代很多次，老师的解释是根据图来的，虽然很直观但是根本原因他没说清楚，现在分析下来我认为原因在于，梯度下降时，alpha对于每个参数都是一样的（现在假定alpha为1），则根据最终得到的算法（“Repeat”里面那行），alpha、1/m、h(xi)-y(i)都是一样的，不一样的只有xj(i)（上标下标不会打，凑合着看），那么对于房屋尺寸，尺寸都上千了，数值很大，则theta1的变化也很大，因此对于theta1，alpha太大了，看那张草图，已经导致了越过最小值的情况。而对于theta2呢，房间一共不会超过5，因此对于theta2，alpha太小了，每次就靠近最小值一点点。</p>
<p>这时候我们就需要特征缩放，把所有参数缩放到-1～1的范围，让alpha适应每个参数，每个参数每次的变化都相当。 <img src="/posts/42401/20170212164501171.png" alt="这里写图片描述"></p>
<p>具体实施就是令<img src="/posts/42401/20170212164609457.png" alt="这里写图片描述"> 其中u是平均值，s是标准差。把每个数据都如上修改范围，相当于预处理，这样可以对后面线性回归有帮助。而对于多项式回归模型，在运行梯度下降算法前,特征缩放就显得更有必要了。</p>
<p>其实我个人觉得给每个参数分配一个alpha也是可行的一种方案，不过仔细想想，这样的确实麻烦了点，因为找出合适的alpha不是那么容易的事情。</p>
<h2 id="学习率alpha的选择">学习率alpha的选择</h2>
<p>上面说到了，alpha太大，步子大了容易扯到蛋，可能导致越过最小值甚至无法收敛；alpha小了又显得娘炮，太慢了。 通常可以考虑尝试这些学习率：α=0.01,0.03,0.1,0.3,1,3,10，多试一试找出比较好的。</p>
<h2 id="局部最优解还是全局最优解">局部最优解还是全局最优解</h2>
<p>之前也明确说了，梯度下降不一定能获得全局最优解，但是网上那么多教程、博客还是写的很混乱，或者说非常不严谨，都说“到达全局最小值”；包括在吴恩达老师的视频里，也不是描述的很清爽。搞得我很懵。所以问题是，梯度下降用来求最优解，哪些问题可以求得全局最优？哪些问题可能获得局部最优解？ 如果函数图像只有一个凹坑，像吴大大视频里的例子全都是一个峰的，那梯度下降最终求得的肯定是全局最优解，应该说获得的局部最优解就是全局最优解。然而对于有多个凹坑的问题，梯度下降获得的局部最优解很有可能的最终结果不是全局最优。对于线性回归问题这也是一样的，网上看到有人说线性回归问题只有一个全局最小值没有局部最小值，感觉这不对，我记得吴恩达老师有说过线性回归也可以有极小值存在的。先mark，等我验证后更新。 但是正规方程呢？当有多个极小值时他一定会返回最小值吗？这点我也不清楚，但是按照周志华老师的机器学习的书上说，当特征数量大于所给训练集样本个数时使用正规方程，会得到多个解，而具体返回哪个解就看算法的选择了。</p>
<h1 id="正规方程梯度下降的选择比较">4.正规方程、梯度下降的选择、比较</h1>
<table>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>梯度下降</th>
<th>正规方程</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>需要选择学习率 α</td>
<td>不需要</td>
</tr>
<tr class="even">
<td>需要多次迭代</td>
<td>一次运算得出</td>
</tr>
<tr class="odd">
<td>当特征数量 n 大时也能较好适用</td>
<td>需要计算(X.T X)^-1。如果特征数量 n 较大则运算代价大,因为矩阵逆的计算时间复杂度为 O(n 3 ),通常来说当 n 小于 10000 时还是可以接受的</td>
</tr>
<tr class="even">
<td>适用于各种类型的模型</td>
<td>只适用于线性模型,不适合逻辑回归模型等其他模型</td>
</tr>
</tbody>
</table>
<blockquote>
<p>总结一下,只要特征变量的数目并不大,标准方程是一个很好的计算参数 θ 的替代方法。具体地说,只要特征变量数量小于一万,我通常使用标准方程法,而不使用梯度下降法。 随着我们要讲的学习算法越来越复杂,例如,当我们讲到分类算法,像逻辑回归算法,我们会看到, 实际上对于那些算法,并不能使用标准方程法。对于那些更复杂的学习算法,我们将不得不仍然使用梯度下降法。因此,梯度下降法是一个非常有用的算法,可以用在有大量特征变量的线性回归问题。或者我们以后在课程中,会讲到的一些其他的算法,因为标准方程法不适合或者不能用在它们上。但对于这个特定的线性回归模型,标准方程法是一个比梯度下降法更快的替代算法。所以,根据具体的问题,以及你的特征变量的数量,这两种算法都是值得学习的。</p>
</blockquote>
<hr>
<p>补充：</p>
<h1 id="随机梯度下降算法stochastic-gradient-descent">5.随机梯度下降算法（Stochastic Gradient Descent）</h1>
<p>普通的梯度下降算法更新一次theta需要载入所有样本，也就是说一次更新的计算量为m*n^2（m为样本数量，n为参数数量）。这样如果m 非常大，我们需要把所有样本都载入，才能更新一次参数theta，更新一次theta的时间太久了。 而随机梯度下降算法是每次只取一个样本，马上就更新theta。 <img src="/posts/42401/6bb07f83gccf29f0eb9c1&amp;690.png" alt="这里写图片描述"> 也就是说，每次更新theta的计算量为n^2，当m很大的时候，随机梯度下降迭代一次的速度要远高于梯度下降。 当然有弊有利，利就是更新速度很快，弊就是梯度下降的方向不稳。虽然大致方向上还是向着最低点的，但是一路上都在来回移动。要知道毕竟一套参数不能完全满足所有样本，而每个样本都试图将参数向自己方向靠。（说起来这样不应该很可能没法收敛吗？最后会不会一直在最优解附近游荡。） <img src="/posts/42401/132035089105720.jpg" alt="这里写图片描述"></p>
]]></content>
      <categories>
        <category>Machine Learning</category>
        <category>Coursera Machine Learning</category>
      </categories>
      <tags>
        <tag>Machine Learning</tag>
        <tag>Coursera</tag>
        <tag>Linear Regression</tag>
      </tags>
  </entry>
  <entry>
    <title>Coursera Machine Learning Week0 - 目录大纲</title>
    <url>/posts/58377.html</url>
    <content><![CDATA[<p>目录会根据我的学习进度而更新，给自己列一个大纲以系统地看待整个学习过程。</p>
<p>#学习资料来源</p>
<p>学习的是Coursera上吴恩达（Andrew Ng）老师的机器学习视频（<a href="https://www.coursera.org/learn/machine-learning/home/welcome" target="_blank" rel="noopener">课程传送门</a>，最近在“最强大脑”上看到他了好激动啊，原来他去做百度大脑了呀），笔记根据此系列视频整理。笔记顺序不一定与原教程一样，希望加入些自己的思考。</p>
<p>同时使用了网上找到的黄海广博士的对于吴大大视频教程的笔记（<a href="http://mooc.guokr.com/note/16274/" target="_blank" rel="noopener">传送门</a>）。因为我一开始看视频没做笔记，现在忘得差不多啦，现在打算写个笔记，重新去看视频再整理太麻烦，网上竟然找到这一神器，视频内容全都用中文写在里面了，棒！（不过还是不太好意思发邮件给他自我介绍。。。先暂时做伸手党吧。。。）</p>
<p>#机器学习分类</p>
<p>##1.监督学习（Supervised Learning） 给定数据集，数据集的每个样本均有提供“正确答案”，根据这些样本进行预测。例子： 垃圾邮件分类：根据已知的垃圾邮件特征判断新邮件是否垃圾； 判定肿瘤是否恶性：根据已知恶性、良性特征判断病人肿瘤情况。 ###1)回归问题（Regression） 给定数据集中每个样本的正确答案，运用到机器学习中，推出一个连续的输出。 如线性回归（Linear Regression）。 ###2)分类问题（Classification） 给定数据集中每个样本的正确答案，运用到机器学习中，推出一组离散的结果。 如逻辑回归（Logistic Regression）。 注意：逻辑回归算法是分类算法,我们将它作为分类算法使用。有时候可能因为这个算法的名字中出现了“回归”使你感到困惑，但逻辑回归算法实际上是一种分类算法。</p>
<p>##2.无监督学习（Unsupervised Learning） 只给定数据集，每个样本没有标签、没有提前告知的“正确答案”，要求在数据中自动找出某种结构。例子： 新闻分类：自动将同一主题的新闻分类； DNA检测：判断每个个体是否有一个特定基因。 辨识人声：从一段音频分出每个人的音轨。 （待更新）</p>
]]></content>
      <categories>
        <category>Machine Learning</category>
        <category>Coursera Machine Learning</category>
      </categories>
      <tags>
        <tag>Machine Learning</tag>
        <tag>Coursera</tag>
      </tags>
  </entry>
  <entry>
    <title>SciPy、Matplotlib基础操作</title>
    <url>/posts/29569.html</url>
    <content><![CDATA[<p>NumPy、SciPy、Matplotlib，Python下机器学习三大利器。上一篇讲了NumPy基础操作，这节讲讲SciPy和Matplotlib。目前接触到的东西不多，以后再遇到些比较常用的再更新。</p>
<p>scipy是基于numpy的扩充，所以安装时要先安装numpy再安装scipy。scipy的命名空间包含numpy，所以只需import scipy即可，numpy不用import。（所以以下有些东西可能是numpy里的我没分清楚，反正一并写了吧。）</p>
<figure class="highlight elm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> scipy <span class="keyword">as</span> sp</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>
<p>首先从文件导入数据，使用genfromtxt函数。文件是《Python语言构建机器学习系统（第二版）》里提供的数据：<a href="https://github.com/luispedro/BuildingMachineLearningSystemsWithPython/blob/master/ch01/data/web_traffic.tsv" target="_blank" rel="noopener">web_traffic.tsv</a>。读取后把x与y分开。而且里面有几个nan数据，得事先踢掉：</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">data</span> = sp.genfromtxt(<span class="string">"web_traffic.tsv"</span>,delimiter=<span class="string">"\t"</span>)</span><br><span class="line"><span class="attr">x</span> = data[:,<span class="number">0</span>]</span><br><span class="line"><span class="attr">y</span> = data[:,<span class="number">1</span>]</span><br><span class="line"><span class="attr">x</span> = x[~sp.isnan(y)]</span><br><span class="line"><span class="attr">y</span> = y[~sp.isnan(y)]</span><br></pre></td></tr></table></figure>
<p>然后我们想可视化这些数据，以图表给出，那就用到matplotlib了：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">plt.scatter(x, y, <span class="attribute">s</span>=6)  # 在图标上产生散点，s代表绘制的点的粗细</span><br><span class="line">plt.title(<span class="string">"Web traffic"</span>)  # 标题</span><br><span class="line">plt.xlabel(<span class="string">"Time"</span>)  # x轴标签</span><br><span class="line">plt.ylabel(<span class="string">"Hits/hour"</span>)  # y轴标签</span><br><span class="line">plt.xticks([w<span class="number">*7</span><span class="number">*24</span> <span class="keyword">for</span> w <span class="keyword">in</span> range(10)],</span><br><span class="line">           [<span class="string">"week %i"</span> % w <span class="keyword">for</span> w <span class="keyword">in</span> range(10)])  # 更改x轴的默认刻度显示，以一星期为一个刻度，range中数字10表示x刻度最多显示到第10周</span><br><span class="line">plt.autoscale(<span class="attribute">tight</span>=<span class="literal">True</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>,<span class="attribute">linestyle</span>=<span class="string">'-'</span>,color='0.75')</span><br></pre></td></tr></table></figure>
<p>最后<code>plt.show()</code>以显示窗口。</p>
<figure>
<img src="/posts/29569/1.png" alt="这里写图片描述"><figcaption>这里写图片描述</figcaption>
</figure>
<p>然后我们用二次函数作为模型，并使得函数最好的适应数据。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">fp,residuals,rank,sv,rcond = sp.polyfit(x,y,2,<span class="attribute">full</span>=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>polyfit函数直接帮我们找到了这个使得方差最小的直线的参数，参数存在f1p里面。里面那个参数2就代表产生二次函数，3代笔3次函数，50就是50次函数。我们print fp，得到： <figure class="highlight subunit"><table><tr><td class="code"><pre><span class="line">[  1.05322215e<span class="string">-02</span>  <span class="string">-5</span>.26545650e<span class="string">+00</span>   1.97476082e<span class="string">+03</span>]</span><br></pre></td></tr></table></figure> full=True使得这个函数返回更多的东西，返回一些额外的后台信息，比如误差（error），就存在那个residuals里： <figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[  <span class="number">1.79983508e+08</span>]</span><br></pre></td></tr></table></figure></p>
<p>poly1d将参数转换成可识别的函数格式，可以把它当做普通python的函数用。注意是poly“1”d，是1不是l。不知道有没有poly2d。</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">f = <span class="built_in">sp</span>.poly1d(<span class="built_in">fp</span>)</span><br></pre></td></tr></table></figure>
<p>linspace函数产生一次函数从x=0到x=x[-1]区间内的函数的值，作为一维矩阵存储。1000那个数字代表产生几个值，数字越大产生的值越多。当然对于一次函数，值为2其实就够了。 <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">fx = sp.linspace(<span class="number">0</span>,x[<span class="number">-1</span>],<span class="number">1000</span>)</span><br></pre></td></tr></table></figure></p>
<p>值为1000时： <img src="/posts/29569/2.png" alt="这里写图片描述"></p>
<p>值为5时： <img src="/posts/29569/3.png" alt="这里写图片描述"></p>
<p>就只计算了5个值，明显弧度不行了。</p>
<p>然后以下plot函数就是把得到的二次函数放到figure上的。legend产生左上角那个d=2标示。 <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">plt.plot(fx,f(fx),<span class="attribute">linewidth</span>=2)</span><br><span class="line">plt.legend([<span class="string">"d=%i"</span> % f.order],<span class="attribute">loc</span>=<span class="string">"upper left"</span>)</span><br></pre></td></tr></table></figure></p>
<p>同理可得其他次数的最佳适应的函数。以下写了个小小的成品，计算了一次、二次、五十三次函数：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">import scipy as sp</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line"></span><br><span class="line">data = sp.genfromtxt(<span class="string">"web_traffic.tsv"</span>,<span class="attribute">delimiter</span>=<span class="string">"\t"</span>)</span><br><span class="line">x = data[:,0]</span><br><span class="line">y = data[:,1]</span><br><span class="line">x = x[~sp.isnan(y)]</span><br><span class="line">y = y[~sp.isnan(y)]</span><br><span class="line"></span><br><span class="line">plt.scatter(x, y, <span class="attribute">s</span>=6)</span><br><span class="line">plt.title(<span class="string">"Web traffic"</span>)</span><br><span class="line">plt.xlabel(<span class="string">"Time"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"Hits/hour"</span>)</span><br><span class="line">plt.xticks([w<span class="number">*7</span><span class="number">*24</span> <span class="keyword">for</span> w <span class="keyword">in</span> range(10)],</span><br><span class="line">           [<span class="string">"week %i"</span> % w <span class="keyword">for</span> w <span class="keyword">in</span> range(10)])</span><br><span class="line">plt.autoscale(<span class="attribute">tight</span>=<span class="literal">True</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>,<span class="attribute">linestyle</span>=<span class="string">'-'</span>,color='0.75')</span><br><span class="line"></span><br><span class="line">f1p,residuals,rank,sv,rcond = sp.polyfit(x,y,1,<span class="attribute">full</span>=<span class="literal">True</span>)</span><br><span class="line">f1 = sp.poly1d(f1p)</span><br><span class="line">f1x = sp.linspace(0,x[-1],1000)</span><br><span class="line">plt.plot(f1x,f1(f1x),<span class="attribute">linewidth</span>=2)</span><br><span class="line">plt.legend([<span class="string">"d=%i"</span> % f1.order],<span class="attribute">loc</span>=<span class="string">"upper left"</span>)</span><br><span class="line"></span><br><span class="line">f2p = sp.polyfit(x,y,2)</span><br><span class="line">f2 = sp.poly1d(f2p)</span><br><span class="line">f2x = sp.linspace(0,x[-1],1000)</span><br><span class="line">plt.plot(f2x,f2(f2x),<span class="attribute">linewidth</span>=2)</span><br><span class="line">plt.legend([<span class="string">"d=%i"</span> % f2.order],<span class="attribute">loc</span>=<span class="string">"upper left"</span>)</span><br><span class="line"></span><br><span class="line">f3p = sp.polyfit(x,y,53)</span><br><span class="line">f3 = sp.poly1d(f3p)</span><br><span class="line">f3x = sp.linspace(0,x[-1],1000)</span><br><span class="line">plt.plot(f3x,f3(f3x),<span class="attribute">linewidth</span>=2)</span><br><span class="line">plt.legend([<span class="string">"d=%i"</span> % f3.order],<span class="attribute">loc</span>=<span class="string">"upper left"</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<figure>
<img src="/posts/29569/4.png" alt="这里写图片描述"><figcaption>这里写图片描述</figcaption>
</figure>
]]></content>
      <tags>
        <tag>Python</tag>
        <tag>Scipy</tag>
        <tag>Matplotlib</tag>
      </tags>
  </entry>
  <entry>
    <title>NumPy基础操作</title>
    <url>/posts/42661.html</url>
    <content><![CDATA[<p>学机器学习做点小笔记，都是Python的NumPy库的基本小操作，图书馆借的书看到的，怕自己还了书后忘了，就记下来。</p>
<p>一般习惯导入numpy时使用 <code>import numpy as np</code> ，不要直接import，会有命名空间冲突。比如numpy的array和python自带的array。</p>
<p>numpy下有两个可以做矩阵的东西，一个叫matrix，一个叫array。matrix指定是二维矩阵，array任意维度，所以matrix是array的分支，但是这个matrix和matlab的矩阵很像，操作也很像：</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import numpy as np</span><br><span class="line">&gt;&gt;&gt; a=np.mat('<span class="number">4</span> <span class="number">3</span>; <span class="number">2</span> <span class="number">1</span>')  # 使用字符串来初始化</span><br><span class="line">&gt;&gt;&gt; b=np.mat('<span class="number">1</span> <span class="number">2</span>; <span class="number">3</span> <span class="number">4</span>')</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">matrix([[<span class="number">4</span>, <span class="number">3</span>],</span><br><span class="line">        [<span class="number">2</span>, <span class="number">1</span>]])</span><br><span class="line">&gt;&gt;&gt; b</span><br><span class="line">matrix([[<span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">        [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line">&gt;&gt;&gt; a+b  # 对应位置相加</span><br><span class="line">matrix([[<span class="number">5</span>, <span class="number">5</span>],</span><br><span class="line">        [<span class="number">5</span>, <span class="number">5</span>]])</span><br><span class="line">&gt;&gt;&gt; a*b  # 矩阵乘法，与matlab相同</span><br><span class="line">matrix([[<span class="number">13</span>, <span class="number">20</span>],</span><br><span class="line">        [ <span class="number">5</span>,  <span class="number">8</span>]])</span><br><span class="line">&gt;&gt;&gt; np.multiply(a,b)  # 对应位置乘法，相当于matlab的点乘 “.*”</span><br><span class="line">matrix([[<span class="number">4</span>, <span class="number">6</span>],</span><br><span class="line">        [<span class="number">6</span>, <span class="number">4</span>]])</span><br></pre></td></tr></table></figure>
<p>而重点讲讲np.array。</p>
<p>#np.array操作 ###首先是初始化与属性查看 <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="keyword">import</span> numpy as np</span><br><span class="line">&gt;&gt;&gt; np.arange(<span class="number">10</span>)  # 从零生成到<span class="number">10</span><span class="number">-1</span>的一维矩阵</span><br><span class="line"><span class="built_in">array</span>([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line">&gt;&gt;&gt; a=np.<span class="built_in">array</span>([<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])  # 因为支持多维，所以用数组来初始化</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line"><span class="built_in">array</span>([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line">&gt;&gt;&gt; a.ndim  # 查看维度</span><br><span class="line"><span class="number">1</span></span><br><span class="line">&gt;&gt;&gt; a.shape  # 查看矩阵形状尺寸</span><br><span class="line">(<span class="number">6</span>,)</span><br><span class="line">&gt;&gt;&gt; a.dtype  # 查看类型</span><br><span class="line">dtype(<span class="string">'int32'</span>)</span><br></pre></td></tr></table></figure></p>
<p>###reshape改变矩阵形状，可以改变维度，但是reshape后的数据还是共享原来那一份数据 <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; b=a.reshape(<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">&gt;&gt;&gt; b</span><br><span class="line"><span class="built_in">array</span>([[<span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">4</span>, <span class="number">5</span>]])</span><br><span class="line">&gt;&gt;&gt; b.ndim</span><br><span class="line"><span class="number">2</span></span><br><span class="line">&gt;&gt;&gt; b.shape</span><br><span class="line">(<span class="number">3</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; b[<span class="number">1</span>][<span class="number">0</span>]=<span class="number">77</span></span><br><span class="line">&gt;&gt;&gt; b</span><br><span class="line"><span class="built_in">array</span>([[ <span class="number">0</span>,  <span class="number">1</span>],</span><br><span class="line">       [<span class="number">77</span>,  <span class="number">3</span>],</span><br><span class="line">       [ <span class="number">4</span>,  <span class="number">5</span>]])</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line"><span class="built_in">array</span>([ <span class="number">0</span>,  <span class="number">1</span>, <span class="number">77</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">5</span>])  # 可见b和a其实用的同一个数据</span><br></pre></td></tr></table></figure></p>
<p>###因而要产生的新矩阵不再关联，要使用copy()： <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; c=a.reshape(<span class="number">3</span>,<span class="number">2</span>).copy()</span><br><span class="line">&gt;&gt;&gt; c</span><br><span class="line"><span class="built_in">array</span>([[ <span class="number">0</span>,  <span class="number">1</span>],</span><br><span class="line">       [<span class="number">77</span>,  <span class="number">3</span>],</span><br><span class="line">       [ <span class="number">4</span>,  <span class="number">5</span>]])</span><br><span class="line">&gt;&gt;&gt; c[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">233</span></span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line"><span class="built_in">array</span>([ <span class="number">0</span>,  <span class="number">1</span>, <span class="number">77</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">5</span>])</span><br><span class="line">&gt;&gt;&gt; c</span><br><span class="line"><span class="built_in">array</span>([[<span class="number">233</span>,   <span class="number">1</span>],</span><br><span class="line">       [ <span class="number">77</span>,   <span class="number">3</span>],</span><br><span class="line">       [  <span class="number">4</span>,   <span class="number">5</span>]])</span><br></pre></td></tr></table></figure></p>
<p>###array的运算： <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; d=np.<span class="built_in">array</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])  # 一维矩阵运算</span><br><span class="line">&gt;&gt;&gt; d.T  # 转置矩阵</span><br><span class="line"><span class="built_in">array</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line">&gt;&gt;&gt; d*<span class="number">2</span>  # 每个数据乘以<span class="number">2</span></span><br><span class="line"><span class="built_in">array</span>([ <span class="number">2</span>,  <span class="number">4</span>,  <span class="number">6</span>,  <span class="number">8</span>, <span class="number">10</span>])</span><br><span class="line">&gt;&gt;&gt; d**<span class="number">2</span>  # 每个数据二次方</span><br><span class="line"><span class="built_in">array</span>([ <span class="number">1</span>,  <span class="number">4</span>,  <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>])</span><br><span class="line">&gt;&gt;&gt; d*d   # 按位置乘，与“d**<span class="number">2</span>”等效，和mat正好相反</span><br><span class="line"><span class="built_in">array</span>([ <span class="number">1</span>,  <span class="number">4</span>,  <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>])</span><br><span class="line">&gt;&gt;&gt; d.dot(d)  # 矩阵乘法，和mat相反</span><br><span class="line"><span class="number">55</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; x=np.<span class="built_in">array</span>([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>],[<span class="number">5</span>,<span class="number">6</span>]])  # 二维矩阵运算</span><br><span class="line">&gt;&gt;&gt; y=np.<span class="built_in">array</span>([[<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>],[<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]])</span><br><span class="line">&gt;&gt;&gt; x</span><br><span class="line"><span class="built_in">array</span>([[<span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">       [<span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">       [<span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line">&gt;&gt;&gt; y</span><br><span class="line"><span class="built_in">array</span>([[<span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>],</span><br><span class="line">       [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; x.dot(y)  # 二维矩阵矩阵乘法</span><br><span class="line"><span class="built_in">array</span>([[<span class="number">12</span>,  <span class="number">9</span>,  <span class="number">6</span>],</span><br><span class="line">       [<span class="number">30</span>, <span class="number">23</span>, <span class="number">16</span>],</span><br><span class="line">       [<span class="number">48</span>, <span class="number">37</span>, <span class="number">26</span>]])</span><br><span class="line">&gt;&gt;&gt; x= x.reshape(<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">&gt;&gt;&gt; x</span><br><span class="line"><span class="built_in">array</span>([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line">&gt;&gt;&gt; x*y  # 按位置乘，要求两个矩阵shape相同</span><br><span class="line"><span class="built_in">array</span>([[ <span class="number">6</span>, <span class="number">10</span>, <span class="number">12</span>],</span><br><span class="line">       [<span class="number">12</span>, <span class="number">10</span>,  <span class="number">6</span>]])</span><br><span class="line">&gt;&gt;&gt; x.T  # 二维矩阵的转置矩阵</span><br><span class="line"><span class="built_in">array</span>([[<span class="number">1</span>, <span class="number">4</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">5</span>],</span><br><span class="line">       [<span class="number">3</span>, <span class="number">6</span>]])</span><br><span class="line">&gt;&gt;&gt; x.mean()  # 求平均值</span><br><span class="line"><span class="number">3.5</span></span><br></pre></td></tr></table></figure></p>
<p>###关于下标的运算：（这些挺有意思的） <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; a=np.<span class="built_in">array</span>([<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">233</span>,<span class="number">9</span>])</span><br><span class="line">&gt;&gt;&gt; a[np.<span class="built_in">array</span>([<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>])]  # 列出对应下标的数值</span><br><span class="line"><span class="built_in">array</span>([  <span class="number">3</span>,   <span class="number">9</span>, <span class="number">233</span>])</span><br><span class="line">&gt;&gt;&gt; a&gt;<span class="number">4</span></span><br><span class="line"><span class="built_in">array</span>([ True, False, False,  True,  True], dtype=<span class="built_in">bool</span>)</span><br><span class="line">&gt;&gt;&gt; a[a&gt;<span class="number">4</span>]</span><br><span class="line"><span class="built_in">array</span>([  <span class="number">5</span>, <span class="number">233</span>,   <span class="number">9</span>])</span><br><span class="line">&gt;&gt;&gt; a[a&gt;<span class="number">8</span>]=<span class="number">8</span></span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line"><span class="built_in">array</span>([<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">8</span>])</span><br><span class="line">&gt;&gt;&gt; a.clip(<span class="number">4</span>,<span class="number">5</span>)  # 限定所有数据范围</span><br><span class="line"><span class="built_in">array</span>([<span class="number">5</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>])</span><br></pre></td></tr></table></figure></p>
<p>###还有一个关于nan的 <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; a=np.<span class="built_in">array</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line"><span class="built_in">array</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line">&gt;&gt;&gt; b=np.<span class="built_in">array</span>([<span class="number">1</span>,<span class="number">2</span>,np.NAN,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">&gt;&gt;&gt; b</span><br><span class="line"><span class="built_in">array</span>([  <span class="number">1.</span>,   <span class="number">2.</span>,  nan,   <span class="number">3.</span>,   <span class="number">4.</span>])  # 和a不同，虽然只改了一个nan，b每个数据后面有个“.”，说明变成<span class="built_in">float</span>型了，说明nan其实是个<span class="built_in">float</span></span><br><span class="line">&gt;&gt;&gt; np.isnan(b)</span><br><span class="line"><span class="built_in">array</span>([False, False,  True, False, False], dtype=<span class="built_in">bool</span>)</span><br><span class="line">&gt;&gt;&gt; b[~np.isnan(b)]</span><br><span class="line"><span class="built_in">array</span>([ <span class="number">1.</span>,  <span class="number">2.</span>,  <span class="number">3.</span>,  <span class="number">4.</span>])</span><br></pre></td></tr></table></figure></p>
<p>#与系统自带array的差异</p>
<p>###array的乘法 <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]*<span class="number">2</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">&gt;&gt;&gt; [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]**<span class="number">2</span></span><br><span class="line">(报错)</span><br></pre></td></tr></table></figure></p>
<p>###运行时间 对array和np.array进行按元素平方并求和的运算，运算3000次统计时间。 <figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; timeit.timeit(<span class="string">'sum(x*x for x in range(1000))'</span>,number=<span class="number">3000</span>)</span><br><span class="line"><span class="number">0</span>.<span class="number">31559807779291305</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; timeit.timeit(<span class="string">'sum(na*na)'</span>, setup=<span class="string">'import numpy as np; na=np.arange(1000)'</span>,number=<span class="number">3000</span>)</span><br><span class="line"><span class="number">0</span>.<span class="number">37785958035067324</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; timeit.timeit(<span class="string">'na.dot(na)'</span>, setup=<span class="string">'import numpy as np; na=np.arange(1000)'</span>,number=<span class="number">3000</span>)</span><br><span class="line"><span class="number">0</span>.<span class="number">006</span>9067372806728144</span><br></pre></td></tr></table></figure> 惊奇的发现系统级的array求和比np.array还快，说明np.array单个数据的访问还是比array较慢。但是用了矩阵乘法后，虽然效果一样，但这个速度就飞起来了。</p>
]]></content>
      <tags>
        <tag>Numpy</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 6-9UVa127 - Accordian Patience</title>
    <url>/posts/61171.html</url>
    <content><![CDATA[<p>题意：52张牌排一行，一旦出现任何一张牌与它左边的第一张或第三张“匹配”，即花色或点数相同，则须立即将其移动到那张牌上面，将其覆盖。能执行以上移动的只有压在最上面的牌。直到最后没有牌能向左移动。 注意细则：如果同时有多张牌都可以移动，你应该采取的策略是移动最左边可移动的牌。当一张牌既可以移动到左边第一张，又可以移动到左边第三张时，应移动到左边第三张上面。</p>
<hr>
<p>代码：（Accepted，0.100s） <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa127 - "Accordian" Patience</span></span><br><span class="line"><span class="comment">//Accepted 0.100s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NUM 52</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BIAS 1</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">card</span> &#123;</span></span><br><span class="line">	<span class="keyword">char</span> a, b;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> ==(card&amp; that) &#123;</span><br><span class="line">		<span class="keyword">return</span> a == that.a || b == that.b;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">stack</span> &#123;</span></span><br><span class="line">	card st[NUM + <span class="number">2</span>], *p;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">ini</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		p = st + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">card&amp; <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (p != st) <span class="keyword">return</span> *(p--);</span><br><span class="line">		<span class="keyword">return</span> *p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">card&amp; <span class="title">top</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> *p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(card&amp; c)</span> </span>&#123;</span><br><span class="line">		*++p = c;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> p - st;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">empty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> p == st;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;cards[NUM + <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">list</span> &#123;</span></span><br><span class="line">	<span class="built_in">stack</span> *ls[NUM + <span class="number">2</span>];</span><br><span class="line">	<span class="built_in">list</span>() &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; NUM + <span class="number">1</span>;++i)</span><br><span class="line">			ls[i] = cards + i;</span><br><span class="line">		ls[NUM + <span class="number">1</span>] = <span class="literal">nullptr</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">erease</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">while</span> (ls[n] != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">			ls[n] = ls[n + <span class="number">1</span>];</span><br><span class="line">			++n;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">stack</span>&amp; <span class="keyword">operator</span> [](<span class="keyword">int</span> i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (i &gt;= <span class="number">0</span>) <span class="keyword">return</span> *ls[i];</span><br><span class="line">		<span class="keyword">return</span> *ls[<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 129)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	cards[<span class="number">0</span>].st[<span class="number">1</span>].a = cards[<span class="number">0</span>].st[<span class="number">1</span>].b = <span class="string">'X'</span>;			<span class="comment">// 第0个stack的top里储存一个没用的card，使得没有一张卡片与之相等，以方便以后处理前两张左边没牌的牌；</span></span><br><span class="line">	<span class="keyword">while</span> ((cards[<span class="number">1</span>].st[<span class="number">1</span>].a = getchar()) != <span class="string">'#'</span>) &#123;</span><br><span class="line">		cards[<span class="number">1</span>].st[<span class="number">1</span>].b = getchar();</span><br><span class="line">		getchar();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; NUM + <span class="number">3</span>;++i) cards[i].ini();	<span class="comment">// 每个stack里将都只有一张卡片，这个ini就是把top的指针指向1</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">2</span>);i &lt; NUM + <span class="number">1</span>;++i) &#123;				<span class="comment">// 数据全部直接作为top读取到stack里面</span></span><br><span class="line">			cards[i].top().a = getchar();</span><br><span class="line">			cards[i].top().b = getchar();</span><br><span class="line">			getchar();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">list</span> pile;										<span class="comment">//处理部分，直接模拟，懒得另写函数了</span></span><br><span class="line">		<span class="keyword">int</span> num;</span><br><span class="line">		<span class="keyword">for</span> (num = <span class="number">2</span>;&amp;pile[num];) &#123;						<span class="comment">// num从2开始，毕竟第一个数据怎么样也移动不了（接下来num再跳回1就懒得管他了）</span></span><br><span class="line">			<span class="keyword">if</span> (pile[num].top() == pile[num - <span class="number">3</span>].top()) &#123;</span><br><span class="line">				pile[num - <span class="number">3</span>].push(pile[num].pop());</span><br><span class="line">				<span class="keyword">if</span> (pile[num].empty()) pile.erease(num);</span><br><span class="line">				num -= <span class="number">3</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (pile[num].top() == pile[num - <span class="number">1</span>].top()) &#123;</span><br><span class="line">				pile[num - <span class="number">1</span>].push(pile[num].pop());</span><br><span class="line">				<span class="keyword">if</span> (pile[num].empty()) pile.erease(num);</span><br><span class="line">				--num;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> ++num;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d pile"</span>, num - <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">if</span> (num != <span class="number">2</span>) <span class="built_in">printf</span>(<span class="string">"s"</span>);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">" remaining:"</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">1</span>);i &lt; num;++i) <span class="built_in">printf</span>(<span class="string">" %d"</span>, pile[i].size());</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>分析：差不多又是一遍过，而且只用了0.1s，竟然挤进了UVa本题Ranking的前20，虽然题目确实很简单就是了，还是开心的不行。 我的思路是安放52个栈，直接进行模拟操作。从第二张牌开始（毕竟第一张牌不可能向左移动）往下判断，直到到达末尾。 具体流程是，若当前牌可以左移，移之，并且下一个进行判断的牌还是它（因为左侧的都是已经完成的不可能再有可移动的牌了，所以无需重新从最左侧开始检索）；反之此牌没法动了，则判断下一张牌。 感觉这不能叫遍历，毕竟期间会向左移动牌，应该算是迭代吧。 要注意的是输出格式！如下图所示，</p>
<blockquote>
<p>6 piles remaining: 40 8 1 1 1 1 1 pile remaining: 52</p>
</blockquote>
<p>pile/piles的单复数问题。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 6-8UVa806 - Spatial Structures</title>
    <url>/posts/58091.html</url>
    <content><![CDATA[<p>题意：黑白图像的路径表示法</p>
<hr>
<p>代码：（Accepted，0.120s） <figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa806 - Spatial Structures</span></span><br><span class="line"><span class="comment">//Accepted 0.120s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, T(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">bool</span> Img[<span class="number">66</span>][<span class="number">66</span>];</span><br><span class="line">vector&lt;<span class="keyword">string</span>&gt; Sqns;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">unsigned</span> C5_10(<span class="keyword">const</span> <span class="keyword">string</span>&amp; five) &#123;<span class="comment">//五进制转十进制</span></span><br><span class="line">	<span class="keyword">unsigned</span> ans(<span class="number">0</span>), i(<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">auto</span> p(five.rbegin());p != five.rend();++p, i *= <span class="number">5</span>)</span><br><span class="line">		ans += (*p - <span class="number">48</span>) * i;</span><br><span class="line">	<span class="built_in">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">string</span> C10_5(<span class="keyword">unsigned</span> ten) &#123;<span class="comment">//十进制转五进制(倒序)</span></span><br><span class="line">	<span class="keyword">string</span> ans;</span><br><span class="line">	<span class="built_in">do</span> ans += <span class="keyword">char</span>(ten % <span class="number">5</span> + <span class="number">48</span>);</span><br><span class="line">	<span class="built_in">while</span> (ten /= <span class="number">5</span>);</span><br><span class="line">	<span class="built_in">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> DFS(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">string</span> f) &#123;</span><br><span class="line">	<span class="keyword">int</span> len = N / (<span class="keyword">int</span>)<span class="built_in">pow</span>(<span class="number">2</span>, f.length()) / <span class="number">2</span>;</span><br><span class="line">	<span class="built_in">if</span> (!len) &#123;</span><br><span class="line">		<span class="built_in">if</span> (Img[x][y]) &#123;</span><br><span class="line">			Sqns.push_back(f);</span><br><span class="line">			<span class="comment">//cerr &lt;&lt; "Debug: Sqns(" &lt;&lt; x &lt;&lt; ", " &lt;&lt; y &lt;&lt; ")  " &lt;&lt; f &lt;&lt; endl;//Debug</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">return</span> Img[x][y];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">bool</span> NW(DFS(x, y, <span class="string">'1'</span> + f));</span><br><span class="line">	<span class="keyword">bool</span> NE(DFS(x, y + len, <span class="string">'2'</span> + f));</span><br><span class="line">	<span class="keyword">bool</span> SW(DFS(x + len, y, <span class="string">'3'</span> + f));</span><br><span class="line">	<span class="keyword">bool</span> SE(DFS(x + len, y + len, <span class="string">'4'</span> + f));</span><br><span class="line">	<span class="keyword">bool</span> flag(NW&amp;&amp;NE&amp;&amp;SW&amp;&amp;SE);</span><br><span class="line">	<span class="built_in">if</span> (flag) &#123;</span><br><span class="line">		Sqns.pop_back(), Sqns.pop_back(), Sqns.pop_back(), Sqns.pop_back();</span><br><span class="line">		Sqns.push_back(f);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> Initialize() &#123;</span><br><span class="line">	Sqns.<span class="built_in">clear</span>();</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; N;++i) <span class="built_in">for</span> (<span class="keyword">int</span> j(<span class="number">0</span>);j &lt;= N;++j)</span><br><span class="line">		Img[i][j] = false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> SolvePlus() &#123;</span><br><span class="line">	Initialize();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Input</span></span><br><span class="line">	<span class="keyword">char</span> n;</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; N;++i) <span class="built_in">for</span> (<span class="keyword">int</span> j(<span class="number">0</span>);j &lt; N;++j)</span><br><span class="line">		cin &gt;&gt; n, Img[i][j] = n - <span class="number">48</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Solve</span></span><br><span class="line">	DFS(<span class="number">0</span>, <span class="number">0</span>, <span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Output</span></span><br><span class="line">	<span class="built_in">if</span> (Sqns.<span class="built_in">size</span>()) &#123;</span><br><span class="line">		sort(Sqns.<span class="built_in">begin</span>(), Sqns.<span class="built_in">end</span>(), [](<span class="keyword">string</span>&amp; a, <span class="keyword">string</span>&amp; b)-&gt;<span class="keyword">bool</span> &#123;</span><br><span class="line">			<span class="built_in">if</span> (a.length() != b.length()) <span class="built_in">return</span> a.length() &lt; b.length();</span><br><span class="line">			<span class="built_in">return</span> a &lt; b;</span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="keyword">auto</span> p(Sqns.<span class="built_in">begin</span>());</span><br><span class="line">		<span class="keyword">int</span> cnt(<span class="number">0</span>);</span><br><span class="line">		<span class="built_in">while</span> (p != Sqns.<span class="built_in">end</span>()) &#123;</span><br><span class="line">			<span class="built_in">if</span> (cnt == <span class="number">12</span>) cnt = <span class="number">0</span>, cout &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">			<span class="built_in">if</span> (cnt++) cout &lt;&lt; <span class="string">' '</span> &lt;&lt; C5_10(*p);</span><br><span class="line">			<span class="built_in">else</span> cout &lt;&lt; C5_10(*p);</span><br><span class="line">			++p;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; <span class="string">"Total number of black nodes = "</span> &lt;&lt; Sqns.<span class="built_in">size</span>() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> SolveMinus() &#123;</span><br><span class="line">	N = -N;</span><br><span class="line">	Initialize();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Input</span></span><br><span class="line">	<span class="keyword">unsigned</span> n;</span><br><span class="line">	<span class="built_in">while</span> (cin &gt;&gt; n &amp;&amp; n != <span class="number">-1</span>)</span><br><span class="line">		Sqns.push_back(C10_5(n));</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Solve</span></span><br><span class="line">	<span class="built_in">if</span> (Sqns.empty());</span><br><span class="line">	<span class="built_in">else</span> <span class="built_in">if</span> (Sqns[<span class="number">0</span>] == <span class="string">"0"</span>) &#123;</span><br><span class="line">		<span class="built_in">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; N;++i) <span class="built_in">for</span> (<span class="keyword">int</span> j(<span class="number">0</span>);j &lt; N;++j)</span><br><span class="line">			Img[i][j] = true;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">else</span> &#123;</span><br><span class="line">		<span class="built_in">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; t : Sqns) &#123;</span><br><span class="line">			<span class="comment">//cerr &lt;&lt;"Debug1: "&lt;&lt; t &lt;&lt; endl;//</span></span><br><span class="line">			<span class="keyword">int</span> x(<span class="number">0</span>), y(<span class="number">0</span>), len(N);</span><br><span class="line">			<span class="built_in">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; c : t) &#123;</span><br><span class="line">				len /= <span class="number">2</span>;</span><br><span class="line">				<span class="built_in">switch</span> (c)</span><br><span class="line">				&#123;</span><br><span class="line">				<span class="built_in">case</span> <span class="string">'1'</span>: <span class="built_in">break</span>;</span><br><span class="line">				<span class="built_in">case</span> <span class="string">'2'</span>: y += len;<span class="built_in">break</span>;</span><br><span class="line">				<span class="built_in">case</span> <span class="string">'3'</span>: x += len;<span class="built_in">break</span>;</span><br><span class="line">				<span class="built_in">case</span> <span class="string">'4'</span>: x += len;y += len;<span class="built_in">break</span>;</span><br><span class="line">				<span class="built_in">default</span>:<span class="built_in">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//cerr &lt;&lt; "Debug2: ("&lt;&lt;x &lt;&lt; ", " &lt;&lt; y &lt;&lt;")  "&lt;&lt;len&lt;&lt; endl;//</span></span><br><span class="line">			<span class="built_in">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; len;++i)</span><br><span class="line">				<span class="built_in">for</span> (<span class="keyword">int</span> j(<span class="number">0</span>);j &lt; len;++j)</span><br><span class="line">					Img[x + i][y + j] = true;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Output</span></span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; N;++i) &#123;</span><br><span class="line">		<span class="built_in">for</span> (<span class="keyword">int</span> j(<span class="number">0</span>);j &lt; N;++j)</span><br><span class="line">			cout &lt;&lt; (Img[i][j] ? <span class="string">'*'</span> : <span class="string">'.'</span>);</span><br><span class="line">		cout &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 129)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, stdin);</span><br><span class="line">	freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, stdout);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	std::ios::sync_with_stdio(false);</span><br><span class="line">	<span class="built_in">while</span> (cin &gt;&gt; N &amp;&amp; N) &#123;</span><br><span class="line">		<span class="built_in">if</span> (T) cout &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		cout &lt;&lt; <span class="string">"Image "</span> &lt;&lt; ++T &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		<span class="built_in">if</span> (N &gt; <span class="number">0</span>) SolvePlus();</span><br><span class="line">		<span class="built_in">else</span> SolveMinus();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>分析：用的DFS来递归来着，题目倒是不难，直接跟着题意霸王硬上弓就行。但是大神们用10、20ms，我用了120ms。。。刚刚网上看了看好像思路也差不多。啊不管了，其实好久之前写的了，只是忘记发博客里了，我也有点忘了我怎么写的（记得当时写的时候有点昏昏沉沉）。 唉感觉自己越来越懒了，分析也不高兴写了。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>我的Linux入门之路 - 05.Eclipse的Python开发环境搭建与Numpy、Scipy库安装</title>
    <url>/posts/42706.html</url>
    <content><![CDATA[<p>#一、Python环境</p>
<p>直接终端查询下python安装没：<code>python --version</code></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Python <span class="number">2.7</span><span class="number">.12</span></span><br></pre></td></tr></table></figure>
<p>Ubuntu竟然已经装了Python2.7，那就好说了。不然自己装和装jdk差不多。本来想着要不要再装个3.4的，但是发现2.7也很常用，那就偷个懒了。</p>
<p>#二、安装PyDev</p>
<p>##1.在线安装</p>
<p>Elipse可以在线安装，又方便还方便而且方便。从http://pydev.org/updates 可以获得在线安装地址。在Help菜单中，选择Install New Software，点击Add，如图输入： <img src="/posts/42706/1.png" alt="这里写图片描述"></p>
<p>得到如下图内容，只选择PyDev for Eclipse即可（听说装多了反而有问题） <img src="/posts/42706/2.png" alt="这里写图片描述"></p>
<p>然后Next，发现进度条不动了。。。是的它访问不到。。。唉活在 土啬 里真累。怎么办呢？Ubuntu的全局代理总是不行，好在Eclipse自带网络设置，那就曲线救国一下。</p>
<p>##2.Eclipse网络设置</p>
<p>在Window菜单中选择最后一个Preference，选择General - Network Connections，面板中的Active Provider选择Manual并配置SOCKS地址与端口。 <img src="/posts/42706/3.png" alt="这里写图片描述"></p>
<p>然后重新在线安装就行啦！下载速度快的不行！</p>
<p>##3.开启Cython加速</p>
<p>随便写个hello world，可以运行但是提示一个warning： <figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">warning</span>: Debugger speedups <span class="keyword">using</span> cython <span class="keyword">not</span> <span class="built_in">found</span>. Run <span class="string">'"/usr/bin/python" "/home/xienaoban/.eclipse/org.eclipse.platform_4.7.0_1966938284_linux_gtk_x86_64/plugins/org.python.pydev_5.5.0.201701191708/pysrc/setup_cython.py" build_ext --inplace'</span> <span class="keyword">to</span> build.</span><br><span class="line">pydev debugger: starting (pid: <span class="number">8716</span>)</span><br></pre></td></tr></table></figure></p>
<p>就根据他给你的要求，打开终端输入</p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line"><span class="string">"/usr/bin/python"</span> <span class="string">"/home/xienaoban/.eclipse/org.eclipse.platform_4.7.0_1966938284_linux_gtk_x86_64/plugins/org.python.pydev_5.5.0.201701191708/pysrc/setup_cython.py"</span> build_ext <span class="comment">--inplace</span></span><br></pre></td></tr></table></figure>
<p>即可。然后再运行warning就没了。</p>
<p>#三、安装Numpy、Scipy库</p>
<p><a href="https://pypi.python.org/pypi/numpy" target="_blank" rel="noopener">Numpy官网</a> <a href="https://pypi.python.org/pypi/numpy" target="_blank" rel="noopener">Scipy官网</a></p>
<p>f发现库文件全都是whl格式的，需要使用python的pip进行安装。 pip的使用格式为：pip install xxx.whl 。尽量使用sudo吧，不然访问不了/usr会安装失败。 我下载了一个numpy，安装时提示 <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">numpy<span class="number">-1.12</span><span class="number">.0</span>-cp27-cp27m-manylinux1_x86_64.whl <span class="keyword">is</span> <span class="keyword">not</span> a supported wheel on <span class="keyword">this</span> platform.</span><br></pre></td></tr></table></figure></p>
<p>说明下错了版本。那么我怎么知道你支持哪个版本呢？打开python，写如下程序段： <figure class="highlight elm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pip</span><br><span class="line"><span class="title">print</span>(pip.pep425tags.get_supported())</span><br></pre></td></tr></table></figure></p>
<p>然后执行，我的结果如下： <figure class="highlight scheme"><table><tr><td class="code"><pre><span class="line">[(<span class="symbol">'cp27</span>', <span class="symbol">'cp27mu</span>', <span class="symbol">'manylinux1_x86_64</span>'), (<span class="symbol">'cp27</span>', <span class="symbol">'cp27mu</span>', <span class="symbol">'linux_x86_64</span>'), (<span class="symbol">'cp27</span>', <span class="symbol">'none</span>', <span class="symbol">'manylinux1_x86_64</span>'), (<span class="symbol">'cp27</span>', <span class="symbol">'none</span>', <span class="symbol">'linux_x86_64</span>'), (<span class="symbol">'py2</span>', <span class="symbol">'none</span>', <span class="symbol">'manylinux1_x86_64</span>'), (<span class="symbol">'py2</span>', <span class="symbol">'none</span>', <span class="symbol">'linux_x86_64</span>'), (<span class="symbol">'cp27</span>', <span class="symbol">'none</span>', <span class="symbol">'any</span>'), (<span class="symbol">'cp2</span>', <span class="symbol">'none</span>', <span class="symbol">'any</span>'), (<span class="symbol">'py27</span>', <span class="symbol">'none</span>', <span class="symbol">'any</span>'), (<span class="symbol">'py2</span>', <span class="symbol">'none</span>', <span class="symbol">'any</span>'), (<span class="symbol">'py26</span>', <span class="symbol">'none</span>', <span class="symbol">'any</span>'), (<span class="symbol">'py25</span>', <span class="symbol">'none</span>', <span class="symbol">'any</span>'), (<span class="symbol">'py24</span>', <span class="symbol">'none</span>', <span class="symbol">'any</span>'), (<span class="symbol">'py23</span>', <span class="symbol">'none</span>', <span class="symbol">'any</span>'), (<span class="symbol">'py22</span>', <span class="symbol">'none</span>', <span class="symbol">'any</span>'), (<span class="symbol">'py21</span>', <span class="symbol">'none</span>', <span class="symbol">'any</span>'), (<span class="symbol">'py20</span>', <span class="symbol">'none</span>', <span class="symbol">'any</span>')]</span><br></pre></td></tr></table></figure></p>
<p>于是就知道应该下载哪个版本了。</p>
<p>安装成功： <img src="/posts/42706/4.png" alt="这里写图片描述"></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
        <tag>Eclipse</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>我的Linux入门之路 - 04.Eclipse安装</title>
    <url>/posts/54802.html</url>
    <content><![CDATA[<p>首先，要安装ecliose自然是先要有Java环境。在上一篇已经安装好了，不再赘述。</p>
<p>#一、下载#</p>
<p><a href="https://www.eclipse.org/downloads/download.php?file=/oomph/epp/neon/R2a/eclipse-inst-linux64.tar.gz" target="_blank" rel="noopener">Eclipse官网</a> 下载下来的文件“：eclipse-inst-linux64.tar.gz 。</p>
<p>#二、安装#</p>
<p>这次和上次不同，jdk解压即用，而双击打开此压缩包，发现里面有<code>eclipse-inst</code> 文件，说明自带安装程序，那就像windows下装软件一样好办了，把整个包解压缩出来随便放个目录，并且终端cd到该目录。执行<code>sudo ./eclipse-inst</code> 打开安装文件，发现了熟悉的界面： <img src="/posts/54802/1.png" alt="这里写图片描述"></p>
<p>##1）不好的安装方法一与其症状##</p>
<p>使用sudo运行它，很大条的该选安装目录选安装目录，该点I agree点I agree，该点下一步点下一步。 然后安装完最后一个页面，这个installer提醒你说我们启动一次看看成功没？你说吼哇吼哇，launch按一下，耶真的打开了，好轻松！于是满意地关掉了。然后过两天再想打开它，直接用ubuntu自带的“文件”定位到它的目录并双击eclipse，报错说定位不到相关的什么什么。然后我就执行<code>/usr/local/bin/ide/eclipse/eclipse</code> （这是我的安装目录），终端显示说什么大意就是说/etc下的一个文件打不开。我就知道哦权限不够，sudo一下。但是这样的话每次都要sudo明显烦人。而且这导致我在后面创建软件快捷方式时也总是“程序什么什么出现错误”，八成也是没权限导致的。不(bu)能(hui)做快捷方式、每次都要终端sudo输密码打开，太烦了。</p>
<p>##2）不好的安装方法二与其症状##</p>
<p>既然它会在etc目录下生成东西，那我安装时不给他sudo呢？结果发现安装目录只能被限定在/home里面了。不不不，这不好，强迫症一定要分门别类。</p>
<p>##3）正确的安装方法##</p>
<p>看到installer右上角的汉堡菜单没，点击它，把BUNDLE POOLS关掉。这个BUNDLE POOLS是共享插件用的，还能使eclipse启动变快什么什么的，但是它要权限啊，我这linux也就我一人使，关了。 <img src="/posts/54802/2.png" alt="这里写图片描述"> 然后该怎么做怎么做。</p>
<p>#三、创建快捷方式#</p>
<p>Linux下创建个快捷方式都那么烦...其实步骤本身很简单，会了之后也感觉没啥，但是自己一开始做的时候失败了多少次。Ubuntu安装的软件都能在Dash里面看到，但是Eclipse没有注册自己（就像它在Win下也是个绿色软件一样），所以要自己添加快捷方式到Dash，（直接在桌面上创建个快捷方式也可以，但这样在Dash里将找不到，其实你在哪里创建快捷方式也无所谓啦）。定位到存放Dash应用快捷方式的位置并创建Eclipse快捷方式并打开编辑它： <figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">sudo gedit <span class="regexp">/usr/</span>share<span class="regexp">/applications/</span>Eclipse.desktop</span><br></pre></td></tr></table></figure></p>
<p>输入以下内容： <figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[Desktop Entry]</span></span><br><span class="line"><span class="attr">Encoding</span>=UTF-<span class="number">8</span></span><br><span class="line"><span class="attr">Name</span>=Eclipse</span><br><span class="line"><span class="attr">Comment</span>=Eclipse IDE</span><br><span class="line"><span class="attr">Exec</span>=/usr/local/bin/ide/eclipse/eclipse</span><br><span class="line"><span class="attr">Icon</span>=/usr/local/bin/ide/eclipse/icon.xpm</span><br><span class="line"><span class="attr">Terminal</span>=<span class="literal">false</span></span><br><span class="line"><span class="attr">StartupNotify</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">Type</span>=Application</span><br><span class="line"><span class="attr">Categories</span>=Application;Development;</span><br></pre></td></tr></table></figure></p>
<p>（网上乱七八糟的教程害死人啊。。。第一次做快捷方式，粘贴的别人代码，他<code>[Desktop Entry]</code> 两个单词中间没有加空格！导致系统一直识别不了为真正的快捷方式） 其他不用改，就改Exec和Icon路径即可。里面什么内容也不难看懂。不出意外此时你就能在Dash里面搜索到它了。然后把它拖到任务栏就好。</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
        <tag>Eclipse</tag>
      </tags>
  </entry>
  <entry>
    <title>我的Linux入门之路 - 03.Java环境搭建</title>
    <url>/posts/58851.html</url>
    <content><![CDATA[<p>其实ubuntu是自带一个叫openJDK的东西的，是谷歌看Oracle不爽而搞的。不过呢。。。总感觉不太习惯，况且我既然都来Linux了，总是想折腾一把的。 首先先检查下有没有安装java。终端输入<code>java -version</code>，若出现以下字段则说明未安装。 <figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">The program ‘<span class="keyword">java’ </span>can <span class="keyword">be </span>found in the following packages:</span><br><span class="line">* default-<span class="keyword">jre</span></span><br><span class="line"><span class="keyword">* </span>gcj-4.<span class="number">6</span>-<span class="keyword">jre-headless</span></span><br><span class="line"><span class="keyword">* </span>openjdk-6-<span class="keyword">jre-headless</span></span><br><span class="line"><span class="keyword">* </span>gcj-4.<span class="number">5</span>-<span class="keyword">jre-headless</span></span><br><span class="line"><span class="keyword">* </span>openjdk-7-<span class="keyword">jre-headless</span></span><br><span class="line"><span class="keyword">Try: </span>sudo apt-get <span class="keyword">install</span></span><br></pre></td></tr></table></figure></p>
<p>#一、下载#</p>
<p><a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">Java SE Development Kit 8 官网</a> 选择对应系统的jdk下载。会发现有rpm和tar.gz两种格式。ubuntu不支持rpm所以下载tar.gz版本。（要安装rpm的包，则要先用alien把rpm转换成deb，这里我用的tar.gz，就讲这个）。 比如我下载在了默认的Downloads文件夹，即/home/xienaoban/Downloads/目录。名字叫jdk-8u121-linux-x64.tar.gz。</p>
<p>#二、解压#</p>
<p>tar是个打包格式，gz即gzip是种压缩格式。那要安装它就要先解压。先用文件（Files）双击打开这个包看看，没有找到什么setup、install字样的文件，说明是解压即用的那种类型。（如果有install什么的文件就更方便了，就像win下面安装软件的exe一样，或者也可能是个sh脚本） 首先想一个安装路径，路径随意，自己喜欢就好。我选择了/usr/local/lib/java/路径。 系统本身没有java文件夹，所以要先创建个。首先打开终端： <figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line">sudo mkdir /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">java</span></span></span><br></pre></td></tr></table></figure> 以创建java文件夹（若你选择的路径无需创建则跳过该步骤）；</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cd</span> ~<span class="string">/Downloads/</span></span><br></pre></td></tr></table></figure>
<p>定位到jdk下载的目录。“～”相当于“/home/xienaoban”；</p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line">sudo tar -zxvf eclipse-inst-linux64.tar.gz -C /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">java</span></span></span><br></pre></td></tr></table></figure>
<p>意思是使用管理员权限，使用tar命令的zxvf操作将jdk安装包解压到安装路径。-zxvf中，-z是配合解压.GZ的 ，-x是解开一个包文件，-v显示详细信息，-f是必须的，表示使用归档文件，合并起来意思也很明显了。-C dir参数的作用在于改变工作目录，即改变了解压的路径。</p>
<p>于是就解压好了。可以用<code>ls -l /usr/local/lib/java</code> 查看目录下是否有jdk1.8.0_121目录。（ls：list，列出目录内的文件夹与子目录，-l：显示详细信息），没错的话会找到以下这条（当然时间什么的信息会不同）： <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">drwxr-xr-x <span class="number">8</span> uucp <span class="number">143</span> <span class="number">4096</span> <span class="number">12</span>月 <span class="number">13</span> <span class="number">08</span>:<span class="number">50</span> jdk1<span class="number">.8</span><span class="number">.0</span>_121</span><br></pre></td></tr></table></figure></p>
<p>#三、配置环境变量#</p>
<p>##1.修改bashrc或profile文件##</p>
<p>方法有两个，一个是编辑<code>~/.bashrc</code>文件，一个是编辑<code>/etc/profile</code>文件。两者效果一样！网上针对两者的教程都有，任选其一即可！所以一开始搞得我一脸懵逼。我选择了编辑profile文件。 <code>sudo gedit /etc/profile</code> ， 用gedit打开profile文件并编辑（用其他文本编辑器如vim也随意），在文末添加如下代码： <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/usr/local/lib/java/jdk1.8.0_121</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JRE_HOME</span>=<span class="variable">$JAVA_HOME</span>/jre</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CLASSPATH</span>=.:$JAVA_HOME/lib:$JRE_HOME/lib</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$JAVA_HOME</span>/bin:$PATH</span><br></pre></td></tr></table></figure></p>
<p>当然，路径如果和我的不一样的话改成自己的安装路径。其实只要改JAVA_HOME就行。网上看到有人四个变量全用的绝对路径，这不好，尽量不要用硬编码，改起来也麻烦。注意CLASSPATH后面是“.:”，我没有写错。</p>
<p>##2.设置默认JDK 版本##</p>
<p>然后再执行以下五句<code>update-alternatives</code>以设置系统默认JDK 版本（记得修改自己的目录）： <figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line"><span class="comment"># java和javac必须配置</span></span><br><span class="line">sudo update-alternatives --install /usr/bin/java java /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">java</span>/<span class="title">jdk1</span>.8.0<span class="title">_121</span>/<span class="title">bin</span>/<span class="title">java</span> 300  </span></span><br><span class="line">sudo update-alternatives --install /usr/bin/javac javac /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">java</span>/<span class="title">jdk1</span>.8.0<span class="title">_121</span>/<span class="title">bin</span>/<span class="title">javac</span> 300</span></span><br><span class="line"><span class="comment"># 以下可以不配置</span></span><br><span class="line">sudo update-alternatives --install /usr/bin/jar jar /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">java</span>/<span class="title">jdk1</span>.8.0<span class="title">_121</span>/<span class="title">bin</span>/<span class="title">jar</span> 300   </span></span><br><span class="line">sudo update-alternatives --install /usr/bin/javah javah /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">java</span>/<span class="title">jdk1</span>.8.0<span class="title">_121</span>/<span class="title">bin</span>/<span class="title">javah</span> 300   </span></span><br><span class="line">sudo update-alternatives --install /usr/bin/javap javap /usr/local/<span class="class"><span class="keyword">lib</span>/<span class="title">java</span>/<span class="title">jdk1</span>.8.0<span class="title">_121</span>/<span class="title">bin</span>/<span class="title">javap</span> 300</span></span><br></pre></td></tr></table></figure></p>
<p>其中：每个指令最后的参数300代表着优先级，我看也有教程选择50的。还有java和javac是必须配置的，后面的几条，看到别人的说法是“如果你无聊,也可以把javah等等也给配置上”。。。所以你会发现不同的教程update-alternatives的数量还不一样。这里一并说明下。 <a href="http://www.cnblogs.com/loca/p/4679110.html" target="_blank" rel="noopener">参考链接</a></p>
<p>##3.更新config##</p>
<p>最后再执行<code>sudo update-alternatives --config java</code> 与<code>sudo update-alternatives --config javac</code>更新config，当然如果是第一次安装会提示 <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">There is only one alternative <span class="keyword">in</span> link<span class="built_in"> group </span>java (providing /usr/bin/java): /usr/local/lib/java/jdk1.8.0_121/bin/java</span><br><span class="line"><span class="literal">Nothing</span> <span class="keyword">to</span> configure.</span><br></pre></td></tr></table></figure> 那就不用管了，否则选择你要的版本。</p>
<p>##4.配置系统环境变量（可不做）##</p>
<p>看到有教程还要“配置系统环境变量”，即在<code>/etc/environment</code> 文件的 末尾添加 <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="attribute">PATH</span>=<span class="string">"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:<span class="variable">$JAVA_HOME</span>/bin"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CLASSPATH</span>=.:$JAVA_HOME/lib:$JAVA_HOME/jre/lib</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/usr/java/jdk</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JRE_HOME</span>=<span class="variable">$&#123;JAVA_HOME&#125;</span>/jre</span><br></pre></td></tr></table></figure> 但是也有很多教程没有做这一项，我也没做。查了一下区别就是这个步骤是针对整个系统的，而更改profile是针对所有用户的（看上去不一样但实际结果上没啥区别）。所以这个步骤不执行也没有问题。</p>
<blockquote>
<p>etc/profile: 此文件为系统的每个用户设置环境信息。当用户登录时，该文件被执行一次，并从 /etc/profile.d 目录的配置文件中搜集shell 的设置。一般用于设置所有用户使用的全局变量。 /etc/bashrc: 当 bash shell 被打开时，该文件被读取。也就是说，每次新打开一个终端 shell，该文件就会被读取。 ~/.bash_profile 或 ~/.profile: 只对单个用户生效，当用户登录时该文件仅执行一次。用户可使用该文件添加自己使用的 shell 变量信息。另外在不同的LINUX操作系统下，这个文件可能是不同的，可能是 ~/.bash_profile， ~/.bash_login 或 ~/.profile 其中的一种或几种，如果存在几种的话，那么执行的顺序便是：~/.bash_profile、 ~/.bash_login、 ~/.profile。比如 Ubuntu 系统一般是 ~/.profile 文件。 ~/.bashrc: 只对单个用户生效，当登录以及每次打开新的 shell 时，该文件被读取。 此外，修改 /etc/environment 这个文件也能实现环境变量的设置。/etc/environment 设置的也是全局变量，从文件本身的作用上来说， /etc/environment 设置的是整个系统的环境，而/etc/profile是设置所有用户的环境。有几点需注意： 系统先读取 etc/profile 再读取 /etc/environment（还是反过来？） /etc/environment 中不能包含命令，即直接通过 VAR=&quot;...&quot; 的方式设置，不使用 export 。 使用 source /etc/environment 可以使变量设置在当前窗口立即生效，需注销/重启之后，才能对每个新终端窗口都生效。</p>
</blockquote>
<p><a href="http://www.powerxing.com/linux-environment-variable/" target="_blank" rel="noopener">参考链接</a></p>
<p>#四、安装完成#</p>
<p>输入<code>java -version</code> 可以查看java有没有安装成功。若成功，会跳出以下文字： <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">java version <span class="string">"1.8.0_121"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_121-b13)</span><br><span class="line">Java HotSpot(TM) 64-Bit<span class="built_in"> Server </span>VM (build 25.121-b13, mixed mode)</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>我的Linux入门之路 - 02.Shadowsocks-Qt5配置</title>
    <url>/posts/41853.html</url>
    <content><![CDATA[<p>作为一个学习中的程序员，查wiki等，科学上网肯定是刚需。况且没有它很多东西都下不下来。我在windows环境下使用的是shadowsocks，那么在linux下也使用它。</p>
<p>#一、SS版本#</p>
<p>SS版本众多，而且自从你懂得之后又衍生出SSR。<a href="https://github.com/shadowsocks/shadowsocks/wiki/Ports-and-Clients#windows%20SS%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%90%84%E4%B8%AA%E7%89%88%E6%9C%AC" target="_blank" rel="noopener">SS全平台各个版本 - Github</a> ，<a href="https://github.com/breakwa11/shadowsocks-rss" target="_blank" rel="noopener">SSR各平台版本 - Github</a> 。</p>
<p>#二、安装#</p>
<p>这里我使用的是Qt5版本（<a href="https://github.com/shadowsocks/shadowsocks-qt5/wiki" target="_blank" rel="noopener">Github链接</a>）。毕竟是从win过渡过来的，一开始还是倾向GUI。 安装方法也异常简单，简单到我一开始不相信。（官方github上有安装文档。幸运的是，github可以直接访问）。三行代码即可解决，无需自己从github下载客户端。 首先打开终端（Ctrl+Alt+T） 然后分步运行以下三行命令。</p>
<figure class="highlight smali"><table><tr><td class="code"><pre><span class="line">sudo<span class="built_in"> add-apt-repository </span>ppa:hzwhuang/ss-qt5</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install shadowsocks-qt5</span><br></pre></td></tr></table></figure>
<p>注：sudo的意思是获得管理员权限，会要求你输入密码，即你的ubuntu登录密码。 它的提示如下面所示：<code>[sudo] password for xienaoban:</code> 需要注意的是在终端输入密码不会有任何显示，包括'*'都不会显示，新手要注意。</p>
<p>然后就安装完成了。从你的dash（左上角相当于win开始键的东西）上能找到他，拖到任务栏上创个快捷方式就好啦。打开后如下图（File菜单里有个import from gui-config.json，把你的文件导入就行了。比别的版本的ss好的是，它能导入多个服务器，而别的版本的ss的config文件貌似只能添加一个）： <img src="/posts/41853/20170129104109279.jpg" alt="这里写图片描述"></p>
<p>#三、配置全局代理（失败）#</p>
<p>Linux上与win不同，得自己从ss代理的接口转发出去。不像win那样一步到位，也不支持PAC。。。 根据网上各大教程，都是说打开系统设置，选择网络（Network）- 网络代理（Network proxy）。接下来有两种方法。 [法一] （实现全局代理）选择手动，sock5里如下填写： <img src="/posts/41853/20170129105059364.png" alt="这里写图片描述"></p>
<p>[法二] （实现PAC代理）选择自动，下载个pac文件（怎么合成或下载自己查吧）把你下载的文件的路径填进去。文件格式如图片（file:后面三个‘/’） <img src="/posts/41853/20170129105431610.png" alt="这里写图片描述"></p>
<p>然而我失败了，怎么设置浏览器都不能访问（明明步骤一样，好气呀）。所以我放弃了。求大神告知。（听说是qt版本有问题？）</p>
<p>#四、配置浏览器代理#</p>
<p>虽然全局不行，但浏览器自顾自的代理还是可以的。 Firefox：下载FoxyProxy插件，然后根据插件的教程来（浏览器自带的代理设置没效果不知道为什么，求告知）最后设置如图： <img src="/posts/41853/20170129112226131.png" alt="这里写图片描述"></p>
<p>Chrome：下载SwitchyOmega插件。根据以下教程来（插件下载地址都在里面） http://www.ihacksoft.com/chrome-switchyomega.html 。这个插件教程很详细，我就不写了。 要注意的是Rule List Config部分下载gfwlist.txt可能会失败，因为此时你还不能上某些网。所以做此步骤时先切换到刚做好的ss全局代理。</p>
<p>#五、配置终端代理#</p>
<p>挂代理的东西不少，我使用的是Polipo，和shadowsocks的socks5搭配比较不错。 Polipo安装： <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> install polipo</span><br></pre></td></tr></table></figure></p>
<p>打开配置文件： <figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/polipo/<span class="built_in">config</span></span><br></pre></td></tr></table></figure></p>
<p>修改配置文件： <figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="comment"># This file only needs to list configuration variables that deviate</span></span><br><span class="line"><span class="comment"># from the default values.  See /usr/share/doc/polipo/examples/config.sample</span></span><br><span class="line"><span class="comment"># and "polipo -v" for variables you can tweak and further information.</span></span><br><span class="line"></span><br><span class="line"><span class="attr">logSyslog</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">logFile</span> = /var/log/polipo/polipo.log</span><br><span class="line"><span class="attr">socksParentProxy</span> = <span class="string">"localhost:1080"</span></span><br><span class="line"><span class="attr">socksProxyType</span> = socks5</span><br><span class="line"><span class="attr">logLevel</span>=<span class="number">4</span></span><br></pre></td></tr></table></figure></p>
<p>然后重启polipo： <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">sudo<span class="built_in"> service </span>polipo stop</span><br><span class="line">sudo<span class="built_in"> service </span>polipo start</span><br></pre></td></tr></table></figure></p>
<p>Polipo默认的代理地址是 <code>http_proxy=http://localhost:8123</code> 那么每次对于希望 番羽 土啬 的指令，只需在前面加一句<code>http_proxy=http://localhost:8123</code> 即可。当然每次输入这么一长串这比较麻烦，可以打开<code>～/.bashrc</code>，在最后面添加一句 <figure class="highlight monkey"><table><tr><td class="code"><pre><span class="line"><span class="keyword">alias</span> <span class="title">fanqiang</span>=<span class="string">"http_proxy=http://localhost:8123"</span></span><br></pre></td></tr></table></figure></p>
<p>这样以后只需在需要 番羽 土啬 的指令前面加一句fanqiang即可了。 先来测试下有没有成功，输入： <figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">fanqiang</span> curl <span class="built_in">ip</span>.gs</span><br></pre></td></tr></table></figure></p>
<p>得到： <figure class="highlight css"><table><tr><td class="code"><pre><span class="line">当前 <span class="selector-tag">IP</span>：104<span class="selector-class">.238</span><span class="selector-class">.149</span><span class="selector-class">.195</span> 来自：日本东京都东京 <span class="selector-tag">choopa</span><span class="selector-class">.com</span></span><br></pre></td></tr></table></figure></p>
<p>如果不想每条指令都输入fanqiang，可以 <figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">http_proxy</span>=http://localhost:8123</span><br></pre></td></tr></table></figure></p>
<p>#六、开机启动#</p>
<p>参考的这个http://www.afox.cc/archives/83 英文系统在dash里面搜索“start”，中文搜索“启动”，或者在终端里输入<code>gnome-session-properties</code>，总之就是打开这个<img src="/posts/41853/20170129113939433.png" alt="这里写图片描述"> 打开后界面如下图。 <img src="/posts/41853/2015-07-11-171133屏幕截图.png" alt="这里写图片描述"></p>
<p>选择添加，如下填入即可。一个字都不需要改。 <img src="/posts/41853/2015-07-11-171220屏幕截图.png" alt="这里写图片描述"></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
        <tag>Shadowsocks</tag>
      </tags>
  </entry>
  <entry>
    <title>我的Linux入门之路 - 01.Ubuntu安装</title>
    <url>/posts/41653.html</url>
    <content><![CDATA[<p>最近学机器学习，感觉matlab/octave用的人不多，想改用python。于是开始学python，辛辛苦苦学会了自己装环境和装第三方库，结果发现scipy库竟然没有win版本！于是想着那我得装个linux了。于是乎...我本来只是想学学机器学习的。。。（教练：你怎么什么都想学）那么说干就干，顺便写个笔记，也不指望别人看到，也是以防以后我再需要安装linux时忘了自己曾经的步骤。</p>
<p>#一、Linux版本选择与下载#</p>
<p>因为是入门么，首先想到的自然是ubuntu。然后查了查，定下来就ubuntu比较适合我这种从windows过渡过去的。版本就默认他的最新就好，我目前最新版本是16.04。那么虽然选择ubuntu，还是不要选择其旗下的优麒麟吧。。。这个版本预装了些本地化软件，然而并没有什么用。（听说是win98一样打GUI，以及预装360?!360爸爸都管到linux啦） Ubuntu官网： http://www.ubuntu.org.cn/global</p>
<p>#二、双系统选择#</p>
<p>我选择的安装模式是传统的legacy+mbr格式。打算linux和win10并存。我的win10是uefi+gpt安装在ssd里，而这里的linux选择legacy+mbr装在hdd里。而且我的BIOS不支持csm。两种启动引导方式完全不同，所以不会出现重装win导致引导丢失什么的，我这种方式甚至说不上是双系统。因此每次要启动对应系统时，要进linux就把bios的boot方式改为legacy，要进win10就选uefi。</p>
<p>以前试着装win7+win10双系统，网上教程看了一大堆，各种uefi、lagacy、mbr、gpt、csm什么什么术语的看得发晕，各种添加引导什么什么的乱的很。最后我想，legacy和uefi作为两种完全不同的引导方式，因该是互不影响的，而且win10我肯定是要fast boot的不肯回legacy（win8、win10的3秒神速开机就靠uefi下的fast boot支持），而win7那会还不支持uefi只能legacy，想转换uefi还麻烦，还会涉及双系统启动的那个界面。那我刚好一个win10装uefi，一个win7装legacy，通过BIOS 切换系统不就好了吗。于是作死亲测可用！于是这里装linux就把原来win7删了，反正ubuntu对uefi支持也不好。其实个人感觉这种双系统方式还更快，不用经过双系统选择界面，也没有双系统导致的引导问题。网上很多人对重装win导致linux引导丢失很烦恼，而我这样随便重装，从底层上互不影响。</p>
<p>#三、制作U盘启动#</p>
<p>官网就提供U盘启动制作器，很方便地把下载的ubuntu的iso刻入U盘。 <img src="/posts/41653/1.png" alt="这里写图片描述"> U盘启动制作器地址：https://www.pendrivelinux.com/universal-usb-installer-easy-as-1-2-3/</p>
<p>注意：U盘得是fat32格式的，NTFS打不开Linux启动盘（至少我的不能用NTFS）。用了NTFS虽然也显示的了那个启动界面（如下图）， <img src="/posts/41653/2.jpg" alt="这里写图片描述"> 但是不管Run Ubuntu from this USB还是Install Ubuntu...，都会显示 Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(2,0)而报错。（网上人家都是在unknown-block(0,0)报错，就我(2,0)...查半天也差不出什么原因，我竟然能自己找出来是U盘格式原因我也挺佩服自己的）。</p>
<p>这里说一下发现的比较好玩的地方。win要安装到u盘需要win to go，貌似就是那个vhd，而且好像win8以上才支持。而这个linux启动盘，选择install后发现，他就是拿我下的ubuntu版本当作pe，然后有个可执行文件放在里面再把这个版本装一遍到硬盘里，挺有意思的。</p>
<p>#四、建立根目录与安装#</p>
<p>毕竟Ubuntu，安装界面相当友好。其他步骤都很简单，唯一有难度的是分区着一块。 首先是选择语言。有简体中文。我也选了简体中文，这个对新手还是很友好的。不过有一个问题，选了中文后你以后的用户文件目录下的文件夹名字也是中文（比如”文档“、”下载“、”图片“之类的文件夹）。 和Windows不同，Win下的用户文件夹不同，Win下虽然显示着中文，<img src="/posts/41653/3.png" alt="这里写图片描述"> ，但是其文件目录本质还是英文，只是显示为中文罢了。比如说文档，<img src="/posts/41653/4.png" alt="这里写图片描述"> ，显示是文档，但其实目录是<img src="/posts/41653/5.png" alt="这里写图片描述"> 英文。但这里Ubuntu不一样，你选了中文，它的个人文件夹名字就真的变成中文了。。。所以我现在还有一点点小后悔选中文。不过好在ubuntu里的个人文件夹作用没win那么大，以后装软件、开发用到的不多。</p>
<p>安装ubuntu时下载更新与安装第三方软件均随意，（我这边是因为已经装好了，所以再打开安装面板做演示时第一个选项就灰了） <img src="/posts/41653/6.jpg" alt="这里写图片描述"></p>
<p>安装类型自己看它的描述很清楚，同样因为我已经装好了，所以前几个选项会不一样。但是一般前几个选项都满足不了你，都会选其他选项。 <img src="/posts/41653/7.jpg" alt="这里写图片描述"></p>
<p>选择“其他选项”后就到了重头戏，分区。 <img src="/posts/41653/8.jpg" alt="这里写图片描述"></p>
<p>##分区##</p>
<p>这界面和win不一样。。。一开始我都分不清哪个是哪个区。sda代表它找到的第一块硬盘，在我电脑里是ssd，那下面的sda1、2、3就是ssd的分区。我们的目标是机械硬盘，也就是这里识别为sd2的这块。sdb5、6、7是我的其他盘，不管。</p>
<p>首先我事先格式化了一个60G的盘。然后把这个盘删了，释放为空闲的空间。然后就到瓜分这个60G的时间了。（这60G最后分的结果就是我的sdb1、8、9、10、11）</p>
<p>Linux的文件系统和win完全不一样！啥都不懂就硬上的我一开始一脸蒙蔽！win下么创建个分区，格式化，系统装起来。而linux要安装，需要一个根目录。这个根目录类似于C盘，但是在它下面还需要自己挂载一些其他目录才能安装。详情先查Linux文件系统、Linux磁盘分区、挂载点等关键词。</p>
<p>查了这么多的结果就是，首先得分一个根目录，这是必须的。（如果像win那样建个盘，格式化，选中后就点安装，会提示找不到根目录安装不了）然后可以创几个分区。下面讲一下几个常用分区（所谓常用就是非必须，但是你了解了各自功能后感觉还是装一下比较好的）顺序也是根据我的分区顺序。</p>
<ul>
<li><p>/boot：这玩意引导用的，但也不是必须（除非你电脑是老标准引导则必须要这个，还有这玩意对双系统在win中用easybcd引导grub2有帮助）但我新手，为了稳，分了200MB。另外要说的是，网上推荐/boot放在根目录前面并设为主分区，于是我先分了/boot。 步骤是：选择sdb这片名为“空闲”的60G的区域，点击左下角+号，弹出对话框（没截图）分区类型:主分区； 新建分区容量:200mb； 新建分区位置:起始（在这60G开头分出来）； 用于:Ext4日志文件系统（Ext4最能充分发挥linux性能）； 挂载点:选择“/boot”。</p></li>
<li><p>根目录：必须有的目录！！我之前看到好几个教程被坑了，都没让你创建根目录！一般20G绝对够了，盘小的就也相应少给点没问题，我60G大着呢，给了20G不到。 步骤是：选择“空闲”的区域，点击左下角+号，弹出对话框。分区类型:逻辑分区； 新建分区容量:20000mb； 新建分区位置:起始； 用于:还是Ext4日志文件系统； 挂载点:选择“/”。</p></li>
<li><p>交换空间：与windows的虚拟内存有点类似。一般如果你内存小于等于512MB，建议分两倍于内存大小的交换空间，如果内存大于512mb，可以分等于内存大小的空间。如果你内存很充裕，那就不用建立了。我内存8G，其实完全不需要这个。但是以防万一嘛，万一将来要运行什么大玩意呢？于是给了2G。 步骤是：选择“空闲”的区域，点击左下角+号，弹出对话框。分区类型:逻辑分区； 新建分区容量:2048mb； 新建分区位置:起始； 用于:swap（没记错的话是这个名字）； 此时挂载点灰了没法选。</p></li>
<li><p>/usr：与Windows的 Program Files文件夹、AppData文件夹有些许类似。主要功能是存放软件啊、库文件啊、其他可执行文件什么的。以后你会看到里面有/bin、/lib、/local什么的目录，很亲切。因为分了20G只剩40G了，后面还有一个home要分，想想软件怎么会比文件大，就决定1：3分，usr给1/（1+3）*40=10G。 步骤是：点击左下角+号，分区类型:逻辑分区； 新建分区容量:10240mb； 新建分区位置:起始； 用于:Ext4日志文件系统；挂载点:“/usr”。</p></li>
<li><p>/home：与win的个人文件夹类似，自带文档、图片、下载等文件夹。同时你作为用户的所有文件（工程啊、源文件啊、照片啊、小电影啊）都放这里了。所以给30G多。一般网上的建议都是剩下的空间全部作为home 步骤同上，就改个容量和挂载点，而且容量就默认的全部不用改。</p></li>
</ul>
<p>以上是我的分配，也是综合了网上的方案，应该是个比较大众点的方案吧。其他如/var啊/tmp啊等等很多分区自行wiki功能，比如有的针对服务器我就不需要装了。</p>
<p>最后点击安装即可。重启后就可以了（win拔U盘重启后还有后续安装步骤，而linux重启直接好了）。</p>
<p>然后一个崭新的Ubuntu诞生了！ <img src="/posts/41653/9.png" alt="这里写图片描述"></p>
<p>第一件事换个壁纸AoA，毕竟是目前唯一不用教就会做的事。</p>
<p>当然了，这张图是后截的，已经装了些东西了比如某显眼的红色图标与某显眼的绿色图标。</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Ubuntu</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 6-7UVa804 - Petri Net Simulation</title>
    <url>/posts/10913.html</url>
    <content><![CDATA[<p>题意：模拟Petri网的执行。虽然没听说过Petri网，但是题目描述的很清晰。</p>
<hr>
<p>代码：（Accepted，0.210s）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa804 - Petri Net Simulation</span></span><br><span class="line"><span class="comment">//Accepted 0.210s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">	<span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; ipt, opt;</span><br><span class="line">&#125; Trans[<span class="number">111</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> NP, NT, NF, Cnt, T(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">int</span> Token[<span class="number">111</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IniAndInput</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">1</span>);i &lt;= NP;++i)</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, Token + i);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;NT);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">1</span>);i &lt;= NT;++i) &#123;</span><br><span class="line">		Trans[i].ipt.clear();</span><br><span class="line">		Trans[i].opt.clear();</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) != EOF &amp;&amp; n) &#123;</span><br><span class="line">			<span class="keyword">if</span> (n &lt; <span class="number">0</span>) ++Trans[i].ipt[-n];</span><br><span class="line">			<span class="keyword">else</span> ++Trans[i].opt[n];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;NF);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">JudgeTrans</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; t : Trans[i].ipt)</span><br><span class="line">		<span class="keyword">if</span> (Token[t.first] &lt; t.second)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">TryTrans</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">1</span>);i &lt;= NT;++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!JudgeTrans(i)) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; t : Trans[i].ipt)</span><br><span class="line">			Token[t.first] -= t.second;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; t : Trans[i].opt)</span><br><span class="line">			Token[t.first] += t.second;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Output</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"Case %d: "</span>, ++T);</span><br><span class="line">	<span class="keyword">if</span> (Cnt &lt; NF)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"dead after %d transitions\n"</span>, Cnt);</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"still live after %d transitions\n"</span>, NF);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"Places with tokens:"</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">1</span>);i &lt;= NP;++i) <span class="keyword">if</span> (Token[i])</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">" %d (%d)"</span>, i, Token[i]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Debug</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">cerr</span> &lt;&lt; <span class="string">"\nToken:\n"</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">1</span>);i &lt;= NP;++i) <span class="built_in">cerr</span> &lt;&lt; Token[i] &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">	<span class="built_in">cerr</span> &lt;&lt; <span class="string">"\nTrans:\n"</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">1</span>);i &lt;= NT;++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; t : Trans[i].ipt) <span class="built_in">cerr</span> &lt;&lt; t.first &lt;&lt; <span class="string">" - "</span> &lt;&lt; t.second &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; t : Trans[i].opt) <span class="built_in">cerr</span> &lt;&lt; t.first &lt;&lt; <span class="string">" + "</span> &lt;&lt; t.second &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 129)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;NP) != EOF &amp;&amp; NP) &#123;</span><br><span class="line">		IniAndInput();</span><br><span class="line">		<span class="comment">//Debug();//</span></span><br><span class="line">		<span class="keyword">for</span> (;Cnt &lt; NF;++Cnt) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!TryTrans()) <span class="keyword">break</span>;</span><br><span class="line">			<span class="comment">//Debug();//</span></span><br><span class="line">		&#125;</span><br><span class="line">		Output();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>分析：其实就是无脑模拟。比前一题简单好多，有些意外。一遍通过，好久没一遍过了，好爽。题目描述的很清晰，看紫书的中文简述反而看不懂。这次尽量给不同部分分了个块，分到不同函数里去了，看着清晰点。210ms好像有点长，看网上别人的做法也基本类似，也不优化了。 说起来我一开始对每一个Case进行初始化Trans数组时，一开始选择的对整个数组的ipt、opt进行clear，用时190ms。后来改成只对要用的部分进行clear初始化，反而用时更长了（210ms）。这应该是处理器的优化的结果吧。就是让处理器反复干一件事时它会预测下一步还是这个同样的计算，就会处理的特别快。也算是硬件因素吧？</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 6-6UVa12166 - Equilibrium Mobile</title>
    <url>/posts/23916.html</url>
    <content><![CDATA[<p>题意：二叉树代表使得平衡天平，修改最少值使之平衡。</p>
<hr>
<p>代码：（Accepted，0.030s）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa12166 - Equilibrium Mobile</span></span><br><span class="line"><span class="comment">//Accepted 0.030s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> total;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">map</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">int</span>&gt; leaf;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> dp)</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">char</span> <span class="title">c</span><span class="params">(getchar())</span></span>;</span><br><span class="line">	<span class="keyword">if</span> (c == <span class="string">'['</span>) &#123;</span><br><span class="line">		build(dp + <span class="number">1</span>),build(dp + <span class="number">1</span>);</span><br><span class="line">		getchar();</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">n</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		n = n * <span class="number">10</span> + c - <span class="string">'0'</span>;</span><br><span class="line">		c = getchar();</span><br><span class="line">	&#125; <span class="keyword">while</span> (c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>);</span><br><span class="line">	++leaf[n&lt;&lt;dp];</span><br><span class="line">	++total;</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 129)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line">	<span class="keyword">while</span> (getchar() != <span class="string">'\n'</span>);</span><br><span class="line">	<span class="keyword">while</span> (total = <span class="number">0</span>,leaf.clear(),T--) &#123;</span><br><span class="line">		build(<span class="number">0</span>);</span><br><span class="line">		<span class="function"><span class="keyword">int</span> <span class="title">mx</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> p(leaf.begin());p != leaf.end();++p)</span><br><span class="line">			<span class="keyword">if</span> (p-&gt;second &gt; mx) mx = p-&gt;second;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,total - mx);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>分析：题目给了每一片树叶的值与深度与树的形状。 由题，每个结点（除了树叶）的值为左右儿子之和，且其左右儿子值均相同。 推出，确定任意树叶与树的形状，其他结点的唯一可能的值均可求出(唯一确定)。 推出，确定任意结点与树的形状，其他结点的唯一可能的值均可求出(唯一确定)。 反之，若根节点值为N，且已知树的形状，可推出每个树叶的唯一可能的值(唯一确定)。</p>
<p>一开始想在以每个树叶为基准的情况下求出其他所有树叶的对应值，所以要遍历每个树叶，并对每个树叶遍历其他树叶求是否需要改变，时间复杂度O(n^2)，明显就麻烦。 看了题解，既然以某一树叶唯一确定一棵树，则只需求出以每片树叶为基准下的根节点值，看所有树叶对应根节点值相同的最多的，就是不需要改动的树叶最多的情况。时间复杂度O(n)。</p>
<p>唉，大神们的逆向思维就是厉害。论审题、分析题目的重要性。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>A星寻路算法初探</title>
    <url>/posts/56919.html</url>
    <content><![CDATA[<h2 id="写在开始之前">写在开始之前</h2>
<p>最近突然对各路游戏的寻路算法很感兴趣，于是去学习了下游戏里的AI们是如何寻路的。网上相关内容很多，但同时有些说法也不一，制作自己的 <code>A*</code> 算法时也有因不同的说法而困惑。整理多方资料并自己实践之后，以下是我对寻路算法，尤其是 <code>A*</code> 算法的一些自己的总结。以下为自己的思考与想法，可能不准确之处，请指正。 我本次的模拟比较简单，下面简述一下模拟环境：</p>
<ol type="1">
<li>地图是棋盘式的格子地图；</li>
<li>各个点没有权值，或者说权值为1；</li>
<li>只能上下左右走，不支持斜着走；</li>
<li>未考虑终点被包住而到达不了的情况，发生此类情况时，算法会遍历所有可到达点无果后才证明目标无法到达。</li>
</ol>
<p>虽然模拟的比较简单，但是足以学习、说明问题。为了使算法更形象可视化，我给算法的过程做了小动画。成品存在了我的Github里：https://github.com/xienaoban/Pathfinding 这里代码就不贴了。使用的java编写。当时是初学java，所以代码写的比较屎，我现在回头都有点看不下去。</p>
<h2 id="寻路的基本思路">寻路的基本思路</h2>
<p>首先总结一下寻路的最常见的两个思路， <strong>遍历</strong> 与 <strong>贪心算法</strong> 。</p>
<h3 id="遍历只考虑起点">遍历：只考虑起点</h3>
<p>这里说的遍历其实用的是Dijkstra算法或BFS，也就从起点开始一扩散出去寻找最短路径。也就是遍历距离起点最短距离为1、2、3……n-1、n的点。对于地形复杂比如有山有沼泽（即有权值）的地图（图），使用Dijkstra算法，用优先队列存储遍历到地图的每一个点时的权值和。对于一张平滑的也就是无权值（权值相同）的地图，Dijkstra的表现与BFS相同，即只需退化使用队列进行BFS遍历即可，无需使用Dijkstra算法。这里我的模拟的地图没有权值，直接使用了BFS。</p>
<figure>
<img src="/posts/56919/1.png" alt="图1. BFS无障碍寻路演示"><figcaption>图1. BFS无障碍寻路演示</figcaption>
</figure>
<figure>
<img src="/posts/56919/2.png" alt="图1. BFS小障碍寻路演示"><figcaption>图1. BFS小障碍寻路演示</figcaption>
</figure>
<figure>
<img src="/posts/56919/3.png" alt="图3. BFS略复杂障碍寻路演示"><figcaption>图3. BFS略复杂障碍寻路演示</figcaption>
</figure>
<p>黄色代表被搜索过，蓝色代表搜索完成后找到的路径（在这里显然也是最短路径）。格子中的值为从起点到本格子的最短距离。由图可知算法从起点向周围扩散，直到扩散到终点。 结论是，BFS（或带权图中用的Dijkstra）肯定找到最短路径，但是问题在于，它太耗时了，访问的点（黄色格子）太多了。想想就知道很多点完全没有必要遍历。 造成这一现象的原因是，这个算法只考虑了起点，一直找距离起点最短的路直到遇到终点。</p>
<h3 id="贪心只想着终点">贪心：只想着终点</h3>
<p>试图不遍历，直接找到终点去，那基本就是使用贪心算法了吧。 以上的启发式函数仅仅考虑了起点，因而导致算法无目的地向四周扩散寻找。那既然是使用贪心算法，每次寻找目前为之的最优解，那么这次只要考虑终点在哪里就行了，一路向终点走，起点不用考虑。这使得算法疯狂试图向终点靠近。 <img src="/posts/56919/4.png" alt="图4. 贪心算法无复杂障碍寻路演示"> 结果发现无障碍情况下效果杠杠的，没有一块多余的白色。但是如果有障碍呢？ <img src="/posts/56919/5.png" alt="图5. 贪心算法略复杂障碍寻路演示"> 虽然一格都没有多搜索，但是游戏里AI要是这样走路那玩家肯定吃不消。而且还有一个问题，万一走到了死胡同里，算法就会判定无法到达终点，而事实却是是算法自己钻了牛角尖。所以必须允许算法倒退，从死胡同里后退一步或多步，换条路子走。可以使用栈即可实现。有时会发现换了路之后反而更快地到达了之前到过的一个点，于是有些点重复搜索了，重复搜索的话很有可能比无脑遍历都不划算。于是我关闭了重复搜索，效果好多了。 <img src="/posts/56919/6.png" alt="图4. 贪心算法复杂障碍寻路演示"> 可以看到算法产生了很多失败的搜索（黄格子）（都是被自己走过的路堵死的。。。创战记既视感）但是搜索的路比遍历少多了，但是说起来，允许倒退重新寻路，说到底这也还算是是进行遍历了。。。有时候还不及遍历。（其实我搜索完后画的路径不是完全根据算法来的，算法找的路还要更绕，我很多地方已经根据黄格子的梯度抄近路了。） 同时贪心算法只考虑了终点，永远只向着终点方向走，不考虑目前离起点已经走了多少格了。</p>
<h2 id="a星算法">A星算法</h2>
<p>A星（<code>*</code> 在 Markdown 里打起来有点麻烦，下面直接用‘星’代替了）用的也是Dijkstra。每次找出当前期望值最高的点（即最可能最快速度通往终点的点），一步步搜索过去。Wiki上也说了，这是对Dijkstra's Algorithm 的扩展，因为它使用了性能更好的<strong>启发</strong>式引导其搜索。</p>
<h3 id="最短路径还是最合理路径">“最短”路径还是“最合理”路径</h3>
<p>我刚开始了解A星的时候, 看了好几篇博客、文章，竟然众说纷纭。有人说“不是。因为‘启发’是不精确的。”。也有人说“尽管A星基于无法保证最佳解的启发式方法，A星却能保证找到一条最短路径。”这就很尴尬了。 看了这么多资料以及加上我以往的玩游戏经验，我认为A星只是个比较宽的概念，它可以找到最佳路径，也可以找的只是合理路径。既然用了启发，那么它很可能找的不是“最短”而只是说根据这个启发找到的最“合理”路径。但是也可能你的启发式函数做的很好，找到的最合理路径就是最佳路径（就比如文章开头的说的遍历）。关键就在于你给他的“启发”是怎么样的。 小时候玩红警还是什么游戏时就遇到过单位走的路不是最短路径。</p>
<h3 id="核心寻找启发式函数hn">核心：寻找启发式函数h(n)</h3>
<p>A星既然用了Dijkstra，那它的基本过程就是：从优先队列里拉出期望最高的n点（在我的算法里表示为h(n)值最低），标记，并把它周围的未知点放进优先队列。所以关键就是这个h(n)。 h(n)怎么找？其实最简单的，上面讲的遍历说起来也是h(n)的一种。从起点进行遍历的 <code>h(n) = n.t</code> （t为距离起点的距离），也就是说而对距离近的优先搜索。而这个算法其实就是最短路径的算法，这里“最合理路径”就是“最短路径”。 而对于上面讲的贪心算法，他的引导函数可以看作是</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">h(n) = max(abs(n.x - end.x), abs(n.y - end.y))</span><br></pre></td></tr></table></figure>
<p>哪边离终点近就走哪里。之前这是用贪心实现的，但如果用做A星的h(n)实现呢？</p>
<figure>
<img src="/posts/56919/7.png" alt="这里写图片描述"><figcaption>这里写图片描述</figcaption>
</figure>
<p>效果很好，不过这只能用在仅支持上下左右行走的场景，找的路也比较“合理”（虽然明显不是最短路径）。现在只考虑还有什么可以试试呢？想到起点终点都要考虑进去，首先想到了这个：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">h(n) = sqrt((n.x - end.x) ^ <span class="number">2</span> + (n.y - end.y) ^ <span class="number">2</span>) + sqrt((n.x - start.x) ^ <span class="number">2</span> + (n.y - end.y) ^ <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<p>即点n到起始点的距离加上n到终点的距离。也就是说，距离起点终点所在的直线越近，h(n)就越低。</p>
<figure>
<img src="/posts/56919/8.png" alt="这里写图片描述"><figcaption>这里写图片描述</figcaption>
</figure>
<p>效果还不错。但是问题在于sqrt计算成本太高。即时策略类游戏的话这不好。而且对于这次只有直着走的模拟有些大材小用了。而且还是有些部分是不需要搜索的。</p>
<figure>
<img src="/posts/56919/9.png" alt="这里写图片描述"><figcaption>这里写图片描述</figcaption>
</figure>
<p>还有几个可用的函数，一个和之前的<code>h(n) = max(abs(n.x - end.x), abs(n.y - end.y))</code> 比较像：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">h(n) = abs(x - end.x) + abs(y-end.y)</span><br></pre></td></tr></table></figure>
<p>找出x、y轴方向哪边离终点远，哪边远倾向于走哪边。还有一个和sqrt那个比较像：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">h = abs((x - end.x) * (start.y-end.y) - (start.x-end.x) * (y-end.y))</span><br></pre></td></tr></table></figure>
<p>倾向与走与起点终点所在直线方向的平行线，这个个人觉得不错，比sqrt那个计算少，而且在棋盘式地图里效果也好。但是它也有一个问题：</p>
<figure>
<img src="/posts/56919/10.png" alt="这里写图片描述"><figcaption>这里写图片描述</figcaption>
</figure>
<p>他会搜索反向于终点的方向。所以可以考虑用多个函数组合：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">h = abs((x - end.x) * (start.y-end.y) - (start.x-end.x) * (y-end.y)) + (abs(x - end.x) + abs(y-end.y))*<span class="number">500</span>;</span><br></pre></td></tr></table></figure>
<p>效果比单一使用好很多。虽然实际效果其实不比<code>h(n) = max(abs(n.x - end.x), abs(n.y - end.y))</code> 强，但也给我们提供一个寻找h(n)的思路，将来可以运用到任意方向的地图上。其中里面不同函数还有权重，比如第二个函数乘以了500。权重可以按照实战效果来定。 <img src="/posts/56919/11.png" alt="这里写图片描述"> 不过你可能也根据我放的截图发现了，这些算法都倾向于走起点与终点所在直线之上。即每当越过一个障碍物，就试图重新靠近起点终点所在连线上。尽管连线上或许还有障碍物。这也是我应该改进的地方。</p>
<h2 id="总结精度还是速度">总结：“精度”还是“速度”</h2>
<p>显然，复杂些的启发式函数或是会造成更多搜索的方法往往能取得更好的效果，但是同时速度也更慢。因此如何选择将是本算法的一道难题。对于本次模拟的图，BFS 的表现无疑是最佳，但对于很大的地图、有很多NPC的游戏，就得权衡运行速度与寻路精度了。只要运行速度快、结果合理，A星算法的目的也算是达到了。</p>
]]></content>
      <tags>
        <tag>笔记</tag>
        <tag>造轮子</tag>
        <tag>A*寻路算法</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 6-4UVa439 6-5UVa1600</title>
    <url>/posts/50450.html</url>
    <content><![CDATA[<p>比较忙比较累，只贴代码了。</p>
<hr>
<p>题目：6-4 UVa439 - Knight Moves</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa439 - Knight Moves</span></span><br><span class="line"><span class="comment">//Accepted 0.000s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M(po) Map[po.x][po.y]</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">poi</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> x, y, weight;</span><br><span class="line">	poi <span class="keyword">operator</span> +(<span class="keyword">const</span> poi &amp;that) <span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> poi&#123; x + that.x, y + that.y, weight&#125;;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> ==(<span class="keyword">const</span> poi &amp;that) <span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> (x == that.x) &amp;&amp; (y == that.y);</span><br><span class="line">	&#125;</span><br><span class="line">&#125; op, ed;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> poi dir[<span class="number">8</span>] = &#123; &#123; <span class="number">2</span>,<span class="number">1</span> &#125;,&#123; <span class="number">-2</span>,<span class="number">1</span> &#125;,&#123; <span class="number">2</span>,<span class="number">-1</span> &#125;,&#123; <span class="number">-2</span>,<span class="number">-1</span> &#125;,&#123; <span class="number">1</span>,<span class="number">2</span> &#125;,&#123; <span class="number">-1</span>,<span class="number">2</span> &#125;,&#123; <span class="number">1</span>,<span class="number">-2</span> &#125;,&#123; <span class="number">-1</span>,<span class="number">-2</span> &#125; &#125;;</span><br><span class="line"><span class="keyword">bool</span> Map[<span class="number">10</span>][<span class="number">10</span>];</span><br><span class="line"><span class="keyword">char</span> xstart, ystart, xend, yend;</span><br><span class="line"><span class="keyword">int</span> xs, ys, xe, ye;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BFS</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (op == ed) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">queue</span>&lt;poi&gt; Q;</span><br><span class="line">	Q.push(op);</span><br><span class="line">	M(op) = <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">while</span> (!Q.empty()) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; <span class="number">8</span>;++i)&#123;</span><br><span class="line">			<span class="function">poi <span class="title">nxt</span><span class="params">(Q.front() + dir[i])</span></span>;</span><br><span class="line">			<span class="keyword">if</span> (nxt.x &gt; <span class="number">0</span> &amp;&amp; nxt.y &gt; <span class="number">0</span> &amp;&amp; nxt.x &lt; <span class="number">9</span> &amp;&amp; nxt.y &lt; <span class="number">9</span> &amp;&amp; !M(nxt)) &#123;</span><br><span class="line">				++nxt.weight;</span><br><span class="line">				<span class="keyword">if</span> (nxt == ed) <span class="keyword">return</span> nxt.weight;</span><br><span class="line">				M(nxt) = <span class="literal">true</span>;</span><br><span class="line">				Q.push(nxt);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		Q.pop();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 129)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	<span class="comment">//freopen("out.txt", "w", stdout);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%c%c %c%c"</span>, &amp;xstart, &amp;ystart, &amp;xend, &amp;yend) == <span class="number">4</span>) &#123;</span><br><span class="line">		<span class="built_in">memset</span>(Map, <span class="number">0</span>, <span class="keyword">sizeof</span>(Map));</span><br><span class="line">		op.x = xstart - <span class="number">96</span>, op.y = ystart - <span class="number">48</span>, op.weight = <span class="number">0</span>;</span><br><span class="line">		ed.x = xend - <span class="number">96</span>, ed.y = yend - <span class="number">48</span>, ed.weight = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"To get from %c%c to %c%c takes %d knight moves.\n"</span>, xstart, ystart, xend, yend, BFS());</span><br><span class="line">		<span class="keyword">while</span> (getchar() != <span class="string">'\n'</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>题目：6-5 UVa1600 - Patrol Robot <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1600 - Patrol Robot</span></span><br><span class="line"><span class="comment">//Accepted 0.000s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DONE 2333333</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">step</span> &#123;</span> <span class="keyword">int</span> x, y, k, mov; &#125;;</span><br><span class="line"><span class="keyword">int</span> T, m, n, k;</span><br><span class="line"><span class="keyword">int</span> Map[<span class="number">24</span>][<span class="number">24</span>],Obst[<span class="number">24</span>][<span class="number">24</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">judge</span><span class="params">(<span class="built_in">queue</span>&lt;step&gt; &amp;Q, step &amp;now, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (Obst[x += now.x][y += now.y] == DONE) <span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">int</span> _k = (Obst[x][y] ? now.k + <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span> (_k &lt;= k) &#123;</span><br><span class="line">		<span class="keyword">if</span> (_k) &#123;</span><br><span class="line">			<span class="keyword">if</span> (Map[x][y] &amp;&amp; Map[x][y] &lt;= _k) <span class="keyword">return</span>;</span><br><span class="line">			Map[x][y] = _k;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> Obst[x][y] = DONE;</span><br><span class="line">		Q.push(step&#123; x, y, _k, now.mov + <span class="number">1</span> &#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 129)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">	<span class="keyword">while</span> (T--) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;m, &amp;n, &amp;k);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">1</span>);i &lt;= m;++i) <span class="keyword">for</span> (<span class="keyword">int</span> j(<span class="number">1</span>);j &lt;= n;++j)</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;Obst[i][j]);</span><br><span class="line">		<span class="built_in">memset</span>(Map, <span class="number">0</span>, <span class="keyword">sizeof</span>(Map));</span><br><span class="line">		<span class="built_in">queue</span>&lt;step&gt; Q;</span><br><span class="line">		Q.push(step&#123; <span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span> &#125;);</span><br><span class="line">		Obst[<span class="number">1</span>][<span class="number">1</span>] = DONE;</span><br><span class="line">		<span class="keyword">while</span> (!Q.empty()) &#123;</span><br><span class="line">			<span class="function">step &amp;<span class="title">now</span><span class="params">(Q.front())</span></span>;</span><br><span class="line">			<span class="keyword">if</span> (now.x == m &amp;&amp; now.y == n) <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">if</span> (now.x + <span class="number">1</span> &lt;= m) judge(Q, now, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">			<span class="keyword">if</span> (now.y + <span class="number">1</span> &lt;= n) judge(Q, now, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">			<span class="keyword">if</span> (now.x - <span class="number">1</span> &gt;= <span class="number">1</span>) judge(Q, now, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">			<span class="keyword">if</span> (now.y - <span class="number">1</span> &gt;= <span class="number">1</span>) judge(Q, now, <span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line">			Q.pop();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (Q.empty()) <span class="built_in">printf</span>(<span class="string">"-1\n"</span>);</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Q.front().mov);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 6-1UVa673 6-2UVa712 6-3UVa536</title>
    <url>/posts/51530.html</url>
    <content><![CDATA[<p>这三题比较简单，只放代码了。</p>
<hr>
<p>题目：6-1 UVa673 - Parentheses Balance <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa673 - Parentheses Balance</span></span><br><span class="line"><span class="comment">//Accepted 0.000s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="keyword">char</span> line[<span class="number">130</span>];</span><br><span class="line"><span class="keyword">bool</span> st[<span class="number">130</span>];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (*line == <span class="string">'\0'</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">auto</span> *p = line;</span><br><span class="line">	<span class="keyword">auto</span> *top = st;</span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		<span class="keyword">switch</span> (*p)</span><br><span class="line">		&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'('</span>: *++top = <span class="literal">false</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">'['</span>: *++top = <span class="literal">true</span>;<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">')'</span>:</span><br><span class="line">			<span class="keyword">if</span> (top == st || *top) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			--top;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="keyword">if</span> (top == st || !*top) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">			--top;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">while</span> (*++p != <span class="string">'\0'</span>);</span><br><span class="line">	<span class="keyword">return</span> top == st;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 129)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;N);</span><br><span class="line">	getchar();</span><br><span class="line">	<span class="keyword">while</span> (N--) &#123;</span><br><span class="line">		gets(line);</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; (cal() ? <span class="string">"Yes"</span> : <span class="string">"No"</span>) &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>题目：6-3 UVa712 - S-Trees</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa712 - S-Trees</span></span><br><span class="line"><span class="comment">//Accepted 0.000s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">N</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="keyword">int</span> n, m, ord[<span class="number">10</span>], run[<span class="number">10</span>], val[<span class="number">130</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 129)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	<span class="comment">//freopen("out.txt", "w", stdout);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) != EOF &amp;&amp; n != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"S-Tree #%d:\n"</span>, ++N);</span><br><span class="line">		<span class="function"><span class="keyword">int</span> <span class="title">num</span><span class="params">(<span class="number">1</span> &lt;&lt; n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">1</span>);i &lt;= n;++i) &#123;</span><br><span class="line">			<span class="keyword">while</span> (getchar() != <span class="string">'x'</span>);</span><br><span class="line">			ord[i] = getchar() - <span class="number">48</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (getchar() != <span class="string">'\n'</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; num;++i)</span><br><span class="line">			val[i] = getchar() - <span class="number">48</span>;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; m;++i) &#123;</span><br><span class="line">			<span class="keyword">while</span> (getchar() != <span class="string">'\n'</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j(<span class="number">1</span>);j &lt;= n;++j)</span><br><span class="line">				run[j] = getchar() - <span class="number">48</span>;</span><br><span class="line">			<span class="function"><span class="keyword">int</span> <span class="title">ans</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j(<span class="number">1</span>);j &lt;= n;++j)</span><br><span class="line">				ans = (ans &lt;&lt; <span class="number">1</span>) + run[ord[j]];</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d"</span>, val[ans - num]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\n\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>题目：6-3 UVa536 - Tree Recovery</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa536 - Tree Recovery</span></span><br><span class="line"><span class="comment">//Accepted 0.000s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> pre[<span class="number">30</span>], in[<span class="number">30</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cal</span><span class="params">(<span class="keyword">char</span> *pre, <span class="keyword">char</span> *in, <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">root</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (*(in + root) != *pre) ++root;</span><br><span class="line">	<span class="keyword">if</span> (root) cal(pre + <span class="number">1</span>, in, root);</span><br><span class="line">	<span class="keyword">if</span> (len - root - <span class="number">1</span>) cal(pre + root + <span class="number">1</span>, in + root + <span class="number">1</span>, len - root - <span class="number">1</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c"</span>, *pre);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 129)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	<span class="comment">//freopen("out.txt", "w", stdout);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%s%s"</span>, pre, in) != EOF) &#123;</span><br><span class="line">		cal(pre, in, <span class="built_in">strlen</span>(in));</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-16UVa212 - Use of Hospital Facilities</title>
    <url>/posts/17472.html</url>
    <content><![CDATA[<p>题意：模拟患者做手术。 其条件为：医院有Nop个手术室、准备手术室要Mop分钟，另有Nre个恢复用的床、准备每张床要Mre分钟，早上Ts点整医院开张，从手术室手术完毕转移到回复床要Mtr分钟。现在医院早上开张了，给你一张患者的表，有Npa个患者等着做手术，每个患者的的信息有：名字、做手术需要的时间、恢复需要的时间。只要有空的手术室位就安排患者进去，优先安排门牌号低的。若多人同时竞争，输入列表靠前的先进。进入恢复室的优先顺序是，也是优先安排床号靠前的床，同时做完手术的人按照<strong>手术室的门牌号小的</strong> （很奇葩的设定）优先。</p>
<hr>
<p>代码：（Accepted，0.000s） <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa212 - Use of Hospital Facilities</span></span><br><span class="line"><span class="comment">//Accepted 0.000s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ipt cin</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> opt cout<span class="comment">//just for convenience and appearance, because size("cout"+" ")=5, which is longer than a tab(which is 4)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> time_convert(t) setw(2) &lt;&lt; (t / 60) &lt;&lt; <span class="meta-string">':'</span> &lt;&lt; setfill(<span class="meta-string">'0'</span>) &lt;&lt; setw(2) &lt;&lt; (t % 60) &lt;&lt; setfill(<span class="meta-string">' '</span>)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ROOM</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> id, at;</span><br><span class="line">	ROOM() &#123;&#125;</span><br><span class="line">	ROOM(<span class="keyword">int</span> a, <span class="keyword">int</span> b) :id(a), at(b) &#123;&#125;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> ROOM&amp; that) <span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (at != that.at) <span class="keyword">return</span> at &gt; that.at;</span><br><span class="line">		<span class="keyword">return</span> id &gt; that.id;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PATIENT</span> &#123;</span></span><br><span class="line">	<span class="built_in">string</span> name;</span><br><span class="line">	<span class="keyword">int</span> id, room, bed, top, tre, t1, t2, t3, t4;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Nop, Nre, Ts, Te, Mtr, Mop, Mre, Npa;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 66666)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="keyword">while</span> (ipt &gt;&gt; Nop) &#123;</span><br><span class="line">		ipt &gt;&gt; Nre &gt;&gt; Ts &gt;&gt; Mtr &gt;&gt; Mop &gt;&gt; Mre &gt;&gt; Npa;</span><br><span class="line">		Te = <span class="number">0</span>, Ts *= <span class="number">60</span>;</span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Top(Nop + <span class="number">1</span>, <span class="number">0</span>), Tre(Nre + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">		<span class="built_in">vector</span>&lt;PATIENT&gt; Info(Npa + <span class="number">1</span>);</span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Bre(Nre + <span class="number">1</span>, Ts);</span><br><span class="line">		priority_queue&lt;ROOM&gt; Rop;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">1</span>);i &lt;= Nop;++i) Rop.push(ROOM(i, Ts));</span><br><span class="line"></span><br><span class="line">		<span class="comment">//For all the operating rooms</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> N(<span class="number">1</span>);N &lt;= Npa;++N) &#123;</span><br><span class="line">			<span class="function"><span class="keyword">auto</span>&amp; <span class="title">now</span><span class="params">(Info[N])</span></span>;</span><br><span class="line">			now.id = N;</span><br><span class="line">			<span class="function">ROOM <span class="title">op</span><span class="params">(Rop.top())</span></span>;</span><br><span class="line">			Rop.pop();</span><br><span class="line">			ipt &gt;&gt; now.name &gt;&gt; now.top &gt;&gt; now.tre;</span><br><span class="line">			now.t1 = op.at;</span><br><span class="line">			now.t2 = now.t1 + now.top;</span><br><span class="line">			now.t3 = now.t2 + Mtr;</span><br><span class="line">			now.t4 = now.t3 + now.tre;</span><br><span class="line">			now.room = op.id;</span><br><span class="line">			op.at = now.t2 + Mop;</span><br><span class="line">			Top[op.id] += now.top;</span><br><span class="line">			Rop.push(op);</span><br><span class="line">		&#125;</span><br><span class="line">		sort(Info.begin() + <span class="number">1</span>, Info.end(), [](PATIENT&amp; a, PATIENT&amp; b)-&gt;<span class="keyword">bool</span></span><br><span class="line">		&#123;<span class="keyword">if</span> (a.t2 != b.t2) <span class="keyword">return</span> a.t2 &lt; b.t2;<span class="keyword">return</span> a.room &lt; b.room;&#125;);<span class="comment">//Sort by t2</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//For all the recovery rooms</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> N(<span class="number">1</span>);N &lt;= Npa;++N) &#123;</span><br><span class="line">			<span class="function"><span class="keyword">auto</span>&amp; <span class="title">now</span><span class="params">(Info[N])</span></span>;</span><br><span class="line">			<span class="keyword">int</span> re;</span><br><span class="line">			<span class="keyword">for</span> (re = <span class="number">1</span>;re &lt;= Nre;++re)</span><br><span class="line">				<span class="keyword">if</span> (Bre[re] &lt;= now.t2) <span class="keyword">break</span>;</span><br><span class="line">			now.bed = re;</span><br><span class="line">			Bre[re] = now.t4 + Mre;</span><br><span class="line">			Tre[re] += now.tre;</span><br><span class="line">			<span class="keyword">if</span> (Te &lt; now.t4) Te = now.t4;</span><br><span class="line">		&#125;</span><br><span class="line">		sort(Info.begin() + <span class="number">1</span>, Info.end(), [](PATIENT&amp; a, PATIENT&amp; b) &#123;<span class="keyword">return</span> a.id &lt; b.id;&#125;);<span class="comment">//Sort by id</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//Output</span></span><br><span class="line">		opt &lt;&lt; <span class="string">" Patient          Operating Room          Recovery Room\n"</span></span><br><span class="line">			&lt;&lt; <span class="string">" #  Name     Room#  Begin   End      Bed#  Begin    End\n"</span></span><br><span class="line">			&lt;&lt; <span class="string">" ------------------------------------------------------\n"</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> N(<span class="number">1</span>);N &lt;= Npa;++N) &#123;</span><br><span class="line">			<span class="function"><span class="keyword">auto</span>&amp; <span class="title">now</span><span class="params">(Info[N])</span></span>;</span><br><span class="line">			opt &lt;&lt; setw(<span class="number">2</span>) &lt;&lt; N &lt;&lt; <span class="string">"  "</span> &lt;&lt; left &lt;&lt; setw(<span class="number">10</span>) &lt;&lt; now.name &lt;&lt; right &lt;&lt; setw(<span class="number">2</span>)</span><br><span class="line">				&lt;&lt; now.room &lt;&lt; <span class="string">"   "</span> &lt;&lt; time_convert(now.t1) &lt;&lt; <span class="string">"   "</span> &lt;&lt; time_convert(now.t2) &lt;&lt; <span class="string">"     "</span> &lt;&lt; setw(<span class="number">2</span>)</span><br><span class="line">				&lt;&lt; now.bed &lt;&lt; <span class="string">"   "</span> &lt;&lt; time_convert(now.t3) &lt;&lt; <span class="string">"   "</span> &lt;&lt; time_convert(now.t4) &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		opt &lt;&lt; <span class="string">'\n'</span></span><br><span class="line">			&lt;&lt; <span class="string">"Facility Utilization\n"</span></span><br><span class="line">			&lt;&lt; <span class="string">"Type  # Minutes  % Used\n"</span></span><br><span class="line">			&lt;&lt; <span class="string">"-------------------------\n"</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> N(<span class="number">1</span>);N &lt;= Nop;++N) &#123;</span><br><span class="line">			opt &lt;&lt; <span class="string">"Room "</span> &lt;&lt; setw(<span class="number">2</span>) &lt;&lt; N &lt;&lt; setw(<span class="number">8</span>) &lt;&lt; Top[N]</span><br><span class="line">				&lt;&lt; setw(<span class="number">8</span>) &lt;&lt; fixed &lt;&lt; setprecision(<span class="number">2</span>) &lt;&lt; (Top[N] * <span class="number">100.0</span> / (<span class="keyword">float</span>)(Te - Ts)) &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> N(<span class="number">1</span>);N &lt;= Nre;++N) &#123;</span><br><span class="line">			opt &lt;&lt; <span class="string">"Bed  "</span> &lt;&lt; setw(<span class="number">2</span>) &lt;&lt; N &lt;&lt; setw(<span class="number">8</span>) &lt;&lt; Tre[N]</span><br><span class="line">				&lt;&lt; setw(<span class="number">8</span>) &lt;&lt; fixed &lt;&lt; setprecision(<span class="number">2</span>) &lt;&lt; (Tre[N] * <span class="number">100.0</span> / (<span class="keyword">float</span>)(Te - Ts)) &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>分析：终于是本章节的最后一题啦！书上说很难，感觉其实不难啊，就是麻烦了点，写了好久。就是死在了一句话上“If two patients emerge from surgery at the same time, the patient with the lower number will be the first assigned to a recovery room bed.”（就是上面题意里加黑的那句）我还以为指的是患者编号，即患者输入顺序。结果WA。。。udebug上没有数据，不知道问题在哪里。自己做了一套数据发现了错误，百度查了别人的排序逻辑，才发现原来那个the patient with the lower number指的是在门牌号小的手术室做手术的患者。那个number竟然指的门牌号！所以只把sort函数的lambda比较函数改了一小下就AC了。 手术室的模拟使用了优先队列，空一个房间就来一个人，但是恢复床位不能用优先队列。因为恢复床位进入可使用状态最早的不一定是床号最小的，即当有人要转移到床位时可使用床位可能不止一个，和他做完手术的时间有关系。</p>
<p>附：测试数据 <code>10 30 01 16 15 1 30 Jones 90 140 Smith 10 200 Thompson 60 75 Albright 40 82 Poucher 33 209 Comer 10 201 Perry 3 188 Page 111 120 Roggio 69 100 Brigham 42 79 Nute 22 71 Young 38 50 Bush 26 40 Cates 120 32 Johnson 10 2 Jones 28 140 Smith 120 200 Thompson 23 75 Albright 19 82 Poucher 133 209 Comer 74 101 Perry 93 188 Page 111 223 Roggio 69 122 Brigham 42 79 Nute 22 71 Young 38 140 Bush 26 121 Cates 120 248 Johnson 10 50</code></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-15UVa12333 - Revenge of Fibonacci</title>
    <url>/posts/46172.html</url>
    <content><![CDATA[<p>题意：在前100000个Fibonacci（以下简称F）数字里，能否在这100000个F里找出以某些数字作为开头的F。要求找出下标最小的。没找到输出-1。</p>
<hr>
<p>代码：（Accepted，0.250s） <figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa12333 - Revenge of Fibonacci</span></span><br><span class="line"><span class="comment">//Accepted 0.250s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#include&lt;iostream&gt;</span></span><br><span class="line"><span class="meta">#include&lt;cstring&gt;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXS 0xffffff</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CIN 50</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="title">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> EACH_DIGIT &#123;</span><br><span class="line">	<span class="keyword">int</span> id;</span><br><span class="line">	<span class="keyword">bool</span> flag;</span><br><span class="line">	EACH_DIGIT* next[<span class="number">10</span>];<span class="comment">//0~9</span></span><br><span class="line">&#125;nodes[MAXS];</span><br><span class="line"><span class="keyword">class</span> <span class="title">DIC_TREE</span> &#123;</span><br><span class="line">	<span class="keyword">int</span> index;</span><br><span class="line">	EACH_DIGIT* ini;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	DIC_TREE() :index(<span class="number">0</span>), ini(nodes) &#123;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">insert</span>(<span class="params"><span class="keyword">const</span> <span class="keyword">int</span>* F, <span class="keyword">int</span> d, <span class="keyword">const</span> <span class="keyword">int</span>&amp; n</span>)</span> &#123;</span><br><span class="line">		EACH_DIGIT* p(ini);</span><br><span class="line">		<span class="function"><span class="keyword">int</span> <span class="title">brk</span>(<span class="params">d &gt; <span class="number">41</span> ? d - <span class="number">41</span> : <span class="number">0</span></span>)</span>;</span><br><span class="line">		<span class="keyword">while</span> (d-- &gt; brk) &#123;</span><br><span class="line">			<span class="keyword">if</span> (p-&gt;next[F[d]] == nullptr)</span><br><span class="line">				p-&gt;next[F[d]] = nodes + (++index);</span><br><span class="line">			<span class="keyword">if</span> (!p-&gt;flag &amp;&amp; !p-&gt;id) p-&gt;id = n;</span><br><span class="line">			p = p-&gt;next[F[d]];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!p-&gt;flag) p-&gt;flag = <span class="literal">true</span>, p-&gt;id = n;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">search</span>(<span class="params"><span class="keyword">const</span> <span class="keyword">int</span>* F</span>)</span> &#123;</span><br><span class="line">		EACH_DIGIT* p(ini);</span><br><span class="line">		<span class="keyword">for</span> (<span class="function"><span class="keyword">int</span> <span class="title">i</span>(<span class="params"><span class="number">0</span></span>)</span>;F[i] != <span class="number">-1</span>;++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (p-&gt;next[F[i]] == nullptr) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">			p = p-&gt;next[F[i]];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> p-&gt;id;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;dic;</span><br><span class="line"><span class="keyword">int</span> Fnum[<span class="number">2</span>][<span class="number">21000</span>];<span class="comment">//In average, Fibonacci numbers in each digit is about 5, 21000 &gt; (100000/5)</span></span><br><span class="line"><span class="keyword">int</span> T, N, SN[CIN];</span><br><span class="line"><span class="keyword">char</span> S[CIN];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#ifdef _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 66666)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, stdin);</span><br><span class="line">	<span class="comment">//freopen("out.txt", "w", stdout);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	memset(Fnum, <span class="number">0</span>, <span class="keyword">sizeof</span>(Fnum));</span><br><span class="line">	memset(nodes, <span class="number">0</span>, <span class="keyword">sizeof</span>(nodes));</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">dgt</span>(<span class="params"><span class="number">1</span></span>)</span>;</span><br><span class="line">	Fnum[<span class="number">0</span>][<span class="number">0</span>] = Fnum[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	dic.insert(Fnum[<span class="number">0</span>], dgt, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="function"><span class="keyword">int</span> <span class="title">n</span>(<span class="params"><span class="number">2</span></span>)</span>;n &lt; <span class="number">100000</span>;++n) &#123;</span><br><span class="line">		<span class="function"><span class="keyword">int</span> <span class="title">two</span>(<span class="params">n % <span class="number">2</span></span>), <span class="title">one</span>(<span class="params">(two + <span class="number">1</span></span>) % 2)</span>;<span class="comment">//two:F(n-2)(also means the place of F(n))	one:F(n-1)</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="function"><span class="keyword">int</span> <span class="title">i</span>(<span class="params">dgt &lt; <span class="number">51</span> ? <span class="number">0</span> : dgt - <span class="number">51</span></span>)</span>;i &lt; dgt;++i)</span><br><span class="line">			<span class="keyword">if</span> ((Fnum[two][i] += Fnum[one][i])&gt;<span class="number">9</span>)</span><br><span class="line">				Fnum[two][i] -= <span class="number">10</span>, Fnum[two][i + <span class="number">1</span>] += <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (Fnum[two][dgt]) ++dgt;</span><br><span class="line">		dic.insert(Fnum[two], dgt, n);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (scanf(<span class="string">"%d"</span>, &amp;T) != EOF)<span class="comment">//Start to handle cases </span></span><br><span class="line">		<span class="keyword">for</span> (N = <span class="number">1</span>;N &lt;= T;++N) &#123;</span><br><span class="line">			scanf(<span class="string">"%s"</span>, S);</span><br><span class="line">			<span class="function"><span class="keyword">int</span> <span class="title">i</span>(<span class="params"><span class="number">0</span></span>)</span>;</span><br><span class="line">			<span class="keyword">for</span> (;S[i];++i) SN[i] = S[i] - <span class="number">48</span>;</span><br><span class="line">			SN[i] = <span class="number">-1</span>;</span><br><span class="line">			printf(<span class="string">"Case #%d: %d\n"</span>, N, dic.search(SN));</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>分析：暴力求出前100000个F数字的话妥妥地超时。我一开始也想只取前面多少位以减少计算，担心出现99999...999什么什么的情况，导致精度不对，但看网上取50位的都过了，那就不虚了。 思路是用树的结构，每一位数（next）为一个结点，每个结点还储存“遍历到当前位数时满足的最小的F下标（index）”。若某个F刚好遍历到当前结点时结束，则修改当前结点index为当下F下标，并将其置为不可修改状态（flag:=true;）。若F遍历到当前还未结束，则若当前下标小于已储存下标且flag=false，则修改当前index。其实很好理解，但我好像说的不太清楚。 这题并没用到STL，看网上也是这样。数据结构的组建参考了 http://blog.csdn.net/a197p/article/details/44170921 。真的只是大概的看两眼那两个结构体，看了两眼想自己思考实现出来，但最后自己实现出来发现结构体里的变量和他的一样，最好的实现方法也只能是这样。最神奇的是甚至insert函数和search（他的query）函数和我的都和他写的一样—。— 但是他的代码就是0.130s，而我的时间是他的两倍，明明差不多我却没找出多在哪里。但是大神的代码里有好多巧妙的地方，比如他的 <code>tnode dict[nodesize];//line 14</code> <code>tnode* newnode() { return &amp;dict[size++]; }//line 31</code> 这样就免去了每次都new，节约时间还免去了delete的烦恼，厉害了。于是毫不犹豫抄过来。再比如他的 <code>memset(dict,0,sizeof(dict));//line 28</code> 我一开始是在<code>struct EACH_DIGIT</code> 里面写了个构造函数 <code>EACH_DIGIT():flag(0),id(0){memset(next,NULL,sizeof(next));}</code> 但是发现他一个memset全设为0和我效果不是一样的嘛。刷过去还快。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-14UVa1598 - Exchange</title>
    <url>/posts/554.html</url>
    <content><![CDATA[<p>题意：模拟买卖，当出售价bid等于或低于出售价ask，则交易。</p>
<hr>
<p>代码：（Accepted，0.330s）</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1598 - Exchange</span></span><br><span class="line"><span class="comment">//Accepted 0.330s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">struct INFO &#123; <span class="keyword">char</span> type; <span class="keyword">int</span> <span class="built_in">size</span>, price; &#125;for_push_back;</span><br><span class="line"><span class="keyword">int</span> N, T(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">char</span> type[<span class="number">20</span>];</span><br><span class="line">vector&lt;INFO&gt; LIST;						<span class="comment">//key: buy/ask id,	value: type, size</span></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, set&lt;<span class="keyword">int</span>&gt;, greater&lt;<span class="keyword">int</span>&gt; &gt; BUY;	<span class="comment">//key: bid price,	value: id</span></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, set&lt;<span class="keyword">int</span>&gt;, less&lt;<span class="keyword">int</span>&gt; &gt; SELL;	<span class="comment">//key: ask price,	value: id</span></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; BUY_VAL;					<span class="comment">//key: bid price,	value: size</span></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; SELL_VAL;					<span class="comment">//key: ask price,	value: size</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">int</span> sum(set&lt;<span class="keyword">int</span>&gt;&amp; now) &#123;</span><br><span class="line">	<span class="keyword">int</span> re(<span class="number">0</span>);</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : now) re += LIST[r].<span class="built_in">size</span>;</span><br><span class="line">	<span class="built_in">return</span> re;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> trade(<span class="keyword">bool</span> flag) &#123;</span><br><span class="line">	<span class="keyword">int</span> bid_size, bid_price, ask_size, ask_price;</span><br><span class="line">	<span class="built_in">while</span> (true) &#123;</span><br><span class="line">		<span class="keyword">auto</span> bid(BUY.<span class="built_in">begin</span>()), ask(SELL.<span class="built_in">begin</span>());</span><br><span class="line">		<span class="built_in">if</span> (bid == BUY.<span class="built_in">end</span>()) bid_size = <span class="number">0</span>, bid_price = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">else</span> bid_size = BUY_VAL[bid-&gt;first], bid_price = bid-&gt;first;</span><br><span class="line">		<span class="built_in">if</span> (ask == SELL.<span class="built_in">end</span>()) ask_size = <span class="number">0</span>, ask_price = <span class="number">999999</span>;</span><br><span class="line">		<span class="built_in">else</span> ask_size = SELL_VAL[ask-&gt;first], ask_price = ask-&gt;first;</span><br><span class="line">		<span class="built_in">if</span> (bid_price &lt; ask_price) &#123;</span><br><span class="line">			printf(<span class="string">"QUOTE %d %d - %d %d\n"</span>, bid_size, bid_price, ask_size, (ask_price == <span class="number">999999</span> ? <span class="number">99999</span> : ask_price));</span><br><span class="line">			<span class="built_in">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">auto</span> sizeb(LIST[*bid-&gt;second.<span class="built_in">begin</span>()].<span class="built_in">size</span>), sizea(LIST[*ask-&gt;second.<span class="built_in">begin</span>()].<span class="built_in">size</span>);</span><br><span class="line">		<span class="keyword">const</span> <span class="keyword">auto</span> mini(<span class="built_in">min</span>(sizeb, sizea));</span><br><span class="line">		printf(<span class="string">"TRADE %d %d\n"</span>, mini, flag ? ask_price : bid_price);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">auto</span>&amp; b(bid-&gt;second), &amp;a(ask-&gt;second);</span><br><span class="line">		BUY_VAL[bid-&gt;first] -= mini;</span><br><span class="line">		<span class="built_in">if</span> (!b.empty() &amp;&amp; (LIST[*b.<span class="built_in">begin</span>()].<span class="built_in">size</span> -= mini) == <span class="number">0</span>)</span><br><span class="line">			b.erase(b.<span class="built_in">begin</span>());</span><br><span class="line">		<span class="built_in">if</span> (b.empty()) BUY.erase(bid);</span><br><span class="line">		SELL_VAL[ask-&gt;first] -= mini;</span><br><span class="line">		<span class="built_in">if</span> (!a.empty() &amp;&amp; (LIST[*a.<span class="built_in">begin</span>()].<span class="built_in">size</span> -= mini) == <span class="number">0</span>)</span><br><span class="line">			a.erase(a.<span class="built_in">begin</span>());</span><br><span class="line">		<span class="built_in">if</span> (a.empty()) SELL.erase(ask);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 66666)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, stdin);</span><br><span class="line">	freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, stdout);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">while</span> (scanf(<span class="string">"%d"</span>, &amp;N) != EOF) &#123;</span><br><span class="line">		<span class="built_in">if</span> (T++) puts(<span class="string">""</span>);</span><br><span class="line">		LIST.<span class="built_in">clear</span>(), BUY.<span class="built_in">clear</span>(), SELL.<span class="built_in">clear</span>(), BUY_VAL.<span class="built_in">clear</span>(), SELL_VAL.<span class="built_in">clear</span>();</span><br><span class="line">		LIST.push_back(for_push_back);</span><br><span class="line">		<span class="built_in">for</span> (<span class="keyword">int</span> n(<span class="number">1</span>);n &lt;= N;++n) &#123;</span><br><span class="line">			INFO tmp;</span><br><span class="line">			scanf(<span class="string">"%s"</span>, type);</span><br><span class="line">			<span class="built_in">if</span> (*type == <span class="string">'C'</span>) &#123;</span><br><span class="line">				<span class="keyword">int</span> id;</span><br><span class="line">				scanf(<span class="string">"%d"</span>, &amp;id);</span><br><span class="line">				<span class="keyword">auto</span>&amp; csl(LIST[id]);</span><br><span class="line">				<span class="built_in">if</span> (csl.type == <span class="string">'B'</span>) &#123;</span><br><span class="line">					BUY_VAL[csl.price] -= csl.<span class="built_in">size</span>;</span><br><span class="line">					LIST[id].<span class="built_in">size</span> = <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">auto</span>&amp; now(BUY[csl.price]);</span><br><span class="line">					now.erase(id);</span><br><span class="line">					<span class="built_in">if</span> (now.empty()) BUY.erase(csl.price);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">else</span> &#123;</span><br><span class="line">					SELL_VAL[csl.price] -= csl.<span class="built_in">size</span>;</span><br><span class="line">					LIST[id].<span class="built_in">size</span> = <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">auto</span>&amp; now(SELL[csl.price]);</span><br><span class="line">					now.erase(id);</span><br><span class="line">					<span class="built_in">if</span> (now.empty()) SELL.erase(csl.price);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">else</span> &#123;</span><br><span class="line">				tmp.type = *type;</span><br><span class="line">				scanf(<span class="string">"%d%d"</span>, &amp;tmp.<span class="built_in">size</span>, &amp;tmp.price);</span><br><span class="line">				<span class="built_in">if</span> (*type == <span class="string">'B'</span>) BUY[tmp.price].insert(n), BUY_VAL[tmp.price] += tmp.<span class="built_in">size</span>;</span><br><span class="line">				<span class="built_in">else</span> SELL[tmp.price].insert(n), SELL_VAL[tmp.price] += tmp.<span class="built_in">size</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			LIST.push_back(std::<span class="built_in">move</span>(tmp));</span><br><span class="line">			trade(*type == <span class="string">'B'</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>分析：书上推荐使用优先队列，然而并没有想出来怎么去用。想了想还是用了map，用它的begin()，效果一样的，还可以灵活差入数据。一开始老是在某组测试数据上出现Runtime error，搞得生无可恋。<em>（从一老司机学到的新技能：当提交OJ出现RE时（WA也行），在执行每组数据计算的代码末尾加一句“while(1);”再提交如果从RE变成TLE了则说明是某些特殊数据没照顾到。毕竟不是所有OJ都有udebug可以用，这招还是不错的）</em> 然后过了一天还是心里放不下，又回来想了想，是题目中一个细节“If there is no active order to sell, then it is assumed that ask size is zero and ask price is 99 999. Note, that zero is not a legal price, but 99 999 is a legal price. Recipient of quote messages distinguishes actual 99 999 ask price from the special case of absent orders to sell by looking at its ask size.”出了问题。于是把不可交易价格改成999999，与交易最大价格加以99999区分，果然似乎没问题了。然而接下来就有新问题，Time limit exceeded。。。 又过了一天，心里还是放不下，于是去网上查了查别人的代码，他们不仅用两个map存买卖信息，还再单独开辟两个map来存放sell与buy的总size（就相当于我上面那两个<code>BUY_VAL</code> 和 <code>SELL_VAL</code>），而当时我只用了两个map（<code>BUY</code>和<code>SELL</code>）存买卖的所有信息，所以每次查询循环总的size时要经历一个比较烦的循环，就是以下这个循环：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//求当前价格总的size函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;&amp; now)</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">re</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : now) re += LIST[r].size;</span><br><span class="line">	<span class="keyword">return</span> re;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="comment">//trade函数片段</span></span><br><span class="line">auto bid(<span class="module-access"><span class="module"><span class="identifier">BUY</span>.</span></span><span class="keyword">begin</span><span class="literal">()</span>), ask(<span class="module-access"><span class="module"><span class="identifier">SELL</span>.</span></span><span class="keyword">begin</span><span class="literal">()</span>);</span><br><span class="line"><span class="keyword">if</span> (bid<span class="operator"> == </span><span class="module-access"><span class="module"><span class="identifier">BUY</span>.</span></span><span class="keyword">end</span><span class="literal">()</span>) bid_size = <span class="number">0</span>, bid_price = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> bid_size = sum(bid-&gt;second), bid_price = bid-&gt;first;</span><br><span class="line"><span class="keyword">if</span> (ask<span class="operator"> == </span><span class="module-access"><span class="module"><span class="identifier">SELL</span>.</span></span><span class="keyword">end</span><span class="literal">()</span>) ask_size = <span class="number">0</span>, ask_price = <span class="number">999999</span>;</span><br><span class="line"><span class="keyword">else</span> ask_size = sum(ask-&gt;second), ask_price = ask-&gt;first;</span><br></pre></td></tr></table></figure>
<p>这就是超时的罪魁祸首。改进了下瞬间变成0.330s，还是有些出乎意料。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-13UVa822 - Queue and A</title>
    <url>/posts/16231.html</url>
    <content><![CDATA[<p>题意：模拟客服MM，一共有N种话题，每个客服MM支持处理其中的i个（i &lt; N），处理的话题还有优先级。为了简化流程方便出题，设每个话题都是每隔m分钟来咨询一次。现知道每个话题前来咨询的时间、间隔、处理此话题所需的时长与一共有多少次咨询。问多少时间后全部话题处理完成。</p>
<hr>
<p>代码：（Accepted，0.010s） <figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa822 - Queue and A</span></span><br><span class="line"><span class="comment">//Accepted 0.010s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI 2147483647</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">struct T &#123;</span><br><span class="line">	<span class="keyword">int</span> ti;	<span class="comment">//time for per task</span></span><br><span class="line">	queue&lt;<span class="keyword">int</span>&gt; table;</span><br><span class="line">&#125; ttmp;</span><br><span class="line">struct P &#123;</span><br><span class="line">	<span class="keyword">int</span> id, at, st, n, to[<span class="number">22</span>];<span class="comment">//identity, available time, start time of last task, number of topics, topics</span></span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span>&lt; (<span class="keyword">const</span> P&amp; that) <span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="built_in">if</span> (st != that.st) <span class="built_in">return</span> st &lt; that.st;</span><br><span class="line">		<span class="built_in">return</span> id &lt; that.id;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; ptmp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Tpc, Psnl;<span class="comment">//Number of Topics &amp; Personnel</span></span><br><span class="line"><span class="keyword">int</span> name, num, nt, to, Scenario(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 80)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, stdin);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	ptmp.at = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">while</span> (scanf(<span class="string">"%d"</span>, &amp;Tpc) != EOF &amp;&amp; Tpc != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> time(MI), needtime(<span class="number">0</span>);</span><br><span class="line">		<span class="built_in">map</span>&lt;<span class="keyword">int</span>, T&gt; tpc;</span><br><span class="line">		<span class="built_in">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; Tpc;++i) &#123;</span><br><span class="line">			scanf(<span class="string">"%d%d%d%d%d"</span>, &amp;name, &amp;num, &amp;nt, &amp;ttmp.ti, &amp;to);</span><br><span class="line">			<span class="built_in">if</span> (time &gt; nt) time = nt;</span><br><span class="line">			<span class="keyword">auto</span>&amp; now(tpc[name] = ttmp);</span><br><span class="line">			<span class="built_in">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; num;++i)</span><br><span class="line">				now.table.push(nt), nt += to;</span><br><span class="line">		&#125;</span><br><span class="line">		scanf(<span class="string">"%d"</span>, &amp;Psnl);</span><br><span class="line">		vector&lt;P&gt; psnl(Psnl);</span><br><span class="line">		<span class="built_in">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; Psnl;++i) &#123;</span><br><span class="line">			scanf(<span class="string">"%d%d"</span>, &amp;ptmp.id, &amp;ptmp.n);</span><br><span class="line">			<span class="built_in">for</span> (<span class="keyword">int</span> j(<span class="number">0</span>);j &lt; ptmp.n;++j)</span><br><span class="line">				scanf(<span class="string">"%d"</span>, ptmp.to + j);</span><br><span class="line">			psnl[i] = ptmp;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">while</span> (Tpc) &#123;</span><br><span class="line">			<span class="keyword">int</span> jumpt = MI;<span class="comment">//Jump time to the earliest possible available time of all the men</span></span><br><span class="line">			sort(psnl.<span class="built_in">begin</span>(), psnl.<span class="built_in">end</span>());</span><br><span class="line">			<span class="built_in">for</span> (<span class="keyword">auto</span>&amp; p : psnl) &#123;<span class="comment">//For all staff members</span></span><br><span class="line">				<span class="keyword">int</span> pti(MI);<span class="comment">//Man's earliest possible available time</span></span><br><span class="line">				<span class="built_in">if</span> (p.at &gt; time) pti = p.at;<span class="comment">//Man is busy</span></span><br><span class="line">				<span class="built_in">else</span> &#123;						<span class="comment">//Man is available</span></span><br><span class="line">					<span class="built_in">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; p.n;++i) &#123;<span class="comment">//For all topics that man can handle</span></span><br><span class="line">						<span class="keyword">auto</span>&amp; t(tpc[p.to[i]]);</span><br><span class="line">						<span class="built_in">if</span> (t.table.empty()) <span class="built_in">continue</span>;							<span class="comment">//Man find current topic finished</span></span><br><span class="line">						<span class="built_in">if</span> (t.table.front() &lt;= time) &#123;							<span class="comment">//Man find his topic</span></span><br><span class="line">							pti = time + t.ti;</span><br><span class="line">							<span class="built_in">if</span> (needtime &lt; pti) needtime = pti;</span><br><span class="line">							p.st = time;</span><br><span class="line">							t.table.pop();</span><br><span class="line">							<span class="built_in">if</span> (t.table.empty()) --Tpc;</span><br><span class="line">							<span class="built_in">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						<span class="built_in">else</span> <span class="built_in">if</span> (t.table.front() &lt; pti) pti = t.table.front();	<span class="comment">//Man find current topic will be available at t.table.front()</span></span><br><span class="line">					&#125;</span><br><span class="line">					p.at = pti;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">if</span> (pti &lt; jumpt) jumpt = pti;</span><br><span class="line">			&#125;</span><br><span class="line">			time = jumpt;</span><br><span class="line">		&#125;</span><br><span class="line">		printf(<span class="string">"Scenario %d: All requests are serviced within %d minutes.\n"</span>, ++Scenario, needtime);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>分析：每分钟每分钟的模拟的话就有点慢了。我的做法是： 对每个topic，把它们每次过来询问的时间放在queue里，每开始处理一件就pop一件，直到它empty则说明处理完毕。 对每个员工，找出他的下一次“开始空闲”或“可能有事情做”的时间pti。所谓“开始空闲”或“可能有事情做”的时间是指：</p>
<ol type="1">
<li>若这人正在处理一个topic，则pti=处理完本topic的时间，这叫“开始空闲”；</li>
<li>若这人闲着，则给他找活干，若找到了可处理topic，pti=处理完这个topic的时间，也是“开始空闲”；</li>
<li>若这人闲着，但发现无活可干，每个他可以处理的topic都还没到来，那么他的pti=最快到来的下一个topic的时间，即只有topic来了他才可能“可能有事情做”。之所以是“可能”，因为每次都要按照“上一次开始干活的时间与ID”把每个人排序，所以他的活可能被抢，依然是“无事可干”状态。</li>
<li>pti初始化时为int的最大值。只有当该员工的每个topic全都处理完的状态时，pti全程没有被赋值，于是该员工的下一个空闲时间变成无限大，一定程度上相当于以后的模拟运算就不考虑他了。</li>
</ol>
<p>找出了每个人的pti，让时间跳转到最近的一个pti，进行下一次循环（要注意的是time最终跳出循环时可能不等于所需时间，所以又定义了个needtime）。</p>
<p><strong>这题最坑的是，udebug的算法是错误的</strong>(⊙﹏⊙)。它的数据答案我死活对不上，害的我调试了好几天。。。后来去网上找别人的算法，发现结果和udebug也一大半数据对不上。但是提交后就AC了。（这uva的数据也比较水，udebug上的100个测试数据我运算了蛮慢的，但提交上去就0.010s。不过开心的是我的运算比网上找的那几个算法都快。）</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-12UVa511 - Do You Know the Way to San Jose</title>
    <url>/posts/6720.html</url>
    <content><![CDATA[<p>题意：N张地图，查找某地点在不在某些地图上，若在，使用细节多的地图。使用哪个地图的破要求挺多，细心一点就好。</p>
<hr>
<p>代码：（Accepted，0.000s） <figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa511 - Do You Know the Way to San Jose?</span></span><br><span class="line"><span class="comment">//Accepted 0.000s</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EPS 1e-7</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mapdat</span> &#123;</span></span><br><span class="line">	<span class="keyword">float</span> area,ratio, midx, midy, x1, y1, x2, y2;</span><br><span class="line">	<span class="keyword">int</span> level;</span><br><span class="line">	<span class="built_in">string</span> name;</span><br><span class="line">	mapdat(<span class="keyword">char</span>* n, <span class="keyword">float</span>&amp; t1, <span class="keyword">float</span>&amp; t2, <span class="keyword">float</span>&amp; t3, <span class="keyword">float</span>&amp; t4) :name(n), midx((t1 + t3) / <span class="number">2</span>), midy((t2 + t4) / <span class="number">2</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (t1 &lt; t3) x1 = t1, x2 = t3;</span><br><span class="line">		<span class="keyword">else</span> x1 = t3, x2 = t1;</span><br><span class="line">		<span class="keyword">if</span> (t2 &lt; t4) y1 = t2, y2 = t4;</span><br><span class="line">		<span class="keyword">else</span> y1 = t4, y2 = t2;</span><br><span class="line">		area = (x2 - x1)*(y2 - y1);</span><br><span class="line">		ratio = (<span class="keyword">float</span>)<span class="built_in">fabs</span>((y2 - y1) / (x2 - x1) - <span class="number">0.75</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">findloc</span><span class="params">(<span class="keyword">const</span> mapdat&amp; m, <span class="keyword">float</span>&amp; x, <span class="keyword">float</span>&amp; y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x &gt; m.x1&amp;&amp;x&lt;m.x2&amp;&amp;y&gt;m.y1&amp;&amp;y &lt; m.y2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">float</span> <span class="title">dist</span><span class="params">(<span class="keyword">const</span> mapdat&amp; m, <span class="keyword">float</span>&amp; x, <span class="keyword">float</span>&amp; y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (x - m.midx)*(x - m.midx) + (y - m.midy)*(y - m.midy);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;mapdat&gt; maps;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, pair&lt;<span class="keyword">float</span>, <span class="keyword">float</span>&gt; &gt; locs;</span><br><span class="line"><span class="keyword">char</span> stmp[<span class="number">80</span>];</span><br><span class="line"><span class="keyword">int</span> l, lev(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">float</span> t1, t2, t3, t4;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 80)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	gets(stmp);</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%s"</span>, stmp) != EOF &amp;&amp; <span class="built_in">strcmp</span>(stmp, <span class="string">"LOCATIONS"</span>)) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%f%f%f%f"</span>, &amp;t1, &amp;t2, &amp;t3, &amp;t4);</span><br><span class="line">		maps.push_back(mapdat(stmp, t1, t2, t3, t4));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	sort(maps.begin(), maps.end(), [](mapdat&amp; a, mapdat&amp; b) &#123;<span class="keyword">return</span> a.area &gt; b.area;&#125;);</span><br><span class="line">	<span class="function"><span class="keyword">float</span> <span class="title">a</span><span class="params">(<span class="number">-1.0</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; r : maps) &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">fabs</span>(r.area - a)&gt;EPS)</span><br><span class="line">			r.level = ++lev, a = r.area;</span><br><span class="line">		<span class="keyword">else</span> r.level = lev;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//for (auto&amp; r : maps) cout &lt;&lt; r.level &lt;&lt; ' ' &lt;&lt; r.name &lt;&lt; '\t' &lt;&lt; r.midx &lt;&lt; ' ' &lt;&lt; r.midy &lt;&lt; ' ' &lt;&lt; r.area &lt;&lt; endl;//</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%s"</span>, stmp) != EOF &amp;&amp; <span class="built_in">strcmp</span>(stmp, <span class="string">"REQUESTS"</span>)) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%f%f"</span>, &amp;t1, &amp;t2);</span><br><span class="line">		locs[stmp] = make_pair(t1, t2);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%s"</span>, stmp) != EOF &amp;&amp; <span class="built_in">strcmp</span>(stmp, <span class="string">"END"</span>)) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;l);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%s at detail level %d "</span>, stmp, l);</span><br><span class="line">		<span class="function"><span class="keyword">auto</span> <span class="title">nowloc</span><span class="params">(locs.find(stmp))</span></span>;</span><br><span class="line">		<span class="keyword">if</span> (nowloc == locs.end()) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"unknown location\n"</span>);</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">vector</span>&lt;mapdat&gt; m,nm;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : maps)</span><br><span class="line">			<span class="keyword">if</span> (findloc(r, nowloc-&gt;second.first, nowloc-&gt;second.second))</span><br><span class="line">				<span class="keyword">if</span>(r.level!=l)m.push_back(r);</span><br><span class="line">				<span class="keyword">else</span> nm.push_back(r);</span><br><span class="line">		<span class="keyword">if</span> (m.empty()) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"no map contains that location\n"</span>);</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">auto</span> cmp = [&amp;nowloc](mapdat&amp; a, mapdat&amp; b)-&gt;<span class="keyword">bool</span> &#123;</span><br><span class="line">			<span class="keyword">auto</span>&amp; X(nowloc-&gt;second.first),&amp; Y(nowloc-&gt;second.second);</span><br><span class="line">			<span class="keyword">if</span> (a.level != b.level) <span class="keyword">return</span> a.level &gt; b.level;</span><br><span class="line">			auto da(dist(a, X, Y)),db(dist(b, X, Y));</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">fabs</span>(da - db) &gt; EPS) <span class="keyword">return</span> da &lt; db;</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">fabs</span>(a.ratio - b.ratio) &gt; EPS) <span class="keyword">return</span> a.ratio &lt; b.ratio;</span><br><span class="line">			da = (X - a.x2)*(X - a.x2) + (Y - a.y1)*(Y - a.y1);</span><br><span class="line">			db = (X - b.x2)*(X - b.x2) + (Y - b.y1)*(Y - b.y1);</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">fabs</span>(db - da) &gt; EPS) <span class="keyword">return</span> da &gt; db;</span><br><span class="line">			<span class="keyword">return</span> a.x1 &lt; b.x1;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">if</span> (nm.empty()) &#123;</span><br><span class="line">			sort(m.begin(), m.end(), cmp);</span><br><span class="line">			<span class="keyword">if</span> (m[<span class="number">0</span>].level &lt; l) <span class="built_in">printf</span>(<span class="string">"no map at that detail level; "</span>);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"using %s\n"</span>, m[<span class="number">0</span>].name.c_str());</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		sort(nm.begin(), nm.end(), cmp);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"using %s\n"</span>, nm[<span class="number">0</span>].name.c_str());</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>分析：状态不好没认真编，编的比较乱比较丑。还没开始优化，想着先提交个试试，结果这也0.000s通过了。。。看来数据比较水。那就不改动不优化了。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-11UVa12504 - Updating a Dictionary</title>
    <url>/posts/27478.html</url>
    <content><![CDATA[<p>题意：对比新老字典的区别：内容多了、少了还是修改了。</p>
<hr>
<p>代码：（Accepted，0.000s）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa12504 - Updating a Dictionary</span></span><br><span class="line"><span class="comment">//#define _XieNaoban_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XieNaoban_</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">	<span class="built_in">cin</span>.ignore();</span><br><span class="line">	<span class="keyword">while</span> (T--) &#123;</span><br><span class="line">		<span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; dic;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i(<span class="number">0</span>);i &lt; <span class="number">2</span>;++i) &#123;</span><br><span class="line">			<span class="built_in">string</span> line, key, value;</span><br><span class="line">			getline(<span class="built_in">cin</span>, line);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;r : line)</span><br><span class="line">				<span class="keyword">if</span> (r == <span class="string">','</span> || r == <span class="string">':'</span> || r == <span class="string">'&#123;'</span> || r == <span class="string">'&#125;'</span>) r = <span class="string">' '</span>;</span><br><span class="line">			<span class="function"><span class="built_in">istringstream</span> <span class="title">in</span><span class="params">(line)</span></span>;</span><br><span class="line">			<span class="keyword">while</span> (in &gt;&gt; key) &#123;</span><br><span class="line">				in &gt;&gt; value;</span><br><span class="line">				<span class="keyword">if</span> (i) &#123;</span><br><span class="line">					<span class="function"><span class="keyword">auto</span> <span class="title">d</span><span class="params">(dic.find(key))</span></span>;</span><br><span class="line">					<span class="keyword">if</span> (d != dic.end()) &#123;</span><br><span class="line">						<span class="keyword">if</span> (d-&gt;second != value) d-&gt;second = <span class="string">"*"</span>;<span class="comment">//changed</span></span><br><span class="line">						<span class="keyword">else</span> d-&gt;second = <span class="string">'&amp;'</span>;<span class="comment">//not changed</span></span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span> dic[key] = <span class="string">"+"</span>;<span class="comment">//increased</span></span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> dic[key] = value;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; inc, rmv, chg;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : dic)</span><br><span class="line">			<span class="keyword">switch</span> (r.second[<span class="number">0</span>])</span><br><span class="line">			&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'+'</span>: inc.push_back(r.first);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'*'</span>: chg.push_back(r.first);<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'&amp;'</span>: <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:  rmv.push_back(r.first);<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">if</span> (inc.empty() &amp;&amp; rmv.empty() &amp;&amp; chg.empty())</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">"No changes\n"</span>;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (!inc.empty()) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">'+'</span> &lt;&lt; inc[<span class="number">0</span>];</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">auto</span> i(inc.begin() + <span class="number">1</span>);i != inc.end();++i)</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="string">','</span> &lt;&lt; *i;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (!rmv.empty()) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">'-'</span> &lt;&lt; rmv[<span class="number">0</span>];</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">auto</span> i(rmv.begin() + <span class="number">1</span>);i != rmv.end();++i)</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="string">','</span> &lt;&lt; *i;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (!chg.empty()) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">'*'</span> &lt;&lt; chg[<span class="number">0</span>];</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">auto</span> i(chg.begin() + <span class="number">1</span>);i != chg.end();++i)</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="string">','</span> &lt;&lt; *i;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>分析：这题很水，轻松AC，没啥好说的。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>ACMICPC 2016北京赛站网络赛 第1题 第3题</title>
    <url>/posts/14358.html</url>
    <content><![CDATA[<p>第一次玩ACM。。。有点小紧张小兴奋。这题目好难啊，只是网赛就这么难。。。只把最简单的两题做出来了。</p>
<p>题目１： <img src="/posts/14358/20160924193953861.png" alt="这里写图片描述"></p>
<hr>
<p>代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//#define _ACM_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> line[<span class="number">111</span>], word[<span class="number">111</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">T</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CAT</span>&#123;</span></span><br><span class="line">	<span class="comment">//string N;			//name of current category</span></span><br><span class="line">	<span class="built_in">map</span>&lt;<span class="built_in">string</span>, CAT&gt; C;	<span class="comment">//categorys</span></span><br><span class="line">	<span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt; B;		<span class="comment">//books</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> sp)</span> <span class="keyword">const</span></span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;r : C) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; sp;++i) <span class="built_in">printf</span>(<span class="string">"    "</span>);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%s\n"</span>, r.first.c_str());</span><br><span class="line">			r.second.show(sp+<span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;r : B) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; sp;++i) <span class="built_in">printf</span>(<span class="string">"    "</span>);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%s\n"</span>, r.c_str());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _ACM_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 111)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (gets(line)) &#123;</span><br><span class="line">		<span class="built_in">map</span>&lt;<span class="built_in">string</span>, CAT&gt; cat;</span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			<span class="function">CAT* <span class="title">pc</span><span class="params">(<span class="literal">NULL</span>)</span></span>;</span><br><span class="line">			<span class="function"><span class="keyword">char</span> *<span class="title">p</span><span class="params">(word)</span></span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">char</span> *pl(line);*pl != <span class="string">'\0'</span>;++pl) &#123;</span><br><span class="line">				<span class="keyword">if</span> (*pl != <span class="string">'/'</span>) *p++ = *pl;</span><br><span class="line">				<span class="keyword">else</span> &#123;</span><br><span class="line">					*p = <span class="string">'\0'</span>;p = word;</span><br><span class="line">					<span class="keyword">if</span> (pc == <span class="literal">NULL</span>) pc = &amp;cat[word];</span><br><span class="line">					<span class="keyword">else</span> pc = &amp;(pc-&gt;C[word]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			*p = <span class="string">'\0'</span>;</span><br><span class="line">			pc-&gt;B.insert(word);</span><br><span class="line">		&#125; <span class="keyword">while</span> (gets(line) &amp;&amp; <span class="built_in">strcmp</span>(line, <span class="string">"0"</span>));</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Case %d:\n"</span>, ++T);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;r : cat) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%s\n"</span>, r.first.c_str());</span><br><span class="line">			r.second.show(<span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>题目３： <img src="/posts/14358/20160924194202264.png" alt="这里写图片描述"></p>
<hr>
<p>代码： <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//#define _ACM_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isch</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123; <span class="keyword">return</span> c &gt;= <span class="string">'a'</span> &amp;&amp; c &lt;= <span class="string">'z'</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> ch, line[<span class="number">555</span>], word[<span class="number">555</span>];</span><br><span class="line"><span class="built_in">string</span> pr;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">unsigned</span>&gt; phs;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _ACM_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 555)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">	ch = getchar();</span><br><span class="line">	<span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">		<span class="function"><span class="keyword">char</span> *<span class="title">p</span><span class="params">(word)</span></span>;</span><br><span class="line">		<span class="keyword">while</span> (isch(ch)) &#123;</span><br><span class="line">			*p++ = ch;</span><br><span class="line">			ch = getchar();</span><br><span class="line">		&#125;</span><br><span class="line">		*p = <span class="string">'\0'</span>;</span><br><span class="line">		<span class="function"><span class="keyword">bool</span> <span class="title">ispunc</span><span class="params">(<span class="literal">false</span>)</span></span>;</span><br><span class="line">		<span class="keyword">while</span> (ch != EOF &amp;&amp; !isch(ch) &amp;&amp; ch != <span class="string">'#'</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (ch == <span class="string">','</span> || ch == <span class="string">'.'</span> || ch == <span class="string">'\n'</span>) ispunc = <span class="literal">true</span>;</span><br><span class="line">			ch = getchar();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (ch == EOF) <span class="keyword">break</span>;<span class="comment">//the end of test file</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (ch == <span class="string">'#'</span>) &#123;<span class="comment">//the end of current text</span></span><br><span class="line">			<span class="keyword">if</span> (!pr.empty()) ++phs[pr + <span class="string">' '</span> + word];</span><br><span class="line">			<span class="keyword">if</span> (ispunc) pr.clear();</span><br><span class="line">			<span class="keyword">else</span> pr = word;</span><br><span class="line">			<span class="keyword">unsigned</span> maxu = <span class="number">0</span>;</span><br><span class="line">			<span class="built_in">string</span> maxs;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : phs)</span><br><span class="line">				<span class="keyword">if</span> (r.second &gt; maxu) maxu = r.second, maxs = r.first;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%s:%u\n"</span>, maxs.c_str(), maxu);</span><br><span class="line">			phs.clear(), pr.clear();</span><br><span class="line">			getchar(), getchar(), getchar(), getchar();</span><br><span class="line">			ch = getchar();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;<span class="comment">//find a word/phrase</span></span><br><span class="line">			<span class="keyword">if</span> (!pr.empty()) ++phs[pr + <span class="string">' '</span> + word];</span><br><span class="line">			<span class="keyword">if</span> (ispunc) pr.clear();</span><br><span class="line">			<span class="keyword">else</span> pr = word;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>ACM</category>
      </categories>
      <tags>
        <tag>ACM</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-10UVa1597 - Searching the Web</title>
    <url>/posts/651.html</url>
    <content><![CDATA[<p>题意：不难理解，照搬题意的解法。</p>
<hr>
<p>代码：（Accepted，0.190s）</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1597 - Searching the Web</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">string</span>, set&lt;<span class="keyword">unsigned</span>&gt; &gt; <span class="keyword">word</span>;</span><br><span class="line"><span class="keyword">char</span> lines[<span class="number">1510</span>][<span class="number">85</span>];</span><br><span class="line"><span class="keyword">unsigned</span> N, M, la[<span class="number">105</span>], ln(<span class="number">1</span>);<span class="comment">//la:last line of the article; ln:line number</span></span><br><span class="line"><span class="keyword">char</span> tmpword[<span class="number">80</span>], tmpline[<span class="number">88</span>], w1[<span class="number">80</span>], w2[<span class="number">80</span>], w3[<span class="number">80</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> ONLY(<span class="keyword">bool</span>&amp; flag, <span class="keyword">const</span> <span class="keyword">string</span>&amp; on) &#123;</span><br><span class="line">	<span class="keyword">auto</span> &amp;t(<span class="keyword">word</span>[on]);</span><br><span class="line">	<span class="keyword">auto</span> p(t.<span class="built_in">begin</span>());</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">unsigned</span> i(<span class="number">1</span>);i &lt;= N;++i) &#123;</span><br><span class="line">		<span class="built_in">while</span> (p != t.<span class="built_in">end</span>() &amp;&amp; *p &lt; la[i - <span class="number">1</span>]) ++p;</span><br><span class="line">		<span class="built_in">if</span> (p != t.<span class="built_in">end</span>() &amp;&amp; *p &lt; la[i]) &#123;</span><br><span class="line">			<span class="built_in">if</span> (flag) puts(<span class="string">"----------"</span>);</span><br><span class="line">			<span class="built_in">else</span> flag = true;</span><br><span class="line">			<span class="built_in">while</span> (p != t.<span class="built_in">end</span>() &amp;&amp; *p &lt; la[i])</span><br><span class="line">				puts(lines[*p++]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> NOT(<span class="keyword">bool</span>&amp; flag, <span class="keyword">const</span> <span class="keyword">string</span>&amp; on) &#123;</span><br><span class="line">	<span class="keyword">auto</span> &amp;t(<span class="keyword">word</span>[on]);</span><br><span class="line">	<span class="keyword">auto</span> p(t.<span class="built_in">begin</span>());</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">unsigned</span> i(<span class="number">0</span>);i &lt; N;++i) &#123;</span><br><span class="line">		<span class="built_in">while</span> (p != t.<span class="built_in">end</span>() &amp;&amp; *p &lt; la[i]) ++p;</span><br><span class="line">		<span class="built_in">if</span> (p == t.<span class="built_in">end</span>() || *p &gt;= la[i + <span class="number">1</span>]) &#123;</span><br><span class="line">			<span class="built_in">if</span> (flag) puts(<span class="string">"----------"</span>);</span><br><span class="line">			<span class="built_in">else</span> flag = true;</span><br><span class="line">			<span class="built_in">for</span> (<span class="keyword">auto</span> j(la[i]);j &lt; la[i + <span class="number">1</span>];++j)</span><br><span class="line">				puts(lines[j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> AND(<span class="keyword">bool</span>&amp; flag, <span class="keyword">const</span> <span class="keyword">string</span>&amp; le, <span class="keyword">const</span> <span class="keyword">string</span>&amp; ri) &#123;</span><br><span class="line">	<span class="keyword">auto</span> &amp;t1(<span class="keyword">word</span>[le]), &amp;t2(<span class="keyword">word</span>[ri]);</span><br><span class="line">	<span class="keyword">auto</span> p1(t1.<span class="built_in">begin</span>()),</span><br><span class="line">		p2(t2.<span class="built_in">begin</span>());</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">unsigned</span> i(<span class="number">1</span>);i &lt;= N;++i) &#123;</span><br><span class="line">		<span class="built_in">while</span> (p1 != t1.<span class="built_in">end</span>() &amp;&amp; *p1 &lt; la[i - <span class="number">1</span>]) ++p1;</span><br><span class="line">		<span class="built_in">while</span> (p2 != t2.<span class="built_in">end</span>() &amp;&amp; *p2 &lt; la[i - <span class="number">1</span>]) ++p2;</span><br><span class="line">		<span class="built_in">if</span> ((p1 != t1.<span class="built_in">end</span>() &amp;&amp; *p1 &lt; la[i]) &amp;&amp;</span><br><span class="line">			(p2 != t2.<span class="built_in">end</span>() &amp;&amp; *p2 &lt; la[i])) &#123;</span><br><span class="line">			<span class="built_in">if</span> (flag) puts(<span class="string">"----------"</span>);</span><br><span class="line">			<span class="built_in">else</span> flag = true;</span><br><span class="line">			<span class="keyword">unsigned</span> re;</span><br><span class="line">			<span class="built_in">while</span> ((p1 != t1.<span class="built_in">end</span>() &amp;&amp; *p1 &lt; la[i]) ||</span><br><span class="line">				(p2 != t2.<span class="built_in">end</span>() &amp;&amp; *p2 &lt; la[i])) &#123;</span><br><span class="line">				<span class="built_in">if</span> (p1 == t1.<span class="built_in">end</span>() || *p1 &gt;= la[i]) re = *p2++;</span><br><span class="line">				<span class="built_in">else</span> <span class="built_in">if</span> (p2 == t2.<span class="built_in">end</span>() || *p2 &gt;= la[i]) re = *p1++;</span><br><span class="line">				<span class="built_in">else</span> <span class="built_in">if</span> (*p2 &gt; *p1) re = *p1++;</span><br><span class="line">				<span class="built_in">else</span> <span class="built_in">if</span> (*p2 &lt; *p1) re = *p2++;</span><br><span class="line">				<span class="built_in">else</span> re = *p1++, *p2++;</span><br><span class="line">				puts(lines[re]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> OR(<span class="keyword">bool</span>&amp; flag, <span class="keyword">const</span> <span class="keyword">string</span>&amp; le, <span class="keyword">const</span> <span class="keyword">string</span>&amp; ri) &#123;</span><br><span class="line">	<span class="keyword">auto</span> p1(<span class="keyword">word</span>[le].<span class="built_in">begin</span>()),</span><br><span class="line">		p2(<span class="keyword">word</span>[ri].<span class="built_in">begin</span>());</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">unsigned</span> i(<span class="number">1</span>);i &lt;= N;++i) &#123;</span><br><span class="line">		<span class="built_in">while</span> (p1 != <span class="keyword">word</span>[le].<span class="built_in">end</span>() &amp;&amp; *p1 &lt; la[i - <span class="number">1</span>]) ++p1;</span><br><span class="line">		<span class="built_in">while</span> (p2 != <span class="keyword">word</span>[ri].<span class="built_in">end</span>() &amp;&amp; *p2 &lt; la[i - <span class="number">1</span>]) ++p2;</span><br><span class="line">		<span class="built_in">if</span> ((p1 != <span class="keyword">word</span>[le].<span class="built_in">end</span>() &amp;&amp; *p1 &lt; la[i]) ||</span><br><span class="line">			(p2 != <span class="keyword">word</span>[ri].<span class="built_in">end</span>() &amp;&amp; *p2 &lt; la[i])) &#123;</span><br><span class="line">			<span class="built_in">if</span> (flag) puts(<span class="string">"----------"</span>);</span><br><span class="line">			<span class="built_in">else</span> flag = true;</span><br><span class="line">			<span class="keyword">unsigned</span> re;</span><br><span class="line">			<span class="built_in">while</span> ((p1 != <span class="keyword">word</span>[le].<span class="built_in">end</span>() &amp;&amp; *p1 &lt; la[i]) ||</span><br><span class="line">				(p2 != <span class="keyword">word</span>[ri].<span class="built_in">end</span>() &amp;&amp; *p2 &lt; la[i])) &#123;</span><br><span class="line">				<span class="built_in">if</span> (p1 == <span class="keyword">word</span>[le].<span class="built_in">end</span>() || *p1 &gt;= la[i]) re = *p2++;</span><br><span class="line">				<span class="built_in">else</span> <span class="built_in">if</span> (p2 == <span class="keyword">word</span>[ri].<span class="built_in">end</span>() || *p2 &gt;= la[i]) re = *p1++;</span><br><span class="line">				<span class="built_in">else</span> <span class="built_in">if</span> (*p2 &gt; *p1) re = *p1++;</span><br><span class="line">				<span class="built_in">else</span> <span class="built_in">if</span> (*p2 &lt; *p1) re = *p2++;</span><br><span class="line">				<span class="built_in">else</span> re = *p1++, *p2++;</span><br><span class="line">				puts(lines[re]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 88)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, stdin);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	scanf(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">	getchar();</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">unsigned</span> now(<span class="number">0</span>);now &lt; N;++now) &#123;						<span class="comment">//read contexts of articles</span></span><br><span class="line">		la[now] = ln;</span><br><span class="line">		<span class="built_in">while</span> (gets(tmpline) &amp;&amp; strcmp(tmpline, <span class="string">"**********"</span>)) &#123;</span><br><span class="line">			strcpy(lines[ln], tmpline);</span><br><span class="line">			<span class="keyword">char</span> *pl(tmpline);</span><br><span class="line">			<span class="built_in">do</span> &#123;</span><br><span class="line">				<span class="built_in">if</span> ((*pl &gt;= <span class="string">'a'</span> &amp;&amp; *pl &lt;= <span class="string">'z'</span>) || (*pl &gt;= <span class="string">'A'</span> &amp;&amp; *pl &lt;= <span class="string">'Z'</span>)) &#123;</span><br><span class="line">					<span class="keyword">char</span> *pw(tmpword);</span><br><span class="line">					<span class="built_in">while</span> ((*pl &gt;= <span class="string">'a'</span> &amp;&amp; *pl &lt;= <span class="string">'z'</span>) || (*pl &gt;= <span class="string">'A'</span> &amp;&amp; *pl &lt;= <span class="string">'Z'</span>)) &#123;</span><br><span class="line">						<span class="built_in">if</span> (*pl &gt;= <span class="string">'A'</span> &amp;&amp; *pl &lt;= <span class="string">'Z'</span>) *pl += <span class="number">32</span>;</span><br><span class="line">						*pw++ = *pl++;</span><br><span class="line">					&#125;</span><br><span class="line">					*pw = <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">word</span>[tmpword].insert(ln);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="built_in">while</span> (*pl++ != <span class="number">0</span>);</span><br><span class="line">			++ln;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	la[N] = ln;</span><br><span class="line">	scanf(<span class="string">"%d"</span>, &amp;M);</span><br><span class="line">	getchar();</span><br><span class="line">	<span class="keyword">int</span> nnnn = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">while</span> (M--) &#123;												<span class="comment">//read requests</span></span><br><span class="line">		gets(tmpline);</span><br><span class="line">		<span class="keyword">char</span> *p = tmpline, *pw1 = w1, *pw2 = w2, *pw3 = w3;</span><br><span class="line">		<span class="built_in">while</span> (*p &amp;&amp; *p != <span class="string">' '</span>) *pw1++ = *p++;</span><br><span class="line">		*pw1 = <span class="string">'\0'</span>;</span><br><span class="line">		<span class="built_in">if</span> (*p) ++p;</span><br><span class="line">		<span class="built_in">while</span> (*p &amp;&amp; *p != <span class="string">' '</span>) *pw2++ = *p++;</span><br><span class="line">		*pw2 = <span class="string">'\0'</span>;</span><br><span class="line">		<span class="built_in">if</span> (*p) ++p;</span><br><span class="line">		<span class="built_in">while</span> (*p &amp;&amp; *p != <span class="string">' '</span>) *pw3++ = *p++;</span><br><span class="line">		*pw3 = <span class="string">'\0'</span>;</span><br><span class="line">		<span class="keyword">bool</span> flag(false);</span><br><span class="line">		<span class="built_in">if</span> (!*w2)				ONLY(flag, w1);</span><br><span class="line">		<span class="built_in">else</span> <span class="built_in">if</span> (*w1 == <span class="string">'N'</span>)	NOT(flag, w2);</span><br><span class="line">		<span class="built_in">else</span> <span class="built_in">if</span> (*w2 == <span class="string">'A'</span>)	AND(flag, w1, w3);</span><br><span class="line">		<span class="built_in">else</span>					OR(flag, w1, w3);</span><br><span class="line">		<span class="built_in">if</span> (!flag) puts(<span class="string">"Sorry, I found nothing."</span>);</span><br><span class="line">		puts(<span class="string">"=========="</span>);</span><br><span class="line">		<span class="comment">//printf("==========%d\n", ++nnnn);//</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>分析：我选择死亡。。。难倒是不难，很快就解出来了。但是一开始用了近1秒的时间，很郁闷。于是又花了几天的时间去研究别人的代码，也包括把之前sstream全改掉用gets和puts，把only not and or全部分开做函数，写的老长。用gets和puts的版本用了0.600s，还是比别人的都慢好多。GitHub上看到大神0.080s的（https://github.com/morris821028/UVa/blob/master/temp/1597%20-%20Searching%20the%20Web.cpp），我天这是差了多少倍！于是仿着大神的代码也写了个，结果1.090s！！？？一定是我没抄到其精髓？！花了几天时间了，结果还变慢了，好难过啊。。。然后过了几天我又回来研究了。我发现其实网上看到的算法全都是大同小异的，那我的代码一定是哪里有问题。看到大神函数里面的这一句：<code>set&lt;int&gt; &amp;t = wordInLine[args[1]];</code> 一开始我以他只是图个书写方便，但想了想，这样就不需要每次寻找wordInLine[args[1]]的值了，于是我就抱着试试的心态，也加了句类似的。结果瞬间从0.960s降到0.190s！新技能get！ 下面是仅仅没有给word[on]、word[le]、word[ri]加引用的版本。 代码：（Accepted，1.090s）</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1597 - Searching the Web</span></span><br><span class="line"><span class="comment">//#define _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">string</span>, set&lt;<span class="keyword">unsigned</span>&gt; &gt; <span class="keyword">word</span>;</span><br><span class="line"><span class="keyword">char</span> lines[<span class="number">1510</span>][<span class="number">85</span>];</span><br><span class="line"><span class="keyword">unsigned</span> N, M, la[<span class="number">105</span>], ln(<span class="number">1</span>);<span class="comment">//la:last line of the article; ln:line number</span></span><br><span class="line"><span class="keyword">char</span> tmpword[<span class="number">80</span>], tmpline[<span class="number">88</span>], w1[<span class="number">80</span>], w2[<span class="number">80</span>], w3[<span class="number">80</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> ONLY(<span class="keyword">bool</span>&amp; flag, <span class="keyword">const</span> <span class="keyword">string</span>&amp; on) &#123;</span><br><span class="line">	<span class="keyword">auto</span> p(<span class="keyword">word</span>[on].<span class="built_in">begin</span>());</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">unsigned</span> i(<span class="number">1</span>);i &lt;= N;++i) &#123;</span><br><span class="line">		<span class="built_in">while</span> (p != <span class="keyword">word</span>[on].<span class="built_in">end</span>() &amp;&amp; *p &lt; la[i - <span class="number">1</span>]) ++p;</span><br><span class="line">		<span class="built_in">if</span> (p != <span class="keyword">word</span>[on].<span class="built_in">end</span>() &amp;&amp; *p &lt; la[i]) &#123;</span><br><span class="line">			<span class="built_in">if</span> (flag) puts(<span class="string">"----------"</span>);</span><br><span class="line">			<span class="built_in">else</span> flag = true;</span><br><span class="line">			<span class="built_in">while</span> (p != <span class="keyword">word</span>[on].<span class="built_in">end</span>() &amp;&amp; *p &lt; la[i])</span><br><span class="line">				puts(lines[*p++]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> NOT(<span class="keyword">bool</span>&amp; flag, <span class="keyword">const</span> <span class="keyword">string</span>&amp; on) &#123;</span><br><span class="line">	<span class="keyword">auto</span> p(<span class="keyword">word</span>[on].<span class="built_in">begin</span>());</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">unsigned</span> i(<span class="number">0</span>);i &lt; N;++i) &#123;</span><br><span class="line">		<span class="built_in">while</span> (p != <span class="keyword">word</span>[on].<span class="built_in">end</span>() &amp;&amp; *p &lt; la[i]) ++p;</span><br><span class="line">		<span class="built_in">if</span> (p == <span class="keyword">word</span>[on].<span class="built_in">end</span>() || *p &gt;= la[i + <span class="number">1</span>]) &#123;</span><br><span class="line">			<span class="built_in">if</span> (flag) puts(<span class="string">"----------"</span>);</span><br><span class="line">			<span class="built_in">else</span> flag = true;</span><br><span class="line">			<span class="built_in">for</span> (<span class="keyword">auto</span> j(la[i]);j &lt; la[i + <span class="number">1</span>];++j)</span><br><span class="line">				puts(lines[j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> AND(<span class="keyword">bool</span>&amp; flag, <span class="keyword">const</span> <span class="keyword">string</span>&amp; le, <span class="keyword">const</span> <span class="keyword">string</span>&amp; ri) &#123;</span><br><span class="line">	<span class="keyword">auto</span> p1(<span class="keyword">word</span>[le].<span class="built_in">begin</span>()),</span><br><span class="line">		p2(<span class="keyword">word</span>[ri].<span class="built_in">begin</span>());</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">unsigned</span> i(<span class="number">1</span>);i &lt;= N;++i) &#123;</span><br><span class="line">		<span class="built_in">while</span> (p1 != <span class="keyword">word</span>[le].<span class="built_in">end</span>() &amp;&amp; *p1 &lt; la[i - <span class="number">1</span>]) ++p1;</span><br><span class="line">		<span class="built_in">while</span> (p2 != <span class="keyword">word</span>[ri].<span class="built_in">end</span>() &amp;&amp; *p2 &lt; la[i - <span class="number">1</span>]) ++p2;</span><br><span class="line">		<span class="built_in">if</span> ((p1 != <span class="keyword">word</span>[le].<span class="built_in">end</span>() &amp;&amp; *p1 &lt; la[i]) &amp;&amp;</span><br><span class="line">			(p2 != <span class="keyword">word</span>[ri].<span class="built_in">end</span>() &amp;&amp; *p2 &lt; la[i])) &#123;</span><br><span class="line">			<span class="built_in">if</span> (flag) puts(<span class="string">"----------"</span>);</span><br><span class="line">			<span class="built_in">else</span> flag = true;</span><br><span class="line">			<span class="keyword">unsigned</span> re;</span><br><span class="line">			<span class="built_in">while</span> ((p1 != <span class="keyword">word</span>[le].<span class="built_in">end</span>() &amp;&amp; *p1 &lt; la[i]) ||</span><br><span class="line">				(p2 != <span class="keyword">word</span>[ri].<span class="built_in">end</span>() &amp;&amp; *p2 &lt; la[i])) &#123;</span><br><span class="line">				<span class="built_in">if</span> (p1 == <span class="keyword">word</span>[le].<span class="built_in">end</span>() || *p1 &gt;= la[i]) re = *p2++;</span><br><span class="line">				<span class="built_in">else</span> <span class="built_in">if</span> (p2 == <span class="keyword">word</span>[ri].<span class="built_in">end</span>() || *p2 &gt;= la[i]) re = *p1++;</span><br><span class="line">				<span class="built_in">else</span> <span class="built_in">if</span> (*p2 &gt; *p1) re = *p1++;</span><br><span class="line">				<span class="built_in">else</span> <span class="built_in">if</span> (*p2 &lt; *p1) re = *p2++;</span><br><span class="line">				<span class="built_in">else</span> re = *p1++, *p2++;</span><br><span class="line">				puts(lines[re]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> OR(<span class="keyword">bool</span>&amp; flag, <span class="keyword">const</span> <span class="keyword">string</span>&amp; le, <span class="keyword">const</span> <span class="keyword">string</span>&amp; ri) &#123;</span><br><span class="line">	<span class="keyword">auto</span> p1(<span class="keyword">word</span>[le].<span class="built_in">begin</span>()),</span><br><span class="line">		p2(<span class="keyword">word</span>[ri].<span class="built_in">begin</span>());</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">unsigned</span> i(<span class="number">1</span>);i &lt;= N;++i) &#123;</span><br><span class="line">		<span class="built_in">while</span> (p1 != <span class="keyword">word</span>[le].<span class="built_in">end</span>() &amp;&amp; *p1 &lt; la[i - <span class="number">1</span>]) ++p1;</span><br><span class="line">		<span class="built_in">while</span> (p2 != <span class="keyword">word</span>[ri].<span class="built_in">end</span>() &amp;&amp; *p2 &lt; la[i - <span class="number">1</span>]) ++p2;</span><br><span class="line">		<span class="built_in">if</span> ((p1 != <span class="keyword">word</span>[le].<span class="built_in">end</span>() &amp;&amp; *p1 &lt; la[i]) ||</span><br><span class="line">			(p2 != <span class="keyword">word</span>[ri].<span class="built_in">end</span>() &amp;&amp; *p2 &lt; la[i])) &#123;</span><br><span class="line">			<span class="built_in">if</span> (flag) puts(<span class="string">"----------"</span>);</span><br><span class="line">			<span class="built_in">else</span> flag = true;</span><br><span class="line">			<span class="keyword">unsigned</span> re;</span><br><span class="line">			<span class="built_in">while</span> ((p1 != <span class="keyword">word</span>[le].<span class="built_in">end</span>() &amp;&amp; *p1 &lt; la[i]) ||</span><br><span class="line">				(p2 != <span class="keyword">word</span>[ri].<span class="built_in">end</span>() &amp;&amp; *p2 &lt; la[i])) &#123;</span><br><span class="line">				<span class="built_in">if</span> (p1 == <span class="keyword">word</span>[le].<span class="built_in">end</span>() || *p1 &gt;= la[i]) re = *p2++;</span><br><span class="line">				<span class="built_in">else</span> <span class="built_in">if</span> (p2 == <span class="keyword">word</span>[ri].<span class="built_in">end</span>() || *p2 &gt;= la[i]) re = *p1++;</span><br><span class="line">				<span class="built_in">else</span> <span class="built_in">if</span> (*p2 &gt; *p1) re = *p1++;</span><br><span class="line">				<span class="built_in">else</span> <span class="built_in">if</span> (*p2 &lt; *p1) re = *p2++;</span><br><span class="line">				<span class="built_in">else</span> re = *p1++, *p2++;</span><br><span class="line">				puts(lines[re]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _XIENAOBAN_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gets(T) gets_s(T, 88)</span></span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, stdin);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	scanf(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">	getchar();</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">unsigned</span> now(<span class="number">0</span>);now &lt; N;++now) &#123;						<span class="comment">//read contexts of articles</span></span><br><span class="line">		la[now] = ln;</span><br><span class="line">		<span class="built_in">while</span> (gets(tmpline) &amp;&amp; strcmp(tmpline, <span class="string">"**********"</span>)) &#123;</span><br><span class="line">			strcpy(lines[ln], tmpline);</span><br><span class="line">			<span class="keyword">char</span> *pl(tmpline);</span><br><span class="line">			<span class="built_in">do</span> &#123;</span><br><span class="line">				<span class="built_in">if</span> ((*pl &gt;= <span class="string">'a'</span> &amp;&amp; *pl &lt;= <span class="string">'z'</span>) || (*pl &gt;= <span class="string">'A'</span> &amp;&amp; *pl &lt;= <span class="string">'Z'</span>)) &#123;</span><br><span class="line">					<span class="keyword">char</span> *pw(tmpword);</span><br><span class="line">					<span class="built_in">while</span> ((*pl &gt;= <span class="string">'a'</span> &amp;&amp; *pl &lt;= <span class="string">'z'</span>) || (*pl &gt;= <span class="string">'A'</span> &amp;&amp; *pl &lt;= <span class="string">'Z'</span>)) &#123;</span><br><span class="line">						<span class="built_in">if</span> (*pl &gt;= <span class="string">'A'</span> &amp;&amp; *pl &lt;= <span class="string">'Z'</span>) *pl += <span class="number">32</span>;</span><br><span class="line">						*pw++ = *pl++;</span><br><span class="line">					&#125;</span><br><span class="line">					*pw = <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">word</span>[tmpword].insert(ln);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="built_in">while</span> (*pl++ != <span class="number">0</span>);</span><br><span class="line">			++ln;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	la[N] = ln;</span><br><span class="line">	scanf(<span class="string">"%d"</span>, &amp;M);</span><br><span class="line">	getchar();</span><br><span class="line">	<span class="keyword">int</span> nnnn = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">while</span> (M--) &#123;												<span class="comment">//read requests</span></span><br><span class="line">		gets(tmpline);</span><br><span class="line">		<span class="keyword">char</span> *p = tmpline, *pw1 = w1, *pw2 = w2, *pw3 = w3;</span><br><span class="line">		<span class="built_in">while</span> (*p &amp;&amp; *p != <span class="string">' '</span>) *pw1++ = *p++;</span><br><span class="line">		*pw1 = <span class="string">'\0'</span>;</span><br><span class="line">		<span class="built_in">if</span> (*p) ++p;</span><br><span class="line">		<span class="built_in">while</span> (*p &amp;&amp; *p != <span class="string">' '</span>) *pw2++ = *p++;</span><br><span class="line">		*pw2 = <span class="string">'\0'</span>;</span><br><span class="line">		<span class="built_in">if</span> (*p) ++p;</span><br><span class="line">		<span class="built_in">while</span> (*p &amp;&amp; *p != <span class="string">' '</span>) *pw3++ = *p++;</span><br><span class="line">		*pw3 = <span class="string">'\0'</span>;</span><br><span class="line">		<span class="keyword">bool</span> flag(false);</span><br><span class="line">		<span class="built_in">if</span> (!*w2)				ONLY(flag, w1);</span><br><span class="line">		<span class="built_in">else</span> <span class="built_in">if</span> (*w1 == <span class="string">'N'</span>)	NOT(flag, w2);</span><br><span class="line">		<span class="built_in">else</span> <span class="built_in">if</span> (*w2 == <span class="string">'A'</span>)	AND(flag, w1, w3);</span><br><span class="line">		<span class="built_in">else</span>					OR(flag, w1, w3);</span><br><span class="line">		<span class="built_in">if</span> (!flag) puts(<span class="string">"Sorry, I found nothing."</span>);</span><br><span class="line">		puts(<span class="string">"=========="</span>);</span><br><span class="line">		<span class="comment">//printf("==========%d\n", ++nnnn);//</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>哎呀呀，就少那么几行，天壤之别。顺便把一开始做的版本也贴了：</p>
<p>代码：（Accepted，0.960s） <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1597 - Searching the Web</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">article</span> &#123;</span></span><br><span class="line">	<span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="built_in">vector</span>&lt;<span class="keyword">unsigned</span>&gt; &gt; word;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; line;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> article tmpart;<span class="comment">//an empty article,just for push_back</span></span><br><span class="line"><span class="keyword">unsigned</span> N, M;</span><br><span class="line"><span class="built_in">string</span> tmpstr;</span><br><span class="line"><span class="built_in">vector</span>&lt;article&gt; dat;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">ONLY</span><span class="params">(<span class="keyword">const</span> article&amp; ar, <span class="keyword">const</span> <span class="built_in">string</span>&amp; l, <span class="keyword">const</span> <span class="built_in">string</span>&amp; r)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> ar.word.count(l);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">AND</span><span class="params">(<span class="keyword">const</span> article&amp; ar, <span class="keyword">const</span> <span class="built_in">string</span>&amp; l, <span class="keyword">const</span> <span class="built_in">string</span>&amp; r)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> ar.word.count(l) &amp;&amp; ar.word.count(r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">OR</span><span class="params">(<span class="keyword">const</span> article&amp; ar, <span class="keyword">const</span> <span class="built_in">string</span>&amp; l, <span class="keyword">const</span> <span class="built_in">string</span>&amp; r)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> ar.word.count(l) || ar.word.count(r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NOT</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; on)</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">flag</span><span class="params">(<span class="literal">false</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; r : dat) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!r.word.count(on)) &#123;</span><br><span class="line">			<span class="keyword">if</span> (flag) <span class="built_in">cout</span> &lt;&lt; <span class="string">"----------\n"</span>;</span><br><span class="line">			<span class="keyword">else</span> flag = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; rr : r.line)</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; rr &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (!flag) <span class="built_in">cout</span> &lt;&lt; <span class="string">"Sorry, I found nothing.\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">bool</span>(*f)(<span class="keyword">const</span> article&amp;, <span class="keyword">const</span> <span class="built_in">string</span>&amp;, <span class="keyword">const</span> <span class="built_in">string</span>&amp;), <span class="keyword">const</span> <span class="built_in">string</span>&amp; le, <span class="keyword">const</span> <span class="built_in">string</span>&amp; ri)</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">flag</span><span class="params">(<span class="literal">false</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; r : dat) &#123;<span class="comment">//why it can't be "const auto&amp; r"? because if a map is const,r.word[i] would be invalid</span></span><br><span class="line">		<span class="keyword">if</span> (f(r, le, ri)) &#123;</span><br><span class="line">			<span class="built_in">set</span>&lt;<span class="keyword">unsigned</span>&gt; re;</span><br><span class="line">			<span class="keyword">if</span> (r.word.count(le)) <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; rr : r.word[le]) re.insert(rr);</span><br><span class="line">			<span class="keyword">if</span> (r.word.count(ri)) <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; rr : r.word[ri]) re.insert(rr);</span><br><span class="line">			<span class="keyword">if</span> (re.empty()) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span> (flag) <span class="built_in">cout</span> &lt;&lt; <span class="string">"----------\n"</span>;</span><br><span class="line">			<span class="keyword">else</span> flag = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; rr : re)</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; r.line[rr] &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (!flag) <span class="built_in">cout</span> &lt;&lt; <span class="string">"Sorry, I found nothing.\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);//</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N;</span><br><span class="line">	<span class="built_in">cin</span>.ignore();<span class="comment">//absorb '\n'</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">unsigned</span> now(<span class="number">0</span>);now &lt; N;++now) &#123;						<span class="comment">//read contexts of articles</span></span><br><span class="line">		<span class="function"><span class="keyword">int</span> <span class="title">ln</span><span class="params">(<span class="number">0</span>)</span></span>;<span class="comment">//line number of current article</span></span><br><span class="line">		dat.push_back(tmpart);<span class="comment">//create a empty article</span></span><br><span class="line">		<span class="keyword">while</span> (getline(<span class="built_in">cin</span>, tmpstr) &amp;&amp; tmpstr != <span class="string">"**********"</span>) &#123;</span><br><span class="line">			dat[now].line.push_back(tmpstr);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; r : tmpstr) &#123;</span><br><span class="line">				<span class="keyword">if</span> (r &gt;= <span class="string">'a'</span>&amp;&amp;r &lt;= <span class="string">'z'</span>) <span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">if</span> (r &gt;= <span class="string">'A'</span>&amp;&amp;r &lt;= <span class="string">'Z'</span>) r += <span class="number">32</span>;</span><br><span class="line">				<span class="keyword">else</span> r = <span class="string">' '</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="function"><span class="built_in">istringstream</span> <span class="title">in</span><span class="params">(tmpstr)</span></span>;</span><br><span class="line">			<span class="keyword">while</span> (in &gt;&gt; tmpstr)</span><br><span class="line">				dat[now].word[tmpstr].push_back(ln);</span><br><span class="line">			++ln;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; M;</span><br><span class="line">	<span class="built_in">cin</span>.ignore();</span><br><span class="line">	<span class="keyword">while</span> (M--) &#123;												<span class="comment">//read requests</span></span><br><span class="line">		<span class="built_in">string</span> sl, sm, sr;<span class="comment">//left middle right</span></span><br><span class="line">		getline(<span class="built_in">cin</span>, tmpstr);</span><br><span class="line">		<span class="function"><span class="built_in">istringstream</span> <span class="title">in</span><span class="params">(tmpstr)</span></span>;</span><br><span class="line">		in &gt;&gt; sl;</span><br><span class="line">		<span class="keyword">if</span> (!(in &gt;&gt; sm))			solve(ONLY, sl, sl);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (!(in &gt;&gt; sr))		NOT(sm);<span class="comment">//why are you so special</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (sm[<span class="number">0</span>] == <span class="string">'A'</span>)		solve(AND, sl, sr);</span><br><span class="line">		<span class="keyword">else</span>						solve(OR, sl, sr);</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"==========\n"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-9UVa1596 - Bug Hunt</title>
    <url>/posts/20085.html</url>
    <content><![CDATA[<p>//开学了，好烦啊啊啊啊啊！怎么开个学那么多破事情！！都俩星期了，终于有时间写出来一道题 题意：不难理解，不写了。这几天忙的心累。</p>
<hr>
<p>代码：（Accepted， 0.010s）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1596 - Bug Hunt</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">o_O</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> size;</span><br><span class="line">	<span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; dim;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, o_O&gt; dat;</span><br><span class="line"><span class="built_in">string</span> line;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">get</span><span class="params">(<span class="built_in">stack</span>&lt;<span class="built_in">string</span>&gt;&amp; st,<span class="keyword">int</span>&amp; num)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (!st.empty()) &#123;</span><br><span class="line">		<span class="keyword">if</span> (num &gt;= dat[st.top()].size) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">if</span> (!dat[st.top()].dim.count(num)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		num = dat[st.top()].dim[num];</span><br><span class="line">		st.pop();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">declare</span><span class="params">()</span> </span>&#123;<span class="comment">//定义数组</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; r : line)</span><br><span class="line">		<span class="keyword">if</span> (r == <span class="string">'['</span> || r == <span class="string">']'</span>) r = <span class="string">' '</span>;</span><br><span class="line">	<span class="function"><span class="built_in">istringstream</span> <span class="title">in</span><span class="params">(line)</span></span>;</span><br><span class="line">	<span class="built_in">string</span> na;</span><br><span class="line">	<span class="keyword">int</span> nu;</span><br><span class="line">	in &gt;&gt; na &gt;&gt; nu;</span><br><span class="line">	dat[na].size = nu;</span><br><span class="line">	<span class="keyword">return</span> nu &gt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">solve</span><span class="params">()</span></span>&#123;<span class="comment">//处理赋值</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; r : line)</span><br><span class="line">		<span class="keyword">if</span> (r == <span class="string">'['</span> || r == <span class="string">']'</span> || r == <span class="string">'='</span>) r = <span class="string">' '</span>;</span><br><span class="line">	<span class="built_in">stack</span>&lt;<span class="built_in">string</span>&gt; stl, str;</span><br><span class="line">	<span class="keyword">int</span> numl, numr;</span><br><span class="line">	<span class="function"><span class="built_in">istringstream</span> <span class="title">in</span><span class="params">(line)</span></span>;</span><br><span class="line">	<span class="built_in">string</span> now,sl;</span><br><span class="line">	in &gt;&gt; sl;</span><br><span class="line">	<span class="keyword">while</span> (in &gt;&gt; now &amp;&amp; now[<span class="number">0</span>] &gt; <span class="string">'9'</span>) stl.push(now);</span><br><span class="line">	<span class="function"><span class="built_in">istringstream</span> <span class="title">inl</span><span class="params">(now)</span></span>;inl &gt;&gt; numl;</span><br><span class="line">	<span class="keyword">while</span> (in &gt;&gt; now &amp;&amp; now[<span class="number">0</span>] &gt; <span class="string">'9'</span>) str.push(now);</span><br><span class="line">	<span class="function"><span class="built_in">istringstream</span> <span class="title">inr</span><span class="params">(now)</span></span>;inr &gt;&gt; numr;</span><br><span class="line">	<span class="keyword">if</span> (!get(stl, numl) || !get(str, numr)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">if</span> (numl &gt;= dat[sl].size) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	dat[sl].dim[numl] = numr;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);//</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span>&gt;&gt;line &amp;&amp; line[<span class="number">0</span>] != <span class="string">'.'</span>) &#123;</span><br><span class="line">		<span class="keyword">unsigned</span> flag = <span class="number">0</span>, linenum = <span class="number">0</span>;</span><br><span class="line">		dat.clear();</span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			++linenum;</span><br><span class="line">			<span class="keyword">if</span> (flag) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span> (!(line.find(<span class="string">'='</span>) == <span class="built_in">string</span>::npos ? declare() : solve()))</span><br><span class="line">				flag = linenum;</span><br><span class="line">		&#125; <span class="keyword">while</span> (<span class="built_in">cin</span>&gt;&gt;line &amp;&amp; line[<span class="number">0</span>] != <span class="string">'.'</span>);</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; flag &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>分析：给数组找bug，只有赋值和定义两种语句。一开始我想复杂了，以为会有诸如 <code>a[b[c[0]=1]=d[2]]=e[e[e[e[e[e[3]]]=e[1]=e[2]=e[3]=233]]]=1</code> 这种情况发生，于是就用递归做，做了好久，还老是WA（/* 实在难抽出一块一块的时间来学习，断断续续写了一星期，思路老是想到一半就断了。而且事情多烦的脑子疼，想不出东西。妈蛋还不如放假。*/） 结果昨天晚上一个老司机跟我说，干嘛那么烦，<strong>一行只有一个赋值</strong>。。。。。 好的，瞬间简单了。。今天花了一个小时不知道到不到就做出来了。可能是用了sstream，再转存到stack的原因，比较慢，用时10ms。</p>
<p>附：之前以为一行可以多个赋值的时候写的代码（更新：终于调试的AC了）： 代码：（Accepted， 0.010s）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1596 - Bug Hunt</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="built_in">string</span> line;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="built_in">string</span>&gt; qu;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">o_O</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> len;</span><br><span class="line">	<span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; def;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, o_O&gt; dat;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">()</span> </span>&#123;<span class="comment">//从qu中get当前index的值，通过递归实现</span></span><br><span class="line">	<span class="built_in">string</span> now = qu.front();</span><br><span class="line">	qu.pop();</span><br><span class="line">	<span class="keyword">if</span> (now[<span class="number">0</span>] &gt; <span class="string">'9'</span>) &#123;<span class="comment">//若为变量名，说明有嵌套</span></span><br><span class="line">		<span class="keyword">int</span> n = get();<span class="comment">//得到当前变量的index</span></span><br><span class="line">		qu.pop();</span><br><span class="line">		<span class="keyword">if</span> (n &gt;= dat[now].len || n &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;<span class="comment">//数组越界</span></span><br><span class="line">		<span class="keyword">if</span> (qu.empty() || qu.front()[<span class="number">0</span>] == <span class="string">'&#125;'</span>) &#123;<span class="comment">//不是赋值，直接返回</span></span><br><span class="line">			<span class="keyword">if</span> (!dat[now].def.count(n)) <span class="keyword">return</span> <span class="number">-1</span>;<span class="comment">//没初始化</span></span><br><span class="line">			<span class="keyword">return</span> dat[now].def[n];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> dat[now].def[n] = get();<span class="comment">//赋值</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> num;<span class="comment">//若为数字</span></span><br><span class="line">	<span class="function"><span class="built_in">istringstream</span> <span class="title">iin</span><span class="params">(now)</span></span>;</span><br><span class="line">	iin &gt;&gt; num;</span><br><span class="line">	<span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">declare</span><span class="params">()</span> </span>&#123;<span class="comment">//定义数组</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; r : line)</span><br><span class="line">		<span class="keyword">if</span> (r == <span class="string">'['</span> || r == <span class="string">']'</span>) r = <span class="string">' '</span>;</span><br><span class="line">	<span class="function"><span class="built_in">istringstream</span> <span class="title">in</span><span class="params">(line)</span></span>;</span><br><span class="line">	<span class="built_in">string</span> na;</span><br><span class="line">	<span class="keyword">int</span> nu;</span><br><span class="line">	in &gt;&gt; na &gt;&gt; nu;</span><br><span class="line">	dat[na].len = nu;</span><br><span class="line">	<span class="keyword">return</span> nu &gt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;<span class="comment">//预处理当前行</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; r : line)</span><br><span class="line">		<span class="keyword">if</span> (r == <span class="string">'['</span> || r == <span class="string">'='</span>) r = <span class="string">' '</span>;</span><br><span class="line">	<span class="function"><span class="built_in">istringstream</span> <span class="title">in</span><span class="params">(line)</span></span>;</span><br><span class="line">	<span class="built_in">string</span> now;</span><br><span class="line">	<span class="keyword">int</span> num;</span><br><span class="line">	<span class="keyword">while</span> (in &gt;&gt; now) &#123;</span><br><span class="line">		<span class="keyword">if</span> (now[<span class="number">0</span>] &gt; <span class="string">'9'</span>) qu.push(now);</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; r : now)</span><br><span class="line">				<span class="keyword">if</span> (r == <span class="string">']'</span>) r = <span class="string">' '</span>, ++i;</span><br><span class="line">			qu.push(now);</span><br><span class="line">			<span class="keyword">while</span> (i--) qu.push(<span class="string">"&#125;"</span>);<span class="comment">//为什么要用&#125;不用]，一开始想的是&#125;的ASCII是125，而]夹在大小写字母之间。然而后来发现并没有什么卵用</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> get() &gt;=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);//</span></span><br><span class="line">	<span class="keyword">while</span> (getline(<span class="built_in">cin</span>, line) &amp;&amp; line[<span class="number">0</span>] != <span class="string">'.'</span>) &#123;</span><br><span class="line">		<span class="keyword">unsigned</span> flag = <span class="number">0</span>, linenum = <span class="number">0</span>;</span><br><span class="line">		dat.clear();</span><br><span class="line">		<span class="keyword">while</span> (!qu.empty()) qu.pop();<span class="comment">//queue不自带clear()的?!</span></span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			++linenum;</span><br><span class="line">			<span class="keyword">if</span> (flag) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span> (!(line.find(<span class="string">'='</span>) == <span class="built_in">string</span>::npos ? declare() : solve()))</span><br><span class="line">				flag = linenum;</span><br><span class="line">		&#125; <span class="keyword">while</span> (getline(<span class="built_in">cin</span>, line) &amp;&amp; line[<span class="number">0</span>] != <span class="string">'.'</span>);</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; flag &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>虽然是我想多了，但是应用到单个赋值也是没问题的呀。但是还是想不通哪里就WA了。。。应该是哪个特殊的格式没考虑到。以后有心情再调试。（更新：终于调试得AC啦，代码已经覆盖更新。竟然也是0.010s。）</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-8UVa230 - Borrowers</title>
    <url>/posts/9828.html</url>
    <content><![CDATA[<p>//又开学啦，不知不觉成为大二的老人了。。。时间过得好快啊，感觉好颓废。。。 题意：建立一个借书/归还系统。有借、还、把还的书插到书架上这三个指令。</p>
<hr>
<p>代码：（Accepted， 0ms）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa230 - Borrowers</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BOOK</span> &#123;</span></span><br><span class="line">	<span class="built_in">string</span> au, ti;</span><br><span class="line">	BOOK(<span class="keyword">const</span> <span class="built_in">string</span>&amp; a, <span class="keyword">const</span> <span class="built_in">string</span>&amp; t) :au(a), ti(t) &#123;&#125;</span><br><span class="line">	BOOK() :ti(<span class="string">"X"</span>), au(<span class="string">"X"</span>) &#123;&#125;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> BOOK &amp;that)<span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (au == that.au) <span class="keyword">return</span> ti &lt; that.ti;</span><br><span class="line">		<span class="keyword">return</span> au &lt; that.au;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">map</span>&lt;BOOK, <span class="keyword">bool</span>&gt; <span class="built_in">list</span>;<span class="comment">//int:0在书架 1已经借出</span></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, BOOK&gt; auth;</span><br><span class="line"><span class="built_in">set</span>&lt;BOOK&gt; ret;<span class="comment">//归还列表</span></span><br><span class="line"><span class="built_in">string</span> tmp;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">B</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; t)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">list</span>[auth[t]] = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">R</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; t)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">auto</span> f = <span class="built_in">list</span>.find(auth[t]);</span><br><span class="line">	ret.insert(f-&gt;first);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">S</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; r : ret) &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"Put "</span> &lt;&lt; r.ti;</span><br><span class="line">		<span class="keyword">auto</span> re = <span class="built_in">list</span>.find(r),p=re;</span><br><span class="line">		<span class="comment">//if (re == list.end()) cout &lt;&lt; "FUCK!\n";//</span></span><br><span class="line">		<span class="keyword">while</span> (p != <span class="built_in">list</span>.begin() &amp;&amp; (--p)-&gt;second);</span><br><span class="line">		<span class="comment">//cout &lt;&lt; "喵喵喵?????\n";//</span></span><br><span class="line">		<span class="keyword">if</span> (p == <span class="built_in">list</span>.begin() &amp;&amp; p-&gt;second) <span class="built_in">cout</span> &lt;&lt; <span class="string">" first\n"</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; <span class="string">" after "</span> &lt;&lt; p-&gt;first.ti &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		re-&gt;second = <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"END\n"</span>;</span><br><span class="line">	ret.clear();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="keyword">while</span> (getline(<span class="built_in">cin</span>, tmp) &amp;&amp; tmp[<span class="number">0</span>] != <span class="string">'E'</span>) &#123;</span><br><span class="line">		<span class="keyword">size_t</span> n = tmp.rfind(<span class="string">'\"'</span>);</span><br><span class="line">		<span class="function"><span class="built_in">string</span> <span class="title">ti</span><span class="params">(tmp.substr(<span class="number">0</span>, n + <span class="number">1</span>))</span></span>;</span><br><span class="line">		<span class="function"><span class="built_in">string</span> <span class="title">au</span><span class="params">(tmp.substr(n + <span class="number">5</span>, tmp.size() - n - <span class="number">6</span>))</span></span>;</span><br><span class="line">		<span class="built_in">list</span>[BOOK(au, ti)] = <span class="literal">false</span>;</span><br><span class="line">		auth[ti] = BOOK(au, ti);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//for (auto&amp;r : list) cout &lt;&lt; "--" &lt;&lt; r.first.ti &lt;&lt; '\t' &lt;&lt; r.first.au &lt;&lt; endl;//</span></span><br><span class="line">	<span class="keyword">while</span> (getline(<span class="built_in">cin</span>, tmp) &amp;&amp; tmp[<span class="number">0</span>] != <span class="string">'E'</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (tmp[<span class="number">0</span>] == <span class="string">'B'</span>) B(tmp.substr(<span class="number">7</span>));</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (tmp[<span class="number">0</span>] == <span class="string">'R'</span>) R(tmp.substr(<span class="number">7</span>));</span><br><span class="line">		<span class="keyword">else</span> S();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>分析：使用了STL的map和set。一个map存放所有书（书的作者与标题作为key，借阅/归还状态为value），一个map用来从标题映射到书的信息（因为下面borrow和return指令里不带作者信息，映射一下方便，但我内心还是不大情愿。的确有更好的方法，我不大会，下面再讲。）还有一个set存储归还了但还未放回书架的书。其他没啥要说的。</p>
<p>本来想将key设为标题，value设为作者的，但是不知道如何将map按value排序。查了查要用到vector+pair 中转，好像有点烦啊。但是网上看到这个，http://blog.csdn.net/a197p/article/details/43747539 。他就是采用了</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">book</span>&#123;</span>  </span><br><span class="line">    <span class="built_in">string</span> author;  </span><br><span class="line">    <span class="keyword">int</span> status;  </span><br><span class="line">&#125;;  </span><br><span class="line"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, book&gt; books;</span><br></pre></td></tr></table></figure>
<p>来存储。我还以为他能给map按照value重排，结果他建立了个vector&lt; string &gt; name; 来存放标题，存放顺序用以下方法</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">bool </span>compare(<span class="keyword">string </span>a, <span class="keyword">string </span><span class="keyword">b)&#123; </span> </span><br><span class="line">    <span class="meta">if</span>(<span class="keyword">books[a].author </span>== <span class="keyword">books[b].author) </span>return a &lt; <span class="keyword">b; </span> </span><br><span class="line">    <span class="meta">else</span> return <span class="keyword">books[a].author </span>&lt; <span class="keyword">books[b].author; </span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>原来是稍微绕了一下，但是也不错耶。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-7UVa12100 - Printer Queue</title>
    <url>/posts/34815.html</url>
    <content><![CDATA[<p>题意：一堆文件但只有一个打印机，按优先级与排队顺序进行打印。也就是在一个可以插队的的队列里，问你何时可以打印到。至于这个插队啊，题目说”Of course, those annoying term papers that others are printing may have to wait for quite some time to get printed, but that's life.“嗯，这就是生活。</p>
<hr>
<p>代码：（Accepted， 0ms）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa12100 - Printer Queue</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> T,M,N;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">	<span class="keyword">while</span> (T--) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;N, &amp;M);</span><br><span class="line">		<span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">		priority_queue&lt;<span class="keyword">int</span>&gt; p;</span><br><span class="line">		<span class="keyword">int</span> time = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N;++i)&#123;</span><br><span class="line">			<span class="keyword">int</span> tmp;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;tmp);</span><br><span class="line">			q.push(tmp), p.push(tmp);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (q.front() == p.top()) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!M) <span class="keyword">break</span>;</span><br><span class="line">				q.pop(), p.pop();</span><br><span class="line">				++time;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				q.push(q.front());</span><br><span class="line">				q.pop();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (--M == <span class="number">-1</span>) M = N - time;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, time);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>分析：采用了队列和优先队列。排的队存在队列q里，每读取一个，与p的top()比对，若一致，则弹出p和q的首个元素已打印的份数time进行++，否则p的首元素放最后面去。这个优先队列就是比大小来的，只不过用着方便。 一遍过，哈哈，开心，前两天的题目总是WA和RE，现在终于挽回一点心情。本来还想了好几个办法的，或许比这个还要快一点，但是这章就是让你练习STL嘛，而且这个方法已经0ms了而且方便的很，是不是更快区别不大，也不高兴再换个方法试试了。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-6UVa1595 - Symmetry</title>
    <url>/posts/37527.html</url>
    <content><![CDATA[<p>题意：平面上给若干点，问它们是不是关于某垂直于x轴的直线对称。</p>
<hr>
<p>代码：（<strong>Wrong Answer</strong>， --ms）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1595 - Symmetry</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> x, y;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(point&amp; that)<span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (y == that.y) <span class="keyword">return</span> x &lt; that.x;</span><br><span class="line">		<span class="keyword">return</span> y &lt; that.y;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> T, N;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">	<span class="keyword">while</span> (T--) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">		<span class="built_in">vector</span>&lt;point&gt; all(N);</span><br><span class="line">		<span class="function"><span class="keyword">int</span> <span class="title">sym</span><span class="params">(<span class="number">0</span>)</span></span>;<span class="comment">//2倍的对称轴</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;r : all) &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;r.x, &amp;r.y);</span><br><span class="line">			sym += r.x;</span><br><span class="line">		&#125;</span><br><span class="line">		sym = sym * <span class="number">2</span> / N;</span><br><span class="line">		sort(all.rbegin(), all.rend());</span><br><span class="line">		<span class="comment">//printf("sym:%d\n", sym);for (int i = 0;i &lt; N;++i) printf("%d&amp;%d  ", all[i].y, all[i].x);printf("\n");//------------</span></span><br><span class="line">		<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (i &lt; N) &#123;</span><br><span class="line">			<span class="keyword">int</span> k, ij, j = i;</span><br><span class="line">			<span class="keyword">while</span> (++j != N &amp;&amp; all[j].y == all[i].y);</span><br><span class="line">			ij = (--j - i) / <span class="number">2</span>;</span><br><span class="line">			<span class="comment">//printf("i:%d\t", i);printf("j:%d\t", j);printf("ij:%d\n", ij);//----------</span></span><br><span class="line">			<span class="keyword">for</span> (k = <span class="number">0</span>;k &lt;= ij;++k) &#123;</span><br><span class="line">				<span class="keyword">if</span> (all[i + k].x + all[j - k].x != sym) <span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (k &lt;= ij) <span class="keyword">break</span>;</span><br><span class="line">			i = j + <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>((i &lt; N ? <span class="string">"NO\n"</span> : <span class="string">"YES\n"</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>分析：好气呀，这么简单的题目，做了一下午+一上午，无限WA，至今找不到错误。不玩了，学会放弃，以后有心情再看。 我的想法是：定义一个结构体存每个点的x、y，读取每个数据后排序，优先y从小到大，其次x从小到大（目的是方便找出每个点对应的点。例如相同的y里面，最小的x与最大的x对应）。随便找出一个可能的对称轴（可以是找最大、最小的x，相加除以二；也可以所有的x相加再除以N。我选的后者）。然后取每对对应的两个点看相加的结果是不是对称轴两倍。 然而自己的测试数据都对，到了提交就总是WA。换成网上都用的set的方法重新做一遍，还是WA，开始怀疑人生。以下是我的测试数据，我实在是找不到其他的特殊情况了。</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">12</span></span><br><span class="line"></span><br><span class="line"><span class="number">5</span> </span><br><span class="line"><span class="number">-2</span> <span class="number">5</span> </span><br><span class="line"><span class="number">0</span> <span class="number">0</span> </span><br><span class="line"><span class="number">6</span> <span class="number">5</span> </span><br><span class="line"><span class="number">4</span> <span class="number">0</span> </span><br><span class="line"><span class="number">2</span> <span class="number">3</span> </span><br><span class="line"></span><br><span class="line"><span class="number">4</span> </span><br><span class="line"><span class="number">2</span> <span class="number">3</span> </span><br><span class="line"><span class="number">0</span> <span class="number">4</span> </span><br><span class="line"><span class="number">4</span> <span class="number">0</span> </span><br><span class="line"><span class="number">0</span> <span class="number">0</span> </span><br><span class="line"></span><br><span class="line"><span class="number">4</span> </span><br><span class="line"><span class="number">5</span> <span class="number">14</span> </span><br><span class="line"><span class="number">6</span> <span class="number">10</span></span><br><span class="line"><span class="number">5</span> <span class="number">10</span> </span><br><span class="line"><span class="number">6</span> <span class="number">14</span></span><br><span class="line"></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">7</span> <span class="number">-666</span></span><br><span class="line"><span class="number">0</span> <span class="number">5</span></span><br><span class="line"><span class="number">-1</span> <span class="number">-666</span></span><br><span class="line"><span class="number">7</span> <span class="number">5</span></span><br><span class="line"><span class="number">3</span> <span class="number">4</span></span><br><span class="line"><span class="number">0</span> <span class="number">-666</span></span><br><span class="line"><span class="number">4</span> <span class="number">4</span></span><br><span class="line"><span class="number">4</span> <span class="number">-666</span></span><br><span class="line"><span class="number">3</span> <span class="number">-666</span></span><br><span class="line"><span class="number">8</span> <span class="number">-666</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">233</span> <span class="number">322</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">-10000</span> <span class="number">999</span></span><br><span class="line"><span class="number">9999</span> <span class="number">998</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">-999</span> <span class="number">999</span></span><br><span class="line"><span class="number">0</span> <span class="number">999</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">4</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">3</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span></span><br><span class="line"><span class="number">3</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">0</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">3</span> <span class="number">1</span></span><br><span class="line"><span class="number">5</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">37</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span></span><br><span class="line"><span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">4</span> <span class="number">4</span></span><br><span class="line"><span class="number">5</span> <span class="number">5</span></span><br><span class="line"><span class="number">6</span> <span class="number">6</span></span><br><span class="line"><span class="number">7</span> <span class="number">7</span></span><br><span class="line"><span class="number">8</span> <span class="number">8</span></span><br><span class="line"><span class="number">9</span> <span class="number">9</span></span><br><span class="line"><span class="number">1</span> <span class="number">9</span></span><br><span class="line"><span class="number">2</span> <span class="number">8</span></span><br><span class="line"><span class="number">3</span> <span class="number">7</span></span><br><span class="line"><span class="number">4</span> <span class="number">6</span></span><br><span class="line"><span class="number">6</span> <span class="number">4</span></span><br><span class="line"><span class="number">7</span> <span class="number">3</span></span><br><span class="line"><span class="number">8</span> <span class="number">2</span></span><br><span class="line"><span class="number">9</span> <span class="number">1</span></span><br><span class="line"><span class="number">5</span> <span class="number">6</span></span><br><span class="line"><span class="number">5</span> <span class="number">7</span></span><br><span class="line"><span class="number">5</span> <span class="number">55</span></span><br><span class="line"><span class="number">5</span> <span class="number">4</span></span><br><span class="line"><span class="number">5</span> <span class="number">3</span></span><br><span class="line"><span class="number">5</span> <span class="number">-45</span></span><br><span class="line"><span class="number">6</span> <span class="number">5</span></span><br><span class="line"><span class="number">7</span> <span class="number">5</span></span><br><span class="line"><span class="number">8</span> <span class="number">5</span></span><br><span class="line"><span class="number">10</span> <span class="number">5</span></span><br><span class="line"><span class="number">55</span> <span class="number">5</span></span><br><span class="line"><span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="number">3</span> <span class="number">5</span></span><br><span class="line"><span class="number">2</span> <span class="number">5</span></span><br><span class="line"><span class="number">0</span> <span class="number">5</span></span><br><span class="line"><span class="number">-45</span> <span class="number">5</span></span><br><span class="line"><span class="number">8</span> <span class="number">100</span></span><br><span class="line"><span class="number">7</span> <span class="number">100</span></span><br><span class="line"><span class="number">3</span> <span class="number">100</span></span><br><span class="line"><span class="number">2</span> <span class="number">100</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-5UVa10391 - Compound Words</title>
    <url>/posts/4342.html</url>
    <content><![CDATA[<p>题意：问在一个词典里，那些单词是复合词，即哪些单词是由两个单词拼出来的。</p>
<hr>
<p>渣渣代码：（Accepted， 30ms） <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa10391 - Compound Words</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt; dic;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="built_in">string</span> w;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; w) dic.insert(w);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;r : dic) &#123;</span><br><span class="line">		<span class="keyword">int</span> s = r.size();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; s;++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (dic.count(r.substr(<span class="number">0</span>, i)) &amp;&amp; dic.count(r.substr(i, s - i))) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; r &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 分析：遍历两遍词典找出两个单词来找/判断复合词肯定不行，慢死了，肯定只能是拆当前单词拆成两部分，枚举所有可拆分的情况，看这两部分有没有找到两个独立的单词。于是用了如上面的超简单的方法，但是30ms。学习他们的0ms至10ms的做法，发现他们都用了hash。我不知道什么是hash，一下子看他们代码也看的一愣一愣的。看了一下午代码和hash资料了，累死了。。明天继续改进这题，今天我要歇息下了。明天再会更新此博客。</p>
<p>更新：对hash还不熟，但是自己做了一下，但是总是Runtime error！我要哭了，自己做了N组不同的测试数据，没有任何异常，但是提交总是RE！为什么啊！！！！：</p>
<p>垃圾代码：（Runtime Error， --） <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa10391 - Compound Words</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mdic = <span class="number">120200</span>, d[] = &#123; <span class="number">4616</span>,<span class="number">177</span>,<span class="number">7</span> &#125;;</span><br><span class="line"><span class="keyword">char</span> dic[mdic][<span class="number">40</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hash</span><span class="params">(<span class="keyword">char</span>* s)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> re = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;s[i] &amp;&amp; i &lt; <span class="number">3</span>;++i)</span><br><span class="line">		re = (s[i] - <span class="string">'a'</span>)*d[i];</span><br><span class="line">	<span class="keyword">return</span> re;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">(<span class="keyword">char</span>* s)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> h = hash(s);</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">strcmp</span>(s, dic[h]) &gt; <span class="number">0</span>) ++h;</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">strcmp</span>(s, dic[h])) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">	<span class="built_in">memset</span>(*dic, <span class="number">0</span>, <span class="keyword">sizeof</span>(*dic));</span><br><span class="line">	<span class="keyword">char</span> w[<span class="number">40</span>], (*p)[<span class="number">40</span>] = dic;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%s"</span>, w) != <span class="number">-1</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> h = hash(w);</span><br><span class="line">		<span class="keyword">while</span> (dic[h][<span class="number">0</span>]) ++h;</span><br><span class="line">		<span class="built_in">strcpy</span>(dic[h], w);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> I = <span class="number">0</span>;I &lt; mdic;++I, ++p) &#123;</span><br><span class="line">		<span class="keyword">if</span> (!*p) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">int</span> len = <span class="built_in">strlen</span>(*p);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; len;++i) &#123;</span><br><span class="line">			<span class="keyword">char</span> a[<span class="number">40</span>], b[<span class="number">40</span>];</span><br><span class="line">			<span class="built_in">strncpy</span>(a, *p, i);a[i] = <span class="number">0</span>;</span><br><span class="line">			<span class="built_in">strcpy</span>(b, *p + i);</span><br><span class="line">			<span class="keyword">if</span> (find(a) &amp;&amp; find(b)) <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, *p);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 分析：尽量按照自己的想法做的。对于获得hash那个函数，我也是自己想的（4616=120010/26，177=120010/26/26，7=120010/26/26/26），不知道高人有什么看法。还有再次声明：这个代码是RE的！！我测试了好多数据都没问题，一到oj上就RE。。好歹来个WA啊啊啊（哇的一声就哭了） 就我自己的测试数据，上面的版本用时2136，下面的4726。。。。怎么还慢了。。不服。。以后学精了再说吧。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-4UVa10763 - Foreign Exchange</title>
    <url>/posts/25094.html</url>
    <content><![CDATA[<p>题意：有若干交换生、若干学校，有人希望从A校到B校，有的想从B到C、C到A等等等等。如果有人想从A到B也刚好有人想从B到A，那么可以交换（不允许一对多、多对一）。看作后如果有人找不到人交换，那么整个交换计划失败。</p>
<hr>
<p>代码：（Accepted， 50ms）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa10763 - Foreign Exchange</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> N, a, b,all[<span class="number">1003</span>][<span class="number">1003</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N) != <span class="number">-1</span> &amp;&amp; N != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">memset</span>(all, <span class="number">0</span>, <span class="keyword">sizeof</span>(all));</span><br><span class="line">		<span class="keyword">while</span> (N--) &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;a, &amp;b);</span><br><span class="line">			++all[a][b], --all[b][a];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> *p = all[<span class="number">0</span>], i = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (;i &lt; <span class="number">1006009</span>;++i, ++p)</span><br><span class="line">			<span class="keyword">if</span> (*p != <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="built_in">printf</span>(i&lt;<span class="number">1006009</span> ? <span class="string">"NO\n"</span> : <span class="string">"YES\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>分析：一开始我使用multimap &lt; int,int &gt;去完全的模拟，但是其实我不大会使用，不知道怎么删除单个元素而不把整个key删除，就把那个元素置为-1。最后遍历一遍看看有没有不是-1的。结果。。。。虽然一遍过了，蛮开心，但一看结果1870ms！！！我的天呐！我开始怀疑人生啦！近2000毫秒什么鬼！突然怀疑我是不是不适合计算机这个专业/(ㄒoㄒ)/~~。于是去网上看他们怎么做的。好吧，好好一个题目被我搞复杂了。神经病啦，谁需要用到multimap啦。 看到网上有几个方法： 1. 就是我现在的方法，定义一个二维数组all，all[A][B]即为A到B的人数。下标1000就够了，题目的数据里没有标号更大的学校（但1000*1000还是好大！又是空间换时间的交♂易，不过这场交♂易明显合算啊）。 2. 把“原来所在学校x”到“交换目标学校y”的数据输入数组后，排序；再按照y到x的顺序存入数组，排序；若两个数组一样，则yes。相当好的想法呢。就是实现烦一点而且有bug（待会说）。 3. 直接统计各个学校想进来、想出去的人数，看看是不是平衡。与方法2有一样的bug。</p>
<p>好，说说那个bug。就是甲：A→B；乙：B→C；丙：C→A；的情况。题目只说了A到B、B到A可行，没说这个也行。但是VJ和博客上看到好多这两个方法的也AC了，而且代码又快又少。一开始有点懵圈了，不知道是题目没说清还是代码的bug。现在想想应该是网友没想到这点吧。但是我还是用法三做了一遍：（法三，Accepted， 60ms）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa10763 - Foreign Exchange</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> N, a, b;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N) != <span class="number">-1</span> &amp;&amp; N != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; all;</span><br><span class="line">		<span class="keyword">while</span> (N--) &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;a, &amp;b);</span><br><span class="line">			++all[a], --all[b];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">bool</span> num = <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;r : all)</span><br><span class="line">			<span class="keyword">if</span> (r.second) &#123; num = <span class="literal">true</span>;<span class="keyword">break</span>; &#125;</span><br><span class="line">		<span class="built_in">printf</span>(num ? <span class="string">"NO\n"</span> : <span class="string">"YES\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>出人意料的那个用all[1003][1003]的方法比法三那个投机取巧还便宜了10ms。map有这么慢？好吧。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-3UVa10935 - Throwing cards away I</title>
    <url>/posts/64810.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO</p>
<hr>
<p>代码：（Accepted，0 ms）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa10935 - Throwing cards away I</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> N;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N) != <span class="number">-1</span> &amp;&amp; N != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; C;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= N;++i) C.push(i);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Discarded cards:"</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">0</span>;n &lt; N - <span class="number">1</span>;++n) &#123;</span><br><span class="line">			<span class="keyword">if</span> (n) <span class="built_in">printf</span>(<span class="string">","</span>);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">" %d"</span>,C.front());</span><br><span class="line">			C.pop();</span><br><span class="line">			C.push(C.front());</span><br><span class="line">			C.pop();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"\nRemaining card: %d\n"</span>, C.front());</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>题意：N张扑克从1到N编号，表面那张扔掉，表面那张放最后去；表面那张扔掉，表面那张放最后去；表面那张扔掉，表面那张放最后去；表面那张扔掉，表面那张放最后去……直到只剩一张。求扔牌的顺序和最后一张。</p>
<hr>
<p>分析：用了紫书教的queue，直接模拟，pop一张，然后把front的一张push到最后面去，再pop掉这张。直至只剩一张。 本来想直接在N张牌的数组里面，用指针p先指向第一张，把应扔掉的牌设为0，再搜索下一张不为0的牌（当p一直搜索直至指向最后一张牌的后面时，把p拉回第一张。所以其实搞个环形链表倒是不错，就是STL里我不知道list能不能做成环形的，又不高兴自己做。）。但是虽然应该快一点，实现起来比较烦，而且遇到了奇怪的bug，整了半天愣是没找出来出错的原因，鼻子都气歪了（第一次花了一下午找不出自己的错误在哪里，还是在短短的二三十行里，很不服。）。最后还是全部推倒重来，用了队列，还顺便熟悉下queue。然后发现也不会慢。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-2UVa1594 - Ducci Sequence</title>
    <url>/posts/3706.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO</p>
<hr>
<p>代码：（Accepted，20 ms） <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1594 - Ducci Sequence</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> T,N;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_zero</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;d)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;i : d)</span><br><span class="line">		<span class="keyword">if</span> (i) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">	<span class="keyword">while</span> (T--) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; D(N);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i : D) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;i);</span><br><span class="line">		<span class="keyword">int</span> i = <span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">while</span> (++i&lt;<span class="number">200</span>) &#123;</span><br><span class="line">			<span class="keyword">int</span> D0 = D[<span class="number">0</span>];</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N<span class="number">-1</span>;++i)</span><br><span class="line">				D[i] = <span class="built_in">abs</span>(D[i] - D[(i + <span class="number">1</span>)]);</span><br><span class="line">			D[N - <span class="number">1</span>] = <span class="built_in">abs</span>(D[N - <span class="number">1</span>] - D0);</span><br><span class="line">			<span class="keyword">if</span> (is_zero(D)) <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(i==<span class="number">200</span>?<span class="string">"LOOP\n"</span>: <span class="string">"ZERO\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>题意：一个数组每次做一定变换，问最后他是循环了还是数据全都变成0了。</p>
<hr>
<p>分析：模拟每一步，没什么思路。但是纯模拟量很大。 一开始我直接无限模拟每一步，看是不是全变成0了，还是有没有进入循环。 用了set来存储每一步的结果，用set的count函数来判断是不是进入循环了。代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1594 - Ducci Sequence</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> T,N;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_zero</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;d)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;i : d)</span><br><span class="line">		<span class="keyword">if</span> (i) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">	<span class="keyword">while</span> (T--) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; D(N);</span><br><span class="line">		<span class="built_in">set</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &gt; P;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i : D) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;i);</span><br><span class="line">		P.insert(D);</span><br><span class="line">		<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">			<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; D2(N);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; N;++i)</span><br><span class="line">				D2[i] = <span class="built_in">abs</span>(D[i] - D[(i + <span class="number">1</span>) % N]);</span><br><span class="line">			<span class="keyword">if</span> (is_zero(D2)) &#123; <span class="built_in">printf</span>(<span class="string">"ZERO\n"</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line">			<span class="keyword">if</span> (P.count(D2)) &#123; <span class="built_in">printf</span>(<span class="string">"LOOP\n"</span>); <span class="keyword">break</span>; &#125;</span><br><span class="line">			D = D2;</span><br><span class="line">			P.insert(D);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是结果把我从椅子上吓得掉下去：“Time: 520 MS”！一口老血喷了出来（与上面最终提交的结果差了十万八千里！）。想了想，问题在哪里呢？于是去网上看了大神们的做法：他们都没有做数据是否循环的检查。原来如此，虽然set的检查已经很快了，但是如此庞大的检查量还是不敢恭维。直接不检查，1000次循环，要么出现全0，否则就是循环了，题目给你保证了不过1000的。现在知道了，原来还可以这么玩！ 于是我又去除set的循环检查又提交一遍，100ms。那么与别人的40ms、50ms又差在哪儿呢？一看，人家只循环了500次甚至更少。为什么呢？我试了200，依然AC。想找点规律会不会保证它在200之内必有结果，没找出来。或许是题目的数据太水了原因。（本来猜想只要有一半的数字是一样的就应该是loop，想提交试试的，但是想想加个这样的判断并不合算）所以100ms差不多了。像我这样算是钻空子了。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 5-1UVa1593 - Alignment of Code</title>
    <url>/posts/27312.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO</p>
<hr>
<p>代码：（Accepted，0 ms） <figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1593 - Alignment of Code</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iterator&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">string</span>&gt; <span class="built_in">text</span>[<span class="number">1009</span>];</span><br><span class="line"><span class="keyword">int</span> num[<span class="number">100</span>] = &#123; <span class="number">0</span> &#125;, X = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> <span class="built_in">line</span>[<span class="number">200</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="built_in">while</span> (cin.getline(<span class="built_in">line</span>, <span class="number">200</span>)) &#123;</span><br><span class="line">		istringstream in(<span class="built_in">line</span>);</span><br><span class="line">		istream_iterator&lt;<span class="keyword">string</span>&gt; fi(in), eof;</span><br><span class="line">		<span class="keyword">int</span> y = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">while</span> (fi != eof) &#123;</span><br><span class="line">			<span class="built_in">text</span>[X].push_back(*fi);</span><br><span class="line">			num[y] = <span class="built_in">max</span>(num[y], (<span class="keyword">int</span>)fi-&gt;<span class="built_in">size</span>());</span><br><span class="line">			++y, ++fi;</span><br><span class="line">		&#125;</span><br><span class="line">		++X;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; X;++i) &#123;</span><br><span class="line">		<span class="keyword">int</span> t = <span class="built_in">text</span>[i].<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; t;++j)</span><br><span class="line">			cout &lt;&lt; left &lt;&lt; setw(num[j] + <span class="number">1</span>) &lt;&lt; <span class="built_in">text</span>[i][j];</span><br><span class="line">		cout &lt;&lt; *(<span class="built_in">text</span>[i].rbegin()) &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>题意：把很多行的单词排整齐。本来每一行中的各个单词之间含有随机个空格或tab，现在要求每一列单词左对齐。很好懂。</p>
<hr>
<p>分析：思路很简单：找出每一列单词的最大字母数，再根据此输出即可。紫书也说了，这章不难，主要练习一下STL。之前我抱着C++ Primer也啃了很久，那这章就把之前学到的不管是不是很偏的东西尽量都用上吧。 读取文件不仅用了&lt;<em>sstream</em>&gt;，而且用了头文件iterator，用了流迭代器。其实流迭代器这里并没有什么优势，直接用流读入就行。我只是练习一下。（因为对流还能有迭代器感觉很神奇） 对于头文件&lt;<em>algorithm</em>&gt;，用到了max函数。其实在这里的情况下并没有很划算。就是 a=max(a,b);的情况。直接if (a &lt; b) a = b;更好，这样还省掉一些赋值。 输出直接用了头文件&lt;<em>iomanip</em>&gt;里的setw对齐，left左对齐,方便的很！</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>cin、cout与scanf、printf的效率差异对比分析</title>
    <url>/posts/30653.html</url>
    <content><![CDATA[<p>之前上传UVa227 puzzle时，好不容易AC了，但发现自己用时50(ms)，而在VJ上看到人家都是40ms、20ms，于是打开一个20ms的代码查看人家强在哪里。但结果研究了半天感觉差不多，于是想着应该不是算法的问题。然后又想到，网上提交的答案，大家都是用scanf和printf写的，而我用的cin cout，而这题的确需要大量的输入输出，于是就想着把所有cin cout改成scanf printf。结果 —。— <img src="/posts/30653/1.png" alt="这里写图片描述"> 上面c++版，下面c版。 于是我很好奇C的输入输出方法和C++提倡的方法为什么差距那么大。经过一番研究和查询，结果如下： <strong>首先是scanf和cin：</strong> cin之所以慢，主要是因为要与scanf同步的关系，即允许scanf与cin混用。但是如果你的代码里没用到scanf，那么想关闭同步也可以。 只要使用这行代码，就可关闭同步：std::ios::sync_with_stdio(false); 关闭同步后的cin效率大大提高。有人说比scanf还高，有人说差不多，网上评论不一。其实cin关闭同步后真正的效率如何还是依赖编译器。下面这篇博文很详尽地比较了cin和关闭同步的cin和scanf：https://www.byvoid.com/blog/fast-readfile 。看完这篇基本就可以了解性能上的差异了，编译器占的因素蛮大的。那么关了同步的cin与scanf差不多，但是cin是新标准，更安全更便捷。况且string只能用cin。 <strong>然后是printf和cout：</strong> 对于cout和printf，则效率差异不明显。有人认为流更快有人认为printf快，逛论坛查询时看到他们都吵起来了。具体怎样我又找到一篇博文：http://www.cnblogs.com/killerlegend/p/3918452.html 。他的结论是：输出时尽量使用cout,输入时尽量使用scanf。不过我也测试了，试了点最简单的： <figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">clock_t </span>a, <span class="keyword">b;</span></span><br><span class="line"><span class="keyword">	</span>a = <span class="keyword">clock();</span></span><br><span class="line"><span class="keyword">	</span>for (int i = <span class="number">0</span><span class="comment">;i &lt; 29999;++i)</span></span><br><span class="line">		cout &lt;&lt; i &lt;&lt; <span class="string">'\n'</span><span class="comment">;</span></span><br><span class="line">	<span class="keyword">b </span>= <span class="keyword">clock();</span></span><br><span class="line"><span class="keyword">	</span>cout &lt;&lt; <span class="keyword">b </span>- a<span class="comment">;</span></span><br><span class="line">	return <span class="number">0</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 与 <figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">clock_t </span>a, <span class="keyword">b;</span></span><br><span class="line"><span class="keyword">	</span>a = <span class="keyword">clock();</span></span><br><span class="line"><span class="keyword">	</span>for (int i = <span class="number">0</span><span class="comment">;i &lt; 29999;++i)</span></span><br><span class="line">		printf(<span class="string">"%d\n"</span>,i)<span class="comment">;</span></span><br><span class="line">	<span class="keyword">b </span>= <span class="keyword">clock();</span></span><br><span class="line"><span class="keyword">	</span>printf(<span class="string">"%d"</span>,<span class="keyword">b </span>- a)<span class="comment">;</span></span><br><span class="line">	return <span class="number">0</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 结果是：cout用时6124，printf用时3536。cout比printf差了一倍不到。而且对于cout，那句“std::ios::sync_with_stdio(false);”其实是不起作用的，它只针对cin。于是我的结论与上面链接里的博文相反。 所以cout和printf效率可以说差不多，主要还是看编译器吧。使用时也不必纠结，只是cout毕竟新标准，更安全适用面更广更灵活。</p>
<p><strong>最后：</strong> 本文讨论的输入输出使用仅仅针对ACM做题。scanf的确快，拿来做题还是很不错的。输入量少的话拿cin也毫无问题，刷个题目也没必要特地跑过去关闭同步。而且cin更安全更便捷，还支持重载。且对于string与自定义的数据，就只能用cin、cout没跑了。 对于我们这种有强迫症、选择恐惧症的，有两个方法给你自由选择也未必是个好事。不分分清楚心理难受哈哈。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
      </categories>
      <tags>
        <tag>笔记</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 4-10UVa815 - Flooded!</title>
    <url>/posts/14458.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO</p>
<hr>
<p>代码：（Accepted，0 ms）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa815 - Flooded!</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> M, N, W, S[<span class="number">1000</span>], T = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;M, &amp;N) != <span class="number">-1</span> &amp;&amp; M != <span class="number">0</span> &amp;&amp; N != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, *p = S;i &lt; M*N;++i)</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, p++);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;W);</span><br><span class="line">		<span class="built_in">std</span>::sort(S, S + M*N);</span><br><span class="line">		<span class="keyword">int</span> i, water = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">1</span>;i &lt; M*N;++i) &#123;</span><br><span class="line">			<span class="keyword">int</span> t = water + i*(S[i] - S[i - <span class="number">1</span>]) * <span class="number">100</span>;</span><br><span class="line">			<span class="keyword">if</span> (t &gt;= W) <span class="keyword">break</span>;</span><br><span class="line">			water = t;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">float</span> level = (<span class="keyword">float</span>)(W - water) / (<span class="keyword">float</span>)(i * <span class="number">100</span>) + S[i - <span class="number">1</span>];</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Region %d\nWater level is %.2f meters.\n"</span>, ++T, level);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%.2f percent of the region is under water.\n\n"</span>, (<span class="keyword">float</span>)(i * <span class="number">100</span>) / (<span class="keyword">float</span>)(M*N));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>题意：简单的理解，就是给你一个铁桶，铁桶桶壁无限高，桶底是个长方形，一边长M · 10米，另一边长N · 10米。把这个桶底分为M · N个正方形区域，即每个正方形边长10米。现在每单个正方形区域高度处处都是一样的，每个不同的区域高度不一。现在一桶体积位W的水倒进去，问淹了多少区域，水高度多少。</p>
<hr>
<p>分析：看懂这题后感觉很惊奇，原来在现实生活中都没想过的简单问题在编程里实现要考虑的东西还不少！紫书说：本题有多种解法，可以锻炼思维。那我先说说我想到的方法吧：</p>
<ol type="1">
<li>计算平均海拔后再看哪些地本应该是露在外面的，依此调整水高度。但是后来发现并不合算。</li>
<li>一桶水全浇第一块地上，往旁边扩散。但是怎么实现。。想想也不合算。</li>
<li>每10 · 10 · 1体积的水填进最低海拔的区域去，对于一样高的区域随便填哪个。直到最后可能发现水平面不平，把凸出来的水平均划分到整个没在水里的区域。但是按每一个单位的水来循环，循环量很大，最后凸出来的水也要分开计算。</li>
<li>现在使用的方法。（本来想到好几个方法，最后发现其实都很相近，把这些类似的方法整合、优化成了这一个）升序排序每一个区域的高度，一个区域一个区域地填水。具体如下： <img src="/posts/14458/1.png" alt="这里写图片描述"></li>
</ol>
<figure>
<img src="/posts/14458/2.png" alt="这里写图片描述"><figcaption>这里写图片描述</figcaption>
</figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 4-9UVa1591 - Data Mining</title>
    <url>/posts/55710.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO</p>
<hr>
<p>代码：（Accepted，0 ms） <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">unsigned</span> N, A, B, Sp, Sq, ansA, ansB;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> Pofs, K, nowK;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%u%u%u"</span>, &amp;N, &amp;Sp, &amp;Sq) != <span class="number">-1</span>) &#123;</span><br><span class="line">		K = <span class="number">0xffffffffffffffff</span>;</span><br><span class="line">		<span class="keyword">for</span> (A = <span class="number">0</span>;A &lt; <span class="number">32</span>;++A) <span class="keyword">for</span> (B = <span class="number">0</span>;B &lt; <span class="number">32</span>;++B) &#123;</span><br><span class="line">			Pofs = (N - <span class="number">1</span>)*Sp;</span><br><span class="line">			nowK = (Pofs + (Pofs &lt;&lt; A) &gt;&gt; B) + Sq;</span><br><span class="line">			<span class="keyword">if</span> (nowK &gt;= N*Sq &amp;&amp; nowK &lt; K) K = nowK, ansA = A, ansB = B;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%llu %u %u\n"</span>, K, ansA, ansB);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p><strong>题意</strong>：看着好复杂的题目。看了半天不懂，看网上人家的解释也是一头雾水。于是花了好久把他翻译并理解。翻译只是大概翻翻，但和原意基本一致，括号内的内容是我最终理解的内容。 翻译如下： Tuple博士正在给ACM公司研究数据挖掘。其中一个子工程是关于P、Q两个数组的，两个数组各含N组数据（<em>这个“组”的单位是record，不知道怎么翻译好。论好好学习英语的重要性。</em>）。这N个record的数据从0到N-1命名。数组P包含含密钥的类似哈希的结构。P用来给程序定位要用哪个record，且这个数据的对应的Q里的record待会会从Q数组里恢复出来（<em>如紫书中文的理解就是知道P的第i个record的偏移量求Q第i个数据的偏移量</em>）。 数组P中的每个record长度为Sp字节，Q的每个record长Sq字节。Tuple酱需要最最高效地执行这个程序，因为这是整个数据挖掘一直要用到的地方。但是坑爹的是Sp和Sq只在运行时知道其大小，没法在编译时进行优化（<em>哦就跟定义数组必须要用常量来定义的原因类似</em>）。 找到P数组的第i个record的偏移量（<em>不懂偏移量是什么，差不多就是指：比如一个数组a[10]，那么a[3]的地址在首地址的右边地三个，偏移量就是(&amp;a[3]-a) · sizeof(int)，也就是3 · sizeof(int)。如果我没猜错应该就是了</em>）的最直接的方法是用以下函数： Pods(i) = Sp * I (1) Q的也一样： Qods(i) = Sq * I (2) 但是！乘法比加减法慢多了（<em>哦你好烦啊，直接说你最后用了什么就行了啊</em>）。Tuple酱拒绝使用乘法。那么他怎么做的？他保存了已经计算好的第i个record的偏移量Pofs(i)，而不是保存这个下标（索引）i（<em>哦就相当于一个数组a[10]，你已经计算得你要的数据是a[2]，现在别人要调用a[2]，你给他</em> p=&amp;a[2]比直接给他i=2让他自己找到a{2}更快。是这个意思吧<em>）。于是现在当他需要计算第i个record旁边的record的偏移量时，就用下面的方程： Pofs(i + 1) = Pofs(i) + Sp Pofs(i - 1) = Pofs(i) – Sp （</em>好吧，原来就相当于我们遍历数组时用指针<em>p先指向首地址，然后不停p++指向下一个数据一样啊，比直接调用a[i++]快啊</em>） 当一个P的record不管是用上面两个方法的哪个（用乘法扫描数组，及用其他数据的偏移量用加减法获得），Tuple酱需要从对应Q数组把数据恢复进去。要获取Q的record的偏移量Qofs(i)也要计算。当Pofs(i)已知时可以直接用(1)、(2)两个函数求得Qofs(i)。 Qofs(i) = Pofs(i)/SP <em>SQ (3)（</em>就把(1)、(2)整合了一下<em>） 然后又来了。“Unfortunately”，这个函数不仅有乘法，甚至还有除法！“我不管我不管，乘除就是比加减慢！我就是不允许乘除的出现！” Tuple酱傲娇地鼓起了腮帮。 最后Tuple酱研究得出，可以这么求Qofs(i)： Qofs'(i) = (Pofs(i) + Pofs(i) &lt; &lt; A) &gt; &gt; B (4) （</em>Qofs'(i)那个’不是求导的意思哦，我说一开始怎么没看懂。<em>）(</em>等一下让我查一下位移运算和加法运算的优先级。。。好的+比&lt;&lt;优先级高？？不对啊，那他要这个括号干嘛？看了下别人的代码，这里题目错了。应该是(Pofs(i) +（(Pofs(i) &lt; &lt; A)) &gt; &gt; B。但是还是没看懂怎么从(3)推出这个式子的??!!<em>）（</em>好的现在看懂了，这是一个新方法，和(3)无关，不是从(3)推导出来的。这个方法牺牲了些没用上的内存但是速度快了。详见分析<em>） A和B是无符号整形。这个函数跑的比(3)不知道快到哪里去了。但是不管A、B选何值，它一般不能总是产生和(3)一样的结果（</em>喵喵喵？？？为什么不一样？没看懂。根据紫书：“为了让(4)成立，在P数组连续存储的情况下Q可以不连续存储”我去？哪里说可以不连续存储了。好吧现在看懂了，最下面一起讲。<em>）。但是如果你愿意牺牲点内存，你还是可以用。 传统的布局里，Q在内存里需要N</em>Sq字节去储存整个数组。Tuple发现总是可以找到一个K（K&lt;=N<em>Sq）（</em>题目反了吧？？！！K&gt;=N · Sq还差不多，看样例输入输出也明显是1119&gt;=1024 · 1*），如果分配K字节的内存给Q且小心地找A和B的值，(4)会给不重复的把存储地址给数组Q的N个record。 你的目标是写一个程序找出当(4)被用时最小的内存K去分配给Q，对应的A、B也要找出来。若多个A、B得到一样的最小的K，那么找出A最小的那组，还不行，那就找B最小的。 (这个CSDN-markdown编辑器好垃圾啊，为什么不能输出多个空格？导致不能每段首行缩进两个字？？！！狂按空格也没效果。。我按空格你也要管。。)</p>
<hr>
<p><strong>分析</strong>：好的那么就是说 （比如如图，P是上面那个，每个数据占3bit，Q占2bit）以P的某个数据的偏移量按照(4)快速求出Q对应数据的地址（算的快的结果是部分内存没用上）。所以原来(3)、(4)不是等价的，是Tuple酱另外想的方法。我说怎么死活看不懂、推不出来(4)这个公式。<img src="/posts/55710/1.png" alt="这里写图片描述"> 所以简言之，已知A和B，P的每一个元素的偏移量Pofs（其实就是第i个元素首地址位置）通过含A和B的公式4计算得出Qofs（即求出Q的第i个元素的位置）后，即知道了Q的各个元素的位置。现在要求找出Q最少占用多少空间，即求Q的后一个元素的最后一个字节的地址与分配的第一个内存地址的距离即可。（本来我还想Q的各个元素的存储位置不能重叠，要不要判断，但是题目已经说了，用公式4保证不会出现存储重叠） 那么暴力枚举A，B即可。而还有个问题，A，B没说范围。那么因为 &gt; 1 ≤ N ≤ 2^20,1 ≤ SP ≤ 2^10,1 ≤ SQ ≤ 2^10</p>
<p>因为Pofs最大为(N-1)<em>Sp，所以这里最大(2^20-1) · 2^10差不多2的30次方。而long long64位，也就30多位可以给你移的。而且参考了 http://blog.csdn.net/code4101/article/details/38540759 这篇博文，那么30多次的枚举就行了。那么说到这里，这题其实是个超简单的题目。 /</em> 本来我一开始看题目时觉得这都什么鬼，看不懂。 但是看到紫书上说“本题有一定实际意义，不过描述比较抽象。如果对本题兴趣不大，可以先跳过。”于是瞬间来了兴趣... （—。—） 哈哈我简直是个受虐狂。 */</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 4-8UVa12108 - Extraordinarily Tired Students</title>
    <url>/posts/50108.html</url>
    <content><![CDATA[<p>﻿书上具体所有题目：http://pan.baidu.com/s/1hssH0KO 代码：（Accepted，0 ms）</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa12108 - Extraordinarily Tired Students</span></span><br><span class="line">#include&lt;iostream&gt;</span><br><span class="line">struct how_cute_my_sleepy_boys_are &#123;</span><br><span class="line">	<span class="built_in">int</span> a,<span class="comment">//awaken period :		a&gt;=1;</span></span><br><span class="line">		b,<span class="comment">//sleeping period :	b&lt;=5;</span></span><br><span class="line">		s,<span class="comment">//state :				0醒着,1睡觉;</span></span><br><span class="line">		t;<span class="comment">//time :				睡/醒到什么时候;</span></span><br><span class="line">&#125;g[<span class="number">12</span>];</span><br><span class="line"><span class="built_in">int</span> n, c, mi, cnt, T = <span class="number">0</span>;<span class="comment">//cnt:统计睡着的人;mi:minute</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="keyword">while</span> (scanf(<span class="string">"%d"</span>, &amp;n) &amp;&amp; n != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> I = <span class="number">0</span>;I &lt; n;++I) &#123;<span class="comment">//读入数据</span></span><br><span class="line">			scanf(<span class="string">"%d%d%d"</span>, &amp;g[I].a, &amp;g[I].b, &amp;c);</span><br><span class="line">			g[I].s = (c &gt; g[I].a ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">			g[I].t = (g[I].s ? g[I].a + g[I].b - c + <span class="number">1</span> : g[I].a - c + <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (mi = <span class="number">1</span>;mi &lt; <span class="number">400</span>;++mi) &#123;<span class="comment">//直接循环400分钟，不高兴做-1这一情况的循环检查了</span></span><br><span class="line">			cnt = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="built_in">int</span> I = <span class="number">0</span>;I &lt; n;++I)<span class="comment">//计算本分钟的睡觉人数</span></span><br><span class="line">				<span class="keyword">if</span> (g[I].s == <span class="number">1</span>) ++cnt;</span><br><span class="line">			<span class="keyword">if</span> (!cnt) <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="built_in">int</span> I = <span class="number">0</span>;I &lt; n;++I) &#123;<span class="comment">//睡或醒状态转换</span></span><br><span class="line">				<span class="keyword">if</span> (g[I].t != mi) <span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">if</span> (g[I].s == <span class="number">1</span>) g[I].s = <span class="number">0</span>, g[I].t += g[I].a;</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span> (cnt &gt; n / <span class="number">2</span>) g[I].s = <span class="number">1</span>, g[I].t += g[I].b;</span><br><span class="line">				<span class="keyword">else</span> g[I].t += g[I].a;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		printf(<span class="string">"Case %d: %d\n"</span>, ++T, !cnt ? mi : <span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>题意：一个班级所有学生个个是特“困”生。每个人睡着和醒着有一定规律，那就是：醒着a分钟，然后想睡觉了，环顾四周，如果睡着的人比醒着的多，那我也睡，睡b分钟后再坚挺a分钟，否则直接再坚挺a分钟。简言之，也就是每醒a分钟就检查接下来是继续醒a分钟还是睡b分钟后再醒a分钟。（这“醒a分钟-睡b分钟”的a+b分钟被题目称为一个周期。）然后每个学生一上课就有个初始状态，是在各自醒-睡周期的第几分钟。求何时第一次全班醒着，还是说全班永远有人在睡觉。</p>
<p>分析：直接模拟每一分钟即可。struct一个结构体储存每个学生的状态，存放内容代码注释里已经很详细。本来t想存放的是还有几分钟到达目前状态的最后一分钟，但转念一想这样的话每分钟都要自减一次，直接存到哪一分钟更为便捷。具体模拟没用问题，很简单。 最大的问题是，就是老师上课永无天日的情况，永远没人醒着。本来我想做个数组存放每分钟的状态检查其是否构成循环，想想略麻烦，但是我看网上大家好多人都没检查，直接从一分钟检测到1000分钟（或其他很大的数字），1000分钟后还是没有全醒的情况就直接判定为“it'll never happen”。的确不够严谨但是很方便。最后昨晚睡觉前想了下，决定使用这个不严谨的方案。理由如下：</p>
<ol type="1">
<li>本来这每一分钟的模拟运算量就很小，还要每一分钟都去循环判断，有循环且循环很短的情况下不错，但是如果循环有几百分钟或很久后找到全醒的情况，综合这些情况下好像并不很合算。</li>
<li>题目的状态转换并不复杂，1000分钟甚至更短（我用的400分钟就AC了）该循环的绝对能循环了，当然数学上肯定能求出个这个分钟的最小值，也没必要去搞吧。</li>
<li>谁上个课上1000分钟啊！！！我一开始循环的150分钟，也已经2.5个小时了，结果WA，改成400分钟，AC了。400分钟已经6.666小时了。嗯，可以，老师学生们都很666。。。</li>
<li>听谁说过：竞赛题没人看你的代码是否优美，它也不关心你的算法，只要通过就行。→.→适当投机有益身心健康哈（大雾）。</li>
<li>懒得写循环检查了哈哈&gt;_&lt;。</li>
</ol>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 4-7UVa509 - RAID!</title>
    <url>/posts/26431.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO 代码：（Accepted，0 ms）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa509 - RAID!</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> d, s, b, t, times = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> disk_data[<span class="number">7</span>][<span class="number">6666</span>], type;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span>* <span class="title">disk</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>&#123;<span class="comment">//二维数组当作三维数组使,方便运算</span></span><br><span class="line">	<span class="keyword">return</span> *(disk_data + x - <span class="number">1</span>) + (y - <span class="number">1</span>)*s + z - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">char</span>* <span class="title">parity</span><span class="params">(<span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>&#123;<span class="comment">//定位到当前一行blocks的parity</span></span><br><span class="line">	<span class="keyword">return</span> *(disk_data + (y - <span class="number">1</span>) % d) + (y - <span class="number">1</span>)*s + z - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_data</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> f = <span class="number">1</span>, n = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= b;++j) <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= d;++i) <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= s;++k) &#123;</span><br><span class="line">		<span class="keyword">if</span> (disk(i, j, k) == parity(j, k)) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">if</span> (f == <span class="number">5</span>) &#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%X"</span>, n);</span><br><span class="line">			f = <span class="number">1</span>, n = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		n = (n &lt;&lt; <span class="number">1</span>) + *disk(i, j, k) - <span class="number">48</span>;</span><br><span class="line">		++f;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%X\n"</span>, (n &lt;&lt; (<span class="number">5</span> - f)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;d) &amp;&amp; d != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d\n%c"</span>, &amp;s, &amp;b, &amp;type);</span><br><span class="line">		t = (type == <span class="string">'E'</span> ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; d;++i)</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%s"</span>, disk_data[i]);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= b;++j) <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= s;++k) &#123;<span class="comment">//数据读取完毕,开始检测</span></span><br><span class="line">			<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">bool</span> flag = <span class="literal">false</span>;<span class="comment">//0:没有x问题;1:有一个x;</span></span><br><span class="line">			<span class="keyword">char</span> *p;<span class="comment">//定位x的位置</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= d;++i) &#123;</span><br><span class="line">				<span class="keyword">if</span> (*disk(i, j, k) != <span class="string">'x'</span>) sum += *disk(i, j, k) - <span class="string">'0'</span>;</span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span> (flag) <span class="keyword">goto</span> o_O;<span class="comment">//invalid:two or more disks are unavailable for that block</span></span><br><span class="line">				<span class="keyword">else</span> p = disk(i, j, k), flag = <span class="literal">true</span>;<span class="comment">//出现第一个x,并定位</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (flag) *p = (sum % <span class="number">2</span> == t ? <span class="string">'0'</span> : <span class="string">'1'</span>);<span class="comment">//计算x</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (sum % <span class="number">2</span> != t) <span class="keyword">goto</span> o_O;<span class="comment">//invalid:a parity error is detected</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Disk set %d is valid, contents are: "</span>, ++times);<span class="comment">//能执行完所有循环的才是真男人</span></span><br><span class="line">		print_data();</span><br><span class="line">		<span class="keyword">continue</span>;</span><br><span class="line">	o_O:<span class="built_in">printf</span>(<span class="string">"Disk set %d is invalid.\n"</span>, ++times);<span class="comment">//我就是用goto了怎么着!跳出三重循环用goto多方便</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>题意：好几块硬盘组RAID，组的方法是每个硬盘都平均划分成b个块(block)，每块硬盘的第i个块一起组成一个区域（也就是一块数据平均保存在n个硬盘里，实际上说是保存在n-1个硬盘里更合理，因为其中一块硬盘的这个区域保存的是用于数据恢复用的，名为parity block）同时不同parity还错开保存在不同的硬盘里，这样就有效防止了某个硬盘损坏导致全盘数组丢失。 而这个parity存的又到底是什么呢，是这一行每个data block对应的每个bit进行某种运算得来。运算法则可理解为，每个bit存的0或1进行相加，若结果(在我的代码里用sum表示)为偶数，parity对应bit储存为0，否则为1（even的情况。odd反过来：若为奇数储存为0。没什么意义，就是个标准不同）。 然后就是校验数据是否损坏。若直接告诉你一行里有一个损坏(表示为x)，那么没关系，可以通过其他那几个盘恢复。若一行里有俩损坏，那就没戏了。若一行没有出现x，那么所有数据相加，结果若为0（E的情况。O为1）则数据正常，否则出错。</p>
<p>分析：没什么特殊的思路，就一步步按照题目来呗。输入的格式和题目给的图表格式坐标是反的，比较讨厌。得用到三重循环，不同地方循环的顺序还不一样，比较绕，思路要理清了。然后三重循环跳出麻烦（因为我把其中两个循环写在了一行，这样理解上方便，代码看着也清楚，所以不方便加大括号），我就用了goto。是的我就是用goto了怎么着啦o_O！你咬我啊！在这种情况下多好用！具体算法都在代码注释里了。 还有那个print_data()函数，那个三重循环里面我本来写的是</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (int <span class="built_in">j</span> = <span class="number">1</span>;<span class="built_in">j</span> &lt;= b;++<span class="built_in">j</span>) <span class="keyword">for</span> (int <span class="built_in">i</span> = <span class="number">1</span>;<span class="built_in">i</span> &lt;= d;++<span class="built_in">i</span>) <span class="keyword">for</span> (int k = <span class="number">1</span>;k &lt;= s;++k) &#123;</span><br><span class="line">        <span class="keyword">if</span> (f == <span class="number">5</span>) &#123;</span><br><span class="line">            printf(<span class="string">"%X"</span>, n);</span><br><span class="line">            f = <span class="number">1</span>, n = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (disk(<span class="built_in">i</span>, <span class="built_in">j</span>, k) == parity(<span class="built_in">j</span>, k)) <span class="keyword">continue</span>;</span><br><span class="line">        n = (n &lt;&lt; <span class="number">1</span>) + *disk(<span class="built_in">i</span>, <span class="built_in">j</span>, k) - <span class="number">48</span>;</span><br><span class="line">        ++f;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也就是三个步骤（是否输出、当前数据是否是parity的、是否读入数据到n）顺序不一样。我原本的目的是除了最后一个十六进制数字，其他均在三重循环里输出。理由是最后一个数据比较特殊，它有可能不满4bit，要手动添加0直至其满4bit，而且顺便要输出换行。下面这个版本有个bug，就是如果最最后一个block是parity block，那么会多输出一个0。原因很简单我就不说了，但是怎么改动我倒是想了很久，怎么改都要加变量、加好几个if，代码瞬间复杂很多，我不太情愿。最后发现只需要顺序倒一下即可！ 果然编程这个东西，顺序很重要啊。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 4-6UVa508 - Morse Mismatches</title>
    <url>/posts/55954.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO 代码：（Accepted，10 ms）</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa508 - Morse Mismatches</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">char</span>, <span class="keyword">string</span>&gt; morse;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; <span class="keyword">word</span>;</span><br><span class="line"><span class="keyword">string</span> wo, tran, result;</span><br><span class="line"><span class="keyword">char</span> c;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cmp(<span class="keyword">string</span> a, <span class="keyword">string</span> b) &#123;</span><br><span class="line">	<span class="built_in">if</span> (a == b) <span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">if</span> (a.<span class="built_in">size</span>() &gt; b.<span class="built_in">size</span>()) a.swap(b);</span><br><span class="line">	<span class="built_in">if</span> (a == b.substr(<span class="number">0</span>, a.<span class="built_in">size</span>())) <span class="built_in">return</span> b.<span class="built_in">size</span>() - a.<span class="built_in">size</span>();</span><br><span class="line">	<span class="built_in">return</span> <span class="number">666</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">	<span class="built_in">while</span> ((cin &gt;&gt; c) &amp;&amp; c != <span class="string">'*'</span>) cin &gt;&gt; morse[c];</span><br><span class="line">	<span class="built_in">while</span> ((cin &gt;&gt; wo) &amp;&amp; wo[<span class="number">0</span>] != <span class="string">'*'</span>) &#123;</span><br><span class="line">		<span class="keyword">auto</span> cp = wo.<span class="built_in">begin</span>();</span><br><span class="line">		tran = morse[*cp];</span><br><span class="line">		<span class="built_in">while</span> (++cp != wo.<span class="built_in">end</span>())</span><br><span class="line">			tran += morse[*cp];</span><br><span class="line">		<span class="keyword">word</span>[wo] = tran;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">while</span> ((cin &gt;&gt; tran) &amp;&amp; tran[<span class="number">0</span>] != <span class="string">'*'</span>) &#123;</span><br><span class="line">		result.<span class="built_in">clear</span>();</span><br><span class="line">		<span class="keyword">int</span> <span class="built_in">min</span> = <span class="number">888</span>;</span><br><span class="line">		<span class="built_in">for</span> (<span class="keyword">auto</span> i = <span class="keyword">word</span>.<span class="built_in">begin</span>();i != <span class="keyword">word</span>.<span class="built_in">end</span>();++i) &#123;</span><br><span class="line">			<span class="built_in">if</span> (i-&gt;second == tran)<span class="comment">//精确寻找</span></span><br><span class="line">				<span class="built_in">if</span> (!result.<span class="built_in">size</span>() || *result.rbegin() == <span class="string">'?'</span>) result = i-&gt;first;</span><br><span class="line">				<span class="built_in">else</span> &#123; result += <span class="string">"!"</span>;<span class="built_in">break</span>; &#125;</span><br><span class="line">			<span class="built_in">else</span> <span class="built_in">if</span> (!result.<span class="built_in">size</span>() || *result.rbegin() == <span class="string">'?'</span>) &#123;<span class="comment">//模糊寻找</span></span><br><span class="line">				<span class="keyword">int</span> n = cmp(tran, i-&gt;second);</span><br><span class="line">				<span class="built_in">if</span> (n&lt;<span class="built_in">min</span>) <span class="built_in">min</span> = n, result = i-&gt;first + <span class="string">"?"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; result &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：思路是先根据电报代码表把单词全部转换成代码，单词和其代码存在一个map里，然后一个个检测下面的码的匹配。精确匹配不用说，如果只找到一个，直接输出，找到多个的话还是只输出第一个，但加一个“!”；模糊匹配是检索每个单词的代码，看哪一串缺的最多出来的代码最少 /<em> 看VJ上好些0ms的，但我又想不出来什么更好的算法。想过会不会是循环的问题，于是试过将精确寻找和模糊寻找分开循环，结果还是10ms。就想到应该又是流的速度太慢导致。就加了一句ios::sync_with_stdio(false);关了stdio同步，果然变0ms了。唉好吧。。不过想了想不必太较真，博客里使用的还是没关同步的版本。 不用map也可以做的，map似乎还自带排序来着？我也是第一次用map，一开始做没用map，后来想试试看map，就改了。不过改成map后好像有些问题，主要是针对char[]字符串，因为char[]不可以用=来赋值，只能用strcpy()函数，而用这个函数给map赋值报错了，编译通不过，捣鼓半天不知道怎么改，就改用string了，慢一点但是方便。 好几天没刷题了，整个人懒洋洋的，脑子使不出劲，这题写了好久。。主要还是那win10那破一周年更新，导致显卡驱动不正常，折腾了好几天，题目落下了。虽然作为一个win10脑残粉，甚至在考虑要不要回win7. </em>/</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 4-5UVa1590 - IP Networks</title>
    <url>/posts/35518.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO 代码：（Accepted，0 ms）</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1590 - IP Networks</span></span><br><span class="line">#include&lt;iostream&gt;</span><br><span class="line">unsigned i, m, num, ip[<span class="number">4</span>], ipmax[<span class="number">4</span>], ipmin[<span class="number">4</span>], mask[<span class="number">4</span>];</span><br><span class="line"><span class="built_in">int</span> cmp(unsigned *a, unsigned *b) &#123;<span class="comment">//compare</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (a[i] &lt; b[i]) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">if</span> (a[i] &gt; b[i]) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="keyword">while</span> (scanf(<span class="string">"%d"</span>, &amp;m) != <span class="number">-1</span>) &#123;</span><br><span class="line">		scanf(<span class="string">"%d.%d.%d.%d"</span>, &amp;ip[<span class="number">0</span>], &amp;ip[<span class="number">1</span>], &amp;ip[<span class="number">2</span>], &amp;ip[<span class="number">3</span>]);</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i) ipmax[i] = ipmin[i] = ip[i];</span><br><span class="line">		<span class="keyword">while</span> (--m) &#123;</span><br><span class="line">			scanf(<span class="string">"%d.%d.%d.%d"</span>, &amp;ip[<span class="number">0</span>], &amp;ip[<span class="number">1</span>], &amp;ip[<span class="number">2</span>], &amp;ip[<span class="number">3</span>]);</span><br><span class="line">			<span class="keyword">if</span> (cmp(ip, ipmax) == <span class="number">1</span>)</span><br><span class="line">				<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i) ipmax[i] = ip[i];</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (cmp(ip, ipmin) == <span class="number">-1</span>)</span><br><span class="line">				<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i) ipmin[i] = ip[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (i == <span class="number">0</span> || mask[i - <span class="number">1</span>] == <span class="number">255</span>) &#123;</span><br><span class="line">				mask[i] = <span class="number">255</span> ^ (ipmax[i] ^ ipmin[i]);</span><br><span class="line">				<span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>;j &lt;= <span class="number">8</span>;++j)</span><br><span class="line">					<span class="keyword">if</span> ((mask[i] &gt;&gt; j) == (<span class="number">255</span> &gt;&gt; j)) &#123;</span><br><span class="line">						mask[i] = ((mask[i] &gt;&gt; j) &lt;&lt; j);</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> mask[i] = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		printf(<span class="string">"%u.%u.%u.%u\n"</span>, mask[<span class="number">0</span>] &amp; ipmax[<span class="number">0</span>], mask[<span class="number">1</span>] &amp; ipmax[<span class="number">1</span>], mask[<span class="number">2</span>] &amp; ipmax[<span class="number">2</span>], mask[<span class="number">3</span>] &amp; ipmax[<span class="number">3</span>]);</span><br><span class="line">		printf(<span class="string">"%u.%u.%u.%u\n"</span>, mask[<span class="number">0</span>], mask[<span class="number">1</span>], mask[<span class="number">2</span>], mask[<span class="number">3</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：网上他们说这是水题ToT。。。他们说只要知道点IP地址的知识就行了。。。然而我并不知道。。。于是看那英文的题目也没细说ip地址与子网掩码的规则，就自己查了好久子网掩码和ip地址的转化规则，其实到现在也仅仅是“好像懂了”，却竟然做出来了，不知道是开心还是不开心。而且之前我也没学过按位运算，这次竟然自己摸索着运用的还可以。 IP地址与子网掩码转化规则如下：（假设ip地址为a，a 的子网掩码为b，图个打字方便） a与b（每一段分别）按位与，就得到它的smallest possible IP network 如果a1、a2、a3……分别与b“按位与”运算均得到一个答案，那么说明这些电脑全在一个子网里。 而现在要求已知很多地址，且知道他们在一个子网里，让你求smallest possible IP network和子网掩码。那么其实只要知道最大最小两个ip就行。于是找出最大最小，ipmax和ipmin。然后看ipmax和ipmin从哪一位（二进制）开始不同，从不同的那一位开始，那些电脑就是在同一个子网里了，于是可以求得子网掩码。我的算法是，最大最小两个ip进行异或运算，目的是找出第一个开始不一样的地方，然后再与1111 1111（二进制，即255）异或运算，相当于取反，但是这里不能直接使用取反运算“~”，因为一个unsigned有32位，会使得比1111 1111高位的0也取反。于是得到子网掩码的雏形。而子网掩码前n位连续为1，后32-n位连续为0，这个雏形仅仅办到了前n位为1，所以得想办法把后32-n位清零。于是用了这个方法 <figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (int <span class="built_in">j</span> = <span class="number">0</span>;<span class="built_in">j</span> &lt;= <span class="number">8</span>;++<span class="built_in">j</span>)</span><br><span class="line">    <span class="keyword">if</span> ((mask[<span class="built_in">i</span>] &gt;&gt; <span class="built_in">j</span>) == (<span class="number">255</span> &gt;&gt; <span class="built_in">j</span>)) &#123;</span><br><span class="line">        mask[<span class="built_in">i</span>] = ((mask[<span class="built_in">i</span>] &gt;&gt; <span class="built_in">j</span>) &lt;&lt; <span class="built_in">j</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure> 再根据子网掩码和随意一个ip按位与，就得到smallest possible IP network。 （应该没说错吧）</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 4-4UVa253 - Cube painting</title>
    <url>/posts/24045.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO 代码：（Accepted，0 ms）</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">#include&lt;iostream&gt;</span><br><span class="line">char str[<span class="number">15</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">void</span> change(<span class="built_in">int</span> b) &#123;<span class="comment">//更换顶上的面</span></span><br><span class="line">	char t;</span><br><span class="line">	<span class="keyword">if</span>(b) t = str[<span class="number">0</span>], str[<span class="number">0</span>] = str[<span class="number">1</span>], str[<span class="number">1</span>] = str[<span class="number">5</span>], str[<span class="number">5</span>] = str[<span class="number">3</span>], str[<span class="number">3</span>] = t;</span><br><span class="line">	<span class="keyword">else</span> t = str[<span class="number">0</span>], str[<span class="number">0</span>] = str[<span class="number">4</span>], str[<span class="number">4</span>] = str[<span class="number">5</span>], str[<span class="number">5</span>] = str[<span class="number">2</span>], str[<span class="number">2</span>] = t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> compare() &#123;</span><br><span class="line">	<span class="keyword">if</span> (str[<span class="number">0</span>] != str[<span class="number">6</span>] || str[<span class="number">5</span>] != str[<span class="number">11</span>]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;++j)</span><br><span class="line">			<span class="keyword">if</span> (str[(j + i) % <span class="number">4</span> + <span class="number">1</span>] != str[j + <span class="number">7</span>]) <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">if</span> (j == <span class="number">4</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="keyword">while</span> (scanf(<span class="string">"%s"</span>, str) != <span class="number">-1</span>) &#123;</span><br><span class="line">		<span class="built_in">int</span> i;</span><br><span class="line">		i = str[<span class="number">3</span>], str[<span class="number">3</span>] = str[<span class="number">4</span>], str[<span class="number">4</span>] = i;</span><br><span class="line">		i = str[<span class="number">9</span>], str[<span class="number">9</span>] = str[<span class="number">10</span>], str[<span class="number">10</span>] = i;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">6</span>;++i) &#123;</span><br><span class="line">			<span class="comment">//printf("----------------%c%c%c%c%c%c\n", str[0], str[1], str[2], str[3], str[4], str[5]);</span></span><br><span class="line">			<span class="keyword">if</span> (compare()) <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">if</span>(i!=<span class="number">5</span>) change(i%<span class="number">2</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		printf((i &lt; <span class="number">6</span> ? <span class="string">"TRUE\n"</span> : <span class="string">"FALSE\n"</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：这题告诉我认真审题的重要性。。。题目给的各个面的输入顺序是123546，即各个对面为1-6,2-5,3-4，而我当作了123456。。。于是面与面的对应关系错了。。我说怎么老是WA。 很奇怪题目为什么要这么给各个面的顺序，按他这样做起来比较烦（至少我没发现他故意这样排能有什么快速的途径）于是我把地4和第5个数据换了个位： <figure class="highlight accesslog"><table><tr><td class="code"><pre><span class="line">i = str<span class="string">[3]</span>, str<span class="string">[3]</span> = str<span class="string">[4]</span>, str<span class="string">[4]</span> = i;</span><br><span class="line">i = str<span class="string">[9]</span>, str<span class="string">[9]</span> = str<span class="string">[10]</span>, str<span class="string">[10]</span> = i;</span><br></pre></td></tr></table></figure> 这样绕着上下两个面的中点所形成的直线旋转比较方便（也算是历史遗留问题。。。如果一开始就没看错题目的话，应该会想别的方法，现在WA的怕了，就直接转化一下数据了事）。 题目一共有6*4=24种情况，即6个面分别朝向上方时周围4各面旋转4次，所以甚至直接枚举也是极好的。VJ看到直接列6个数组，代表各个面朝上时其他面所在的情况，代码极其简洁： <a href="http://acm.hust.edu.cn/vjudge/problem/source/6310914" target="_blank" rel="noopener">LINK</a>。这里因为量不大，用枚举很不错啊。而我的还要做5次旋转，旋转需要要不停地赋值。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>scanf的使用(主要是针对char)</title>
    <url>/posts/5943.html</url>
    <content><![CDATA[<p>学的是C++，用cin cout也用的很顺溜，写自己的类时重载“&lt;&lt;”与“&gt;&gt;”运算符也很爽，但是发现在刷算法竞赛题时，cin cout很没优势，输入量大时一道题我用cin cout要50ms，用scanf printf只要10ms、20ms，这个就差的太大了时间都花在输入输出上也是很郁闷。于是开始使用C的输入输出标准。输出很正常，也可以轻松更改double输出的精度，c++还要个iomanip头文件，还烦一点。格式化字符%u %d %ld %lld %f %lf %s %c等就这几个限死了，也就是只能输入输出这几个系统自带的格式，是没法将自己的类重载到里面的，，只能自己做个print函数。不过毕竟面向对象是c++的内容。 就是那个输入scanf有些异类。首先输入得取地址，输入int的a要&amp;a不能写a。这我总是忘记。先输入整形、long long、double、字符串什么的都没问题，可以任意换行。scanf(&quot;%d%d%d%d&quot;, &amp;a, &amp;b, &amp;c, &amp;d); 像下面这样输入 <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">123</span>  <span class="number">2</span></span><br><span class="line"></span><br><span class="line">       <span class="number">23</span>  </span><br><span class="line"><span class="number">6</span></span><br></pre></td></tr></table></figure> 有任意空格和回车都可以接收。 而对于字符串char sss[100]，不支持空格的读取，要读取空格得用gets()。 而scanf(&quot;%s&quot;,sss)还是scanf(&quot;%s&quot;,&amp;sss)都可以，论坛里上说前者还少取个地址更快一点。 而对于char型，char ch;scanf(&quot;%c&quot;,ch)；可以是可以，但是不能像int等一样随心所欲地加空格和回车，明明说好的scanf自带无视回车和空格。比如下一段代码</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">int</span> a, b, c, d;</span><br><span class="line">	char <span class="keyword">x</span>, <span class="keyword">y</span>, z,s1[<span class="number">10</span>],s2[<span class="number">10</span>],s3[<span class="number">10</span>];</span><br><span class="line">	scanf(<span class="string">"%d%d%d%d"</span>, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class="line">	scanf(<span class="string">"%s%s%s"</span>, s1, s2, s3);</span><br><span class="line">	scanf(<span class="string">"%c%c%c"</span>, &amp;<span class="keyword">x</span>, &amp;<span class="keyword">y</span>, &amp;z);</span><br><span class="line">	<span class="keyword">printf</span>(<span class="string">"%c%c%c"</span>, <span class="keyword">x</span>, <span class="keyword">y</span>, z);</span><br><span class="line">	<span class="keyword">printf</span>(<span class="string">"%d%d%d%d\n'%c'\t'%c'\t'%c'\n%s\n%s\n%s"</span>, a, b, c, d, <span class="keyword">x</span>, <span class="keyword">y</span>, z,s1,s2,s3);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输入： <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">111</span> <span class="number">222</span> <span class="number">333</span> <span class="number">444</span> <span class="number">555</span> <span class="number">666</span> <span class="number">777</span> <span class="number">8</span> <span class="number">9</span> <span class="number">0</span></span><br></pre></td></tr></table></figure></p>
<p>输出： <figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">111222333444</span></span><br><span class="line">' '     '<span class="number">8</span>'     ' '</span><br><span class="line"><span class="number">555</span></span><br><span class="line"><span class="number">666</span></span><br><span class="line"><span class="number">777</span>请按任意键继续. . .</span><br></pre></td></tr></table></figure></p>
<p>而输入： <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">111</span></span><br><span class="line"><span class="number">222</span></span><br><span class="line"><span class="number">333</span></span><br><span class="line"><span class="number">444</span></span><br><span class="line"><span class="number">555</span></span><br><span class="line"><span class="number">666</span></span><br><span class="line"><span class="number">777</span></span><br><span class="line"><span class="number">890</span></span><br></pre></td></tr></table></figure></p>
<p>则输出： <figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">111222333444</span></span><br><span class="line">'</span><br><span class="line">'       '<span class="number">8</span>'     '<span class="number">9</span>'</span><br><span class="line"><span class="number">555</span></span><br><span class="line"><span class="number">666</span></span><br><span class="line"><span class="number">777</span>请按任意键继续. . .</span><br></pre></td></tr></table></figure></p>
<p>char的什么回车啊空格啊都读进去了。 而如果先读入char，一旦char坏掉了，后面也全乱了。</p>
<p>####我总结的规律是： scanf读取int等内容时，读取完一个数据后后面的空格回车仅仅是表示这个数据输入完了，没有略过，它一直存在于输入缓冲区，而到了下一个数据，若也是int或字符串什么的，会自动把空格回车略过，直到找到应输入的内容，然后读取。而char不同，它不忽略本该读取的数据前面的空白，就把那空格或回车读进去了，如果是有多个空格回车，剩下那些空白就依然还存在与缓冲区，给下一个char读取了。</p>
<p>####我现在找到了以下几种解决方案</p>
<ol type="1">
<li>使用fflush(stdin)。scanf读取char之前，用fflush(stdin)空输入缓冲区，使其为空，然后输入char就不会有空白符阻碍了。</li>
<li>scanf读取char之前使用getchar()把''和' '吃了，getchar()不跳过空格回车。当然getchar()几次，即吃几个字符也是个问题，所以本方法仅适用于比如竞赛题什么的，输入格式都很标准，不会出现不定多少的空格回车。不过现在想想好像scanf和getchar功能一样欸，都不跳空白的。那么这么说来直接用scanf吸收空格应该也是可以的，比如scanf(&quot;%c%c&quot;,&amp;ch,&amp;ch)但是好像没见人用过。</li>
<li>VJ上看到这个写法scanf(&quot;%c&quot;,ch)，即在每个输入char的scanf里的%c前面，都加上。对于在scanf里不仅仅写%c还写其他的东西，就像输出一样，我没细研究，就知道比如scanf(&quot;233%c666&quot;,ch)我必须先输入233再输入char再输入666，想想好像也有道理，以此来忽略，但是我发现它也可以忽略空格。虽然不是很懂，空格和回车在编译器眼里一样吗？于是试了试scanf(&quot; %c&quot;,ch)，也一样的效果！于是这就达到了与输入int、double一样的格式，任意输入多少空格和回车都没事了。现在也是这么在用，虽然其实我不是很懂其原理。</li>
<li>CSDN论坛里看到有12级的大神说不要用scanf输入字符。。不是很懂，全用getchar()吗。。。还是输入字符转用cin。。。 0.0 [震惊哭]。</li>
</ol>
<p>附[方法三]实例：</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">int</span> a, b, c, d;</span><br><span class="line">	char <span class="keyword">x</span>, <span class="keyword">y</span>, z,s1[<span class="number">10</span>],s2[<span class="number">10</span>],s3[<span class="number">10</span>];</span><br><span class="line">	scanf(<span class="string">"%d%d%d%d"</span>, &amp;a, &amp;b, &amp;c, &amp;d);</span><br><span class="line">	scanf(<span class="string">"%s%s%s"</span>, s1, s2, s3);</span><br><span class="line">	scanf(<span class="string">" %c\n%c %c"</span>, &amp;<span class="keyword">x</span>, &amp;<span class="keyword">y</span>, &amp;z);</span><br><span class="line">	//<span class="keyword">x</span> = getchar(), <span class="keyword">y</span> = getchar(), z = getchar();</span><br><span class="line">	<span class="keyword">printf</span>(<span class="string">"%d%d%d%d\n'%c'\t'%c'\t'%c'\n%s\n%s\n%s"</span>, a, b, c, d, <span class="keyword">x</span>, <span class="keyword">y</span>, z,s1,s2,s3);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输入： <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>   <span class="number">2</span>  <span class="number">3</span>   </span><br><span class="line"><span class="number">4</span>   <span class="number">5</span>  </span><br><span class="line">  <span class="number">6</span>  </span><br><span class="line">     <span class="number">7</span>  </span><br><span class="line">    <span class="number">8</span>  </span><br><span class="line"> <span class="number">9</span>  </span><br><span class="line">       <span class="number">0</span></span><br></pre></td></tr></table></figure></p>
<p>输出： <figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line"><span class="number">1234</span></span><br><span class="line">'<span class="number">8</span>'     '<span class="number">9</span>'     '<span class="number">0</span>'</span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">7</span>请按任意键继续. . .</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>算法竞赛</category>
      </categories>
      <tags>
        <tag>笔记</tag>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 4-3UVa220 - Othello</title>
    <url>/posts/25421.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO 代码：（Accepted，0 ms）</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa 220 - Othello</span></span><br><span class="line">#include&lt;iostream&gt;</span><br><span class="line">char Board[<span class="number">11</span>][<span class="number">11</span>], Current, Command[<span class="number">5</span>];</span><br><span class="line"><span class="built_in">bool</span> Flag, L_Refresh;<span class="comment">//flag用于空格的输出,同时可以判断出本局是不是当前颜色的棋子无路可走</span></span><br><span class="line"><span class="built_in">int</span> Times, Num[<span class="number">2</span>];<span class="comment">//Num:0白1黑</span></span><br><span class="line"><span class="built_in">int</span> Rx[] = &#123; <span class="number">0</span>, <span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">-1</span> &#125;;</span><br><span class="line"><span class="built_in">int</span> Ry[] = &#123; <span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>, <span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">1</span> &#125;;</span><br><span class="line">inline char oppo() &#123; <span class="keyword">return</span> (Current == <span class="string">'W'</span> ? <span class="string">'B'</span> : <span class="string">'W'</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> judge(<span class="built_in">int</span> i, <span class="built_in">int</span> j, <span class="built_in">int</span> x, <span class="built_in">int</span> y, <span class="built_in">bool</span> is_print) &#123;</span><br><span class="line">	<span class="built_in">int</span> ii = i + <span class="number">1</span>, jj = j + <span class="number">1</span>, flg = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> ((i += x) &lt; <span class="number">8</span> &amp;&amp; (j += y) &lt; <span class="number">8</span> &amp;&amp; i &gt;= <span class="number">0</span> &amp;&amp; j&gt;=<span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (Board[i][j] == <span class="string">'-'</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">if</span> (Board[i][j] == Current) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!flg) <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">if</span> (is_print) &#123;</span><br><span class="line">				<span class="keyword">if</span> (Flag) printf(<span class="string">" "</span>);</span><br><span class="line">				printf(<span class="string">"(%d,%d)"</span>, ii, jj);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (!Flag) Flag = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		++flg;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">void</span> change(<span class="built_in">int</span> i, <span class="built_in">int</span> j, <span class="built_in">int</span> x, <span class="built_in">int</span> y) &#123;</span><br><span class="line">	<span class="built_in">int</span> n = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (Board[i += x][j += y] != Current) &#123;</span><br><span class="line">		Board[i][j] = Current, ++n;</span><br><span class="line">	&#125;</span><br><span class="line">	Current == <span class="string">'W'</span> ? (Num[<span class="number">0</span>] += n, Num[<span class="number">1</span>] -= n) : (Num[<span class="number">0</span>] -= n, Num[<span class="number">1</span>] += n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">void</span> L(<span class="built_in">bool</span> is_print) &#123;</span><br><span class="line">	L_Refresh = <span class="number">1</span>, Flag = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>;i &lt; <span class="number">8</span>;++i)  <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>;j &lt; <span class="number">8</span>;++j) &#123;</span><br><span class="line">		<span class="keyword">if</span> (Board[i][j] != <span class="string">'-'</span>) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> l = <span class="number">0</span>;l &lt; <span class="number">8</span>;++l)</span><br><span class="line">			<span class="keyword">if</span> (judge(i, j, Rx[l], Ry[l], is_print))  <span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (is_print) Flag ? printf(<span class="string">"\n"</span>) : printf(<span class="string">"No legal move.\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">void</span> M() &#123;</span><br><span class="line">	char i = Command[<span class="number">1</span>] - <span class="number">49</span>, j = Command[<span class="number">2</span>] - <span class="number">49</span>;</span><br><span class="line">	<span class="keyword">if</span> (!L_Refresh) L(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span> (!Flag) Current = oppo();</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> l = <span class="number">0</span>;l &lt; <span class="number">8</span>;++l)</span><br><span class="line">		<span class="keyword">if</span> (judge(i, j, Rx[l], Ry[l], <span class="number">0</span>)) change(i, j, Rx[l], Ry[l]);</span><br><span class="line">	Current == <span class="string">'W'</span> ? Num[<span class="number">0</span>] += <span class="number">1</span> : Num[<span class="number">1</span>] += <span class="number">1</span>;</span><br><span class="line">	Board[i][j] = Current;</span><br><span class="line">	Current = oppo();</span><br><span class="line">	L_Refresh = <span class="number">0</span>;</span><br><span class="line">	printf(<span class="string">"Black - %2d White - %2d\n"</span>, Num[<span class="number">1</span>], Num[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">void</span> Q() &#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>;i &lt; <span class="number">8</span>;++i) printf(<span class="string">"%s\n"</span>, Board[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	scanf(<span class="string">"%d"</span>, &amp;Times);</span><br><span class="line">	<span class="keyword">while</span> (Times--) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>;i &lt; <span class="number">8</span>;++i) scanf(<span class="string">"%s"</span>, Board[i]);</span><br><span class="line">		scanf(<span class="string">"\n%c"</span>, &amp;Current);</span><br><span class="line">		L_Refresh = <span class="number">0</span>;</span><br><span class="line">		Num[<span class="number">0</span>] = Num[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>;i &lt; <span class="number">8</span>;++i)  <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>;j &lt; <span class="number">8</span>;++j) &#123;</span><br><span class="line">			<span class="keyword">if</span> (Board[i][j] == <span class="string">'W'</span>) ++Num[<span class="number">0</span>];</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (Board[i][j] == <span class="string">'B'</span>) ++Num[<span class="number">1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (scanf(<span class="string">"%s"</span>, Command) &amp;&amp; Command[<span class="number">0</span>] != <span class="string">'Q'</span>)</span><br><span class="line">			Command[<span class="number">0</span>] == <span class="string">'L'</span> ? L(<span class="number">1</span>) : M();</span><br><span class="line">		Q();</span><br><span class="line">		<span class="keyword">if</span> (Times) printf(<span class="string">"\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析： 在uDebug上调试都对了，提交时还是无限WA，挠的头发都要掉光了，最后发现忘记把freopen(&quot;in.txt&quot;, &quot;r&quot;, stdin);加注释了@。@。。。。气得我笑出声。 首先是List all possible moves for the current player.有上下左右与4条斜线8种情况。8*8个格子每个都要检索一遍。先judge()查看每个位置各个方向是否legal，如果可以放置，输出之。输出直接放在judge里了，不高兴写入字符数组了，后面M()也会用到judge，这时不希望他输出，于是给judge()加了个is_print变量来控制。尽量代码重用。还有对于这八个方向，我一开始是用的傻傻的枚举， <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (judge(i, j, <span class="number">0</span>, <span class="number">1</span>, is_print)) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (judge(i, j, <span class="number">0</span>, <span class="number">-1</span>, is_print)) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (judge(i, j, <span class="number">1</span>, <span class="number">0</span>, is_print)) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (judge(i, j, <span class="number">-1</span>, <span class="number">0</span>, is_print)) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (judge(i, j, <span class="number">1</span>, <span class="number">1</span>, is_print)) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (judge(i, j, <span class="number">-1</span>, <span class="number">-1</span>, is_print)) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (judge(i, j, <span class="number">1</span>, <span class="number">-1</span>, is_print)) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (judge(i, j, <span class="number">-1</span>, <span class="number">1</span>, is_print)) <span class="keyword">continue</span>;</span><br></pre></td></tr></table></figure> 后来VJ上看到别人用以下数组， <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span> rx[] = &#123; <span class="number">0</span>, <span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">-1</span> &#125;， ry[] = &#123; <span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>, <span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">1</span> &#125;;</span><br></pre></td></tr></table></figure> 一开始没看懂他这奇怪的数组干嘛的，看懂后真的是令我拍大腿叫绝。 所以现在只需一个循环 <figure class="highlight lisp"><table><tr><td class="code"><pre><span class="line">for (<span class="name">int</span> l = <span class="number">0</span><span class="comment">;l &lt; 8;++l)</span></span><br><span class="line">		if (<span class="name">judge</span>(<span class="name">i</span>, j, Rx[l], Ry[l], <span class="number">0</span>)) change(<span class="name">i</span>, j, Rx[l], Ry[l])<span class="comment">;</span></span><br></pre></td></tr></table></figure> 即可，真心方便。下面M()函数也一样。 还有就是L_Refresh的作用。系统有可能一口气执行多次L()（当然我不确定，只是有可能），也可能未执行就执行M，这时需要知道是不是无合法操作，还得先执行L()，L_Refresh就是用来检测L()有没有执行过，且防止其重复执行多次。 还有那个输出，比如“Black - 1 White - 4”，数字1和4在输出时应用“ %2d”输出，而不是两个空格键。之前看题目“Black - xx White - yy”的xx、yy没看懂，后来才知道是占两个格子的意思。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 4-2UVa201 - Squares</title>
    <url>/posts/61878.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO 代码：（Accepted，20 ms）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> N, M, x, y, CO[<span class="number">12</span>], Times = <span class="number">0</span>;<span class="comment">// 2 &lt;=n&lt;= 9,CO=Count</span></span><br><span class="line"><span class="keyword">char</span> SQ[<span class="number">12</span>][<span class="number">12</span>], ch;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">V</span><span class="params">(<span class="keyword">char</span> a)</span> </span>&#123; <span class="keyword">return</span> (a == <span class="string">'B'</span> || a == <span class="string">'V'</span> ? <span class="number">1</span> : <span class="number">0</span>); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">H</span><span class="params">(<span class="keyword">char</span> a)</span> </span>&#123; <span class="keyword">return</span> (a == <span class="string">'B'</span> || a == <span class="string">'H'</span> ? <span class="number">1</span> : <span class="number">0</span>); &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;M)) &#123;</span><br><span class="line">		getchar();</span><br><span class="line">		<span class="built_in">memset</span>(SQ, <span class="string">'0'</span>, <span class="keyword">sizeof</span>(SQ));</span><br><span class="line">		<span class="built_in">memset</span>(CO, <span class="number">0</span>, <span class="keyword">sizeof</span>(CO));</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; M;++i) &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%c%d%d"</span>, &amp;ch, &amp;x, &amp;y);</span><br><span class="line">			getchar();</span><br><span class="line">			<span class="keyword">if</span> (SQ[x][y] == <span class="string">'0'</span>) SQ[x][y] = ch;</span><br><span class="line">			<span class="keyword">else</span> SQ[x][y] = <span class="string">'B'</span>;<span class="comment">//Both</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (x = <span class="number">1</span>;x &lt; N;++x) <span class="keyword">for</span> (y = <span class="number">1</span>;y &lt; N;++y) &#123;</span><br><span class="line">			<span class="keyword">int</span> ml = (x &gt; y ? N - x : N - y);<span class="comment">//max_length,最大边长</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= ml;++i) &#123;</span><br><span class="line">				<span class="keyword">int</span> j;</span><br><span class="line">				<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; i;++j)</span><br><span class="line">					<span class="keyword">if</span> (!V(SQ[y][x + j]) || !V(SQ[y + i][x + j]) || !H(SQ[x][y + j]) || !H(SQ[x + i][y + j])) <span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">if</span> (j == i) ++CO[i];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> flag = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(Times)<span class="built_in">printf</span>(<span class="string">"\n**********************************\n\n"</span>);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"Problem #%d\n\n"</span>,++Times);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; N;++i)</span><br><span class="line">			<span class="keyword">if</span> (CO[i]) &#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">"%d square (s) of size %d\n"</span>, CO[i],i);</span><br><span class="line">				<span class="keyword">if</span> (!flag) flag = <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">if</span> (!flag) <span class="built_in">printf</span>(<span class="string">"No completed squares can be found.\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：把每个可能的正方形都枚举一遍。。比较坑的是V和H的坐标顺序是反的。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典(第2版) 4-1UVa1589 - Xiangqi</title>
    <url>/posts/28602.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO 代码：（Accepted，0 ms）</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1589</span></span><br><span class="line">#<span class="keyword">include</span>&lt;iostream&gt;</span><br><span class="line">#<span class="keyword">include</span>&lt;cmath&gt;</span><br><span class="line">#define <span class="constructor">P(<span class="params">x</span>,<span class="params">y</span>)</span> Pi<span class="literal">[<span class="identifier">x</span>]</span>.position<span class="literal">[<span class="identifier">y</span>]</span></span><br><span class="line">using namespace std;</span><br><span class="line"><span class="built_in">int</span> N;<span class="comment">//2&lt;=N&lt;=7</span></span><br><span class="line"><span class="built_in">bool</span> A<span class="literal">[<span class="number">4</span>]</span>;<span class="comment">//around,储存"将"周围是不是已经不能走了  0上 1左 2下 3右</span></span><br><span class="line"><span class="keyword">struct</span> piece &#123;</span><br><span class="line">	<span class="built_in">char</span> name;</span><br><span class="line">	<span class="built_in">int</span> position<span class="literal">[<span class="number">2</span>]</span>;<span class="comment">//0x 1y</span></span><br><span class="line">&#125;Pi<span class="literal">[<span class="number">10</span>]</span>;</span><br><span class="line"></span><br><span class="line">inline <span class="built_in">bool</span> f1(<span class="built_in">int</span> i, <span class="built_in">int</span> j, <span class="built_in">bool</span> po) &#123;<span class="comment">//判断第j个子是否堵在第i个子前面,针对"车"和"帅"和"炮"</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="constructor">P(<span class="params">i</span>, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>) != <span class="constructor">P(<span class="params">j</span>, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>)) return <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">int</span> ii = <span class="constructor">P(<span class="params">i</span>, <span class="params">po</span>)</span> - <span class="constructor">P(0, <span class="params">po</span>)</span>, jj = <span class="constructor">P(<span class="params">j</span>, <span class="params">po</span>)</span> - <span class="constructor">P(0, <span class="params">po</span>)</span>;</span><br><span class="line">	<span class="keyword">if</span> (ii &gt; <span class="number">0</span><span class="operator"> &amp;&amp; </span>jj &gt; <span class="number">0</span><span class="operator"> &amp;&amp; </span>ii &gt; jj) return <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> (ii &lt; <span class="number">0</span><span class="operator"> &amp;&amp; </span>jj &lt; <span class="number">0</span><span class="operator"> &amp;&amp; </span>ii &lt; jj) return <span class="number">1</span>;</span><br><span class="line">	return <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">inline <span class="built_in">bool</span> f2(<span class="built_in">int</span> i) &#123;<span class="comment">//判断第i个子是不是在"将"周围</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="constructor">P(<span class="params">i</span>, 0)</span><span class="operator"> == </span><span class="constructor">P(0, 0)</span><span class="operator"> &amp;&amp; </span>abs(<span class="constructor">P(<span class="params">i</span>, 1)</span> - <span class="constructor">P(0, 1)</span>)<span class="operator"> == </span><span class="number">1</span>) return <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="constructor">P(<span class="params">i</span>, 1)</span><span class="operator"> == </span><span class="constructor">P(0, 1)</span><span class="operator"> &amp;&amp; </span>abs(<span class="constructor">P(<span class="params">i</span>, 0)</span> - <span class="constructor">P(0, 0)</span>)<span class="operator"> == </span><span class="number">1</span>) return <span class="number">1</span>;</span><br><span class="line">	return <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">bool</span> f3(<span class="built_in">int</span> i, <span class="built_in">int</span> xx, <span class="built_in">int</span> yy) &#123;<span class="comment">//判断"马"是否可以到达"将"周围</span></span><br><span class="line">	<span class="keyword">if</span> ((abs(xx)<span class="operator"> == </span><span class="number">2</span><span class="operator"> &amp;&amp; </span>abs(yy)<span class="operator"> == </span><span class="number">1</span>)<span class="operator"> || </span>(abs(xx)<span class="operator"> == </span><span class="number">1</span><span class="operator"> &amp;&amp; </span>abs(yy)<span class="operator"> == </span><span class="number">2</span>)) &#123;</span><br><span class="line">		for (<span class="built_in">int</span> j = <span class="number">0</span>;j &lt;= N;++j) &#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="constructor">P(<span class="params">j</span>, 0)</span><span class="operator"> == </span><span class="constructor">P(<span class="params">i</span>, 0)</span> - <span class="built_in">int</span>(xx<span class="operator"> / </span><span class="number">2</span>)<span class="operator"> &amp;&amp; </span><span class="constructor">P(<span class="params">j</span>, 1)</span><span class="operator"> == </span><span class="constructor">P(<span class="params">i</span>, 1)</span> - <span class="built_in">int</span>(yy<span class="operator"> / </span><span class="number">2</span>)) return <span class="number">0</span>;</span><br><span class="line">			<span class="comment">//cerr &lt;&lt;"H:"&lt;&lt;i&lt;&lt;' '&lt;&lt;j&lt;&lt;'\t'&lt;&lt; P(j, 0) &lt;&lt; ' ' &lt;&lt; P(i, 0) - int(xx / 2) &lt;&lt; '\t' &lt;&lt; P(j, 0) &lt;&lt; ' ' &lt;&lt; P(i, 1) - int(yy / 1) &lt;&lt; '\n';//-------------------</span></span><br><span class="line">		&#125;</span><br><span class="line">		return <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	return <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">void <span class="constructor">GR(<span class="params">int</span> <span class="params">i</span>, <span class="params">bool</span> <span class="params">po</span>)</span> &#123;<span class="comment">//"将"和"车"的函数</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="constructor">P(<span class="params">i</span>, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>)&gt;<span class="constructor">P(0, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>) + <span class="number">1</span><span class="operator"> || </span><span class="constructor">P(<span class="params">i</span>, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>) &lt; <span class="constructor">P(0, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>) - <span class="number">1</span>) return;</span><br><span class="line">	<span class="built_in">int</span> j = <span class="number">1</span>;</span><br><span class="line">	for (;j &lt;= N&amp;&amp;!f1(i, j, po);++j);</span><br><span class="line">	<span class="keyword">if</span> (j &gt; N) &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="constructor">P(<span class="params">i</span>, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>)<span class="operator"> == </span><span class="constructor">P(0, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>) - <span class="number">1</span>) &#123; <span class="keyword">if</span> (!f2(i)) A<span class="literal">[(<span class="identifier">po</span> + <span class="number">1</span>) % <span class="number">2</span>]</span> = <span class="number">1</span>; &#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="constructor">P(<span class="params">i</span>, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>)<span class="operator"> == </span><span class="constructor">P(0, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>) + <span class="number">1</span>) &#123; <span class="keyword">if</span> (!f2(i))A<span class="literal">[(<span class="identifier">po</span> + <span class="number">1</span>) % <span class="number">2</span> + <span class="number">2</span>]</span> = <span class="number">1</span>; &#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (f2(i)) <span class="constructor">P(<span class="params">i</span>, <span class="params">po</span>)</span> - <span class="constructor">P(0, <span class="params">po</span>)</span> &gt; <span class="number">0</span> ? A<span class="literal">[<span class="identifier">po</span>]</span> = <span class="number">1</span> : A<span class="literal">[<span class="identifier">po</span> + <span class="number">2</span>]</span> = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span> A<span class="literal">[<span class="identifier">po</span>]</span> = A<span class="literal">[<span class="identifier">po</span> + <span class="number">2</span>]</span> = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">void <span class="constructor">H(<span class="params">int</span> <span class="params">i</span>)</span> &#123;<span class="comment">//"马"的函数</span></span><br><span class="line">	<span class="keyword">if</span> (f2(i)) return;</span><br><span class="line">	<span class="keyword">if</span> (!A<span class="literal">[<span class="number">0</span>]</span><span class="operator"> &amp;&amp; </span>f3(i, <span class="constructor">P(<span class="params">i</span>, 0)</span> - (<span class="constructor">P(0, 0)</span> - <span class="number">1</span>), <span class="constructor">P(<span class="params">i</span>, 1)</span> - <span class="constructor">P(0, 1)</span>)) A<span class="literal">[<span class="number">0</span>]</span> = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> (!A<span class="literal">[<span class="number">1</span>]</span><span class="operator"> &amp;&amp; </span>f3(i, <span class="constructor">P(<span class="params">i</span>, 0)</span> - <span class="constructor">P(0, 0)</span>, <span class="constructor">P(<span class="params">i</span>, 1)</span> - (<span class="constructor">P(0, 1)</span> - <span class="number">1</span>))) A<span class="literal">[<span class="number">1</span>]</span> = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> (!A<span class="literal">[<span class="number">2</span>]</span><span class="operator"> &amp;&amp; </span>f3(i, <span class="constructor">P(<span class="params">i</span>, 0)</span> - (<span class="constructor">P(0, 0)</span> + <span class="number">1</span>), <span class="constructor">P(<span class="params">i</span>, 1)</span> - <span class="constructor">P(0, 1)</span>)) A<span class="literal">[<span class="number">2</span>]</span> = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> (!A<span class="literal">[<span class="number">3</span>]</span><span class="operator"> &amp;&amp; </span>f3(i, <span class="constructor">P(<span class="params">i</span>, 0)</span> - <span class="constructor">P(0, 0)</span>, <span class="constructor">P(<span class="params">i</span>, 1)</span> - (<span class="constructor">P(0, 1)</span> + <span class="number">1</span>))) A<span class="literal">[<span class="number">3</span>]</span> = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">void <span class="constructor">C(<span class="params">int</span> <span class="params">i</span>, <span class="params">bool</span> <span class="params">po</span>)</span> &#123;<span class="comment">//"炮"的函数</span></span><br><span class="line">	<span class="keyword">if</span> (f2(i)<span class="operator"> || </span><span class="constructor">P(<span class="params">i</span>, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>) &gt; <span class="constructor">P(0, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>) + <span class="number">1</span><span class="operator"> || </span><span class="constructor">P(<span class="params">i</span>, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>) &lt; <span class="constructor">P(0, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>) - <span class="number">1</span>) return;</span><br><span class="line">	<span class="built_in">int</span> flag = <span class="number">0</span>;</span><br><span class="line">	for (<span class="built_in">int</span> j = <span class="number">1</span>;j &lt;= N;++j) <span class="keyword">if</span> (f1(i, j, po)) ++flag;</span><br><span class="line">	<span class="keyword">if</span> (flag<span class="operator"> == </span><span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="constructor">P(<span class="params">i</span>, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>)<span class="operator"> == </span><span class="constructor">P(0, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>) - <span class="number">1</span>) A<span class="literal">[(<span class="identifier">po</span> + <span class="number">1</span>) % <span class="number">2</span>]</span> = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (<span class="constructor">P(<span class="params">i</span>, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>)<span class="operator"> == </span><span class="constructor">P(0, (<span class="params">po</span> + 1)</span> % <span class="number">2</span>) + <span class="number">1</span>) A<span class="literal">[(<span class="identifier">po</span> + <span class="number">1</span>) % <span class="number">2</span> + <span class="number">2</span>]</span> = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">int</span> j = <span class="number">1</span>;</span><br><span class="line">			for (;j &lt;= N;++j) <span class="keyword">if</span> (f1(i, j, po)<span class="operator"> &amp;&amp; </span>f2(j)) break;</span><br><span class="line">			<span class="keyword">if</span> (j &lt;= N) <span class="constructor">P(<span class="params">i</span>, <span class="params">po</span>)</span> - <span class="constructor">P(0, <span class="params">po</span>)</span> &gt; <span class="number">0</span> ? A<span class="literal">[<span class="identifier">po</span>]</span> = <span class="number">1</span> : A<span class="literal">[<span class="identifier">po</span> + <span class="number">2</span>]</span> = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">else</span> A<span class="literal">[<span class="identifier">po</span>]</span> = A<span class="literal">[<span class="identifier">po</span> + <span class="number">2</span>]</span> = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main<span class="literal">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//freopen("in.txt", "r", stdin);</span></span><br><span class="line">	<span class="comment">//freopen("out.txt", "w", stdout);</span></span><br><span class="line">	<span class="keyword">while</span> ((cin &gt;&gt; N &gt;&gt; <span class="constructor">P(0, 0)</span> &gt;&gt; <span class="constructor">P(0, 1)</span>)<span class="operator"> &amp;&amp; </span>N<span class="operator"> &amp;&amp; </span><span class="constructor">P(0, 0)</span><span class="operator"> &amp;&amp; </span><span class="constructor">P(0, 1)</span>) &#123;</span><br><span class="line">		for (<span class="built_in">int</span> i = <span class="number">1</span>;i &lt;= N;++i)</span><br><span class="line">			cin &gt;&gt; Pi<span class="literal">[<span class="identifier">i</span>]</span>.name &gt;&gt; <span class="constructor">P(<span class="params">i</span>, 0)</span> &gt;&gt; <span class="constructor">P(<span class="params">i</span>, 1)</span>;</span><br><span class="line">		A<span class="literal">[<span class="number">0</span>]</span> = (<span class="constructor">P(0, 0)</span><span class="operator"> == </span><span class="number">1</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">		A<span class="literal">[<span class="number">1</span>]</span> = (<span class="constructor">P(0, 1)</span><span class="operator"> == </span><span class="number">4</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">		A<span class="literal">[<span class="number">2</span>]</span> = (<span class="constructor">P(0, 0)</span><span class="operator"> == </span><span class="number">3</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">		A<span class="literal">[<span class="number">3</span>]</span> = (<span class="constructor">P(0, 1)</span><span class="operator"> == </span><span class="number">6</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">		<span class="comment">//cerr &lt;&lt; "A:" &lt;&lt; A[0] &lt;&lt; '\t' &lt;&lt; A[1] &lt;&lt; '\t' &lt;&lt; A[2] &lt;&lt; '\t' &lt;&lt; A[3] &lt;&lt; "\n";//--------</span></span><br><span class="line">		for (<span class="built_in">int</span> i = <span class="number">1</span>;i &lt;= N;++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (Pi<span class="literal">[<span class="identifier">i</span>]</span>.name<span class="operator"> == </span><span class="character">'G'</span>) <span class="constructor">GR(<span class="params">i</span>, 0)</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (Pi<span class="literal">[<span class="identifier">i</span>]</span>.name<span class="operator"> == </span><span class="character">'R'</span>) <span class="constructor">GR(<span class="params">i</span>, 0)</span>, <span class="constructor">GR(<span class="params">i</span>, 1)</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (Pi<span class="literal">[<span class="identifier">i</span>]</span>.name<span class="operator"> == </span><span class="character">'H'</span>) <span class="constructor">H(<span class="params">i</span>)</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="constructor">C(<span class="params">i</span>, 0)</span>, <span class="constructor">C(<span class="params">i</span>, 1)</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">int</span> i;</span><br><span class="line">		<span class="comment">//cerr &lt;&lt; "A:" &lt;&lt; A[0] &lt;&lt; '\t' &lt;&lt; A[1] &lt;&lt; '\t' &lt;&lt; A[2] &lt;&lt; '\t' &lt;&lt; A[3] &lt;&lt; "\n";//--------</span></span><br><span class="line">		for (i = <span class="number">0</span>;i &lt; <span class="number">4</span><span class="operator"> &amp;&amp; </span>A<span class="literal">[<span class="identifier">i</span>]</span>;++i);</span><br><span class="line">		cout &lt;&lt; (i &lt; <span class="number">4</span> ? <span class="string">"NO"</span> : <span class="string">"YES"</span>) &lt;&lt; <span class="character">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	return <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析： 看着挺烦的，以为会调试很久，有那么多情况，感觉还不好找出错的点。结果两遍就AC了，喜出望外~ 我的思路是，判断每个子有没有把“将”周围堵住，对棋子大循环。同时我没有定义9*10的大棋盘。（现在想想定义了个棋盘好像简单好多。甚至可以打表查看哪里红子可以到达。或许我太过在意空间的占用了） A[4]的0上 1左 2下 3右是有顺序要求的，这样定义可以方便地和po对应起来。 车炮帅的攻击范围都是直线，所以定义的函数只针对其中一个方向，而G只能是向x轴方向出击，所以是只使用向x轴（po=0）方向的函数，而车和炮要使用两次函数。这三者有两种情况将军，第一是指向“将”旁边，使“将”无法向旁边行走。另一种是直接指向“将”，使之只能往旁边走不能在车炮指向的方向行走。三者都得考虑被堵住看不见“将”的情况。 不过这题有个小bug，就是将和帅面对面的情况，将可以直接飞过去翻盘赢了，无需躲闪。但是题目好像没有考虑这种情况，应该是规避了这类输入数据。我也是点击“Submit”时突然想起来这个情况没写。。。不过竟然AC了，那就算了。。。 还有就是车和炮直接在将旁边的情况，将可以吃掉它们消除威胁（当然前提是没有别人可以吃这个位置）。这个情况下，比如红车在（1，6），黑将在（1，5），那么黑将可以向右吃掉它，但是不能向左，因为向左进入（1，4）后车依然可以吃“将”。这是比较特殊的。 还有就是这一段： <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//在GR(...)函数的最后几行</span></span><br><span class="line"><span class="keyword">if</span> (P(i, (po + <span class="number">1</span>) % <span class="number">2</span>) == P(<span class="number">0</span>, (po + <span class="number">1</span>) % <span class="number">2</span>) - <span class="number">1</span>) &#123; <span class="keyword">if</span> (!f2(i)) A[(po + <span class="number">1</span>) % <span class="number">2</span>] = <span class="number">1</span>; &#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (P(i, (po + <span class="number">1</span>) % <span class="number">2</span>) == P(<span class="number">0</span>, (po + <span class="number">1</span>) % <span class="number">2</span>) + <span class="number">1</span>) &#123; <span class="keyword">if</span> (!f2(i))A[(po + <span class="number">1</span>) % <span class="number">2</span> + <span class="number">2</span>] = <span class="number">1</span>; &#125;</span><br></pre></td></tr></table></figure> 本来我写的是</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (P(i, (po + <span class="number">1</span>) % <span class="number">2</span>) == P(<span class="number">0</span>, (po + <span class="number">1</span>) % <span class="number">2</span>) - <span class="number">1</span>) A[(po + <span class="number">1</span>) % <span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (P(i, (po + <span class="number">1</span>) % <span class="number">2</span>) == P(<span class="number">0</span>, (po + <span class="number">1</span>) % <span class="number">2</span>) + <span class="number">1</span>) A[(po + <span class="number">1</span>) % <span class="number">2</span> + <span class="number">2</span>] = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p>没有后面的if。结果出现的问题就是当比如车在（1，6），将在（1，5）时，会判定为在针对x轴方向时，（1，6）（即将右侧，即A[3]）是将不可以走的。 还有炮的函数C，对于该函数最后几行，</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">int</span> j = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (;j &lt;= N;++j) <span class="keyword">if</span> (f1(i, j, po) &amp;&amp; f2(j)) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span> (j &lt;= N) P(i, po) - P(<span class="number">0</span>, po) &gt; <span class="number">0</span> ? A[po] = <span class="number">1</span> : A[po + <span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> A[po] = A[po + <span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>意思是，如果炮架子刚好在将前面，那么炮只能攻击将的后面（即“将”不能后移），将前面即跑架子所在那个点打不到。 马的函数竟然算是最简单的了。。判断够不够得到将旁边的点，已及马有没有蹩脚即可。</p>
<p>附：uDebug上看到的测试数据： 2 1 4 G 10 5 R 6 4</p>
<p>3 1 5 H 4 5 G 10 5 C 7 5</p>
<p>2 1 5 R 4 4 G 10 5</p>
<p>3 1 5 G 10 4 R 5 5 H 3 7</p>
<p>4 1 5 G 10 4 C 6 5 H 5 5 R 1 1</p>
<p>5 1 5 G 10 4 C 6 5 H 5 5 H 4 5 R 1 1</p>
<p>3 1 5 G 10 4 C 2 7 H 3 7</p>
<p>3 1 5 G 10 4 R 5 5 R 1 6</p>
<p>4 1 5 G 10 4 R 5 5 R 1 6 H 3 7</p>
<p>0 0 0</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>我的整形大数类(支持正负)</title>
    <url>/posts/18423.html</url>
    <content><![CDATA[<p>好几天没刷题没看书没写博客了，一直在闭关修炼写大数，现在终于写出来啦！我也终于有了属于我自己的大数~~~~并且以头文件的形式写出的，可以算是一个完整的成品了，拿过来就可以用。 本大数类：longer实现的功能：加减乘除、取余、取绝对值，开根号什么的没精力弄了，只是声明了一下没定义，以后会更新的。同时支持正负号。数据用的vector&lt; long long &gt;存储，long long最大储存9位数，也就是999999999，因为2个999999999相乘刚好不越界。不过后来发现好像没必要，用int就行了，但是写都写一半了，就没改。不过灵活性也蛮高的吧，可以很轻松地把数据类型从long long 改为int，同时只要把MAX改为int的最大值10000，把DIGIT改为4即可（没具体试过，应该没问题）。就是下面这几行：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//longer类内定义</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">constexpr</span> ll MAX = <span class="number">1000000000</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">int</span> DIGIT = <span class="number">9</span>;</span><br></pre></td></tr></table></figure>
<p>当然有储存，这应该不是最好的方法，不过就我目前的水平就这样吧。而且现在对于编程是“空间换时间”还是“时间换空间”一直很纠结。。。 然后单独定义一个sign表示正负号。那么当然啦，对于这种用单独一个符号标记来表示正负数字的，就会有+0和-0的问题，我也是基本解决了，就是把负的改成正的。当然不排除还有bug，没精力检测了。后续更新吧。 加法减乘除均使用小学教的竖式方法。。。因为网上也没学到更快的方法，最快的方法（尤其是除法）好像看到个，没会。。。所以这个东西在处理比如一千多位除以几百之类的数据时会很慢。。。不过毕竟我现在还算是新手嘛，以后可以还会再写一个更快的大数。使用竖式时，加法减法乘法使用的10^10进制，即统一算出一个ll（long long）的值，进位到下一个。 加法减法本质上由get_addition()与get_subtraction()实现，这两个函数无视正负号，全都看成是正的进行运算，只支持大的数加减小的数。因此对于有不同的正负符号的数字，比如负+正，可以看作-（正-负），所以只要调用get _subtraction()运算后添个负号即可；而对于正-负，可看作正+正，反而调用get _addition()。所以本质上还是正数之间的运算。 乘法与加法类似，甚至还少了符号的问题。 除法也是小学教的竖式法，一位位除，也就是一位位减，但是由于我得先乘以10的好多次，再循环减，再看下一位，速度还是慢，就比如3000位的数字除以50位的数字，那速度醉啦，要十几秒。 取余使用的&quot;<em>this - (</em>this / n)*n&quot;，所以比除号还慢。 比较符号没有很仔细地调试，但是应该没什么问题吧。 截图： <img src="/posts/18423/1.png" alt="这里写图片描述"></p>
<figure>
<img src="/posts/18423/2.png" alt="这里写图片描述"><figcaption>这里写图片描述</figcaption>
</figure>
<p>代码：</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="comment">//我的大数类，定义为longer好了[笑哭]</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _LONGER_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _LONGER_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma warning(disable:4996)	//对使用VS2015且开启了“安全开发生命周期(SDL)检测”的项目奏效(VS2013应该也有用)</span></span><br><span class="line">class longer</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//必要定义	(-.-;)</span></span><br><span class="line">	<span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">constexpr</span> ll MAX = <span class="number">1000000000</span>;	<span class="comment">//每个ll的存储限制，999999999*999999999刚好不溢出(9个9)</span></span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">int</span> DIGIT = <span class="number">9</span>;			<span class="comment">//ll支持的最大位数</span></span><br><span class="line">	<span class="comment">//数据储存	(-.-;)</span></span><br><span class="line">	<span class="keyword">bool</span> sign;								<span class="comment">//正负号：0正1负</span></span><br><span class="line">	std::vector&lt;ll&gt; number;					<span class="comment">//大数存储区</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">//构造函数	(-.-;)</span></span><br><span class="line">	longer();</span><br><span class="line">	longer(<span class="keyword">const</span> ll&amp;);</span><br><span class="line">	longer(<span class="keyword">const</span> longer&amp;);</span><br><span class="line">	longer(<span class="keyword">const</span> <span class="keyword">char</span>*);</span><br><span class="line">	longer(<span class="keyword">const</span> std::<span class="keyword">string</span>&amp;);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//运算符重载	(-.-;)</span></span><br><span class="line">	longer <span class="keyword">operator</span> +()<span class="keyword">const</span>;</span><br><span class="line">	longer <span class="keyword">operator</span> +(<span class="keyword">const</span> longer&amp;)<span class="keyword">const</span>;</span><br><span class="line">	longer <span class="keyword">operator</span> -()<span class="keyword">const</span>;</span><br><span class="line">	longer <span class="keyword">operator</span> -(<span class="keyword">const</span> longer&amp;)<span class="keyword">const</span>;</span><br><span class="line">	longer <span class="keyword">operator</span> *(<span class="keyword">const</span> longer&amp;)<span class="keyword">const</span>;</span><br><span class="line">	longer <span class="keyword">operator</span> /(<span class="keyword">const</span> longer&amp;)<span class="keyword">const</span>;</span><br><span class="line">	longer <span class="keyword">operator</span> %(<span class="keyword">const</span> longer&amp;)<span class="keyword">const</span>;</span><br><span class="line"></span><br><span class="line">	longer&amp; <span class="keyword">operator</span> ++();</span><br><span class="line">	longer <span class="keyword">operator</span> ++(<span class="keyword">int</span>);</span><br><span class="line">	longer&amp; <span class="keyword">operator</span> --();</span><br><span class="line">	longer <span class="keyword">operator</span> --(<span class="keyword">int</span>);</span><br><span class="line"></span><br><span class="line">	longer&amp; <span class="keyword">operator</span> =(<span class="keyword">const</span> ll&amp;);</span><br><span class="line">	longer&amp; <span class="keyword">operator</span> =(<span class="keyword">const</span> longer&amp;);</span><br><span class="line">	longer&amp; <span class="keyword">operator</span> =(<span class="keyword">const</span> <span class="keyword">char</span>*);</span><br><span class="line">	longer&amp; <span class="keyword">operator</span> =(<span class="keyword">const</span> std::<span class="keyword">string</span>&amp;);</span><br><span class="line"></span><br><span class="line">	longer&amp; <span class="keyword">operator</span> +=(<span class="keyword">const</span> longer&amp;);</span><br><span class="line">	longer&amp; <span class="keyword">operator</span> -=(<span class="keyword">const</span> longer&amp;);</span><br><span class="line">	longer&amp; <span class="keyword">operator</span> *=(<span class="keyword">const</span> longer&amp;);</span><br><span class="line">	longer&amp; <span class="keyword">operator</span> /=(<span class="keyword">const</span> longer&amp;);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">inline</span> <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> longer&amp;)<span class="keyword">const</span>;</span><br><span class="line">	<span class="keyword">inline</span> <span class="keyword">bool</span> <span class="keyword">operator</span> &gt;(<span class="keyword">const</span> longer&amp;)<span class="keyword">const</span>;</span><br><span class="line">	<span class="keyword">inline</span> <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;=(<span class="keyword">const</span> longer&amp;)<span class="keyword">const</span>;</span><br><span class="line">	<span class="keyword">inline</span> <span class="keyword">bool</span> <span class="keyword">operator</span> &gt;=(<span class="keyword">const</span> longer&amp;)<span class="keyword">const</span>;</span><br><span class="line">	<span class="keyword">inline</span> <span class="keyword">bool</span> <span class="keyword">operator</span> ==(<span class="keyword">const</span> longer&amp;)<span class="keyword">const</span>;</span><br><span class="line">	<span class="keyword">inline</span> <span class="keyword">bool</span> <span class="keyword">operator</span> !=(<span class="keyword">const</span> longer&amp;)<span class="keyword">const</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">friend</span> std::istream&amp; <span class="keyword">operator</span> &gt;&gt;(std::istream&amp;, longer&amp;);</span><br><span class="line">	<span class="keyword">friend</span> std::ostream&amp; <span class="keyword">operator</span> &lt;&lt;(std::ostream&amp;, <span class="keyword">const</span> longer&amp;);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//其他函数	(-.-;)</span></span><br><span class="line">	<span class="keyword">int</span> digit()<span class="keyword">const</span>;</span><br><span class="line">	<span class="keyword">static</span> longer lrabs(<span class="keyword">const</span> longer&amp;);		<span class="comment">//求绝对值</span></span><br><span class="line">	<span class="keyword">static</span> longer lrsqrt(<span class="keyword">const</span> longer&amp;);	<span class="comment">//求算数平方根,暂时没打算完成，先占个茅坑,不拉屎</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="comment">//类内部调用	(-.-;)</span></span><br><span class="line">	longer(<span class="keyword">const</span> <span class="keyword">int</span>, <span class="keyword">const</span> ll&amp;);									<span class="comment">//分配多少个vector容量，每个数据均为第一个参数</span></span><br><span class="line">	<span class="keyword">static</span> longer&amp; get_addition(longer&amp;, <span class="keyword">const</span> longer&amp;, <span class="keyword">bool</span>);		<span class="comment">//获得加法结果,仅支持正整数以大加小,无视正负号</span></span><br><span class="line">	<span class="keyword">static</span> longer&amp; get_subtraction(longer&amp;, <span class="keyword">const</span> longer&amp;, <span class="keyword">bool</span>);	<span class="comment">//获得减法结果,仅支持正整数以大减小,无视正负号</span></span><br><span class="line">	<span class="keyword">int</span> get_comparison(<span class="keyword">const</span> longer&amp;)<span class="keyword">const</span>;							<span class="comment">//获得比较结果,仅支持正整数相互比较,无视正负号</span></span><br><span class="line">	<span class="keyword">inline</span> ptrdiff_t get_ptrdiff()<span class="keyword">const</span>;							<span class="comment">//获得vector数组元素个数</span></span><br><span class="line">	<span class="keyword">inline</span> longer&amp; get_zero();										<span class="comment">//若结果为0,且若0的sign为负，则改为0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//必要定义	↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗</span></span><br><span class="line"><span class="keyword">constexpr</span> longer::ll longer::MAX;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> longer::DIGIT;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//构造函数	↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗</span></span><br><span class="line">longer::longer() &#123; number.push_back(<span class="number">0</span>); &#125;</span><br><span class="line">longer::longer(<span class="keyword">const</span> ll&amp; n) &#123; *<span class="keyword">this</span> = n; &#125;</span><br><span class="line">longer::longer(<span class="keyword">const</span> longer&amp; n) &#123; *<span class="keyword">this</span> = n; &#125;</span><br><span class="line">longer::longer(<span class="keyword">const</span> <span class="keyword">char</span>* s) &#123; *<span class="keyword">this</span> = s; &#125;</span><br><span class="line">longer::longer(<span class="keyword">const</span> std::<span class="keyword">string</span>&amp; s) &#123; *<span class="keyword">this</span> = s; &#125;</span><br><span class="line">longer::longer(<span class="keyword">const</span> <span class="keyword">int</span> i, <span class="keyword">const</span> ll&amp; n) : number(i, n), sign(<span class="number">0</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//运算符重载	↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗</span></span><br><span class="line"><span class="comment">//加减乘除取余次方</span></span><br><span class="line">longer longer::<span class="keyword">operator</span> +()<span class="keyword">const</span> &#123; <span class="built_in">return</span> *<span class="keyword">this</span>; &#125;</span><br><span class="line"></span><br><span class="line">longer longer::<span class="keyword">operator</span> +(<span class="keyword">const</span> longer&amp; n)<span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">bool</span> judge = get_comparison(n) &gt;= <span class="number">0</span>;</span><br><span class="line">	longer aa(judge ? *<span class="keyword">this</span> : n);</span><br><span class="line">	<span class="keyword">auto</span> &amp;bb = (judge ? n : *<span class="keyword">this</span>);</span><br><span class="line">	<span class="built_in">if</span> ((!aa.sign) &amp;&amp; (!bb.sign)) <span class="built_in">return</span> get_addition(aa, bb, <span class="number">0</span>);			<span class="comment">//正+正</span></span><br><span class="line">	<span class="built_in">if</span> ((!aa.sign) &amp;&amp; (bb.sign)) <span class="built_in">return</span> get_subtraction(aa, bb, !judge);	<span class="comment">//正+负</span></span><br><span class="line">	<span class="built_in">if</span> ((aa.sign) &amp;&amp; (!bb.sign)) <span class="built_in">return</span> get_subtraction(aa, bb, judge);		<span class="comment">//负+正</span></span><br><span class="line">	<span class="built_in">return</span> get_addition(aa, bb, <span class="number">1</span>);											<span class="comment">//负+负</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">longer longer::<span class="keyword">operator</span> -()<span class="keyword">const</span> &#123; longer t(*<span class="keyword">this</span>);t.sign = (t.sign ? <span class="number">0</span> : <span class="number">1</span>);<span class="built_in">return</span> t; &#125;</span><br><span class="line"></span><br><span class="line">longer longer::<span class="keyword">operator</span> -(<span class="keyword">const</span> longer&amp; n)<span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">bool</span> judge = get_comparison(n) &gt;= <span class="number">0</span>;</span><br><span class="line">	longer aa(judge ? *<span class="keyword">this</span> : n);</span><br><span class="line">	<span class="keyword">auto</span> &amp;bb = (judge ? n : *<span class="keyword">this</span>);</span><br><span class="line">	<span class="built_in">if</span> ((!aa.sign) &amp;&amp; (!bb.sign)) <span class="built_in">return</span> get_subtraction(aa, bb, !judge);	<span class="comment">//正-正</span></span><br><span class="line">	<span class="built_in">if</span> ((!aa.sign) &amp;&amp; (bb.sign)) <span class="built_in">return</span> get_addition(aa, bb, <span class="number">0</span>);			<span class="comment">//正-负</span></span><br><span class="line">	<span class="built_in">if</span> ((aa.sign) &amp;&amp; (!bb.sign)) <span class="built_in">return</span> get_addition(aa, bb, <span class="number">1</span>);			<span class="comment">//负-正</span></span><br><span class="line">	<span class="built_in">return</span> get_subtraction(aa, bb, judge);									<span class="comment">//负-负</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">longer longer::<span class="keyword">operator</span> *(<span class="keyword">const</span> longer&amp; n)<span class="keyword">const</span></span><br><span class="line">&#123;<span class="comment">//模拟小学老师教的方法</span></span><br><span class="line">	<span class="keyword">int</span> leni = get_ptrdiff(), lenj = n.get_ptrdiff();</span><br><span class="line">	longer re(leni + lenj, <span class="number">0</span>);</span><br><span class="line">	ll flag;</span><br><span class="line">	sign == n.sign ? re.sign = <span class="number">0</span> : re.sign = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; leni;++i) &#123;</span><br><span class="line">		longer t(n);</span><br><span class="line">		<span class="keyword">int</span> j;</span><br><span class="line">		flag = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">for</span> (j = <span class="number">0</span>;j &lt; lenj;++j) &#123;</span><br><span class="line">			t.number[j] = t.number[j] * number[i] + flag;</span><br><span class="line">			flag = t.number[j] / MAX;</span><br><span class="line">			t.number[j] -= flag*MAX;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">if</span> (flag) t.number.push_back(flag);</span><br><span class="line">		flag = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">for</span> (j = <span class="number">0</span>;j &lt; t.get_ptrdiff();++j) &#123;</span><br><span class="line">			re.number[i + j] += t.number[j] + flag;</span><br><span class="line">			<span class="built_in">if</span> (re.number[i + j] &gt;= MAX) re.number[i + j] -= MAX, flag = <span class="number">1</span>;</span><br><span class="line">			<span class="built_in">else</span> flag = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">if</span> (flag) re.number[i + j] += flag;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">while</span> (re.get_ptrdiff() &gt; <span class="number">1</span> &amp;&amp; !*re.number.rbegin()) re.number.pop_back();</span><br><span class="line">	<span class="built_in">return</span> re.get_zero();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">longer longer::<span class="keyword">operator</span> /(<span class="keyword">const</span> longer&amp; n)<span class="keyword">const</span></span><br><span class="line">&#123;<span class="comment">//模拟小学老师教的方法</span></span><br><span class="line">	<span class="built_in">if</span> (n == longer((ll)<span class="number">0</span>)) &#123; std::cerr &lt;&lt; <span class="string">"除数为0!\n"</span>;exit(<span class="number">1</span>); &#125;</span><br><span class="line">	longer th(*<span class="keyword">this</span>), re((ll)<span class="number">0</span>);</span><br><span class="line">	re.sign = th.sign = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> times = digit() - n.digit();</span><br><span class="line">	<span class="built_in">for</span> (<span class="keyword">int</span> i = times;i &gt;= <span class="number">0</span>;--i) &#123;</span><br><span class="line">		longer digi(i / DIGIT + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">		*digi.number.rbegin() = ((ll)<span class="built_in">pow</span>(<span class="number">10</span>, i % DIGIT));</span><br><span class="line">		longer t(n*digi); t.sign = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">while</span> (th.get_comparison(t) == <span class="number">1</span>) th-=t, re += digi;</span><br><span class="line">		<span class="built_in">if</span> (th.get_comparison(t) == <span class="number">0</span>) &#123; re += digi;<span class="built_in">break</span>; &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">if</span> (sign != n.sign) re.sign = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">return</span> re.get_zero();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">longer longer::<span class="keyword">operator</span> %(<span class="keyword">const</span> longer&amp; n)<span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">	longer re(*<span class="keyword">this</span> - (*<span class="keyword">this</span> / n)*n);</span><br><span class="line">	<span class="built_in">return</span> re.get_zero();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//自增自减</span></span><br><span class="line">longer&amp; longer::<span class="keyword">operator</span> ++() &#123; <span class="built_in">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> + <span class="number">1</span>; &#125;</span><br><span class="line">longer longer::<span class="keyword">operator</span> ++(<span class="keyword">int</span>) &#123; longer t = *<span class="keyword">this</span>;*<span class="keyword">this</span> = *<span class="keyword">this</span> + <span class="number">1</span>;<span class="built_in">return</span> t; &#125;</span><br><span class="line">longer&amp; longer::<span class="keyword">operator</span> --() &#123; <span class="built_in">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> - <span class="number">1</span>; &#125;</span><br><span class="line">longer longer::<span class="keyword">operator</span> --(<span class="keyword">int</span>) &#123; longer t = *<span class="keyword">this</span>;*<span class="keyword">this</span> = *<span class="keyword">this</span> - <span class="number">1</span>;<span class="built_in">return</span> t; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//赋值</span></span><br><span class="line">longer&amp; longer::<span class="keyword">operator</span> =(<span class="keyword">const</span> ll&amp; n)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">if</span> (n &lt; <span class="number">0</span>) sign = <span class="number">1</span>, number.push_back(-n);</span><br><span class="line">	<span class="built_in">else</span> sign = <span class="number">0</span>, number.push_back(n);</span><br><span class="line">	<span class="built_in">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">longer&amp; longer::<span class="keyword">operator</span> =(<span class="keyword">const</span> longer&amp; n)</span><br><span class="line">&#123;</span><br><span class="line">	number = n.number;</span><br><span class="line">	sign = n.sign;</span><br><span class="line">	<span class="built_in">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">longer&amp; longer::<span class="keyword">operator</span> =(<span class="keyword">const</span> <span class="keyword">char</span>* s)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">return</span> *<span class="keyword">this</span> = std::<span class="keyword">string</span>(s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">longer&amp; longer::<span class="keyword">operator</span> =(<span class="keyword">const</span> std::<span class="keyword">string</span>&amp; s)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">auto</span> ps = s.rbegin();</span><br><span class="line">	<span class="keyword">char</span> c[DIGIT + <span class="number">1</span>], *pc;</span><br><span class="line">	ll temp;</span><br><span class="line">	sign = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">while</span> (ps != s.rend()) &#123;</span><br><span class="line">		*(pc = &amp;c[DIGIT]) = <span class="string">'\0'</span>;</span><br><span class="line">		<span class="keyword">int</span> i;</span><br><span class="line">		<span class="built_in">for</span> (i = <span class="number">0</span>;i &lt; DIGIT &amp;&amp; ps != s.rend();++i)</span><br><span class="line">			*--pc = *ps++;</span><br><span class="line">		<span class="built_in">if</span> (*(ps - <span class="number">1</span>) == <span class="string">'-'</span>) *pc = <span class="string">'0'</span>, sign = <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">while</span> (i++ &lt; DIGIT) *--pc = <span class="string">'0'</span>;</span><br><span class="line">		std::istringstream in(c);</span><br><span class="line">		in &gt;&gt; temp;</span><br><span class="line">		number.push_back(temp);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">if</span> (get_ptrdiff()&gt;<span class="number">1</span> &amp;&amp; !*number.rbegin()) number.pop_back();</span><br><span class="line">	<span class="built_in">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">longer&amp; longer::<span class="keyword">operator</span> +=(<span class="keyword">const</span> longer&amp; n) &#123; <span class="built_in">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> + n; &#125;</span><br><span class="line">longer&amp; longer::<span class="keyword">operator</span> -=(<span class="keyword">const</span> longer&amp; n) &#123; <span class="built_in">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> - n; &#125;</span><br><span class="line">longer&amp; longer::<span class="keyword">operator</span> *=(<span class="keyword">const</span> longer&amp; n) &#123; <span class="built_in">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> * n; &#125;</span><br><span class="line">longer&amp; longer::<span class="keyword">operator</span> /=(<span class="keyword">const</span> longer&amp; n) &#123; <span class="built_in">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> / n; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//比较</span></span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">bool</span> longer::<span class="keyword">operator</span> &lt;(<span class="keyword">const</span> longer&amp; n)<span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">if</span> ((!sign) &amp;&amp; (n.sign)) <span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">if</span> ((sign) &amp;&amp; (!n.sign)) <span class="built_in">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">if</span> ((!sign) &amp;&amp; (!n.sign)) <span class="built_in">return</span> get_comparison(n) == <span class="number">-1</span>;</span><br><span class="line">	<span class="built_in">return</span> get_comparison(n) == <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">bool</span> longer::<span class="keyword">operator</span> &gt;(<span class="keyword">const</span> longer&amp; n)<span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">if</span> ((!sign) &amp;&amp; (n.sign)) <span class="built_in">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">if</span> ((sign) &amp;&amp; (!n.sign)) <span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">if</span> ((!sign) &amp;&amp; (!n.sign)) <span class="built_in">return</span> get_comparison(n) == <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">return</span> get_comparison(n) == <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">bool</span> longer::<span class="keyword">operator</span> &lt;=(<span class="keyword">const</span> longer&amp; n)<span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">if</span> ((!sign) &amp;&amp; (n.sign)) <span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">if</span> ((sign) &amp;&amp; (!n.sign)) <span class="built_in">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">if</span> ((!sign) &amp;&amp; (!n.sign)) <span class="built_in">return</span> get_comparison(n) &lt;= <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">return</span> get_comparison(n) &gt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">bool</span> longer::<span class="keyword">operator</span> &gt;=(<span class="keyword">const</span> longer&amp; n)<span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">if</span> ((!sign) &amp;&amp; (n.sign)) <span class="built_in">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">if</span> ((sign) &amp;&amp; (!n.sign)) <span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">if</span> ((!sign) &amp;&amp; (!n.sign)) <span class="built_in">return</span> get_comparison(n) &gt;= <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">return</span> get_comparison(n) &lt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">bool</span> longer::<span class="keyword">operator</span> ==(<span class="keyword">const</span> longer&amp; n)<span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">if</span> (((!sign) &amp;&amp; (n.sign)) || ((sign) &amp;&amp; (!n.sign))) <span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">return</span> !get_comparison(n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">bool</span> longer::<span class="keyword">operator</span> !=(<span class="keyword">const</span> longer&amp; n)<span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">if</span> (((!sign) &amp;&amp; (n.sign)) || ((sign) &amp;&amp; (!n.sign))) <span class="built_in">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">return</span> get_comparison(n) != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//输入输出</span></span><br><span class="line">std::istream&amp; <span class="keyword">operator</span> &gt;&gt;(std::istream&amp; is, longer&amp; n)</span><br><span class="line">&#123;</span><br><span class="line">	std::<span class="keyword">string</span> s;is &gt;&gt; s;</span><br><span class="line">	n = s;</span><br><span class="line">	<span class="built_in">return</span> is;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::ostream&amp; <span class="keyword">operator</span> &lt;&lt;(std::ostream&amp; os, <span class="keyword">const</span> longer&amp; n)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">auto</span> p = n.number.rbegin();</span><br><span class="line">	<span class="built_in">if</span> (n.sign) os &lt;&lt; <span class="string">'-'</span>;</span><br><span class="line">	os &lt;&lt; *p;</span><br><span class="line">	<span class="built_in">for</span> (++p;p != n.number.rend();++p) &#123;</span><br><span class="line">		<span class="keyword">int</span> i = <span class="number">0</span>;<span class="keyword">auto</span> n = *p;</span><br><span class="line">		<span class="built_in">while</span> (n /= <span class="number">10</span>) ++i;</span><br><span class="line">		<span class="built_in">for</span> (;++i &lt; longer::DIGIT;std::cout &lt;&lt; <span class="string">'0'</span>);</span><br><span class="line">		os &lt;&lt; *p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> os;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//其他函数	↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗</span></span><br><span class="line"><span class="keyword">int</span> longer::digit()<span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">int</span> a = (get_ptrdiff() - <span class="number">1</span>) * DIGIT;</span><br><span class="line">	ll b = *number.rbegin();</span><br><span class="line">	<span class="built_in">do</span> ++a;<span class="built_in">while</span> (b /= <span class="number">10</span>);</span><br><span class="line">	<span class="built_in">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">longer longer::lrabs(<span class="keyword">const</span> longer&amp; n) &#123; longer t(n);<span class="built_in">if</span> (t.sign) t.sign = <span class="number">0</span>;<span class="built_in">return</span> t; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//类内部调用	↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗↖(-(●●)-)↗</span></span><br><span class="line">longer&amp; longer::get_addition(longer&amp; aa, <span class="keyword">const</span> longer&amp; bb, <span class="keyword">bool</span> si)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">auto</span> a = aa.number.<span class="built_in">begin</span>(), &amp;aend = aa.number.<span class="built_in">end</span>();</span><br><span class="line">	<span class="keyword">auto</span>  b = bb.number.<span class="built_in">begin</span>(), &amp;bend = bb.number.<span class="built_in">end</span>();</span><br><span class="line">	<span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">	aa.sign = si;</span><br><span class="line">	<span class="built_in">do</span> &#123;</span><br><span class="line">		*a += (b == bend ? <span class="number">0</span> : *b++) + flag;</span><br><span class="line">		<span class="built_in">if</span> (*a &gt;= MAX) *a -= MAX, flag = <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">else</span> <span class="built_in">if</span> (flag) flag = <span class="number">0</span>;</span><br><span class="line">	&#125; <span class="built_in">while</span> (++a != aend &amp;&amp; (b != bend || flag));</span><br><span class="line">	<span class="built_in">if</span> (flag) aa.number.push_back(flag);</span><br><span class="line">	<span class="built_in">return</span> aa.get_zero();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">longer&amp; longer::get_subtraction(longer&amp; aa, <span class="keyword">const</span> longer&amp; bb, <span class="keyword">bool</span> si)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">auto</span> a = aa.number.<span class="built_in">begin</span>(), &amp;aend = aa.number.<span class="built_in">end</span>();</span><br><span class="line">	<span class="keyword">auto</span>  b = bb.number.<span class="built_in">begin</span>(), &amp;bend = bb.number.<span class="built_in">end</span>();</span><br><span class="line">	<span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">	aa.sign = si;</span><br><span class="line">	<span class="built_in">do</span> &#123;</span><br><span class="line">		*a -= (b == bend ? <span class="number">0</span> : *b++) + flag;</span><br><span class="line">		<span class="built_in">if</span> (*a &lt; <span class="number">0</span>) *a += MAX, flag = <span class="number">1</span>;</span><br><span class="line">		<span class="built_in">else</span> <span class="built_in">if</span> (flag) flag = <span class="number">0</span>;</span><br><span class="line">	&#125; <span class="built_in">while</span> (++a != aend &amp;&amp; (b != bend || flag));</span><br><span class="line">	<span class="built_in">while</span> (aa.get_ptrdiff()&gt;<span class="number">1</span> &amp;&amp; !*aa.number.rbegin()) aa.number.pop_back();</span><br><span class="line">	<span class="built_in">return</span> aa.get_zero();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> longer::get_comparison(<span class="keyword">const</span> longer&amp; n)<span class="keyword">const</span></span><br><span class="line">&#123;<span class="comment">//返回1:左值大,0相等,-1右值大</span></span><br><span class="line">	<span class="built_in">if</span> (get_ptrdiff() &lt; n.get_ptrdiff()) <span class="built_in">return</span> <span class="number">-1</span>;</span><br><span class="line">	<span class="built_in">if</span> (get_ptrdiff() &gt; n.get_ptrdiff()) <span class="built_in">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">auto</span> a = number.rbegin(), b = n.number.rbegin();</span><br><span class="line">	<span class="built_in">while</span> (a != number.rend()) &#123;</span><br><span class="line">		<span class="built_in">if</span> (*a &lt; *b) <span class="built_in">return</span> <span class="number">-1</span>;</span><br><span class="line">		<span class="built_in">if</span> (*a &gt; *b) <span class="built_in">return</span> <span class="number">1</span>;</span><br><span class="line">		++a, ++b;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> ptrdiff_t longer::get_ptrdiff()<span class="keyword">const</span> &#123; <span class="built_in">return</span> number.<span class="built_in">end</span>() - number.<span class="built_in">begin</span>(); &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> longer&amp; longer::get_zero()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">if</span> (get_ptrdiff() == <span class="number">1</span> &amp;&amp; number[<span class="number">0</span>] == <span class="number">0</span> &amp;&amp; sign == <span class="number">1</span>) sign = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>算法竞赛</category>
      </categories>
      <tags>
        <tag>造轮子</tag>
        <tag>大数模板</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典 第2章习题</title>
    <url>/posts/10776.html</url>
    <content><![CDATA[<p>题目：算法竞赛入门经典 2-1 水仙花数 代码： <figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">#include&lt;iostream&gt;</span><br><span class="line"><span class="built_in">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">100</span>;i &lt; <span class="number">999</span>;++i)</span><br><span class="line">		<span class="keyword">if</span> ((i % <span class="number">10</span>)*(i % <span class="number">10</span>)*(i % <span class="number">10</span>) + (i % <span class="number">100</span> / <span class="number">10</span>)*(i % <span class="number">100</span> / <span class="number">10</span>)*(i % <span class="number">100</span> / <span class="number">10</span>) + (i / <span class="number">100</span>)*(i / <span class="number">100</span>)*(i / <span class="number">100</span>) == i) std::cout &lt;&lt; i &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>题目：算法竞赛入门经典 2-2 韩信点兵 代码： <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a,b,c,times=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; c) &#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"Case "</span> &lt;&lt; ++times &lt;&lt; <span class="string">": "</span>;</span><br><span class="line">		c &lt; <span class="number">3</span>?c += <span class="number">14</span> : c+=<span class="number">7</span>;;</span><br><span class="line">		<span class="keyword">for</span> (;c &lt;= <span class="number">100</span>;c += <span class="number">7</span>)</span><br><span class="line">			<span class="keyword">if</span> (c % <span class="number">5</span> == b&amp;&amp;c % <span class="number">3</span> == a) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; c &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">if</span> (c &gt; <span class="number">100</span>) <span class="built_in">cout</span> &lt;&lt; <span class="string">"No answer\n"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>题目：算法竞赛入门经典 2-3 倒三角形 代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n;<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; i;++j) <span class="built_in">cout</span> &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">2</span> * (n - i) - <span class="number">1</span>;++j) <span class="built_in">cout</span> &lt;&lt; <span class="string">'*'</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>题目：算法竞赛入门经典 2-4 子序列的和 代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">double</span> sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (;a &lt;= b;++a) sum += <span class="number">1.0</span> / a / a;</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n, m,times=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; setprecision(<span class="number">5</span>)&lt;&lt;fixed;</span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">			<span class="keyword">if</span> (n == <span class="number">0</span> &amp;&amp; m == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125; <span class="keyword">while</span> (n &gt;= m || n &lt;= <span class="number">0</span>);</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"Case "</span> &lt;&lt; ++times &lt;&lt; <span class="string">": "</span> &lt;&lt; f(n, m) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125; <span class="keyword">while</span> (<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>题目：算法竞赛入门经典 2-5 分数化小数 代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a, b, c,CASE=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">			<span class="keyword">if</span> (a == <span class="number">0</span> &amp;&amp; b == <span class="number">0</span> &amp;&amp; c == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125; <span class="keyword">while</span> (a &gt; <span class="number">1e6</span> || b &gt; <span class="number">1e6</span> || c &gt; <span class="number">100</span>);</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"Case "</span> &lt;&lt; ++CASE &lt;&lt; <span class="string">": "</span></span><br><span class="line">			&lt;&lt; fixed &lt;&lt; setprecision(c)</span><br><span class="line">			&lt;&lt; (<span class="keyword">double</span>)a / (<span class="keyword">double</span>)b &lt;&lt; <span class="built_in">endl</span>;;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>题目：算法竞赛入门经典 2-6 排列 代码：</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">#include&lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> ge(<span class="built_in">int</span> n) &#123; <span class="keyword">return</span> n % <span class="number">10</span>; &#125;</span><br><span class="line"><span class="built_in">int</span> shi(<span class="built_in">int</span> n) &#123; <span class="keyword">return</span> (n % <span class="number">100</span>) / <span class="number">10</span>; &#125;</span><br><span class="line"><span class="built_in">int</span> bai(<span class="built_in">int</span> n) &#123; <span class="keyword">return</span> n / <span class="number">100</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">int</span> n[<span class="number">9</span>],i,j;</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> <span class="built_in">num</span> = <span class="number">123</span>;<span class="built_in">num</span> &lt;= <span class="number">321</span>;++<span class="built_in">num</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		n[<span class="number">0</span>] = bai(<span class="built_in">num</span>), n[<span class="number">1</span>] = shi(<span class="built_in">num</span>), n[<span class="number">2</span>] = ge(<span class="built_in">num</span>);</span><br><span class="line">		n[<span class="number">3</span>] = bai(<span class="number">2</span> * <span class="built_in">num</span>), n[<span class="number">4</span>] = shi(<span class="number">2</span> * <span class="built_in">num</span>), n[<span class="number">5</span>] = ge(<span class="number">2</span> * <span class="built_in">num</span>);</span><br><span class="line">		n[<span class="number">6</span>] = bai(<span class="number">3</span> * <span class="built_in">num</span>), n[<span class="number">7</span>] = shi(<span class="number">3</span> * <span class="built_in">num</span>), n[<span class="number">8</span>] = ge(<span class="number">3</span> * <span class="built_in">num</span>);</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">8</span>;++i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (j = i + <span class="number">1</span>;j &lt; <span class="number">9</span>;++j)</span><br><span class="line">				<span class="keyword">if</span> (n[i] == n[j]) <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">if</span> (j &lt; <span class="number">9</span>) <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (i == <span class="number">8</span> &amp;&amp; j == <span class="number">9</span>) cout &lt;&lt; <span class="built_in">num</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析： 2-2无需一个一个地枚举，七个七个地枚举就行，因为每七个里有6个事绝壁不可能的数据。当然应该有更直接的数学方法，我不知道（小学奥数书上是不是有来着）。 2-4所说的陷阱是，65536<em>65536刚好溢出，所以算1/n^2时，写1/n/n，而不要写1 / (n </em> n)。 2-6因为每个数字只能使用一次，所以从123开始枚举，而又要存在3倍关系，所以以321结束枚举</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典 3-12UVa11809</title>
    <url>/posts/17916.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO 题目：算法竞赛入门经典 3-4/UVa11809：Floating-Point Numbers 代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa11809 - Floating-Point Numbers</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> E[<span class="number">12</span>][<span class="number">33</span>], e;</span><br><span class="line"><span class="keyword">double</span> M[<span class="number">12</span>][<span class="number">33</span>], m, re;</span><br><span class="line"><span class="keyword">char</span> str[<span class="number">25</span>], *ps;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= <span class="number">9</span>;++i)<span class="comment">//M</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= <span class="number">30</span>;++j) &#123;<span class="comment">//E</span></span><br><span class="line">			m = <span class="number">1</span> - <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">-1</span> - i);</span><br><span class="line">			e = <span class="built_in">pow</span>(<span class="number">2</span>, j) - <span class="number">1</span>;</span><br><span class="line">			re = <span class="built_in">log10</span>(m) + <span class="built_in">log10</span>(<span class="number">2</span>)*e;</span><br><span class="line">			E[i][j] = (<span class="keyword">long</span> <span class="keyword">long</span>)re;</span><br><span class="line">			M[i][j] = <span class="built_in">pow</span>(<span class="number">10</span>, (re - E[i][j]));</span><br><span class="line">		&#125;<span class="comment">//打表完成，读入数据</span></span><br><span class="line">	<span class="keyword">while</span> ((<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; str) &amp;&amp; (ps = str) != <span class="string">"0e0"</span>) &#123;</span><br><span class="line">		<span class="keyword">while</span> (*++ps != <span class="string">'e'</span>);*ps = <span class="string">' '</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="function"><span class="built_in">istringstream</span> <span class="title">s</span><span class="params">(str)</span></span>;</span><br><span class="line">		s &gt;&gt; m &gt;&gt; e;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= <span class="number">9</span>;++i) &#123;<span class="comment">//M</span></span><br><span class="line">			<span class="keyword">int</span> j;</span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">1</span>;j &lt;= <span class="number">30</span>;++j) &#123;<span class="comment">//E</span></span><br><span class="line">				<span class="keyword">if</span> (E[i][j] == e &amp;&amp; (M[i][j] - m &lt; <span class="number">0.0001</span> &amp;&amp; m - M[i][j] &lt; <span class="number">0.0001</span>)) &#123;<span class="comment">//double达不到15位的精度，但是其实无所谓，差不离就行</span></span><br><span class="line">					<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">' '</span> &lt;&lt; j &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (j &lt;= <span class="number">30</span>) <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：这题对我来说有点难，而且一开始做这题时精神状态不佳，磨洋工磨了一下午也没磨出来。甚至一开始看懂了题目但看不懂题意。。然后第二天继续做，在继承了昨天磨了一下午形成的固化思维下，有点思路但是感觉写下来会很烦琐。于是认认真真去网上看大神的思路。又不敢看太多，看太多了就没有自己的思路了完全是抄了，抄完该忘记的还是忘记。 这题主要看了这位大神的博客：http://blog.csdn.net/crazysillynerd/article/details/43339157</p>
<p>首先他是用的打表。这个方法我知道但一直没想到去用过。而这题刚好说了“The input file contains around 300 line of input”，同时有 9 ≥ M ≥ 0 and 30 ≥ E ≥ 1，10*30刚好300，用读表法再好不过。所以这也是我第一次用读表法。。下次就记住了。</p>
<p>然后怎么打表，我又不会了。。真的菜。。主要就是在两个循环里如何计算M和E。看到这位大大用了log什么的看了几眼没看懂，觉得还是自己动手算比较好，于是拿出草稿纸。事实证明草稿纸果真神器一枚，理思路、演算很有帮助。 我们要做的转化是：M x 10^E=m x 2^e（这个e与2.7的那个e无关），m和e可以根据i、j求出，也就是看成常数。那么两边取log10，得lg M + E x lg 2=lg M + e，左式可算出为re，右式E为long long，M为double，且因为使用的科学记数法，1&lt;=M&lt;10（虽然题目上只说0 &lt; M &lt; 10，但这位大神还去测了，题目中给的数据都是大于1的，钻研精神max），所以0 &lt; lg M &lt; 1，所以E = re - lg M，E为re的取整，即强制转化为long long即可，然后M也可求出。。天，这方法比我之前想的不知道快到哪里去了。。。</p>
<p>然后就是根据输入的数据读表，没什么问题。但是注意到那大神用了istringstream。这玩意我在C++Primer上看到过，当时还想着没什么用。现在才知道其威力！当我看到大神那句：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(string::iterator <span class="built_in">i</span> = in.begin(); <span class="built_in">i</span> != in.<span class="keyword">end</span>(); ++<span class="built_in">i</span>) <span class="keyword">if</span>(*<span class="built_in">i</span> == <span class="string">'e'</span>) *<span class="built_in">i</span> = <span class="string">' '</span>;</span><br></pre></td></tr></table></figure>
<p>瞬间让字符串可以直接输入到double和long long，简化了不少的代码！我做题目至今，用来用去就那几个东西，primer上看到的那些东西都没怎么用过。论活学活用的重要性。。。</p>
<p>于是最终。。我写出来的代码还是和那大神的还是太像了。。。跟抄作业的一样。。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典 3-10UVa1587 3-11UVa1588</title>
    <url>/posts/21702.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO 题目：算法竞赛入门经典 3-10/UVa1587：Box 代码：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1587 - Box</span></span><br><span class="line">#include&lt;iostream&gt;</span><br><span class="line">unsigned rect[<span class="number">6</span>];<span class="comment">//每个面各有一个一样的对应面,故12个边只要定义6个,其中每偶奇两个代表一个长方形的两个边长</span></span><br><span class="line"><span class="built_in">bool</span> flag, times[<span class="number">3</span>];<span class="comment">//每个面出现的次数（出现第二次时为true）</span></span><br><span class="line">unsigned tmpx, tmpy, now;</span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span> (scanf(<span class="string">"%u%u"</span>, &amp;rect[<span class="number">0</span>], &amp;rect[<span class="number">1</span>]) != EOF) &#123;</span><br><span class="line">		now = <span class="number">0</span>;</span><br><span class="line">		flag = times[<span class="number">0</span>] = times[<span class="number">1</span>] = times[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (rect[<span class="number">0</span>] &lt; rect[<span class="number">1</span>]) &#123;</span><br><span class="line">			<span class="built_in">auto</span> t = rect[<span class="number">0</span>];</span><br><span class="line">			rect[<span class="number">0</span>] = rect[<span class="number">1</span>], rect[<span class="number">1</span>] = t;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>;i &lt; <span class="number">6</span>;++i) &#123;</span><br><span class="line">			scanf(<span class="string">"%u%u"</span>, &amp;tmpx, &amp;tmpy);</span><br><span class="line">			<span class="keyword">if</span> (flag) <span class="keyword">continue</span>;</span><br><span class="line">			unsigned j;</span><br><span class="line">			<span class="keyword">if</span> (tmpx &lt; tmpy) j = tmpx, tmpx = tmpy, tmpy = j;</span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt;= now;++j) &#123;<span class="comment">//判断新输入的数据是不是之前已经输入过的某矩形的对面</span></span><br><span class="line">				<span class="keyword">if</span> (times[j]) <span class="keyword">continue</span>;<span class="comment">//若当前面已经找到其对面，continue继续寻找</span></span><br><span class="line">				<span class="keyword">if</span> (rect[<span class="number">2</span> * j] == tmpx&amp;&amp;rect[<span class="number">2</span> * j + <span class="number">1</span>] == tmpy) &#123;</span><br><span class="line">					times[j] = <span class="number">1</span>;<span class="comment">//找到对面</span></span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (j &lt;= now) <span class="keyword">continue</span>;<span class="comment">//若已经找到对面</span></span><br><span class="line">			<span class="keyword">if</span> (++now &gt; <span class="number">2</span>) &#123; flag = <span class="number">1</span>;<span class="keyword">continue</span>; &#125;<span class="comment">//若出现了第四组不同的面，则不能组成立方体</span></span><br><span class="line">			rect[<span class="number">2</span> * now] = tmpx, rect[<span class="number">2</span> * now + <span class="number">1</span>] = tmpy;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!flag) &#123;<span class="comment">//下面进一步判断是否可以组成Box</span></span><br><span class="line">			unsigned t;<span class="comment">//排序，从大到小把每个矩形排序</span></span><br><span class="line">			<span class="keyword">for</span> (unsigned i = <span class="number">0</span>;i &lt; <span class="number">2</span>;++i) &#123;</span><br><span class="line">				unsigned  max = <span class="number">2</span> * i;</span><br><span class="line">				<span class="keyword">for</span> (unsigned j = i + <span class="number">1</span>;j &lt; <span class="number">3</span>;++j)</span><br><span class="line">					<span class="keyword">if</span> (rect[max] &lt; rect[<span class="number">2</span> * j]) max = <span class="number">2</span> * j;</span><br><span class="line">				t = rect[max], rect[max] = rect[<span class="number">2</span> * i], rect[<span class="number">2</span> * i] = t;</span><br><span class="line">				t = rect[max+<span class="number">1</span>], rect[max+<span class="number">1</span>] = rect[<span class="number">2</span> * i + <span class="number">1</span>], rect[<span class="number">2</span> * i + <span class="number">1</span>] = t;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (rect[<span class="number">1</span>] &lt; rect[<span class="number">3</span>]) t = rect[<span class="number">1</span>], rect[<span class="number">1</span>] = rect[<span class="number">3</span>], rect[<span class="number">3</span>] = t;</span><br><span class="line">			<span class="keyword">if</span> (rect[<span class="number">2</span>] == rect[<span class="number">4</span>] &amp;&amp; rect[<span class="number">3</span>] &lt; rect[<span class="number">5</span>]) t = rect[<span class="number">3</span>], rect[<span class="number">3</span>] = rect[<span class="number">5</span>], rect[<span class="number">5</span>] = t;</span><br><span class="line">			<span class="keyword">if</span> (rect[<span class="number">1</span>] &lt; rect[<span class="number">3</span>]) t = rect[<span class="number">1</span>], rect[<span class="number">1</span>] = rect[<span class="number">3</span>], rect[<span class="number">3</span>] = t;</span><br><span class="line">			<span class="keyword">if</span> (rect[<span class="number">0</span>] != rect[<span class="number">2</span>] || rect[<span class="number">1</span>] != rect[<span class="number">4</span>] || rect[<span class="number">3</span>] != rect[<span class="number">5</span>]) flag = <span class="number">1</span>;</span><br><span class="line">			<span class="comment">//for (int i = 0;i &lt; 3;++i) std::cout &lt;&lt; rect[2 * i] &lt;&lt; '\t' &lt;&lt; rect[2 * i + 1] &lt;&lt; '\n';</span></span><br><span class="line">		&#125;</span><br><span class="line">		printf(flag ? <span class="string">"IMPOSSIBLE\n"</span> : <span class="string">"POSSIBLE\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：因为每个面都有其对面，所以我只定义了3个面的边长，也就是6条边。于是在输入时就可以排除好些impossible的案例。 在代码后半段的进一步判断是否可以组成长方体时，我本来是用的比较烦的方法，比较绕，虽然答案也对而且也不是很耗时间。但是在网上看到了排序法，就是把各个矩形按长宽从大到小排列，排列后很轻松地就可以做出来。于是后来我也用了排序法。（看到了这个好方法我都不好意思把我之前写的贴出来了哈哈。唉，计算机到最后还是拼数学） 比如6个矩形分别为两个5x4的，两个4x3的，两个5x3的，经排序后即为： 5 4 5 3 4 3（对应rect[0]~rect[5]） 则只需判断&quot;if (rect[0] != rect[2] || rect[1] != rect[4] || rect[3] != rect[5]) flag = 1;&quot;即可。 然后我又找到了一个大神的代码，其代码如下： 原文链接：http://blog.csdn.net/kun768/article/details/43701899</p>
<figure class="highlight gml"><table><tr><td class="code"><pre><span class="line">#include &lt;bits/stdc++.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">struct face&#123;</span><br><span class="line">    int <span class="symbol">x</span>, <span class="symbol">y</span>;</span><br><span class="line">&#125;a[<span class="number">6</span>];</span><br><span class="line">bool check()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keywords">if</span>(memcmp(a, a+<span class="number">1</span>, sizeof(face)) || memcmp(a+<span class="number">2</span>, a+<span class="number">3</span>, sizeof(face)) || memcmp(a+<span class="number">4</span>, a+<span class="number">5</span>, sizeof(face))) <span class="keywords">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keywords">if</span>(a[<span class="number">0</span>].<span class="symbol">x</span>!=a[<span class="number">2</span>].<span class="symbol">x</span> || a[<span class="number">0</span>].<span class="symbol">y</span>!= a[<span class="number">4</span>].<span class="symbol">x</span> || a[<span class="number">2</span>].<span class="symbol">y</span>!=a[<span class="number">4</span>].<span class="symbol">y</span>) <span class="keywords">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keywords">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keywords">while</span>(cin &gt;&gt; a[<span class="number">0</span>].<span class="symbol">x</span> &gt;&gt; a[<span class="number">0</span>].<span class="symbol">y</span> &gt;&gt; a[<span class="number">1</span>].<span class="symbol">x</span> &gt;&gt; a[<span class="number">1</span>].<span class="symbol">y</span> &gt;&gt; a[<span class="number">2</span>].<span class="symbol">x</span> &gt;&gt; a[<span class="number">2</span>].<span class="symbol">y</span> &gt;&gt; a[<span class="number">3</span>].<span class="symbol">x</span> &gt;&gt; a[<span class="number">3</span>].<span class="symbol">y</span> &gt;&gt; a[<span class="number">4</span>].<span class="symbol">x</span> &gt;&gt; a[<span class="number">4</span>].<span class="symbol">y</span> &gt;&gt; a[<span class="number">5</span>].<span class="symbol">x</span> &gt;&gt; a[<span class="number">5</span>].<span class="symbol">y</span>)&#123;</span><br><span class="line">        <span class="keywords">for</span>(int i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i)</span><br><span class="line">            <span class="keywords">if</span>(a[i].<span class="symbol">x</span> &lt; a[i].<span class="symbol">y</span>)</span><br><span class="line">                swap(a[i].<span class="symbol">x</span>, a[i].<span class="symbol">y</span>);</span><br><span class="line">        sort(a, a+<span class="number">6</span>, [](const face a, const face b) &#123;<span class="keywords">return</span> a.<span class="symbol">x</span>==b.<span class="symbol">x</span> ? (a.<span class="symbol">y</span> &gt; b.<span class="symbol">y</span>) : (a.<span class="symbol">x</span> &gt; b.<span class="symbol">x</span>);&#125;);</span><br><span class="line">        printf(<span class="string">"%s\n"</span>, check() ? <span class="string">"POSSIBLE"</span> : <span class="string">"IMPOSSIBLE"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keywords">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>只需短短23行，效率也极高。真的厉害！然后我发现其实我之前只定义3个面也是没必要的，统一判断一样简洁高效。</p>
<p>题目：算法竞赛入门经典 3-11/UVa1588：Kickdown 代码： <figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1588 - Kickdown</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">char</span> a[<span class="number">103</span>], b[<span class="number">103</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calculate</span><span class="params">(<span class="keyword">char</span> *x, <span class="keyword">char</span> *y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> lenx = <span class="built_in">strlen</span>(x), leny = <span class="built_in">strlen</span>(y);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= lenx;++i) &#123;</span><br><span class="line">		<span class="keyword">const</span> <span class="keyword">int</span> len = (leny &lt; lenx - i ? leny : lenx - i);</span><br><span class="line">		<span class="keyword">int</span> j;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>;j != len;++j)</span><br><span class="line">			<span class="keyword">if</span> (x[i + j] + y[j] &gt;= <span class="number">100</span>) <span class="keyword">break</span>;<span class="comment">//'2'的ASCII为50,50+50=100</span></span><br><span class="line">		<span class="keyword">if</span> (j == len)</span><br><span class="line">			<span class="keyword">return</span> (lenx &gt; leny + i ? lenx : leny + i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b) &#123;<span class="comment">//scanf输入字符串有bug？</span></span><br><span class="line">		<span class="keyword">int</span> re_a = calculate(a, b),</span><br><span class="line">			re_b = calculate(b, a);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, re_a &lt; re_b ? re_a : re_b);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 分析：函数从两者的第一个字符开始比较。需要执行两遍函数，两次函数调换了a、b的位置，理解为： 第一遍：a固定不动，b的第一个字符分别指向a的第1个、第2个、第3个……数字，进行比较全数列。 第二遍：b固定不动，a的第一个字符分别指向b的第1个、第2个、第3个……数字，进行比较全数列。 两遍刚好把所有情况找全。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典 3-7UVa1368 3-8UVa202 3-9UVa10340</title>
    <url>/posts/2851.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO 都是《算法竞赛入门经典（第二版）》的题目，标题上没写（第二版）</p>
<p>题目：算法竞赛入门经典 3-7/UVa1368：DNA Consensus String 代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa1368 - DNA Consensus String</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_M 52</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_N 1005</span></span><br><span class="line"><span class="keyword">char</span> DNA[MAX_M][MAX_N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> T, m, n, err, num[<span class="number">4</span>];<span class="comment">//num用于存放ACGT个数</span></span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> &amp;mm = m, &amp;nn = n;<span class="comment">//防止自己代码书写错误</span></span><br><span class="line">	<span class="keyword">char</span> consensus[MAX_N], ACGT[] = <span class="string">"ACGT"</span>;<span class="comment">//consensus为计算结果</span></span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">	<span class="keyword">while</span> (T--) &#123;</span><br><span class="line">		err = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; m &gt;&gt; n;</span><br><span class="line">		<span class="built_in">cin</span>.getline(DNA[<span class="number">51</span>], <span class="number">3</span>);<span class="comment">//吸收'\n'</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; mm;++i)</span><br><span class="line">			<span class="built_in">cin</span>.getline(DNA[i], MAX_N);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; nn;++i) &#123;</span><br><span class="line">			num[<span class="number">0</span>] = num[<span class="number">1</span>] = num[<span class="number">2</span>] = num[<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//初始化或重置num</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; mm;++j)</span><br><span class="line">				<span class="keyword">switch</span> (DNA[j][i]) &#123;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'A'</span>: ++num[<span class="number">0</span>];<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'C'</span>: ++num[<span class="number">1</span>];<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'G'</span>: ++num[<span class="number">2</span>];<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">case</span> <span class="string">'T'</span>: ++num[<span class="number">3</span>];<span class="keyword">break</span>;</span><br><span class="line">				<span class="keyword">default</span>:<span class="built_in">cerr</span> &lt;&lt; <span class="string">"Error:1\n"</span>;<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			<span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j &lt; <span class="number">4</span>;++j)</span><br><span class="line">				<span class="keyword">if</span> (num[j]&gt;num[max])max = j;</span><br><span class="line">			consensus[i] = ACGT[max];</span><br><span class="line">			err += mm - num[max];</span><br><span class="line">		&#125;</span><br><span class="line">		consensus[nn] = <span class="string">'\0'</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; consensus &lt;&lt; <span class="string">'\n'</span> &lt;&lt; err &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：找出每个DNA序列的第i个的碱基，找到出现最多的项，即为Consensus String的第i个碱基 在算法竞赛入门经典里看到使用常量数组的方法，可以有效减少switch与if的使用，感觉很好用（虽然记得学校教材上也讲到过，但是当时没那么印象深刻）。于是这次在ACGT[]=&quot;ACGT&quot;这里用到了，真心好用呀。</p>
<p>题目：算法竞赛入门经典 3-8/UVa202：Repeating Decimals 代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa202 - Repeating Decimals</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX 502</span></span><br><span class="line"><span class="keyword">unsigned</span> Decimal[MAX];<span class="comment">//存放各个小数</span></span><br><span class="line"><span class="keyword">unsigned</span> Remainder[MAX];<span class="comment">//存放各位小数对应的余数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> numerator, denominator;<span class="comment">//分子、分母</span></span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">unsigned</span> &amp;de = denominator;</span><br><span class="line">	<span class="keyword">int</span> temp, digit;<span class="comment">//由于分母可以正可以负,先输入temp至int再转为unsigned,digit记录位数(或者说是位数-1)</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; numerator) &#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; temp;</span><br><span class="line">		digit = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; numerator &lt;&lt; <span class="string">'/'</span> &lt;&lt; temp &lt;&lt; <span class="string">" = "</span>;</span><br><span class="line">		<span class="keyword">if</span> (temp &lt; <span class="number">0</span>)temp = -temp, <span class="built_in">cout</span> &lt;&lt; <span class="string">'-'</span>;</span><br><span class="line">		denominator = (<span class="keyword">unsigned</span>)temp;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; numerator / de &lt;&lt; <span class="string">'.'</span>;</span><br><span class="line">		Decimal[<span class="number">0</span>] = (numerator % de * <span class="number">10</span>) / de;</span><br><span class="line">		Remainder[<span class="number">0</span>] = (numerator % de * <span class="number">10</span>) % de;</span><br><span class="line">		<span class="keyword">while</span> (digit &lt; MAX) &#123;</span><br><span class="line">			<span class="keyword">unsigned</span> di, t = Remainder[digit++] * <span class="number">10</span>;</span><br><span class="line">			Decimal[digit] = t / de;</span><br><span class="line">			Remainder[digit] = t % de;</span><br><span class="line">			<span class="keyword">for</span> (di = <span class="number">0</span>;di &lt; digit;++di)</span><br><span class="line">				<span class="keyword">if</span> (Decimal[di] == Decimal[digit] &amp;&amp; Remainder[di] == Remainder[digit])</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">if</span> (di &lt; digit) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; di;++i)</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; Decimal[i];</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">'('</span>;</span><br><span class="line">				<span class="keyword">if</span> (digit - di &lt;= <span class="number">50</span>)</span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> i = di;i &lt; digit;++i)</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; Decimal[i];</span><br><span class="line">				<span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">50</span>;++i)</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; Decimal[di+i];</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="string">"..."</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">")\n\t"</span> &lt;&lt; digit - di &lt;&lt; <span class="string">" = number of digits in repeating cycle\n\n"</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (digit == MAX) &#123; <span class="built_in">cerr</span> &lt;&lt; <span class="string">"Error:1\n"</span>;<span class="built_in">exit</span>(<span class="number">0</span>); &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：算出下一位小数b并与之前每一位小数比较，如果找到一位小数a，a的小数值与对应的余数均与b的小数与余数相等，则这两个数a----b之间的就是循环部分。想不出好办法，不是所有小数都是像1/3一样从第一位开始洗脑循环。</p>
<p>题目：算法竞赛入门经典 3-9/UVa10340：All in All 代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa10340 - All in All</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M 101000</span></span><br><span class="line"><span class="keyword">char</span> s[M], t[M], *ps, *pt;<span class="comment">//s短t长</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">std</span>::<span class="built_in">cin</span>&gt;&gt;s&gt;&gt;t) &#123;</span><br><span class="line"><span class="comment">//为什么scanf按了crtl^z还是不停止，还得再按一下回车才能结束程序。。。</span></span><br><span class="line"><span class="comment">//于是使用scanf导致提交总是超时，因为程序还在等着输入</span></span><br><span class="line"><span class="comment">//而cin只要按一下crtl^z再回车，马上就结束了。不懂。。</span></span><br><span class="line"><span class="comment">//好吧，于是虽然试图尽量少用cin cout，但是c的东西还是不大会用，不熟练</span></span><br><span class="line">		ps = s, pt = t;</span><br><span class="line">		<span class="keyword">while</span> (*ps != <span class="string">'\0'</span>) &#123;</span><br><span class="line">			<span class="keyword">while</span> (*pt != *ps&amp;&amp;*pt != <span class="string">'\0'</span>)++pt;</span><br><span class="line">			<span class="keyword">if</span> (*pt == <span class="string">'\0'</span>) <span class="keyword">break</span>;</span><br><span class="line">			++ps,++pt;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(*ps == <span class="string">'\0'</span> ? <span class="string">"Yes\n"</span> : <span class="string">"No\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：不难（上面用cin下面用printf是不是有点违和。。）</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>俄罗斯方块</title>
    <url>/posts/11121.html</url>
    <content><![CDATA[<p>和贪吃蛇在同一时期写的，私以为比我在网上找到的那些其他的控制台版的俄罗斯方块更精致!</p>
<p>成品地址：链接: http://pan.baidu.com/s/1jIo9Ovs 密码: 7k8j</p>
<p>当时初学编程，废寝忘食地写着玩的，现在看看优化余地很大。</p>
<p>与之前的贪吃蛇一样R键刷新界面显示，空格暂停，“暂停”两字写在游戏右侧。这次没做花哨的开始界面，也是Visual studio2015写的，一样会生成一个保存分数的文件</p>
<p>上：翻转；下：瞬间下落；左右：就是左右 ESC：退出游戏（退出游戏时做了一个略花哨的动画）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//俄罗斯方块</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="comment">/**********************************/</span></span><br><span class="line"><span class="comment">//根据小键盘,将8、2、4、6定义为上下左右,5为默认,0为退出游戏</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Sb 16<span class="comment">//Screen的宽度</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Sh 21<span class="comment">//Screen的高度</span></span></span><br><span class="line"><span class="keyword">bool</span> Screen[Sh + <span class="number">3</span>][Sb + <span class="number">2</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">unsigned</span> Speed_mulriple_limit = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">unsigned</span> Speed_mulriple = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">unsigned</span> SleepTime = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">unsigned</span> Score = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> Max=<span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Tetris</span> &#123;</span></span><br><span class="line">	<span class="keyword">bool</span> shape[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line">	<span class="keyword">unsigned</span> type;</span><br><span class="line">	<span class="keyword">unsigned</span> x, y;</span><br><span class="line">&#125;Tnow;</span><br><span class="line"><span class="comment">/**********************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Start</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Game</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">End</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Interface</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ScreenPrint</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ScreenClear</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NextShow</span><span class="params">(<span class="keyword">unsigned</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Pause</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TBuild</span><span class="params">(Tetris&amp;, <span class="keyword">unsigned</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TRotate</span><span class="params">(Tetris&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TMove</span><span class="params">(Tetris&amp;, <span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TDown</span><span class="params">(Tetris&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TCopy</span><span class="params">(Tetris&amp;, <span class="keyword">const</span> Tetris&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TShow</span><span class="params">(<span class="keyword">const</span> Tetris&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TClear</span><span class="params">(<span class="keyword">const</span> Tetris&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Judge_down</span><span class="params">(<span class="keyword">const</span> Tetris&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Judge_key</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Judge_eliminate</span><span class="params">(<span class="keyword">const</span> Tetris&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Judge_gameover</span><span class="params">(<span class="keyword">const</span> Tetris&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Pos</span><span class="params">(<span class="keyword">unsigned</span>, <span class="keyword">unsigned</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PosScreen</span><span class="params">(<span class="keyword">unsigned</span>, <span class="keyword">unsigned</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Swap</span><span class="params">(<span class="keyword">bool</span>&amp;, <span class="keyword">bool</span>&amp;)</span></span>;</span><br><span class="line"><span class="comment">/**********************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	system(<span class="string">"mode con cols=80 lines=25"</span>);</span><br><span class="line">	<span class="keyword">const</span> CONSOLE_CURSOR_INFO cursor&#123; (DWORD)<span class="number">100</span>,FALSE &#125;;</span><br><span class="line">	SetConsoleCursorInfo(GetStdHandle(STD_OUTPUT_HANDLE), &amp;cursor);</span><br><span class="line">	srand((<span class="keyword">unsigned</span>)time(<span class="number">0</span>));</span><br><span class="line">	<span class="function">ifstream <span class="title">i</span><span class="params">(<span class="string">"tetris_data.dat"</span>, ios_base::binary)</span></span>;</span><br><span class="line">	<span class="keyword">if</span> (!i) i.close();</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">unsigned</span> s;</span><br><span class="line">		i &gt;&gt; s;</span><br><span class="line">		Max = s;</span><br><span class="line">		i.close();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; Sb + <span class="number">2</span>;++i)Screen[Sh + <span class="number">2</span>][i] = Screen[Sh + <span class="number">1</span>][i] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; Sh + <span class="number">2</span>;++i)Screen[i][<span class="number">0</span>] = Screen[i][Sb + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	Pos(<span class="number">12</span>, <span class="number">16</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"要开始游戏,请先关闭输入法,再"</span>;system(<span class="string">"pause"</span>);system(<span class="string">"cls"</span>);</span><br><span class="line">	Interface();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Game</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> type_now = rand() % <span class="number">7</span>;</span><br><span class="line">	<span class="keyword">unsigned</span> type_next = rand() % <span class="number">7</span>;</span><br><span class="line">	TBuild(Tnow, type_now);</span><br><span class="line">	NextShow(type_next);</span><br><span class="line">	Tetris Tp;<span class="comment">//记录前面一步以方便删除轨迹</span></span><br><span class="line">	TCopy(Tp, Tnow);</span><br><span class="line">	<span class="keyword">int</span> count = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> speed_count = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (++count) &#123;</span><br><span class="line">		<span class="keyword">if</span> (Judge_down(Tnow)) &#123;</span><br><span class="line">			Tp.type = <span class="number">233</span>;</span><br><span class="line">			ScreenPrint();</span><br><span class="line">			<span class="keyword">if</span> (<span class="keyword">int</span> lines=Judge_eliminate(Tnow)) &#123;</span><br><span class="line">				Score += <span class="number">15</span>*lines<span class="number">-5</span>;</span><br><span class="line">				<span class="keyword">if</span> (Score &gt; Max)Max = Score;</span><br><span class="line">				++speed_count;</span><br><span class="line">				speed_count %= <span class="number">6</span>;</span><br><span class="line">				<span class="keyword">if</span> (!speed_count&amp;&amp;Speed_mulriple&gt;Speed_mulriple_limit)Speed_mulriple -= <span class="number">1</span>;</span><br><span class="line">				Pos(<span class="number">14</span>, <span class="number">56</span>);<span class="built_in">cout</span> &lt;&lt; Score;</span><br><span class="line">				Pos(<span class="number">15</span>, <span class="number">56</span>);<span class="built_in">cout</span> &lt;&lt; SleepTime*Speed_mulriple &lt;&lt; <span class="string">'s'</span>;</span><br><span class="line">				Pos(<span class="number">16</span>, <span class="number">58</span>);<span class="built_in">cout</span> &lt;&lt; Max;</span><br><span class="line">				ScreenClear();</span><br><span class="line">				ScreenPrint();</span><br><span class="line">				Sleep(<span class="number">10</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			type_now = type_next;</span><br><span class="line">			type_next = rand() % <span class="number">7</span>;</span><br><span class="line">			TBuild(Tnow, type_now);</span><br><span class="line">			Judge_gameover(Tnow);</span><br><span class="line">			NextShow(type_next);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">switch</span> (Judge_key()) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">8</span>:TRotate(Tnow);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:TMove(Tnow, <span class="number">4</span>);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">6</span>:TMove(Tnow, <span class="number">6</span>);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:TDown(Tnow);<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">0</span>:PosScreen(<span class="number">10</span>, <span class="number">4</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"Escape from Tetris!"</span>;End();</span><br><span class="line">		&#125;</span><br><span class="line">		TClear(Tp);</span><br><span class="line">		TShow(Tnow);</span><br><span class="line">		TCopy(Tp, Tnow);</span><br><span class="line">		<span class="keyword">if</span> (!(count %= Speed_mulriple)) &#123; count = <span class="number">1</span>;++Tnow.x; &#125;</span><br><span class="line">		Sleep(SleepTime);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">End</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="function">ofstream <span class="title">o</span><span class="params">(<span class="string">"tetris_data.dat"</span>, ios_base::binary)</span></span>;</span><br><span class="line">	<span class="keyword">if</span> (!o) o.close();</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		o &lt;&lt; Max;</span><br><span class="line">		o.close();</span><br><span class="line">	&#125;</span><br><span class="line">	PosScreen(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> times = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> sl = <span class="number">3</span>;</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">119</span>);</span><br><span class="line">	<span class="keyword">while</span> (num &lt; <span class="number">336</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> i, j;</span><br><span class="line">		PosScreen(times + <span class="number">1</span>, times + <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span> (i = times + <span class="number">1</span>;i &lt; Sb - times;++i) &#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;</span><br><span class="line">			++num;</span><br><span class="line">			Sleep(sl);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (j = times + <span class="number">1</span>;j &lt; Sh - times;++j) &#123;</span><br><span class="line">			PosScreen(j, i);</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;</span><br><span class="line">			++num;</span><br><span class="line">			Sleep(sl);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (;i &gt; times + <span class="number">1</span>;--i) &#123;</span><br><span class="line">			PosScreen(j, i);</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;</span><br><span class="line">			++num;</span><br><span class="line">			Sleep(sl);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (;j &gt; times + <span class="number">1</span>;--j) &#123;</span><br><span class="line">			PosScreen(j, i);</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;</span><br><span class="line">			++num;</span><br><span class="line">			Sleep(sl);</span><br><span class="line">		&#125;</span><br><span class="line">		++times;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Interface</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">8</span>);</span><br><span class="line">	Pos(<span class="number">2</span>, <span class="number">3</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■■■■■■■■■■■■■■■■■■\n"</span>;<span class="comment">//18x</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>;i &lt; <span class="number">24</span>;++i)<span class="built_in">cout</span> &lt;&lt; <span class="string">"  ■\n"</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"  ■■■■■■■■■■■■■■■■■■\n"</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>;i &lt; <span class="number">24</span>;++i) &#123;</span><br><span class="line">		Pos(i, <span class="number">37</span>); <span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;</span><br><span class="line">		<span class="keyword">if</span> (i &lt;= <span class="number">8</span> || i &gt;= <span class="number">12</span>) &#123;</span><br><span class="line">			Pos(i, <span class="number">47</span>); <span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;</span><br><span class="line">			Pos(i, <span class="number">69</span>); <span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	Pos(<span class="number">2</span>, <span class="number">47</span>); <span class="built_in">cout</span> &lt;&lt; <span class="string">"■■■■■■■■■■■■"</span>;<span class="comment">//12x</span></span><br><span class="line">	Pos(<span class="number">8</span>, <span class="number">47</span>); <span class="built_in">cout</span> &lt;&lt; <span class="string">"■■■■■■■■■■■■"</span>;</span><br><span class="line">	Pos(<span class="number">12</span>, <span class="number">47</span>); <span class="built_in">cout</span> &lt;&lt; <span class="string">"■■■■■■■■■■■■"</span>;</span><br><span class="line">	Pos(<span class="number">24</span>, <span class="number">47</span>); <span class="built_in">cout</span> &lt;&lt; <span class="string">"■■■■■■■■■■■■"</span>;</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">	Pos(<span class="number">9</span>, <span class="number">53</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"下一个  方块"</span>;</span><br><span class="line">	Pos(<span class="number">14</span>, <span class="number">51</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"得分:"</span> &lt;&lt; Score;</span><br><span class="line">	Pos(<span class="number">15</span>, <span class="number">51</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"速度:"</span> &lt;&lt; SleepTime*Speed_mulriple &lt;&lt; <span class="string">'s'</span>;</span><br><span class="line">	Pos(<span class="number">16</span>, <span class="number">51</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"最高分:"</span> &lt;&lt; Max;</span><br><span class="line">	Pos(<span class="number">17</span>, <span class="number">51</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"按R键图像复位"</span>;</span><br><span class="line">	Pos(<span class="number">18</span>, <span class="number">54</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"用于输入法导"</span>;</span><br><span class="line">	Pos(<span class="number">19</span>, <span class="number">54</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"致的显示错误"</span>;</span><br><span class="line">	Pos(<span class="number">20</span>, <span class="number">51</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"上下左右操控"</span>;</span><br><span class="line">	Pos(<span class="number">21</span>, <span class="number">51</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"按空格键暂停"</span>;</span><br><span class="line">	Pos(<span class="number">22</span>, <span class="number">51</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"按ESC结束游戏"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ScreenPrint</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= Sh;++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= Sb;++j) &#123;</span><br><span class="line">			<span class="keyword">if</span> (Screen[i][j]) &#123;</span><br><span class="line">				PosScreen(i, j);</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ScreenClear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= Sh;++i)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= Sb;++j) &#123;</span><br><span class="line">			PosScreen(i, j);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  "</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NextShow</span><span class="params">(<span class="keyword">unsigned</span> t)</span> </span>&#123;</span><br><span class="line">	Pos(<span class="number">3</span>, <span class="number">49</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"                    "</span>;</span><br><span class="line">	Pos(<span class="number">4</span>, <span class="number">49</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"                    "</span>;</span><br><span class="line">	Pos(<span class="number">5</span>, <span class="number">49</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"                    "</span>;</span><br><span class="line">	Pos(<span class="number">6</span>, <span class="number">49</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"                    "</span>;</span><br><span class="line">	Pos(<span class="number">7</span>, <span class="number">49</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"                    "</span>;</span><br><span class="line">	<span class="keyword">if</span> (t == <span class="number">0</span>) &#123; Pos(<span class="number">5</span>, <span class="number">55</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■■■■"</span>; &#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (t == <span class="number">1</span>) &#123; Pos(<span class="number">4</span>, <span class="number">57</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■■"</span>;Pos(<span class="number">5</span>, <span class="number">57</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■■"</span>; &#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (t == <span class="number">2</span>) &#123; Pos(<span class="number">4</span>, <span class="number">59</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;Pos(<span class="number">5</span>, <span class="number">55</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■■■"</span>; &#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (t == <span class="number">3</span>) &#123; Pos(<span class="number">4</span>, <span class="number">57</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;Pos(<span class="number">5</span>, <span class="number">55</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■■■"</span>; &#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (t == <span class="number">4</span>) &#123; Pos(<span class="number">4</span>, <span class="number">55</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;Pos(<span class="number">5</span>, <span class="number">55</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■■■"</span>; &#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (t == <span class="number">5</span>) &#123; Pos(<span class="number">4</span>, <span class="number">57</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■■"</span>;Pos(<span class="number">5</span>, <span class="number">55</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■■"</span>; &#125;</span><br><span class="line">	<span class="keyword">else</span> &#123; Pos(<span class="number">4</span>, <span class="number">55</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■■"</span>;Pos(<span class="number">5</span>, <span class="number">57</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■■"</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Pause</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Pos(<span class="number">11</span>, <span class="number">55</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"暂    停"</span>;</span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		Sleep(<span class="number">200</span>);</span><br><span class="line">	&#125; <span class="keyword">while</span> (!GetAsyncKeyState(VK_SPACE));</span><br><span class="line">	Pos(<span class="number">11</span>, <span class="number">55</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"        "</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TBuild</span><span class="params">(Tetris&amp; t, <span class="keyword">unsigned</span> sh)</span> </span>&#123;</span><br><span class="line">	t.x = <span class="number">0</span>;</span><br><span class="line">	t.type = sh;</span><br><span class="line">	<span class="keyword">switch</span> (sh)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">0</span>: &#123;</span><br><span class="line">		t.shape[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">0</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//</span></span><br><span class="line">		t.shape[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">3</span>] = <span class="number">1</span>;<span class="comment">//■■■■</span></span><br><span class="line">		t.shape[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//</span></span><br><span class="line">		t.shape[<span class="number">3</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//青色</span></span><br><span class="line">		t.y = <span class="number">7</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">1</span>: &#123;</span><br><span class="line">		t.shape[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;t.shape[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;t.shape[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">0</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//■■</span></span><br><span class="line">		t.shape[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">1</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//■■</span></span><br><span class="line">		t.shape[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//</span></span><br><span class="line">		t.shape[<span class="number">3</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//蓝</span></span><br><span class="line">		t.y = <span class="number">8</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>: &#123;</span><br><span class="line">		t.shape[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">1</span>;t.shape[<span class="number">0</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//  ■</span></span><br><span class="line">		t.shape[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//■■■</span></span><br><span class="line">		t.shape[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//</span></span><br><span class="line">		t.shape[<span class="number">3</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//紫</span></span><br><span class="line">		t.y = <span class="number">7</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">3</span>: &#123;</span><br><span class="line">		t.shape[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;t.shape[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">0</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">// ■</span></span><br><span class="line">		t.shape[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//■■■</span></span><br><span class="line">		t.shape[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//</span></span><br><span class="line">		t.shape[<span class="number">3</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//绿</span></span><br><span class="line">		t.y = <span class="number">7</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">4</span>: &#123;</span><br><span class="line">		t.shape[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;t.shape[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">0</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//■</span></span><br><span class="line">		t.shape[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//■■■</span></span><br><span class="line">		t.shape[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//</span></span><br><span class="line">		t.shape[<span class="number">3</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//红</span></span><br><span class="line">		t.y = <span class="number">7</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">5</span>: &#123;</span><br><span class="line">		t.shape[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;t.shape[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">1</span>;t.shape[<span class="number">0</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">// ■■</span></span><br><span class="line">		t.shape[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">1</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//■■</span></span><br><span class="line">		t.shape[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//</span></span><br><span class="line">		t.shape[<span class="number">3</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//橙色</span></span><br><span class="line">		t.y = <span class="number">7</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">6</span>: &#123;</span><br><span class="line">		t.shape[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;t.shape[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;t.shape[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">0</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//■■</span></span><br><span class="line">		t.shape[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span>;t.shape[<span class="number">1</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">// ■■</span></span><br><span class="line">		t.shape[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">2</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//</span></span><br><span class="line">		t.shape[<span class="number">3</span>][<span class="number">0</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">1</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">2</span>] = <span class="number">0</span>;t.shape[<span class="number">3</span>][<span class="number">3</span>] = <span class="number">0</span>;<span class="comment">//黄色</span></span><br><span class="line">		t.y = <span class="number">7</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">default</span>: &#123;Pos(<span class="number">1</span>, <span class="number">1</span>);<span class="built_in">cerr</span> &lt;&lt; <span class="string">"Error 2:方块种类出错!"</span>;<span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TRotate</span><span class="params">(Tetris&amp; t)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (t.type == <span class="number">0</span>) &#123;</span><br><span class="line">		Swap(t.shape[<span class="number">0</span>][<span class="number">1</span>], t.shape[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">		Swap(t.shape[<span class="number">2</span>][<span class="number">1</span>], t.shape[<span class="number">1</span>][<span class="number">2</span>]);</span><br><span class="line">		Swap(t.shape[<span class="number">3</span>][<span class="number">1</span>], t.shape[<span class="number">1</span>][<span class="number">3</span>]);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">4</span>;++j)</span><br><span class="line">				<span class="keyword">if</span> (t.shape[i][j])</span><br><span class="line">					<span class="keyword">if</span> (i + t.x &gt; Sh || j + t.y&gt;Sb || Screen[t.x + i][t.y + j]) &#123;</span><br><span class="line">						Swap(t.shape[<span class="number">0</span>][<span class="number">1</span>], t.shape[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">						Swap(t.shape[<span class="number">2</span>][<span class="number">1</span>], t.shape[<span class="number">1</span>][<span class="number">2</span>]);</span><br><span class="line">						Swap(t.shape[<span class="number">3</span>][<span class="number">1</span>], t.shape[<span class="number">1</span>][<span class="number">3</span>]);</span><br><span class="line">					&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (t.type == <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">bool</span> tmp[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">3</span>;++i)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">3</span>;++j)</span><br><span class="line">				tmp[i][j] = t.shape[i][j];</span><br><span class="line">		t.shape[<span class="number">0</span>][<span class="number">0</span>] = tmp[<span class="number">2</span>][<span class="number">0</span>];</span><br><span class="line">		t.shape[<span class="number">0</span>][<span class="number">1</span>] = tmp[<span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line">		t.shape[<span class="number">0</span>][<span class="number">2</span>] = tmp[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">		t.shape[<span class="number">1</span>][<span class="number">0</span>] = tmp[<span class="number">2</span>][<span class="number">1</span>];</span><br><span class="line">		t.shape[<span class="number">1</span>][<span class="number">2</span>] = tmp[<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line">		t.shape[<span class="number">2</span>][<span class="number">0</span>] = tmp[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">		t.shape[<span class="number">2</span>][<span class="number">1</span>] = tmp[<span class="number">1</span>][<span class="number">2</span>];</span><br><span class="line">		t.shape[<span class="number">2</span>][<span class="number">2</span>] = tmp[<span class="number">0</span>][<span class="number">2</span>];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">3</span>;++i)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">3</span>;++j)</span><br><span class="line">				<span class="keyword">if</span> (t.shape[i][j])</span><br><span class="line">					<span class="keyword">if</span> (i + t.x &gt; Sh || j + t.y&gt;Sb || Screen[t.x + i][t.y + j]) &#123;</span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">3</span>;++i)</span><br><span class="line">							<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">3</span>;++j)</span><br><span class="line">								t.shape[i][j] = tmp[i][j];</span><br><span class="line">					&#125;</span><br><span class="line">		TShow(t);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TMove</span><span class="params">(Tetris&amp; t, <span class="keyword">int</span> d)</span> </span>&#123;</span><br><span class="line">	d -= <span class="number">5</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">4</span>;++j)</span><br><span class="line">			<span class="keyword">if</span> (t.shape[i][j] &amp;&amp; Screen[t.x + i][t.y + j + d])</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">	t.y += d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TDown</span><span class="params">(Tetris&amp; t)</span> </span>&#123;</span><br><span class="line">	TClear(t);</span><br><span class="line">	<span class="keyword">int</span> l = <span class="number">0</span>, i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">for</span> (i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i)</span><br><span class="line">			<span class="keyword">for</span> (j = <span class="number">0</span>;j &lt; <span class="number">4</span>;++j)</span><br><span class="line">				<span class="keyword">if</span> (t.shape[i][j] &amp;&amp; Screen[t.x + i + <span class="number">1</span>][t.y + j]) &#123;</span><br><span class="line">					TShow(t);</span><br><span class="line">					<span class="keyword">return</span>;</span><br><span class="line">				&#125;</span><br><span class="line">		++t.x;</span><br><span class="line">	&#125;</span><br><span class="line">	Sleep(<span class="number">20</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TCopy</span><span class="params">(Tetris&amp; tt, <span class="keyword">const</span> Tetris&amp; t)</span> </span>&#123;</span><br><span class="line">	tt.type = t.type;</span><br><span class="line">	tt.x = t.x, tt.y = t.y;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">4</span>;++j)</span><br><span class="line">			tt.shape[i][j] = t.shape[i][j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TShow</span><span class="params">(<span class="keyword">const</span> Tetris&amp; t)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">4</span>;++j)</span><br><span class="line">			<span class="keyword">if</span> (t.shape[i][j] &amp;&amp; (t.x + i != <span class="number">0</span>)) &#123;</span><br><span class="line">				PosScreen(t.x + i, t.y + j);</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TClear</span><span class="params">(<span class="keyword">const</span> Tetris&amp; t)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (t.type == <span class="number">233</span>)<span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">4</span>;++j)</span><br><span class="line">			<span class="keyword">if</span> (t.shape[i][j] &amp;&amp; (t.x + i != <span class="number">0</span>)) &#123;</span><br><span class="line">				PosScreen(t.x + i, t.y + j);</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">"  "</span>;</span><br><span class="line">			&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Judge_down</span><span class="params">(<span class="keyword">const</span> Tetris&amp; t)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i)</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">4</span>;++j)</span><br><span class="line">			<span class="keyword">if</span> (t.shape[i][j] &amp;&amp; Screen[t.x + i][t.y + j]) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i)</span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">4</span>;++j)</span><br><span class="line">						<span class="keyword">if</span> (t.shape[i][j])</span><br><span class="line">							Screen[t.x + i - <span class="number">1</span>][t.y + j] = <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Judge_key</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> d = <span class="number">5</span>;</span><br><span class="line">	<span class="keyword">if</span> (GetAsyncKeyState(VK_UP)) d = <span class="number">8</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GetAsyncKeyState(VK_DOWN)) d = <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GetAsyncKeyState(VK_LEFT)) d = <span class="number">4</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GetAsyncKeyState(VK_RIGHT)) d = <span class="number">6</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GetAsyncKeyState(VK_SPACE)) Pause();</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GetAsyncKeyState(VK_ESCAPE)) d = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GetAsyncKeyState(<span class="number">0x52</span>)) &#123;</span><br><span class="line">		system(<span class="string">"cls"</span>);</span><br><span class="line">		Interface();</span><br><span class="line">		ScreenPrint();</span><br><span class="line">		Pos(<span class="number">4</span>, <span class="number">49</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"R键图像复位导致下一"</span>;</span><br><span class="line">		Pos(<span class="number">5</span>, <span class="number">49</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"个方块的显示失效BUG"</span>;</span><br><span class="line">		Pos(<span class="number">6</span>, <span class="number">49</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"不高兴修复了"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Judge_eliminate</span><span class="params">(<span class="keyword">const</span> Tetris&amp; t)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> judge = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; <span class="number">4</span>;++j)</span><br><span class="line">			<span class="keyword">if</span> (t.shape[i][j]) &#123;</span><br><span class="line">				<span class="keyword">int</span> k;</span><br><span class="line">				<span class="keyword">unsigned</span> xx = t.x - <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">for</span> (k = <span class="number">1</span>;k &lt;= Sb&amp;&amp;Screen[xx + i][k];++k);</span><br><span class="line">				<span class="keyword">if</span> (k &gt; Sb) &#123;</span><br><span class="line">					++judge;</span><br><span class="line">					<span class="keyword">int</span> blank = <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">if</span> (xx == <span class="number">1</span>) &#123;</span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>;l &lt;= Sb;++l)</span><br><span class="line">							Screen[<span class="number">1</span>][l] = <span class="number">0</span>;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">while</span> (blank != Sb) &#123;</span><br><span class="line">						blank = <span class="number">0</span>;</span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>;l &lt;= Sb;++l) &#123;</span><br><span class="line">							Screen[xx + i][l] = Screen[xx + i - <span class="number">1</span>][l];</span><br><span class="line">							<span class="keyword">if</span> (!Screen[xx + i - <span class="number">1</span>][l])++blank;</span><br><span class="line">						&#125;</span><br><span class="line">						--xx;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> judge;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Judge_gameover</span><span class="params">(<span class="keyword">const</span> Tetris&amp; t)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;++i)</span><br><span class="line">		<span class="keyword">if</span> (t.shape[<span class="number">1</span>][i] &amp;&amp; Screen[<span class="number">1</span>][t.y + i]) &#123;</span><br><span class="line">			PosScreen(<span class="number">10</span>, <span class="number">6</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"Game Over!"</span>;</span><br><span class="line">			End();</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Pos</span><span class="params">(<span class="keyword">unsigned</span> x, <span class="keyword">unsigned</span> y)</span> </span>&#123;</span><br><span class="line">	COORD p;</span><br><span class="line">	<span class="keyword">try</span> &#123; <span class="keyword">if</span> (x &lt; <span class="number">1</span> || y &lt; <span class="number">1</span>) <span class="keyword">throw</span> <span class="number">1</span>; &#125;<span class="comment">//测试代码，记得删除</span></span><br><span class="line">	<span class="keyword">catch</span> (<span class="keyword">int</span>) &#123; Pos(<span class="number">1</span>, <span class="number">1</span>);<span class="built_in">cerr</span> &lt;&lt; <span class="string">"Error 1:坐标出错!"</span>;<span class="built_in">exit</span>(<span class="number">1</span>); &#125;<span class="comment">//测试代码，记得删除</span></span><br><span class="line">	p.X = y - <span class="number">1</span>;p.Y = x - <span class="number">1</span>;</span><br><span class="line">	SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PosScreen</span><span class="params">(<span class="keyword">unsigned</span> x, <span class="keyword">unsigned</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Pos(x + <span class="number">2</span>, <span class="number">2</span> * y + <span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Swap</span><span class="params">(<span class="keyword">bool</span>&amp; a, <span class="keyword">bool</span>&amp; b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> t = a;</span><br><span class="line">	a = b;b = t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Start();</span><br><span class="line">	Game();</span><br><span class="line">	Pos(<span class="number">11</span>, <span class="number">50</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>截图：</p>
<figure>
<img src="/posts/11121/20160719213856516.png" alt="img"><figcaption>img</figcaption>
</figure>
]]></content>
      <tags>
        <tag>造轮子</tag>
        <tag>俄罗斯方块</tag>
      </tags>
  </entry>
  <entry>
    <title>贪吃蛇</title>
    <url>/posts/17402.html</url>
    <content><![CDATA[<p>很久以前自己写着玩的，已经是上个学期的事情了，优化可能不是很好。但至少运行着不卡。。</p>
<p>用的Visual Studio2015，代码复制到别的编译器可能出问题。</p>
<p>成品地址：链接: http://pan.baidu.com/s/1nvKrL6T 密码: 57m5</p>
<p>实现的功能：蛇能跑能转弯能吃豆子（废话！）；按空格暂停，所以进游戏时如果发现蛇动不了，那就是你按了空格，再按一下就好；同时有三种豆子，白色的就是普通的豆子，红色的加速效果，蓝色的减速效果。不能穿墙；还有吃到豆子会有系统警告声，不要被吓到，因为这是我让游戏发出声音的最简单的办法了；</p>
<p>因为是当时学编程以来第一次做个成品，于是做了个极其花哨的开始界面，代码里很多都是花在界面上了，其实都是没用的代码</p>
<p>如果最大化窗口，会花屏，按一下R键可以稍微恢复一点界面；游戏会生成一个文件，用于储存最高分，当然完全没有加密什么的，打开就能看到你的所有成绩，你要篡改成99999也是没问题的。</p>
<p>还有完之前关掉输入法，不然界面显示会有问题，界面出问题了按R键刷新</p>
<p>还有，游戏的对话框按钮鼠标不支持，用左右或上下选择，enter确认</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//贪吃蛇</span></span><br><span class="line"><span class="comment">//全屏下一共横里236格，竖里55格</span></span><br><span class="line"><span class="comment">//本次横里80格(或者说是40格)，竖里29格</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="comment">//-----------------------</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Xsnake</span> &#123;</span></span><br><span class="line">	<span class="keyword">unsigned</span> x, y;</span><br><span class="line">	Xsnake* next;</span><br><span class="line">&#125;*head;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Xfood</span> &#123;</span></span><br><span class="line">	<span class="keyword">unsigned</span> x, y, colour;<span class="comment">//colour:0white 1red 2blue</span></span><br><span class="line">&#125;Food;</span><br><span class="line"><span class="keyword">unsigned</span> Score = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> Max = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">unsigned</span> Length = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">unsigned</span> SleepTime = <span class="number">150</span>;</span><br><span class="line"><span class="keyword">unsigned</span> Direction = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">unsigned</span> SnakeColour = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> GameStatus = <span class="number">0</span>;<span class="comment">//0:正常,1:ESC关闭游戏,2:撞墙,3:撞尾巴</span></span><br><span class="line">				   <span class="comment">//-----------------------</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">XWelcome</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Xstart</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Xinterface</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Xgame</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Xend</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Pos</span><span class="params">(<span class="keyword">unsigned</span>, <span class="keyword">unsigned</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SnakeShow</span><span class="params">(Xsnake*)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">GetSnake</span><span class="params">(Xsnake*)</span></span>;</span><br><span class="line"><span class="function">Xsnake* <span class="title">SnakeAdd</span><span class="params">(Xsnake*, <span class="keyword">unsigned</span>, <span class="keyword">unsigned</span>)</span></span>;</span><br><span class="line"><span class="function">Xsnake* <span class="title">SnakeMove</span><span class="params">(Xsnake*, <span class="keyword">unsigned</span>)</span></span>;</span><br><span class="line"><span class="function">Xsnake* <span class="title">SnakePush_back</span><span class="params">(Xsnake*, <span class="keyword">const</span> <span class="keyword">unsigned</span>, <span class="keyword">const</span> <span class="keyword">unsigned</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">SnakeTail</span><span class="params">(Xsnake*, <span class="keyword">unsigned</span>&amp;, <span class="keyword">unsigned</span>&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">SnakeClear</span><span class="params">(<span class="keyword">unsigned</span>, <span class="keyword">unsigned</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">SnakeBite</span><span class="params">(Xsnake*)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SnakeKey</span><span class="params">(<span class="keyword">unsigned</span>&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SnakeDel</span><span class="params">(Xsnake*)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FoodCreate</span><span class="params">(Xsnake*, Xfood&amp;)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FoodShow</span><span class="params">(<span class="keyword">const</span> Xfood&amp;)</span></span>;</span><br><span class="line"><span class="comment">//-----------------------</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Pos</span><span class="params">(<span class="keyword">unsigned</span> x, <span class="keyword">unsigned</span> y)</span> </span>&#123;</span><br><span class="line">	COORD p;</span><br><span class="line">	p.X = y;p.Y = x;</span><br><span class="line">	HANDLE h = GetStdHandle(STD_OUTPUT_HANDLE);</span><br><span class="line">	SetConsoleCursorPosition(h, p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">XWelcome</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Pos(<span class="number">5</span>, <span class="number">50</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">175</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"                     "</span>;</span><br><span class="line">	Sleep(<span class="number">80</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">10</span>);</span><br><span class="line">	Pos(<span class="number">5</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  ／￣￣￣Y￣￣。＼  "</span>;</span><br><span class="line">	Pos(<span class="number">6</span>, <span class="number">50</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">175</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"                     "</span>;</span><br><span class="line">	Sleep(<span class="number">80</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">10</span>);</span><br><span class="line">	Pos(<span class="number">6</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">" l　　　　　　　　l  "</span>;</span><br><span class="line">	Pos(<span class="number">7</span>, <span class="number">50</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">175</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"                     "</span>;</span><br><span class="line">	Sleep(<span class="number">80</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">10</span>);</span><br><span class="line">	Pos(<span class="number">7</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"ヽ,,,,,／ ￣￣￣ ヽ  "</span>;</span><br><span class="line">	Pos(<span class="number">8</span>, <span class="number">50</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">175</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"                     "</span>;</span><br><span class="line">	Sleep(<span class="number">80</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">10</span>);</span><br><span class="line">	Pos(<span class="number">8</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">" |::::: 　　　　   l "</span>;</span><br><span class="line">	Pos(<span class="number">9</span>, <span class="number">50</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">175</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"                     "</span>;</span><br><span class="line">	Sleep(<span class="number">80</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">10</span>);</span><br><span class="line">	Pos(<span class="number">9</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">" |:::　   __ 　__ |  "</span>;</span><br><span class="line">	Pos(<span class="number">10</span>, <span class="number">50</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">175</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"                     "</span>;</span><br><span class="line">	Sleep(<span class="number">80</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">10</span>);</span><br><span class="line">	Pos(<span class="number">10</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">" （6　  ＼●   ● 丨 "</span>;</span><br><span class="line">	Pos(<span class="number">11</span>, <span class="number">50</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">175</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"                     "</span>;</span><br><span class="line">	Sleep(<span class="number">80</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">10</span>);</span><br><span class="line">	Pos(<span class="number">11</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">" !　　　    )..(  l  "</span>;</span><br><span class="line">	Pos(<span class="number">12</span>, <span class="number">50</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">175</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"                     "</span>;</span><br><span class="line">	Sleep(<span class="number">80</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">10</span>);</span><br><span class="line">	Pos(<span class="number">12</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  ヽ 　　　  (三) l  "</span>;</span><br><span class="line">	Pos(<span class="number">13</span>, <span class="number">50</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">175</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"                     "</span>;</span><br><span class="line">	Sleep(<span class="number">80</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">10</span>);</span><br><span class="line">	Pos(<span class="number">13</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  ／＼  　 二   ノ   "</span>;</span><br><span class="line">	Pos(<span class="number">14</span>, <span class="number">50</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">175</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"                     "</span>;</span><br><span class="line">	Sleep(<span class="number">80</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">10</span>);</span><br><span class="line">	Pos(<span class="number">14</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">" / ⌒ヽ. ‘ー—一＼  "</span>;</span><br><span class="line">	Sleep(<span class="number">80</span>);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">	Pos(<span class="number">12</span>, <span class="number">71</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"."</span>;Sleep(<span class="number">120</span>);</span><br><span class="line">	Pos(<span class="number">12</span>, <span class="number">71</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">" 。"</span>;Sleep(<span class="number">120</span>);</span><br><span class="line">	Pos(<span class="number">12</span>, <span class="number">71</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  o"</span>;Sleep(<span class="number">120</span>);</span><br><span class="line">	Pos(<span class="number">12</span>, <span class="number">71</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"   o"</span>;Sleep(<span class="number">120</span>);</span><br><span class="line">	Pos(<span class="number">12</span>, <span class="number">71</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"     0"</span>;Sleep(<span class="number">120</span>);</span><br><span class="line">	Pos(<span class="number">12</span>, <span class="number">76</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">	Pos(<span class="number">11</span>, <span class="number">84</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"o"</span>;Sleep(<span class="number">120</span>);</span><br><span class="line">	Pos(<span class="number">11</span>, <span class="number">84</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">	Pos(<span class="number">10</span>, <span class="number">85</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"."</span>;Sleep(<span class="number">120</span>);</span><br><span class="line">	Pos(<span class="number">10</span>, <span class="number">85</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Xstart</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	XWelcome();</span><br><span class="line">	<span class="keyword">const</span> CONSOLE_CURSOR_INFO cursor&#123; (DWORD)<span class="number">100</span>,FALSE &#125;;</span><br><span class="line">	SetConsoleCursorInfo(GetStdHandle(STD_OUTPUT_HANDLE), &amp;cursor);</span><br><span class="line">	head = <span class="keyword">new</span> Xsnake;</span><br><span class="line">	head-&gt;x = <span class="number">11</span>;head-&gt;y = <span class="number">38</span>;</span><br><span class="line">	head-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">	head = SnakeAdd(head, <span class="number">10</span>, <span class="number">38</span>);head = SnakeAdd(head, <span class="number">9</span>, <span class="number">38</span>);</span><br><span class="line">	head = SnakeAdd(head, <span class="number">8</span>, <span class="number">38</span>);head = SnakeAdd(head, <span class="number">7</span>, <span class="number">38</span>);</span><br><span class="line">	<span class="function">ifstream <span class="title">i</span><span class="params">(<span class="string">"snake_data.dat"</span>)</span></span>;</span><br><span class="line">	<span class="keyword">if</span> (!i) i.close();</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">unsigned</span> s;</span><br><span class="line">		<span class="keyword">while</span> (i &gt;&gt; s)</span><br><span class="line">			<span class="keyword">if</span> (s &gt; Max)Max = s;</span><br><span class="line">		i.close();</span><br><span class="line">	&#125;</span><br><span class="line">	Pos(<span class="number">16</span>, <span class="number">48</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"载入完毕，"</span>;system(<span class="string">"pause"</span>);</span><br><span class="line">	Pos(<span class="number">16</span>, <span class="number">48</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  贪吃蛇     by蟹脑板              "</span>;</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">160</span>);</span><br><span class="line">	Pos(<span class="number">18</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"    开 始 游 戏    "</span>;</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">	Pos(<span class="number">20</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"    退 出 游 戏    "</span>;</span><br><span class="line">	<span class="keyword">int</span> YN = <span class="number">8</span>;</span><br><span class="line">	<span class="keyword">while</span> (!GetAsyncKeyState(VK_RETURN)) &#123;</span><br><span class="line">		<span class="keyword">if</span> (GetAsyncKeyState(VK_UP)) &#123;</span><br><span class="line">			SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">160</span>);</span><br><span class="line">			Pos(<span class="number">18</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"    开 始 游 戏    "</span>;</span><br><span class="line">			SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">			Pos(<span class="number">20</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"    退 出 游 戏    "</span>;</span><br><span class="line">			YN = <span class="number">8</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (GetAsyncKeyState(VK_DOWN)) &#123;</span><br><span class="line">			SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">			Pos(<span class="number">18</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"    开 始 游 戏    "</span>;</span><br><span class="line">			SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">160</span>);</span><br><span class="line">			Pos(<span class="number">20</span>, <span class="number">50</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"    退 出 游 戏    "</span>;</span><br><span class="line">			YN = <span class="number">4</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (YN == <span class="number">4</span>) <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">	system(<span class="string">"cls"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Xinterface</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">136</span>);</span><br><span class="line">	Pos(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■\n"</span>;<span class="comment">//80x</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">unsigned</span> i = <span class="number">1</span>;i &lt;= <span class="number">28</span>;++i)<span class="built_in">cout</span> &lt;&lt; <span class="string">"■\n"</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">unsigned</span> i = <span class="number">1</span>;i &lt;= <span class="number">28</span>;++i) &#123;</span><br><span class="line">		Pos(i, <span class="number">78</span>);</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■"</span>;</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">	Pos(<span class="number">2</span>, <span class="number">88</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"得分:"</span> &lt;&lt; Score;</span><br><span class="line">	Pos(<span class="number">3</span>, <span class="number">88</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"长度:"</span> &lt;&lt; Length;</span><br><span class="line">	Pos(<span class="number">4</span>, <span class="number">88</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"速度:"</span> &lt;&lt; <span class="number">300</span> - SleepTime;</span><br><span class="line">	Pos(<span class="number">5</span>, <span class="number">88</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"历史最高成绩:"</span> &lt;&lt; Max;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Xgame</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Xinterface();</span><br><span class="line">	<span class="keyword">unsigned</span> tail_x = <span class="number">0</span>, tail_y = <span class="number">0</span>;</span><br><span class="line">	FoodCreate(head, Food);</span><br><span class="line">	FoodShow(Food);</span><br><span class="line">	<span class="keyword">while</span> (Length &lt; <span class="number">1026</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (Food.x == head-&gt;x &amp;&amp; Food.y == head-&gt;y) &#123;</span><br><span class="line">			<span class="keyword">if</span> (SnakeColour == <span class="number">1</span>)SleepTime += <span class="number">40</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (SnakeColour == <span class="number">2</span>)SleepTime -= <span class="number">40</span>;</span><br><span class="line">			<span class="keyword">if</span> (Food.colour == <span class="number">1</span>) &#123;</span><br><span class="line">				SleepTime -= <span class="number">40</span>;</span><br><span class="line">				Score += <span class="number">8</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (Food.colour == <span class="number">2</span>) &#123;</span><br><span class="line">				SleepTime += <span class="number">40</span>;</span><br><span class="line">				Score -= <span class="number">6</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			SnakeColour = Food.colour;</span><br><span class="line">			Score += <span class="number">10</span>;</span><br><span class="line">			++Length;</span><br><span class="line">			head = SnakePush_back(head, tail_x, tail_y);</span><br><span class="line">			FoodCreate(head, Food);</span><br><span class="line">			FoodShow(Food);</span><br><span class="line">			<span class="keyword">if</span> (SleepTime &gt; <span class="number">80</span>) SleepTime -= <span class="number">3</span>;</span><br><span class="line">			Pos(<span class="number">2</span>, <span class="number">93</span>);<span class="built_in">cout</span> &lt;&lt; Score;</span><br><span class="line">			Pos(<span class="number">3</span>, <span class="number">93</span>);<span class="built_in">cout</span> &lt;&lt; Length;</span><br><span class="line">			Pos(<span class="number">4</span>, <span class="number">93</span>);<span class="built_in">cout</span> &lt;&lt; <span class="number">300</span> - SleepTime;</span><br><span class="line">			Pos(<span class="number">5</span>, <span class="number">101</span>);<span class="built_in">cout</span> &lt;&lt; Max;</span><br><span class="line">			<span class="keyword">char</span> bel = <span class="number">7</span>;<span class="built_in">cout</span> &lt;&lt; bel;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> SnakeClear(tail_x, tail_y);</span><br><span class="line">		SnakeTail(head, tail_x, tail_y);</span><br><span class="line">		SnakeShow(head);</span><br><span class="line">		Sleep(SleepTime);</span><br><span class="line">		SnakeKey(Direction);</span><br><span class="line">		<span class="keyword">if</span> (Direction == <span class="number">0</span>) &#123;</span><br><span class="line">			GameStatus = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		head = SnakeMove(head, Direction);</span><br><span class="line">		<span class="keyword">if</span> (head-&gt;x == <span class="number">0</span> || head-&gt;x == <span class="number">29</span> || head-&gt;y == <span class="number">0</span> || head-&gt;y == <span class="number">78</span>) &#123;</span><br><span class="line">			GameStatus = <span class="number">2</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (SnakeBite(head)) &#123;</span><br><span class="line">			GameStatus = <span class="number">3</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Xend</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="function">ofstream <span class="title">o</span><span class="params">(<span class="string">"snake_data.dat"</span>, ios_base::app)</span></span>;</span><br><span class="line">	<span class="keyword">if</span> (!o) o.close();</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		o &lt;&lt; Score &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		o.close();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">switch</span> (GameStatus)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">1</span>: &#123;</span><br><span class="line">		SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">224</span>);</span><br><span class="line">		Pos(<span class="number">10</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  提示                                    "</span>;</span><br><span class="line">		SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">14</span>);</span><br><span class="line">		Pos(<span class="number">11</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏                                      ▕"</span>;</span><br><span class="line">		Pos(<span class="number">12</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏                                      ▕"</span>;</span><br><span class="line">		Pos(<span class="number">13</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▕\n"</span>;</span><br><span class="line">		SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">		Pos(<span class="number">12</span>, <span class="number">19</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"即将退出,"</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>: &#123;</span><br><span class="line">		SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">207</span>);</span><br><span class="line">		Pos(<span class="number">10</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  失败                                    "</span>;</span><br><span class="line">		SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">12</span>);</span><br><span class="line">		Pos(<span class="number">11</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏                                      ▕"</span>;</span><br><span class="line">		Pos(<span class="number">12</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏                                      ▕"</span>;</span><br><span class="line">		Pos(<span class="number">13</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▕\n"</span>;</span><br><span class="line">		SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">		Pos(<span class="number">12</span>, <span class="number">19</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"您撞墙了,"</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">3</span>: &#123;</span><br><span class="line">		SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">223</span>);</span><br><span class="line">		Pos(<span class="number">10</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  失败                                    "</span>;</span><br><span class="line">		SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">13</span>);</span><br><span class="line">		Pos(<span class="number">11</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏                                      ▕"</span>;</span><br><span class="line">		Pos(<span class="number">12</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏                                      ▕"</span>;</span><br><span class="line">		Pos(<span class="number">13</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▕\n"</span>;</span><br><span class="line">		SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">		Pos(<span class="number">12</span>, <span class="number">19</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"撞到自己,"</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">default</span>: &#123;</span><br><span class="line">		SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">175</span>);</span><br><span class="line">		Pos(<span class="number">10</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  恭喜                                    "</span>;</span><br><span class="line">		SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">10</span>);</span><br><span class="line">		Pos(<span class="number">11</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏                                      ▕"</span>;</span><br><span class="line">		Pos(<span class="number">12</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏                                      ▕"</span>;</span><br><span class="line">		Pos(<span class="number">13</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▕\n"</span>;</span><br><span class="line">		SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">		Pos(<span class="number">12</span>, <span class="number">19</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"恭喜通关,"</span>;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	Pos(<span class="number">12</span>, <span class="number">28</span>);system(<span class="string">"pause"</span>);</span><br><span class="line">	Pos(<span class="number">27</span>, <span class="number">88</span>);SnakeDel(head);</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">191</span>);</span><br><span class="line">	Pos(<span class="number">10</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  提示                                    "</span>;</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">11</span>);</span><br><span class="line">	Pos(<span class="number">11</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏                                      ▕"</span>;</span><br><span class="line">	Pos(<span class="number">12</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏                                      ▕"</span>;</span><br><span class="line">	Pos(<span class="number">13</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏                                      ▕"</span>;</span><br><span class="line">	Pos(<span class="number">14</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏                                      ▕"</span>;</span><br><span class="line">	Pos(<span class="number">15</span>, <span class="number">17</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"▏▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▕\n"</span>;</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">	Pos(<span class="number">12</span>, <span class="number">19</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"是否再玩一局？"</span>;</span><br><span class="line">	Pos(<span class="number">14</span>, <span class="number">24</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  是  "</span>;</span><br><span class="line">	Pos(<span class="number">14</span>, <span class="number">46</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  否  "</span>;</span><br><span class="line">	<span class="keyword">int</span> YN = <span class="number">6</span>;</span><br><span class="line">	<span class="keyword">while</span> (!GetAsyncKeyState(VK_RETURN)) &#123;</span><br><span class="line">		<span class="keyword">if</span> (GetAsyncKeyState(VK_LEFT)) &#123;</span><br><span class="line">			YN = <span class="number">4</span>;</span><br><span class="line">			SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">191</span>);</span><br><span class="line">			Pos(<span class="number">14</span>, <span class="number">24</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  是  "</span>;</span><br><span class="line">			SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">			Pos(<span class="number">14</span>, <span class="number">46</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  否  "</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (GetAsyncKeyState(VK_RIGHT)) &#123;</span><br><span class="line">			YN = <span class="number">6</span>;</span><br><span class="line">			SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">			Pos(<span class="number">14</span>, <span class="number">24</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  是  "</span>;</span><br><span class="line">			SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">191</span>);</span><br><span class="line">			Pos(<span class="number">14</span>, <span class="number">46</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  否  "</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">	<span class="keyword">if</span> (YN == <span class="number">4</span>) &#123;</span><br><span class="line">		Score = <span class="number">0</span>;</span><br><span class="line">		Max = <span class="number">0</span>;</span><br><span class="line">		Length = <span class="number">5</span>;</span><br><span class="line">		SleepTime = <span class="number">150</span>;</span><br><span class="line">		Direction = <span class="number">8</span>;</span><br><span class="line">		SnakeColour = <span class="number">0</span>;</span><br><span class="line">		main();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> Pos(<span class="number">29</span>, <span class="number">88</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FoodCreate</span><span class="params">(Xsnake* s, Xfood&amp; f)</span> </span>&#123;</span><br><span class="line">	srand((<span class="keyword">unsigned</span>)time(<span class="number">0</span>));</span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		f.y = <span class="number">2</span> * (rand() % <span class="number">38</span> + <span class="number">1</span>);</span><br><span class="line">		f.x = rand() % <span class="number">28</span> + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (s) &#123;</span><br><span class="line">			<span class="keyword">if</span> (s-&gt;x == f.x&amp;&amp;s-&gt;y == f.y) <span class="keyword">break</span>;</span><br><span class="line">			s = s-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">while</span> (s);</span><br><span class="line">	f.colour = rand() % <span class="number">8</span>;</span><br><span class="line">	<span class="keyword">if</span> (f.colour &gt; <span class="number">2</span>) f.colour = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FoodShow</span><span class="params">(<span class="keyword">const</span> Xfood&amp; f)</span> </span>&#123;</span><br><span class="line">	Pos(f.x, f.y);</span><br><span class="line">	<span class="keyword">if</span> (f.colour == <span class="number">1</span>)SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">12</span>);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (f.colour == <span class="number">2</span>)SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">9</span>);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"●"</span>;</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Xsnake* <span class="title">SnakeAdd</span><span class="params">(Xsnake* s, <span class="keyword">unsigned</span> xx, <span class="keyword">unsigned</span> yy)</span> </span>&#123;</span><br><span class="line">	Xsnake* n = <span class="keyword">new</span> Xsnake;</span><br><span class="line">	n-&gt;x = xx;n-&gt;y = yy;</span><br><span class="line">	n-&gt;next = s;</span><br><span class="line">	<span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Xsnake* <span class="title">SnakeMove</span><span class="params">(Xsnake* s, <span class="keyword">unsigned</span> direction)</span> </span>&#123;</span><br><span class="line">	Xsnake* h = s;</span><br><span class="line">	Xsnake* n = s;</span><br><span class="line">	<span class="keyword">while</span> (s-&gt;next) &#123;</span><br><span class="line">		n = s;</span><br><span class="line">		s = s-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	s-&gt;next = h;</span><br><span class="line">	n-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">	<span class="keyword">switch</span> (direction)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">4</span>: s-&gt;y = (s-&gt;next)-&gt;y - <span class="number">2</span>, s-&gt;x = (s-&gt;next)-&gt;x;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">6</span>: s-&gt;y = (s-&gt;next)-&gt;y + <span class="number">2</span>, s-&gt;x = (s-&gt;next)-&gt;x;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">8</span>: s-&gt;x = (s-&gt;next)-&gt;x - <span class="number">1</span>, s-&gt;y = (s-&gt;next)-&gt;y;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>: s-&gt;x = (s-&gt;next)-&gt;x + <span class="number">1</span>, s-&gt;y = (s-&gt;next)-&gt;y;<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>: <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">SnakeBite</span><span class="params">(Xsnake* s)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> xx = s-&gt;x, yy = s-&gt;y;</span><br><span class="line">	<span class="keyword">while</span> (s-&gt;next) &#123;</span><br><span class="line">		s = s-&gt;next;</span><br><span class="line">		<span class="keyword">if</span> (s-&gt;x == xx&amp;&amp;s-&gt;y == yy) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Xsnake* <span class="title">SnakePush_back</span><span class="params">(Xsnake* s, <span class="keyword">const</span> <span class="keyword">unsigned</span> xx, <span class="keyword">const</span> <span class="keyword">unsigned</span> yy)</span> </span>&#123;</span><br><span class="line">	Xsnake* ss = s;</span><br><span class="line">	<span class="keyword">while</span> (s-&gt;next) s = s-&gt;next;</span><br><span class="line">	Xsnake* n = <span class="keyword">new</span> Xsnake;</span><br><span class="line">	n-&gt;x = xx, n-&gt;y = yy;</span><br><span class="line">	n-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">	s-&gt;next = n;</span><br><span class="line">	<span class="keyword">return</span> ss;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">SnakeTail</span><span class="params">(Xsnake* s, <span class="keyword">unsigned</span>&amp; xx, <span class="keyword">unsigned</span>&amp; yy)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (s-&gt;next)s = s-&gt;next;</span><br><span class="line">	xx = s-&gt;x;yy = s-&gt;y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">SnakeClear</span><span class="params">(<span class="keyword">unsigned</span> xx, <span class="keyword">unsigned</span> yy)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (xx&amp;&amp; yy) &#123;</span><br><span class="line">		Pos(xx, yy);<span class="built_in">cout</span> &lt;&lt; <span class="string">"  "</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SnakeDel</span><span class="params">(Xsnake* s)</span> </span>&#123;</span><br><span class="line">	Xsnake* n;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (s) &#123;</span><br><span class="line">		n = s;</span><br><span class="line">		s = s-&gt;next;</span><br><span class="line">		<span class="keyword">delete</span> n;</span><br><span class="line">		++i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">"本次游戏中贪吃蛇长度为"</span> &lt;&lt; i &lt;&lt; <span class="string">'.'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SnakeShow</span><span class="params">(Xsnake* s)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (SnakeColour == <span class="number">1</span>)SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">12</span>);</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (SnakeColour == <span class="number">2</span>)SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">9</span>);</span><br><span class="line">	<span class="keyword">while</span> (s) &#123;</span><br><span class="line">		Pos(s-&gt;x, s-&gt;y);<span class="built_in">cout</span> &lt;&lt; <span class="string">"■"</span>;</span><br><span class="line">		s = s-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), <span class="number">15</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SnakeKey</span><span class="params">(<span class="keyword">unsigned</span>&amp; d)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (GetAsyncKeyState(VK_UP) &amp;&amp; d != <span class="number">2</span>) d = <span class="number">8</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GetAsyncKeyState(VK_DOWN) &amp;&amp; d != <span class="number">8</span>) d = <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GetAsyncKeyState(VK_LEFT) &amp;&amp; d != <span class="number">6</span>) d = <span class="number">4</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GetAsyncKeyState(VK_RIGHT) &amp;&amp; d != <span class="number">4</span>) d = <span class="number">6</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GetAsyncKeyState(VK_SPACE)) &#123;</span><br><span class="line">		Pos(<span class="number">14</span>, <span class="number">35</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"暂   停"</span>;</span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			Sleep(<span class="number">200</span>);</span><br><span class="line">		&#125; <span class="keyword">while</span> (!GetAsyncKeyState(VK_SPACE));</span><br><span class="line">		Pos(<span class="number">14</span>, <span class="number">35</span>);<span class="built_in">cout</span> &lt;&lt; <span class="string">"       "</span>;</span><br><span class="line">		SnakeShow(head);</span><br><span class="line">		FoodShow(Food);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GetAsyncKeyState(VK_ESCAPE)) d = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (GetAsyncKeyState(<span class="number">0x52</span>)) Xinterface(), FoodShow(Food);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//-----------------------</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	system(<span class="string">"mode con cols=120 lines=30"</span>);</span><br><span class="line">	system(<span class="string">"cls"</span>);</span><br><span class="line">	Pos(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	Xstart();</span><br><span class="line">	Xgame();</span><br><span class="line">	Xend();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//-----------------------</span></span><br></pre></td></tr></table></figure>
<p>截图：</p>
<figure>
<img src="/posts/17402/20160719145434089.png" alt="img"><figcaption>img</figcaption>
</figure>
<figure>
<img src="/posts/17402/20160719145457626.png" alt="img"><figcaption>img</figcaption>
</figure>
<figure>
<img src="/posts/17402/20160719145517189.png" alt="img"><figcaption>img</figcaption>
</figure>
]]></content>
      <tags>
        <tag>造轮子</tag>
        <tag>贪吃蛇</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典 3-4UVa455 3-5UVa227 3-6UVa232</title>
    <url>/posts/24341.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO</p>
<p>题目：算法竞赛入门经典 3-4/UVa455：Periodic Strings</p>
<p>代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa455</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> str[<span class="number">82</span>];</span><br><span class="line">	<span class="keyword">int</span> num;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; num;</span><br><span class="line">	<span class="keyword">while</span> (num--) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span>&gt;&gt;str;</span><br><span class="line">		<span class="keyword">char</span> *ps = str;</span><br><span class="line">		<span class="keyword">while</span> (*++ps != <span class="string">'\0'</span>) &#123;</span><br><span class="line">			<span class="keyword">while</span> (*ps != *str &amp;&amp; *ps != <span class="string">'\0'</span>) ++ps;</span><br><span class="line">			<span class="keyword">if</span> (*ps == <span class="string">'\0'</span>) <span class="keyword">break</span>;<span class="comment">//循环长度即本身</span></span><br><span class="line">			<span class="keyword">char</span> *begin = str, *end = ps;</span><br><span class="line">			<span class="keyword">while</span> (*++begin == *++end);</span><br><span class="line">			<span class="keyword">if</span> (*end == <span class="string">'\0'</span>&amp;&amp;!((begin - str) % (ps - str))) <span class="keyword">break</span>;<span class="comment">//&amp;&amp;的后面的部分为了排除形如abcabcab的情况</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; ps - str &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		<span class="keyword">if</span> (num) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：首先找到与输入的字符串的第一个字符相等的字符，然后判断是否循环，不是循环则继续找下一个与的哥字符相等的字符，直到读入'\0'，则循环即本身</p>
<p>而判断从第一个字符到此字符的前一个字符是否构成循环的办法是，此字符与首字符对应的下一个、下两个字符进行比较，直到遇到'\0'，则说明有可能是相等的</p>
<p>如</p>
<p>abcdabcdabcdabcdabcdabcd</p>
<p>​ ↑向右一个个比较</p>
<p>找到可能的循环点</p>
<p>​ ↓向右一个个比较</p>
<p>​ abcdabcdabcdabcdabcdabcd</p>
<p>但此比较会漏掉如abcabcabcabcabcab的情况，最后一个ab导致整个字符串无循环，用!((begin - str) % (ps - str))来检查是不是循环了整数倍</p>
<p>题目：算法竞赛入门经典 3-5/UVa227：Puzzle</p>
<p>代码：（已更新为accept版本）</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa227</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("test.in", "r", stdin);</span></span><br><span class="line">	<span class="comment">//freopen("out.txt", "w", stdout);</span></span><br><span class="line">	<span class="keyword">char</span> puzzle[<span class="number">5</span>][<span class="number">6</span>];</span><br><span class="line">	<span class="keyword">int</span> x, y, num = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">char</span> step;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span>.getline(puzzle[<span class="number">0</span>], <span class="number">6</span>) &amp;&amp; puzzle[<span class="number">0</span>][<span class="number">0</span>] != <span class="string">'Z'</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (num) <span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		<span class="keyword">bool</span> flag = <span class="number">0</span>;<span class="comment">//操作失败</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; <span class="number">5</span>;++i) <span class="built_in">cin</span>.getline(puzzle[i], <span class="number">6</span>);</span><br><span class="line">		<span class="keyword">for</span> (x = <span class="number">0</span>;x &lt; <span class="number">5</span>;++x) &#123;<span class="comment">//找出空格位置</span></span><br><span class="line">			<span class="keyword">for</span> (y = <span class="number">0</span>;y &lt; <span class="number">5</span>;++y)</span><br><span class="line">				<span class="keyword">if</span> (puzzle[x][y] == <span class="string">' '</span>) <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">if</span> (y != <span class="number">5</span>) <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> ((<span class="built_in">cin</span> &gt;&gt; step) &amp;&amp; step != <span class="string">'0'</span>) &#123;</span><br><span class="line">			<span class="keyword">int</span> cx = x, cy = y;<span class="comment">//计算对应字母的坐标</span></span><br><span class="line">			<span class="keyword">switch</span> (step) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'A'</span>:cx -= <span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'B'</span>:cx += <span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'L'</span>:cy -= <span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">'R'</span>:cy += <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (cx &gt;= <span class="number">0</span> &amp;&amp; cx &lt;= <span class="number">4</span> &amp;&amp; cy &gt;= <span class="number">0</span> &amp;&amp; cy &lt;= <span class="number">4</span>) &#123;<span class="comment">//替换字母和空格</span></span><br><span class="line">				puzzle[x][y] = puzzle[cx][cy];</span><br><span class="line">				puzzle[x = cx][y = cy] = <span class="string">' '</span>;<span class="comment">//同时x、y变化为新的地址</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;<span class="comment">//操作失败的情况</span></span><br><span class="line">				<span class="keyword">while</span> ((<span class="built_in">cin</span> &gt;&gt; step) &amp;&amp; step != <span class="string">'0'</span>);<span class="comment">//吸收非法步骤后面的所有步骤</span></span><br><span class="line">				flag = <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"Puzzle #"</span> &lt;&lt; ++num &lt;&lt; <span class="string">":\n"</span>;</span><br><span class="line">		<span class="keyword">if</span> (flag) <span class="built_in">cout</span> &lt;&lt; <span class="string">"This puzzle has no final configuration.\n"</span>;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">5</span>;++i) &#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; puzzle[i][<span class="number">0</span>];</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j &lt; <span class="number">5</span>;++j)</span><br><span class="line">					<span class="built_in">cout</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; puzzle[i][j];</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cin</span>.getline(puzzle[<span class="number">0</span>], <span class="number">3</span>);<span class="comment">//吸收'\n'</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>抱怨：查了N次没找到错误是什么，看了网上和同学许多人的代码，思路都差不多，自己做了N组数据来检测我的答案都正确，而且貌似不是输出格式的原因。拿到了一份别人已经通过了的代码，输出重定向到文件，比较我的输出和他的输出，甚至做了个程序来比较两个输出文件内容是不是一样，但就是一样。那么应该是特殊数据导致失败，然而是在想不出有什么特殊数据会让它错误的。。。大神求告知。</p>
<p>（更新：找同学给我看了一下，他也基本没改什么，但又上传了一遍，莫名其妙过了。。。虽然不知道之前哪里不对，但是上面的代码也更新为通过了的版本了）</p>
<p>他似乎就仅仅是把本来的</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">switch (step) &#123;</span><br><span class="line">			case <span class="string">'A'</span>:cx -= <span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">			case <span class="string">'B'</span>:cx += <span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">			case <span class="string">'L'</span>:cy -= <span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">			case <span class="string">'R'</span>:cy += <span class="number">1</span>;<span class="keyword">break</span>;</span><br><span class="line">                        default:cerr&lt;&lt;<span class="string">"Error:1\n"</span>;<span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">                     &#125;</span><br></pre></td></tr></table></figure>
<p>改成了现在的代码。好像就改了这个（之前由于没有通过，我也自己改了一小些的，改的都是些貌似无关紧要的东西，所以至今不知道是什么原因导致了之前的WA。。。。不爽）</p>
<p>分析：注意个吸收cin后末尾的''就行。还有吸收错误步骤后的所有步骤。本来很简单的题目，第一天莫名死活wrong answer不过，第二天莫名其妙又过了。。</p>
<p>题目：算法竞赛入门经典 3-6/UVa232：Crossword Answers</p>
<p>代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//UVa232</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> puzzle[<span class="number">10</span>][<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> px, py;<span class="comment">//puzzle的长宽高</span></span><br><span class="line">	<span class="keyword">while</span> ((<span class="built_in">cin</span> &gt;&gt; px) &amp;&amp; px != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (num) <span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; py;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; px;++i)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; py;++j)</span><br><span class="line">				<span class="built_in">cin</span> &gt;&gt; puzzle[i][j];</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"puzzle #"</span> &lt;&lt; ++num &lt;&lt; <span class="string">":\nAcross"</span>;</span><br><span class="line">		<span class="keyword">int</span> number = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; px;++i)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; py;++j)</span><br><span class="line">				<span class="keyword">if</span> (puzzle[i][j] != <span class="string">'*'</span> &amp;&amp; (i == <span class="number">0</span> || j == <span class="number">0</span> || puzzle[i - <span class="number">1</span>][j] == <span class="string">'*'</span> || puzzle[i][j - <span class="number">1</span>] == <span class="string">'*'</span>)) &#123;<span class="comment">//找出起始格</span></span><br><span class="line">					++number;</span><br><span class="line">					<span class="keyword">if</span> (j == <span class="number">0</span> || puzzle[i][j - <span class="number">1</span>] == <span class="string">'*'</span>) &#123;<span class="comment">//输出</span></span><br><span class="line">						<span class="keyword">int</span> jj = j;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span> &lt;&lt; setw(<span class="number">3</span>) &lt;&lt; number &lt;&lt; <span class="string">'.'</span> &lt;&lt; puzzle[i][jj++];</span><br><span class="line">						<span class="keyword">while</span> (jj &lt; py&amp;&amp;puzzle[i][jj] != <span class="string">'*'</span>) <span class="built_in">cout</span> &lt;&lt; puzzle[i][jj++];</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">		number = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"\nDown"</span>;</span><br><span class="line">		<span class="comment">//down与找across的步骤类似,由于分开输出，就分开循环,总感觉效率上、代码重复率上欠妥</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; px;++i)</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; py;++j)</span><br><span class="line">				<span class="keyword">if</span> (puzzle[i][j] != <span class="string">'*'</span> &amp;&amp; (i == <span class="number">0</span> || j == <span class="number">0</span> || puzzle[i - <span class="number">1</span>][j] == <span class="string">'*'</span> || puzzle[i][j - <span class="number">1</span>] == <span class="string">'*'</span>)) &#123;</span><br><span class="line">					++number;</span><br><span class="line">					<span class="keyword">if</span> (i == <span class="number">0</span> || puzzle[i - <span class="number">1</span>][j] == <span class="string">'*'</span>) &#123;</span><br><span class="line">						<span class="keyword">int</span> ii = i;</span><br><span class="line">						<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span> &lt;&lt; setw(<span class="number">3</span>) &lt;&lt; number &lt;&lt; <span class="string">'.'</span> &lt;&lt; puzzle[ii++][j];</span><br><span class="line">						<span class="keyword">while</span> (ii &lt; px&amp;&amp;puzzle[ii][j] != <span class="string">'*'</span>) <span class="built_in">cout</span> &lt;&lt; puzzle[ii++][j];</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：如中间注释所示，感觉我这样分开来算横里竖里的结果有点麻烦了，代码也重复性大。</p>
<p>但是由于它要求Across与Down分开输入，所以就这样了。本来我还想①把across直接输出，down的先存到字符串里去，最后一口气输出来，还想着或者②定义一个[10][10]的int数组，第一遍across循环时找出所有eligible，第二遍输出down就快了。</p>
<p>现在想想还是①比较快，但是当时比较懒，没有改。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
  <entry>
    <title>算法竞赛入门经典 3-1UVa1585 3-2UVa1586 3-3UVa1225</title>
    <url>/posts/45638.html</url>
    <content><![CDATA[<p>书上具体所有题目：http://pan.baidu.com/s/1hssH0KO（我也是在网上找到的pdf，但不记得是从哪里搜刮到的了，就重新上传了一遍）</p>
<p>PS：第一次写博客分享我的代码，不知道我对csdn的使用姿势对不对。想不出来要说些什么哈o(<sup>▽</sup>)o，那就直接开工，先写一篇试试。</p>
<p>题目：算法竞赛入门经典 3-1/UVa1585：Score</p>
<p>代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX 83</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> num;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; num;</span><br><span class="line">	<span class="keyword">while</span> (num--) &#123;</span><br><span class="line">		<span class="keyword">char</span> str[MAX], *ch = str;</span><br><span class="line">		<span class="keyword">int</span> score = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; str;</span><br><span class="line">		<span class="keyword">while</span> (*ch != <span class="string">'\0'</span>)</span><br><span class="line">			sum += (*(ch++) == <span class="string">'X'</span> ? score = <span class="number">0</span> : ++score);</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; sum &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：MAX定为83而不是题目限制的80是为了传说中的鲁棒性，其他好像没什么好说的。。。下一题。。</p>
<p>题目：算法竞赛入门经典 3-2/UVa1586：Molar Mass 代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">float</span> <span class="title">f</span><span class="params">(<span class="keyword">char</span> c)</span><span class="comment">//得到分子量</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">switch</span> (c) &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'C'</span>:<span class="keyword">return</span> <span class="number">12.01</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'H'</span>:<span class="keyword">return</span> <span class="number">1.008</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'O'</span>:<span class="keyword">return</span> <span class="number">16.00</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'N'</span>:<span class="keyword">return</span> <span class="number">14.01</span>;</span><br><span class="line">	<span class="keyword">default</span>:<span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">"error!\n"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">'\''</span> &lt;&lt; c &lt;&lt; <span class="string">'\''</span>;</span><br><span class="line">	<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">g</span><span class="params">(<span class="keyword">char</span> c)</span><span class="comment">//判断char的内容是不是数字</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (c &gt;= <span class="string">'0'</span>&amp;&amp;c &lt;= <span class="string">'9'</span>) <span class="keyword">return</span> <span class="number">1</span>;<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> num;<span class="comment">//判断输入个数</span></span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; num;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::fixed &lt;&lt; <span class="built_in">std</span>::setprecision(<span class="number">3</span>);</span><br><span class="line">	<span class="keyword">while</span> (num--) &#123;</span><br><span class="line">		<span class="keyword">float</span> sum = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">char</span> str[<span class="number">83</span>], *ch = str;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span>&gt;&gt;str;</span><br><span class="line">		<span class="keyword">while</span> (*ch != <span class="string">'\0'</span>) &#123;<span class="comment">//此情况下不是'\0'就是字母</span></span><br><span class="line">			<span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">char</span> c = *ch;</span><br><span class="line">			<span class="keyword">while</span> (g(*++ch))<span class="comment">//是数字</span></span><br><span class="line">				n = n * <span class="number">10</span> + *ch - <span class="string">'0'</span>;</span><br><span class="line">			<span class="keyword">if</span> (!n) n = <span class="number">1</span>;</span><br><span class="line">			sum += f(c)*n;<span class="comment">//若不是字母则报错结束程序</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; sum &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：这次写了注释，好像也没什么好说的了。。不过对于inline，我知道编译器如果觉得这个函数不够小巧，会忽略inline，但我一直不知道要多小才能编译器不忽略inline。然后因为程序比较小，所以没有给两个函数取名字，直接叫f和g。</p>
<p>题目：算法竞赛入门经典 3-3/UVa1225：Digit Counting 代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> num;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; num;</span><br><span class="line">	<span class="keyword">while</span> (num--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n, n2,d=<span class="number">1</span>, times[<span class="number">10</span>] = &#123; <span class="number">0</span> &#125;;<span class="comment">//n:输入的数字,n2:备份n,times:保存各数字出现的次数</span></span><br><span class="line">		<span class="keyword">do</span> <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;<span class="keyword">while</span> (n &gt;= <span class="number">10000</span>);</span><br><span class="line">		n2 = n;</span><br><span class="line">		<span class="keyword">while</span> (n2 /= <span class="number">10</span>) ++d;<span class="comment">//d为位数</span></span><br><span class="line">		n2 = n;</span><br><span class="line">		<span class="keyword">int</span> t = <span class="number">1</span>, sum = <span class="number">0</span>;<span class="comment">//t不断乘以10,sum代表所有数字一样多的部分</span></span><br><span class="line">		<span class="keyword">while</span> (d--) &#123;<span class="comment">//f代表某一位</span></span><br><span class="line">			<span class="keyword">int</span> f = n2 % <span class="number">10</span>;</span><br><span class="line">			n2 /= <span class="number">10</span>;</span><br><span class="line">			sum += n2*t;</span><br><span class="line">			times[<span class="number">0</span>] += (n2 - <span class="number">1</span>)*t;<span class="comment">//0太奇葩，总比别人少一个，单独算</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; f;++i) times[i] += t;</span><br><span class="line">			times[f] += <span class="number">1</span> + n%t;<span class="comment">//当前位最大数字分开算</span></span><br><span class="line">			t *= <span class="number">10</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; times[<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; <span class="number">10</span>;++i)</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">' '</span> &lt;&lt; (times[i] += sum);</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析：这题我看过网上其他人的做法，他们竟然真的把这个长长的数字串写进了字符数组，然后再遍历数组数一遍。总感觉这字符数组长度得爆炸而且慢。</p>
<p>这题的规律是：（划横线的是具体的那个数字）（以123为例）<img src="/posts/45638/20160715212702306.jpg"></p>
<p>第一列也就是12<em>1的那列，代表（除了零）所有数共有的部分（就比如123的前100中每个数字出现的一样多），在代码里用sum表示，比如对于十位上的每个数字，都出现了123/(10^2)</em>10次</p>
<p>第二列 也就是XXX各+1那列，代表特殊的那几个地方，就比如十位上数字是2，那么那超过100的23（准确说是20，个位上3不算在里面的原因在最后一列）就在此计算，但此计算不包括2</p>
<p>而最后一列又是最特殊的，比如十位上的2的与别人不同的地方在此计算，十位2开头的数120、121、122、123，十位上的2出现（123%10+1）=4次</p>
<p>零我是分开单独算的，因为它比较奇葩，就比如1、2、3而不是01、02、03，十位上的0是不写的，其实规律一样的。</p>
<p>嗯、工科男表达能力太差了。。感觉我越说越复杂。。。果然多写写博客练练表达是有好处的。</p>
<p>这次就上传这几题，看题目难度和代码长度来判断每次上传多少题目。</p>
]]></content>
      <categories>
        <category>算法竞赛</category>
        <category>算法竞赛入门经典 (第2版)</category>
      </categories>
      <tags>
        <tag>UVa</tag>
        <tag>算法竞赛入门经典</tag>
      </tags>
  </entry>
</search>
